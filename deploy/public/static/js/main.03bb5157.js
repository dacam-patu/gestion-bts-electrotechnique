/*! For license information please see main.03bb5157.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,r)=>{e.exports=r(202)},153:(e,t,r)=>{var a=r(43),n=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var a,s={},c=null,d=null;for(a in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,a)&&!o.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===s[a]&&(s[a]=t[a]);return{$$typeof:n,type:e,key:c,ref:d,props:s,_owner:l.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{var r=Symbol.for("react.element"),a=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function x(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}function v(){}function b(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=x.prototype;var y=b.prototype=new v;y.constructor=b,p(y,x.prototype),y.isPureReactComponent=!0;var w=Array.isArray,N=Object.prototype.hasOwnProperty,j={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,a){var n,s={},i=null,l=null;if(null!=t)for(n in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(i=""+t.key),t)N.call(t,n)&&!k.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(1===o)s.children=a;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps)void 0===s[n]&&(s[n]=o[n]);return{$$typeof:r,type:e,key:i,ref:l,props:s,_owner:j.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var T=/\/+/g;function _(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function C(e,t,n,s,i){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var o=!1;if(null===e)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case r:case a:o=!0}}if(o)return i=i(o=e),e=""===s?"."+_(o,0):s,w(i)?(n="",null!=e&&(n=e.replace(T,"$&/")+"/"),C(i,t,n,"",function(e){return e})):null!=i&&(S(i)&&(i=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(T,"$&/")+"/")+e)),t.push(i)),1;if(o=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var d=s+_(l=e[c],c);o+=C(l,t,n,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(l=e.next()).done;)o+=C(l=l.value,t,n,d=s+_(l,c++),i);else if("object"===l)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function A(e,t,r){if(null==e)return e;var a=[],n=0;return C(e,a,"","",function(e){return t.call(r,e,n++)}),a}function O(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},P={transition:null},D={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:P,ReactCurrentOwner:j};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,r){A(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=n,t.Profiler=i,t.PureComponent=b,t.StrictMode=s,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=L,t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=p({},e.props),s=e.key,i=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,l=j.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)N.call(t,c)&&!k.hasOwnProperty(c)&&(n[c]=void 0===t[c]&&void 0!==o?o[c]:t[c])}var c=arguments.length-2;if(1===c)n.children=a;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];n.children=o}return{$$typeof:r,type:e.type,key:s,ref:i,props:n,_owner:l}},t.createContext=function(e){return(e={$$typeof:o,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,r){return R.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,r){return R.current.useReducer(e,t,r)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return R.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var a=r-1>>>1,n=e[a];if(!(0<s(n,t)))break e;e[a]=t,e[r]=n,r=a}}function a(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var a=0,n=e.length,i=n>>>1;a<i;){var l=2*(a+1)-1,o=e[l],c=l+1,d=e[c];if(0>s(o,r))c<n&&0>s(d,o)?(e[a]=d,e[c]=r,a=c):(e[a]=o,e[l]=r,a=l);else{if(!(c<n&&0>s(d,r)))break e;e[a]=d,e[c]=r,a=c}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var c=[],d=[],u=1,f=null,h=3,m=!1,p=!1,g=!1,x="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=a(d);null!==t;){if(null===t.callback)n(d);else{if(!(t.startTime<=e))break;n(d),t.sortIndex=t.expirationTime,r(c,t)}t=a(d)}}function w(e){if(g=!1,y(e),!p)if(null!==a(c))p=!0,P(N);else{var t=a(d);null!==t&&D(w,t.startTime-e)}}function N(e,r){p=!1,g&&(g=!1,v(S),S=-1),m=!0;var s=h;try{for(y(r),f=a(c);null!==f&&(!(f.expirationTime>r)||e&&!C());){var i=f.callback;if("function"===typeof i){f.callback=null,h=f.priorityLevel;var l=i(f.expirationTime<=r);r=t.unstable_now(),"function"===typeof l?f.callback=l:f===a(c)&&n(c),y(r)}else n(c);f=a(c)}if(null!==f)var o=!0;else{var u=a(d);null!==u&&D(w,u.startTime-r),o=!1}return o}finally{f=null,h=s,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var j,k=!1,E=null,S=-1,T=5,_=-1;function C(){return!(t.unstable_now()-_<T)}function A(){if(null!==E){var e=t.unstable_now();_=e;var r=!0;try{r=E(!0,e)}finally{r?j():(k=!1,E=null)}}else k=!1}if("function"===typeof b)j=function(){b(A)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,R=O.port2;O.port1.onmessage=A,j=function(){R.postMessage(null)}}else j=function(){x(A,0)};function P(e){E=e,k||(k=!0,j())}function D(e,r){S=x(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||m||(p=!0,P(N))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var r=h;h=t;try{return e()}finally{h=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=h;h=e;try{return t()}finally{h=r}},t.unstable_scheduleCallback=function(e,n,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:u++,callback:n,priorityLevel:e,startTime:s,expirationTime:l=s+l,sortIndex:-1},s>i?(e.sortIndex=s,r(d,e),null===a(c)&&e===a(d)&&(g?(v(S),S=-1):g=!0,D(w,s-i))):(e.sortIndex=l,r(c,e),p||m||(p=!0,P(N))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=h;return function(){var r=h;h=t;try{return e.apply(this,arguments)}finally{h=r}}}},391:(e,t,r)=>{var a=r(950);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},579:(e,t,r)=>{e.exports=r(153)},730:(e,t,r)=>{var a=r(43),n=r(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,l={};function o(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(l[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},m={};function p(e,t,r,a,n,s,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new p(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new p(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new p(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new p(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new p(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,r,a){var n=g.hasOwnProperty(t)?g[t]:null;(null!==n?0!==n.type:a||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,a){if(null===t||"undefined"===typeof t||function(e,t,r,a){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,a))return!0;if(a)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,n,a)&&(r=null),a||null===n?function(e){return!!u.call(m,e)||!u.call(h,e)&&(f.test(e)?m[e]=!0:(h[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=null===r?3!==n.type&&"":r:(t=n.attributeName,a=n.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(n=n.type)||4===n&&!0===r?"":""+r,a?e.setAttributeNS(a,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x,v);g[t]=new p(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x,v);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x,v);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)});var y=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),N=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),T=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var I,M=Object.assign;function F(e){if(void 0===I)try{throw Error()}catch(Qe){var t=Qe.stack.trim().match(/\n( *(at )?)/);I=t&&t[1]||""}return"\n"+I+e}var U=!1;function z(e,t){if(!e||U)return"";U=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(Ye){var a=Ye}Reflect.construct(e,[],t)}else{try{t.call()}catch(Ye){a=Ye}e.call(t.prototype)}else{try{throw Error()}catch(Ye){a=Ye}e()}}catch(Ye){if(Ye&&a&&"string"===typeof Ye.stack){for(var n=Ye.stack.split("\n"),s=a.stack.split("\n"),i=n.length-1,l=s.length-1;1<=i&&0<=l&&n[i]!==s[l];)l--;for(;1<=i&&0<=l;i--,l--)if(n[i]!==s[l]){if(1!==i||1!==l)do{if(i--,0>--l||n[i]!==s[l]){var o="\n"+n[i].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}}while(1<=i&&0<=l);break}}}finally{U=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?F(e):""}function B(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case j:return"Fragment";case N:return"Portal";case E:return"Profiler";case k:return"StrictMode";case C:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return V(e(t))}catch(Qe){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var n=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){a=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=q(e)?e.checked?"true":"false":e.value),(e=a)!==r&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var r=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function X(e,t){var r=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;r=W(null!=t.value?t.value:r),e._wrapperState={initialChecked:a,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){J(e,t);var r=W(t.value),a=t.type;if(null!=r)"number"===a?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&Y(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,a){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&a&&(e[r].defaultSelected=!0)}else{for(r=""+W(r),t=null,n=0;n<e.length;n++){if(e[n].value===r)return e[n].selected=!0,void(a&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ne(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(s(92));if(te(r)){if(1<r.length)throw Error(s(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:W(r)}}function se(e,t){var r=W(t.value),a=W(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=a&&(e.defaultValue=""+a)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?le(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,r,a,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r)})}:e}(function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ue(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function me(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function pe(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var a=0===r.indexOf("--"),n=me(r,t[r],a);"float"===r&&(r="cssFloat"),a?e.setProperty(r,n):e[r]=n}}Object.keys(fe).forEach(function(e){he.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ge=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xe(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function ye(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ne=null,je=null;function ke(e){if(e=_n(e)){if("function"!==typeof we)throw Error(s(280));var t=e.stateNode;t&&(t=An(t),we(e.stateNode,e.type,t))}}function Ee(e){Ne?je?je.push(e):je=[e]:Ne=e}function Se(){if(Ne){var e=Ne,t=je;if(je=Ne=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Te(e,t){return e(t)}function _e(){}var Ce=!1;function Ae(e,t,r){if(Ce)return e(t,r);Ce=!0;try{return Te(e,t,r)}finally{Ce=!1,(null!==Ne||null!==je)&&(_e(),Se())}}function Oe(e,t){var r=e.stateNode;if(null===r)return null;var a=An(r);if(null===a)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(s(231,t,typeof r));return r}var Re=!1;if(d)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(Ke){Re=!1}function De(e,t,r,a,n,s,i,l,o){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var Le=!1,Ie=null,Me=!1,Fe=null,Ue={onError:function(e){Le=!0,Ie=e}};function ze(e,t,r,a,n,s,i,l,o){Le=!1,Ie=null,De.apply(Ue,arguments)}function Be(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Be(e)!==e)throw Error(s(188))}function We(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(s(188));return t!==e?null:e}for(var r=e,a=t;;){var n=r.return;if(null===n)break;var i=n.alternate;if(null===i){if(null!==(a=n.return)){r=a;continue}break}if(n.child===i.child){for(i=n.child;i;){if(i===r)return He(n),e;if(i===a)return He(n),t;i=i.sibling}throw Error(s(188))}if(r.return!==a.return)r=n,a=i;else{for(var l=!1,o=n.child;o;){if(o===r){l=!0,r=n,a=i;break}if(o===a){l=!0,a=n,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,a=n;break}if(o===a){l=!0,a=i,r=n;break}o=o.sibling}if(!l)throw Error(s(189))}}if(r.alternate!==a)throw Error(s(190))}if(3!==r.tag)throw Error(s(188));return r.stateNode.current===r?e:t}(e),null!==e?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Xe=n.unstable_scheduleCallback,Je=n.unstable_cancelCallback,Ze=n.unstable_shouldYield,et=n.unstable_requestPaint,tt=n.unstable_now,nt=n.unstable_getCurrentPriorityLevel,it=n.unstable_ImmediatePriority,lt=n.unstable_UserBlockingPriority,ot=n.unstable_NormalPriority,ct=n.unstable_LowPriority,dt=n.unstable_IdlePriority,ut=null,ft=null;var ht=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(mt(e)/pt|0)|0},mt=Math.log,pt=Math.LN2;var gt=64,xt=4194304;function vt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function bt(e,t){var r=e.pendingLanes;if(0===r)return 0;var a=0,n=e.suspendedLanes,s=e.pingedLanes,i=268435455&r;if(0!==i){var l=i&~n;0!==l?a=vt(l):0!==(s&=i)&&(a=vt(s))}else 0!==(i=r&~n)?a=vt(i):0!==s&&(a=vt(s));if(0===a)return 0;if(0!==t&&t!==a&&0===(t&n)&&((n=a&-a)>=(s=t&-t)||16===n&&0!==(4194240&s)))return t;if(0!==(4&a)&&(a|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)n=1<<(r=31-ht(t)),a|=e[r],t&=~n;return a}function yt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function wt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Nt(){var e=gt;return 0===(4194240&(gt<<=1))&&(gt=64),e}function jt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Et(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ht(t)]=r}function St(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-ht(r),n=1<<a;n&t|e[a]&t&&(e[a]|=t),r&=~n}}var Tt=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Ct,At,Ot,Rt,Pt,Dt=!1,Lt=[],It=null,Mt=null,Ft=null,Ut=new Map,Bt=new Map,Vt=[],Ht="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Mt=null;break;case"mouseover":case"mouseout":Ft=null;break;case"pointerover":case"pointerout":Ut.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bt.delete(t.pointerId)}}function qt(e,t,r,a,n,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:s,targetContainers:[n]},null!==t&&(null!==(t=_n(t))&&At(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n),e)}function Gt(e){var t=Tn(e.target);if(null!==t){var r=Be(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=Ve(r)))return e.blockedOn=t,void Pt(e.priority,function(){Ot(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function $t(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=nr(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=_n(r))&&At(t),e.blockedOn=r,!1;var a=new(r=e.nativeEvent).constructor(r.type,r);be=a,r.target.dispatchEvent(a),be=null,t.shift()}return!0}function Yt(e,t,r){$t(e)&&r.delete(t)}function Kt(){Dt=!1,null!==It&&$t(It)&&(It=null),null!==Mt&&$t(Mt)&&(Mt=null),null!==Ft&&$t(Ft)&&(Ft=null),Ut.forEach(Yt),Bt.forEach(Yt)}function Xt(e,t){e.blockedOn===t&&(e.blockedOn=null,Dt||(Dt=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Kt)))}function Jt(e){function t(t){return Xt(t,e)}if(0<Lt.length){Xt(Lt[0],e);for(var r=1;r<Lt.length;r++){var a=Lt[r];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==It&&Xt(It,e),null!==Mt&&Xt(Mt,e),null!==Ft&&Xt(Ft,e),Ut.forEach(t),Bt.forEach(t),r=0;r<Vt.length;r++)(a=Vt[r]).blockedOn===e&&(a.blockedOn=null);for(;0<Vt.length&&null===(r=Vt[0]).blockedOn;)Gt(r),null===r.blockedOn&&Vt.shift()}var Qt=y.ReactCurrentBatchConfig,Zt=!0;function er(e,t,r,a){var n=Tt,s=Qt.transition;Qt.transition=null;try{Tt=1,rr(e,t,r,a)}finally{Tt=n,Qt.transition=s}}function tr(e,t,r,a){var n=Tt,s=Qt.transition;Qt.transition=null;try{Tt=4,rr(e,t,r,a)}finally{Tt=n,Qt.transition=s}}function rr(e,t,r,a){if(Zt){var n=nr(e,t,r,a);if(null===n)Qa(e,t,a,ar,r),Wt(e,a);else if(function(e,t,r,a,n){switch(t){case"focusin":return It=qt(It,e,t,r,a,n),!0;case"dragenter":return Mt=qt(Mt,e,t,r,a,n),!0;case"mouseover":return Ft=qt(Ft,e,t,r,a,n),!0;case"pointerover":var s=n.pointerId;return Ut.set(s,qt(Ut.get(s)||null,e,t,r,a,n)),!0;case"gotpointercapture":return s=n.pointerId,Bt.set(s,qt(Bt.get(s)||null,e,t,r,a,n)),!0}return!1}(n,e,t,r,a))a.stopPropagation();else if(Wt(e,a),4&t&&-1<Ht.indexOf(e)){for(;null!==n;){var s=_n(n);if(null!==s&&Ct(s),null===(s=nr(e,t,r,a))&&Qa(e,t,a,ar,r),s===n)break;n=s}null!==n&&a.stopPropagation()}else Qa(e,t,a,null,r)}}var ar=null;function nr(e,t,r,a){if(ar=null,null!==(e=Tn(e=ye(a))))if(null===(t=Be(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ar=e,null}function sr(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nt()){case it:return 1;case lt:return 4;case ot:case ct:return 16;case dt:return 536870912;default:return 16}default:return 16}}var ir=null,lr=null,or=null;function cr(){if(or)return or;var e,t,r=lr,a=r.length,n="value"in ir?ir.value:ir.textContent,s=n.length;for(e=0;e<a&&r[e]===n[e];e++);var i=a-e;for(t=1;t<=i&&r[a-t]===n[s-t];t++);return or=n.slice(e,1<t?1-t:void 0)}function dr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ur(){return!0}function fr(){return!1}function hr(e){function t(t,r,a,n,s){for(var i in this._reactName=t,this._targetInst=a,this.type=r,this.nativeEvent=n,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(n):n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?ur:fr,this.isPropagationStopped=fr,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ur)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ur)},persist:function(){},isPersistent:ur}),t}var mr,pr,gr,xr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vr=hr(xr),br=M({},xr,{view:0,detail:0}),yr=hr(br),wr=M({},br,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==gr&&(gr&&"mousemove"===e.type?(mr=e.screenX-gr.screenX,pr=e.screenY-gr.screenY):pr=mr=0,gr=e),mr)},movementY:function(e){return"movementY"in e?e.movementY:pr}}),Nr=hr(wr),jr=hr(M({},wr,{dataTransfer:0})),kr=hr(M({},br,{relatedTarget:0})),Er=hr(M({},xr,{animationName:0,elapsedTime:0,pseudoElement:0})),Sr=M({},xr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Tr=hr(Sr),_r=hr(M({},xr,{data:0})),Cr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ar={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Or={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Or[e])&&!!t[e]}function Pr(){return Rr}var Dr=M({},br,{key:function(e){if(e.key){var t=Cr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=dr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Ar[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pr,charCode:function(e){return"keypress"===e.type?dr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?dr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Lr=hr(Dr),Ir=hr(M({},wr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Mr=hr(M({},br,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pr})),Fr=hr(M({},xr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ur=M({},wr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zr=hr(Ur),Br=[9,13,27,32],Vr=d&&"CompositionEvent"in window,Hr=null;d&&"documentMode"in document&&(Hr=document.documentMode);var Wr=d&&"TextEvent"in window&&!Hr,qr=d&&(!Vr||Hr&&8<Hr&&11>=Hr),Gr=String.fromCharCode(32),$r=!1;function Yr(e,t){switch(e){case"keyup":return-1!==Br.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Xr=!1;var Jr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Jr[e.type]:"textarea"===t}function Zr(e,t,r,a){Ee(a),0<(t=en(t,"onChange")).length&&(r=new vr("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var ea=null,ta=null;function ra(e){Ga(e,0)}function aa(e){if($(Cn(e)))return e}function na(e,t){if("change"===e)return t}var sa=!1;if(d){var ia;if(d){var la="oninput"in document;if(!la){var oa=document.createElement("div");oa.setAttribute("oninput","return;"),la="function"===typeof oa.oninput}ia=la}else ia=!1;sa=ia&&(!document.documentMode||9<document.documentMode)}function ca(){ea&&(ea.detachEvent("onpropertychange",da),ta=ea=null)}function da(e){if("value"===e.propertyName&&aa(ta)){var t=[];Zr(t,ta,e,ye(e)),Ae(ra,t)}}function ua(e,t,r){"focusin"===e?(ca(),ta=r,(ea=t).attachEvent("onpropertychange",da)):"focusout"===e&&ca()}function fa(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return aa(ta)}function ha(e,t){if("click"===e)return aa(t)}function ma(e,t){if("input"===e||"change"===e)return aa(t)}var pa="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ga(e,t){if(pa(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var n=r[a];if(!u.call(t,n)||!pa(e[n],t[n]))return!1}return!0}function xa(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function va(e,t){var r,a=xa(e);for(e=0;a;){if(3===a.nodeType){if(r=e+a.textContent.length,e<=t&&r>=t)return{node:a,offset:t-e};e=r}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=xa(a)}}function ba(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ba(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ya(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(rt){r=!1}if(!r)break;t=Y((e=t.contentWindow).document)}return t}function wa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function Na(e){var t=ya(),r=e.focusedElem,a=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&ba(r.ownerDocument.documentElement,r)){if(null!==a&&wa(r))if(t=a.start,void 0===(e=a.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var n=r.textContent.length,s=Math.min(a.start,n);a=void 0===a.end?s:Math.min(a.end,n),!e.extend&&s>a&&(n=a,a=s,s=n),n=va(r,s);var i=va(r,a);n&&i&&(1!==e.rangeCount||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(n.node,n.offset),e.removeAllRanges(),s>a?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ja=d&&"documentMode"in document&&11>=document.documentMode,ka=null,Ea=null,Sa=null,Ta=!1;function _a(e,t,r){var a=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;Ta||null==ka||ka!==Y(a)||("selectionStart"in(a=ka)&&wa(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},Sa&&ga(Sa,a)||(Sa=a,0<(a=en(Ea,"onSelect")).length&&(t=new vr("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=ka)))}function Ca(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Aa={animationend:Ca("Animation","AnimationEnd"),animationiteration:Ca("Animation","AnimationIteration"),animationstart:Ca("Animation","AnimationStart"),transitionend:Ca("Transition","TransitionEnd")},Oa={},Ra={};function Pa(e){if(Oa[e])return Oa[e];if(!Aa[e])return e;var t,r=Aa[e];for(t in r)if(r.hasOwnProperty(t)&&t in Ra)return Oa[e]=r[t];return e}d&&(Ra=document.createElement("div").style,"AnimationEvent"in window||(delete Aa.animationend.animation,delete Aa.animationiteration.animation,delete Aa.animationstart.animation),"TransitionEvent"in window||delete Aa.transitionend.transition);var Da=Pa("animationend"),La=Pa("animationiteration"),Ia=Pa("animationstart"),Ma=Pa("transitionend"),Fa=new Map,Ua="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function za(e,t){Fa.set(e,t),o(t,[e])}for(var Ba=0;Ba<Ua.length;Ba++){var Va=Ua[Ba];za(Va.toLowerCase(),"on"+(Va[0].toUpperCase()+Va.slice(1)))}za(Da,"onAnimationEnd"),za(La,"onAnimationIteration"),za(Ia,"onAnimationStart"),za("dblclick","onDoubleClick"),za("focusin","onFocus"),za("focusout","onBlur"),za(Ma,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ha="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wa=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ha));function qa(e,t,r){var a=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,a,n,i,l,o,c){if(ze.apply(this,arguments),Le){if(!Le)throw Error(s(198));var d=Ie;Le=!1,Ie=null,Me||(Me=!0,Fe=d)}}(a,t,void 0,e),e.currentTarget=null}function Ga(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var a=e[r],n=a.event;a=a.listeners;e:{var s=void 0;if(t)for(var i=a.length-1;0<=i;i--){var l=a[i],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==s&&n.isPropagationStopped())break e;qa(n,l,c),s=o}else for(i=0;i<a.length;i++){if(o=(l=a[i]).instance,c=l.currentTarget,l=l.listener,o!==s&&n.isPropagationStopped())break e;qa(n,l,c),s=o}}}if(Me)throw e=Fe,Me=!1,Fe=null,e}function $a(e,t){var r=t[kn];void 0===r&&(r=t[kn]=new Set);var a=e+"__bubble";r.has(a)||(Ja(t,e,2,!1),r.add(a))}function Ya(e,t,r){var a=0;t&&(a|=4),Ja(r,e,a,t)}var Ka="_reactListening"+Math.random().toString(36).slice(2);function Xa(e){if(!e[Ka]){e[Ka]=!0,i.forEach(function(t){"selectionchange"!==t&&(Wa.has(t)||Ya(t,!1,e),Ya(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ka]||(t[Ka]=!0,Ya("selectionchange",!1,t))}}function Ja(e,t,r,a){switch(sr(t)){case 1:var n=er;break;case 4:n=tr;break;default:n=rr}r=n.bind(null,t,r,e),n=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(n=!0),a?void 0!==n?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):void 0!==n?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function Qa(e,t,r,a,n){var s=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var l=a.stateNode.containerInfo;if(l===n||8===l.nodeType&&l.parentNode===n)break;if(4===i)for(i=a.return;null!==i;){var o=i.tag;if((3===o||4===o)&&((o=i.stateNode.containerInfo)===n||8===o.nodeType&&o.parentNode===n))return;i=i.return}for(;null!==l;){if(null===(i=Tn(l)))return;if(5===(o=i.tag)||6===o){a=s=i;continue e}l=l.parentNode}}a=a.return}Ae(function(){var a=s,n=ye(r),i=[];e:{var l=Fa.get(e);if(void 0!==l){var o=vr,c=e;switch(e){case"keypress":if(0===dr(r))break e;case"keydown":case"keyup":o=Lr;break;case"focusin":c="focus",o=kr;break;case"focusout":c="blur",o=kr;break;case"beforeblur":case"afterblur":o=kr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=Nr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=jr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=Mr;break;case Da:case La:case Ia:o=Er;break;case Ma:o=Fr;break;case"scroll":o=yr;break;case"wheel":o=zr;break;case"copy":case"cut":case"paste":o=Tr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=Ir}var d=0!==(4&t),u=!d&&"scroll"===e,f=d?null!==l?l+"Capture":null:l;d=[];for(var h,m=a;null!==m;){var p=(h=m).stateNode;if(5===h.tag&&null!==p&&(h=p,null!==f&&(null!=(p=Oe(m,f))&&d.push(Za(m,p,h)))),u)break;m=m.return}0<d.length&&(l=new o(l,c,null,r,n),i.push({event:l,listeners:d}))}}if(0===(7&t)){if(o="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||r===be||!(c=r.relatedTarget||r.fromElement)||!Tn(c)&&!c[jn])&&(o||l)&&(l=n.window===n?n:(l=n.ownerDocument)?l.defaultView||l.parentWindow:window,o?(o=a,null!==(c=(c=r.relatedTarget||r.toElement)?Tn(c):null)&&(c!==(u=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(o=null,c=a),o!==c)){if(d=Nr,p="onMouseLeave",f="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=Ir,p="onPointerLeave",f="onPointerEnter",m="pointer"),u=null==o?l:Cn(o),h=null==c?l:Cn(c),(l=new d(p,m+"leave",o,r,n)).target=u,l.relatedTarget=h,p=null,Tn(n)===a&&((d=new d(f,m+"enter",c,r,n)).target=h,d.relatedTarget=u,p=d),u=p,o&&c)e:{for(f=c,m=0,h=d=o;h;h=tn(h))m++;for(h=0,p=f;p;p=tn(p))h++;for(;0<m-h;)d=tn(d),m--;for(;0<h-m;)f=tn(f),h--;for(;m--;){if(d===f||null!==f&&d===f.alternate)break e;d=tn(d),f=tn(f)}d=null}else d=null;null!==o&&rn(i,l,o,d,!1),null!==c&&null!==u&&rn(i,u,c,d,!0)}if("select"===(o=(l=a?Cn(a):window).nodeName&&l.nodeName.toLowerCase())||"input"===o&&"file"===l.type)var g=na;else if(Qr(l))if(sa)g=ma;else{g=fa;var x=ua}else(o=l.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(g=ha);switch(g&&(g=g(e,a))?Zr(i,g,r,n):(x&&x(e,l,a),"focusout"===e&&(x=l._wrapperState)&&x.controlled&&"number"===l.type&&ee(l,"number",l.value)),x=a?Cn(a):window,e){case"focusin":(Qr(x)||"true"===x.contentEditable)&&(ka=x,Ea=a,Sa=null);break;case"focusout":Sa=Ea=ka=null;break;case"mousedown":Ta=!0;break;case"contextmenu":case"mouseup":case"dragend":Ta=!1,_a(i,r,n);break;case"selectionchange":if(ja)break;case"keydown":case"keyup":_a(i,r,n)}var v;if(Vr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Xr?Yr(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(qr&&"ko"!==r.locale&&(Xr||"onCompositionStart"!==b?"onCompositionEnd"===b&&Xr&&(v=cr()):(lr="value"in(ir=n)?ir.value:ir.textContent,Xr=!0)),0<(x=en(a,b)).length&&(b=new _r(b,e,null,r,n),i.push({event:b,listeners:x}),v?b.data=v:null!==(v=Kr(r))&&(b.data=v))),(v=Wr?function(e,t){switch(e){case"compositionend":return Kr(t);case"keypress":return 32!==t.which?null:($r=!0,Gr);case"textInput":return(e=t.data)===Gr&&$r?null:e;default:return null}}(e,r):function(e,t){if(Xr)return"compositionend"===e||!Vr&&Yr(e,t)?(e=cr(),or=lr=ir=null,Xr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return qr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(a=en(a,"onBeforeInput")).length&&(n=new _r("onBeforeInput","beforeinput",null,r,n),i.push({event:n,listeners:a}),n.data=v))}Ga(i,t)})}function Za(e,t,r){return{instance:e,listener:t,currentTarget:r}}function en(e,t){for(var r=t+"Capture",a=[];null!==e;){var n=e,s=n.stateNode;5===n.tag&&null!==s&&(n=s,null!=(s=Oe(e,r))&&a.unshift(Za(e,s,n)),null!=(s=Oe(e,t))&&a.push(Za(e,s,n))),e=e.return}return a}function tn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function rn(e,t,r,a,n){for(var s=t._reactName,i=[];null!==r&&r!==a;){var l=r,o=l.alternate,c=l.stateNode;if(null!==o&&o===a)break;5===l.tag&&null!==c&&(l=c,n?null!=(o=Oe(r,s))&&i.unshift(Za(r,o,l)):n||null!=(o=Oe(r,s))&&i.push(Za(r,o,l))),r=r.return}0!==i.length&&e.push({event:t,listeners:i})}var an=/\r\n?/g,nn=/\u0000|\uFFFD/g;function sn(e){return("string"===typeof e?e:""+e).replace(an,"\n").replace(nn,"")}function ln(e,t,r){if(t=sn(t),sn(e)!==t&&r)throw Error(s(425))}function on(){}var cn=null,dn=null;function un(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var fn="function"===typeof setTimeout?setTimeout:void 0,hn="function"===typeof clearTimeout?clearTimeout:void 0,mn="function"===typeof Promise?Promise:void 0,pn="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof mn?function(e){return mn.resolve(null).then(e).catch(gn)}:fn;function gn(e){setTimeout(function(){throw e})}function xn(e,t){var r=t,a=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&8===n.nodeType)if("/$"===(r=n.data)){if(0===a)return e.removeChild(n),void Jt(t);a--}else"$"!==r&&"$?"!==r&&"$!"!==r||a++;r=n}while(r);Jt(t)}function vn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function bn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var yn=Math.random().toString(36).slice(2),wn="__reactFiber$"+yn,Nn="__reactProps$"+yn,jn="__reactContainer$"+yn,kn="__reactEvents$"+yn,En="__reactListeners$"+yn,Sn="__reactHandles$"+yn;function Tn(e){var t=e[wn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[jn]||r[wn]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=bn(e);null!==e;){if(r=e[wn])return r;e=bn(e)}return t}r=(e=r).parentNode}return null}function _n(e){return!(e=e[wn]||e[jn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Cn(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function An(e){return e[Nn]||null}var On=[],Rn=-1;function Pn(e){return{current:e}}function Dn(e){0>Rn||(e.current=On[Rn],On[Rn]=null,Rn--)}function Ln(e,t){Rn++,On[Rn]=e.current,e.current=t}var In={},Mn=Pn(In),Fn=Pn(!1),Un=In;function zn(e,t){var r=e.type.contextTypes;if(!r)return In;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var n,s={};for(n in r)s[n]=t[n];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Bn(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Vn(){Dn(Fn),Dn(Mn)}function Hn(e,t,r){if(Mn.current!==In)throw Error(s(168));Ln(Mn,t),Ln(Fn,r)}function Wn(e,t,r){var a=e.stateNode;if(t=t.childContextTypes,"function"!==typeof a.getChildContext)return r;for(var n in a=a.getChildContext())if(!(n in t))throw Error(s(108,H(e)||"Unknown",n));return M({},r,a)}function qn(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||In,Un=Mn.current,Ln(Mn,e),Ln(Fn,Fn.current),!0}function Gn(e,t,r){var a=e.stateNode;if(!a)throw Error(s(169));r?(e=Wn(e,t,Un),a.__reactInternalMemoizedMergedChildContext=e,Dn(Fn),Dn(Mn),Ln(Mn,e)):Dn(Fn),Ln(Fn,r)}var $n=null,Yn=!1,Kn=!1;function Xn(e){null===$n?$n=[e]:$n.push(e)}function Jn(){if(!Kn&&null!==$n){Kn=!0;var e=0,t=Tt;try{var r=$n;for(Tt=1;e<r.length;e++){var a=r[e];do{a=a(!0)}while(null!==a)}$n=null,Yn=!1}catch(Ge){throw null!==$n&&($n=$n.slice(e+1)),Xe(it,Jn),Ge}finally{Tt=t,Kn=!1}}return null}var Qn=[],Zn=0,es=null,ts=0,rs=[],as=0,ns=null,ss=1,is="";function ls(e,t){Qn[Zn++]=ts,Qn[Zn++]=es,es=e,ts=t}function os(e,t,r){rs[as++]=ss,rs[as++]=is,rs[as++]=ns,ns=e;var a=ss;e=is;var n=32-ht(a)-1;a&=~(1<<n),r+=1;var s=32-ht(t)+n;if(30<s){var i=n-n%5;s=(a&(1<<i)-1).toString(32),a>>=i,n-=i,ss=1<<32-ht(t)+n|r<<n|a,is=s+e}else ss=1<<s|r<<n|a,is=e}function cs(e){null!==e.return&&(ls(e,1),os(e,1,0))}function ds(e){for(;e===es;)es=Qn[--Zn],Qn[Zn]=null,ts=Qn[--Zn],Qn[Zn]=null;for(;e===ns;)ns=rs[--as],rs[as]=null,is=rs[--as],rs[as]=null,ss=rs[--as],rs[as]=null}var us=null,fs=null,hs=!1,ms=null;function ps(e,t){var r=zc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function gs(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,us=e,fs=vn(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,us=e,fs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==ns?{id:ss,overflow:is}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=zc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,us=e,fs=null,!0);default:return!1}}function xs(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function vs(e){if(hs){var t=fs;if(t){var r=t;if(!gs(e,t)){if(xs(e))throw Error(s(418));t=vn(r.nextSibling);var a=us;t&&gs(e,t)?ps(a,r):(e.flags=-4097&e.flags|2,hs=!1,us=e)}}else{if(xs(e))throw Error(s(418));e.flags=-4097&e.flags|2,hs=!1,us=e}}}function bs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;us=e}function ys(e){if(e!==us)return!1;if(!hs)return bs(e),hs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!un(e.type,e.memoizedProps)),t&&(t=fs)){if(xs(e))throw ws(),Error(s(418));for(;t;)ps(e,t),t=vn(t.nextSibling)}if(bs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){fs=vn(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}fs=null}}else fs=us?vn(e.stateNode.nextSibling):null;return!0}function ws(){for(var e=fs;e;)e=vn(e.nextSibling)}function Ns(){fs=us=null,hs=!1}function js(e){null===ms?ms=[e]:ms.push(e)}var ks=y.ReactCurrentBatchConfig;function Es(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(s(309));var a=r.stateNode}if(!a)throw Error(s(147,e));var n=a,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=n.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(s(284));if(!r._owner)throw Error(s(290,e))}return e}function Ss(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ts(e){return(0,e._init)(e._payload)}function _s(e){function t(t,r){if(e){var a=t.deletions;null===a?(t.deletions=[r],t.flags|=16):a.push(r)}}function r(r,a){if(!e)return null;for(;null!==a;)t(r,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function n(e,t){return(e=Vc(e,t)).index=0,e.sibling=null,e}function i(t,r,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<r?(t.flags|=2,r):a:(t.flags|=2,r):(t.flags|=1048576,r)}function l(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,r,a){return null===t||6!==t.tag?((t=Gc(r,e.mode,a)).return=e,t):((t=n(t,r)).return=e,t)}function c(e,t,r,a){var s=r.type;return s===j?u(e,t,r.props.children,a,r.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===R&&Ts(s)===t.type)?((a=n(t,r.props)).ref=Es(e,t,r),a.return=e,a):((a=Hc(r.type,r.key,r.props,null,e.mode,a)).ref=Es(e,t,r),a.return=e,a)}function d(e,t,r,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=$c(r,e.mode,a)).return=e,t):((t=n(t,r.children||[])).return=e,t)}function u(e,t,r,a,s){return null===t||7!==t.tag?((t=Wc(r,e.mode,a,s)).return=e,t):((t=n(t,r)).return=e,t)}function f(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Gc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(r=Hc(t.type,t.key,t.props,null,e.mode,r)).ref=Es(e,null,t),r.return=e,r;case N:return(t=$c(t,e.mode,r)).return=e,t;case R:return f(e,(0,t._init)(t._payload),r)}if(te(t)||L(t))return(t=Wc(t,e.mode,r,null)).return=e,t;Ss(e,t)}return null}function h(e,t,r,a){var n=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==n?null:o(e,t,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===n?c(e,t,r,a):null;case N:return r.key===n?d(e,t,r,a):null;case R:return h(e,t,(n=r._init)(r._payload),a)}if(te(r)||L(r))return null!==n?null:u(e,t,r,a,null);Ss(e,r)}return null}function m(e,t,r,a,n){if("string"===typeof a&&""!==a||"number"===typeof a)return o(t,e=e.get(r)||null,""+a,n);if("object"===typeof a&&null!==a){switch(a.$$typeof){case w:return c(t,e=e.get(null===a.key?r:a.key)||null,a,n);case N:return d(t,e=e.get(null===a.key?r:a.key)||null,a,n);case R:return m(e,t,r,(0,a._init)(a._payload),n)}if(te(a)||L(a))return u(t,e=e.get(r)||null,a,n,null);Ss(t,a)}return null}function p(n,s,l,o){for(var c=null,d=null,u=s,p=s=0,g=null;null!==u&&p<l.length;p++){u.index>p?(g=u,u=null):g=u.sibling;var x=h(n,u,l[p],o);if(null===x){null===u&&(u=g);break}e&&u&&null===x.alternate&&t(n,u),s=i(x,s,p),null===d?c=x:d.sibling=x,d=x,u=g}if(p===l.length)return r(n,u),hs&&ls(n,p),c;if(null===u){for(;p<l.length;p++)null!==(u=f(n,l[p],o))&&(s=i(u,s,p),null===d?c=u:d.sibling=u,d=u);return hs&&ls(n,p),c}for(u=a(n,u);p<l.length;p++)null!==(g=m(u,n,p,l[p],o))&&(e&&null!==g.alternate&&u.delete(null===g.key?p:g.key),s=i(g,s,p),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(n,e)}),hs&&ls(n,p),c}function g(n,l,o,c){var d=L(o);if("function"!==typeof d)throw Error(s(150));if(null==(o=d.call(o)))throw Error(s(151));for(var u=d=null,p=l,g=l=0,x=null,v=o.next();null!==p&&!v.done;g++,v=o.next()){p.index>g?(x=p,p=null):x=p.sibling;var b=h(n,p,v.value,c);if(null===b){null===p&&(p=x);break}e&&p&&null===b.alternate&&t(n,p),l=i(b,l,g),null===u?d=b:u.sibling=b,u=b,p=x}if(v.done)return r(n,p),hs&&ls(n,g),d;if(null===p){for(;!v.done;g++,v=o.next())null!==(v=f(n,v.value,c))&&(l=i(v,l,g),null===u?d=v:u.sibling=v,u=v);return hs&&ls(n,g),d}for(p=a(n,p);!v.done;g++,v=o.next())null!==(v=m(p,n,g,v.value,c))&&(e&&null!==v.alternate&&p.delete(null===v.key?g:v.key),l=i(v,l,g),null===u?d=v:u.sibling=v,u=v);return e&&p.forEach(function(e){return t(n,e)}),hs&&ls(n,g),d}return function e(a,s,i,o){if("object"===typeof i&&null!==i&&i.type===j&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,d=s;null!==d;){if(d.key===c){if((c=i.type)===j){if(7===d.tag){r(a,d.sibling),(s=n(d,i.props.children)).return=a,a=s;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&Ts(c)===d.type){r(a,d.sibling),(s=n(d,i.props)).ref=Es(a,d,i),s.return=a,a=s;break e}r(a,d);break}t(a,d),d=d.sibling}i.type===j?((s=Wc(i.props.children,a.mode,o,i.key)).return=a,a=s):((o=Hc(i.type,i.key,i.props,null,a.mode,o)).ref=Es(a,s,i),o.return=a,a=o)}return l(a);case N:e:{for(d=i.key;null!==s;){if(s.key===d){if(4===s.tag&&s.stateNode.containerInfo===i.containerInfo&&s.stateNode.implementation===i.implementation){r(a,s.sibling),(s=n(s,i.children||[])).return=a,a=s;break e}r(a,s);break}t(a,s),s=s.sibling}(s=$c(i,a.mode,o)).return=a,a=s}return l(a);case R:return e(a,s,(d=i._init)(i._payload),o)}if(te(i))return p(a,s,i,o);if(L(i))return g(a,s,i,o);Ss(a,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==s&&6===s.tag?(r(a,s.sibling),(s=n(s,i)).return=a,a=s):(r(a,s),(s=Gc(i,a.mode,o)).return=a,a=s),l(a)):r(a,s)}}var Cs=_s(!0),As=_s(!1),Os=Pn(null),Rs=null,Ps=null,Ds=null;function Ls(){Ds=Ps=Rs=null}function Is(e){var t=Os.current;Dn(Os),e._currentValue=t}function Ms(e,t,r){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function Fs(e,t){Rs=e,Ds=Ps=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Tl=!0),e.firstContext=null)}function Us(e){var t=e._currentValue;if(Ds!==e)if(e={context:e,memoizedValue:t,next:null},null===Ps){if(null===Rs)throw Error(s(308));Ps=e,Rs.dependencies={lanes:0,firstContext:e}}else Ps=Ps.next=e;return t}var zs=null;function Bs(e){null===zs?zs=[e]:zs.push(e)}function Vs(e,t,r,a){var n=t.interleaved;return null===n?(r.next=r,Bs(t)):(r.next=n.next,n.next=r),t.interleaved=r,Hs(e,a)}function Hs(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Ws=!1;function qs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $s(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ys(e,t,r){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&Mo)){var n=a.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),a.pending=t,Hs(e,r)}return null===(n=a.interleaved)?(t.next=t,Bs(a)):(t.next=n.next,n.next=t),a.interleaved=t,Hs(e,r)}function Ks(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var a=t.lanes;r|=a&=e.pendingLanes,t.lanes=r,St(e,r)}}function Xs(e,t){var r=e.updateQueue,a=e.alternate;if(null!==a&&r===(a=a.updateQueue)){var n=null,s=null;if(null!==(r=r.firstBaseUpdate)){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===s?n=s=i:s=s.next=i,r=r.next}while(null!==r);null===s?n=s=t:s=s.next=t}else n=s=t;return r={baseState:a.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:a.shared,effects:a.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Js(e,t,r,a){var n=e.updateQueue;Ws=!1;var s=n.firstBaseUpdate,i=n.lastBaseUpdate,l=n.shared.pending;if(null!==l){n.shared.pending=null;var o=l,c=o.next;o.next=null,null===i?s=c:i.next=c,i=o;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===l?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=o))}if(null!==s){var u=n.baseState;for(i=0,d=c=o=null,l=s;;){var f=l.lane,h=l.eventTime;if((a&f)===f){null!==d&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,p=l;switch(f=t,h=r,p.tag){case 1:if("function"===typeof(m=p.payload)){u=m.call(h,u,f);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(f="function"===typeof(m=p.payload)?m.call(h,u,f):m)||void 0===f)break e;u=M({},u,f);break e;case 2:Ws=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(f=n.effects)?n.effects=[l]:f.push(l))}else h={eventTime:h,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(c=d=h,o=u):d=d.next=h,i|=f;if(null===(l=l.next)){if(null===(l=n.shared.pending))break;l=(f=l).next,f.next=null,n.lastBaseUpdate=f,n.shared.pending=null}}if(null===d&&(o=u),n.baseState=o,n.firstBaseUpdate=c,n.lastBaseUpdate=d,null!==(t=n.shared.interleaved)){n=t;do{i|=n.lane,n=n.next}while(n!==t)}else null===s&&(n.shared.lanes=0);qo|=i,e.lanes=i,e.memoizedState=u}}function Qs(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],n=a.callback;if(null!==n){if(a.callback=null,a=r,"function"!==typeof n)throw Error(s(191,n));n.call(a)}}}var Zs={},ei=Pn(Zs),ti=Pn(Zs),ri=Pn(Zs);function ai(e){if(e===Zs)throw Error(s(174));return e}function ni(e,t){switch(Ln(ri,t),Ln(ti,e),Ln(ei,Zs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oe(null,"");break;default:t=oe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Dn(ei),Ln(ei,t)}function si(){Dn(ei),Dn(ti),Dn(ri)}function ii(e){ai(ri.current);var t=ai(ei.current),r=oe(t,e.type);t!==r&&(Ln(ti,e),Ln(ei,r))}function li(e){ti.current===e&&(Dn(ei),Dn(ti))}var oi=Pn(0);function ci(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var di=[];function ui(){for(var e=0;e<di.length;e++)di[e]._workInProgressVersionPrimary=null;di.length=0}var fi=y.ReactCurrentDispatcher,hi=y.ReactCurrentBatchConfig,mi=0,pi=null,gi=null,xi=null,vi=!1,bi=!1,yi=0,wi=0;function Ni(){throw Error(s(321))}function ji(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!pa(e[r],t[r]))return!1;return!0}function ki(e,t,r,a,n,i){if(mi=i,pi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fi.current=null===e||null===e.memoizedState?ll:ol,e=r(a,n),bi){i=0;do{if(bi=!1,yi=0,25<=i)throw Error(s(301));i+=1,xi=gi=null,t.updateQueue=null,fi.current=cl,e=r(a,n)}while(bi)}if(fi.current=il,t=null!==gi&&null!==gi.next,mi=0,xi=gi=pi=null,vi=!1,t)throw Error(s(300));return e}function Ei(){var e=0!==yi;return yi=0,e}function Si(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===xi?pi.memoizedState=xi=e:xi=xi.next=e,xi}function Ti(){if(null===gi){var e=pi.alternate;e=null!==e?e.memoizedState:null}else e=gi.next;var t=null===xi?pi.memoizedState:xi.next;if(null!==t)xi=t,gi=e;else{if(null===e)throw Error(s(310));e={memoizedState:(gi=e).memoizedState,baseState:gi.baseState,baseQueue:gi.baseQueue,queue:gi.queue,next:null},null===xi?pi.memoizedState=xi=e:xi=xi.next=e}return xi}function _i(e,t){return"function"===typeof t?t(e):t}function Ci(e){var t=Ti(),r=t.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=e;var a=gi,n=a.baseQueue,i=r.pending;if(null!==i){if(null!==n){var l=n.next;n.next=i.next,i.next=l}a.baseQueue=n=i,r.pending=null}if(null!==n){i=n.next,a=a.baseState;var o=l=null,c=null,d=i;do{var u=d.lane;if((mi&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),a=d.hasEagerState?d.eagerState:e(a,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(o=c=f,l=a):c=c.next=f,pi.lanes|=u,qo|=u}d=d.next}while(null!==d&&d!==i);null===c?l=a:c.next=o,pa(a,t.memoizedState)||(Tl=!0),t.memoizedState=a,t.baseState=l,t.baseQueue=c,r.lastRenderedState=a}if(null!==(e=r.interleaved)){n=e;do{i=n.lane,pi.lanes|=i,qo|=i,n=n.next}while(n!==e)}else null===n&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ai(e){var t=Ti(),r=t.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=e;var a=r.dispatch,n=r.pending,i=t.memoizedState;if(null!==n){r.pending=null;var l=n=n.next;do{i=e(i,l.action),l=l.next}while(l!==n);pa(i,t.memoizedState)||(Tl=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),r.lastRenderedState=i}return[i,a]}function Oi(){}function Ri(e,t){var r=pi,a=Ti(),n=t(),i=!pa(a.memoizedState,n);if(i&&(a.memoizedState=n,Tl=!0),a=a.queue,Wi(Li.bind(null,r,a,e),[e]),a.getSnapshot!==t||i||null!==xi&&1&xi.memoizedState.tag){if(r.flags|=2048,Ui(9,Di.bind(null,r,a,n,t),void 0,null),null===Fo)throw Error(s(349));0!==(30&mi)||Pi(r,t,n)}return n}function Pi(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=pi.updateQueue)?(t={lastEffect:null,stores:null},pi.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Di(e,t,r,a){t.value=r,t.getSnapshot=a,Ii(t)&&Mi(e)}function Li(e,t,r){return r(function(){Ii(t)&&Mi(e)})}function Ii(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!pa(e,r)}catch(rt){return!0}}function Mi(e){var t=Hs(e,1);null!==t&&uc(t,e,1,-1)}function Fi(e){var t=Si();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_i,lastRenderedState:e},t.queue=e,e=e.dispatch=rl.bind(null,pi,e),[t.memoizedState,e]}function Ui(e,t,r,a){return e={tag:e,create:t,destroy:r,deps:a,next:null},null===(t=pi.updateQueue)?(t={lastEffect:null,stores:null},pi.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e),e}function zi(){return Ti().memoizedState}function Bi(e,t,r,a){var n=Si();pi.flags|=e,n.memoizedState=Ui(1|t,r,void 0,void 0===a?null:a)}function Vi(e,t,r,a){var n=Ti();a=void 0===a?null:a;var s=void 0;if(null!==gi){var i=gi.memoizedState;if(s=i.destroy,null!==a&&ji(a,i.deps))return void(n.memoizedState=Ui(t,r,s,a))}pi.flags|=e,n.memoizedState=Ui(1|t,r,s,a)}function Hi(e,t){return Bi(8390656,8,e,t)}function Wi(e,t){return Vi(2048,8,e,t)}function qi(e,t){return Vi(4,2,e,t)}function Gi(e,t){return Vi(4,4,e,t)}function $i(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Yi(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Vi(4,4,$i.bind(null,t,e),r)}function Ki(){}function Xi(e,t){var r=Ti();t=void 0===t?null:t;var a=r.memoizedState;return null!==a&&null!==t&&ji(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function Ji(e,t){var r=Ti();t=void 0===t?null:t;var a=r.memoizedState;return null!==a&&null!==t&&ji(t,a[1])?a[0]:(e=e(),r.memoizedState=[e,t],e)}function Qi(e,t,r){return 0===(21&mi)?(e.baseState&&(e.baseState=!1,Tl=!0),e.memoizedState=r):(pa(r,t)||(r=Nt(),pi.lanes|=r,qo|=r,e.baseState=!0),t)}function Zi(e,t){var r=Tt;Tt=0!==r&&4>r?r:4,e(!0);var a=hi.transition;hi.transition={};try{e(!1),t()}finally{Tt=r,hi.transition=a}}function el(){return Ti().memoizedState}function tl(e,t,r){var a=dc(e);if(r={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null},al(e))nl(t,r);else if(null!==(r=Vs(e,t,r,a))){uc(r,e,a,cc()),sl(r,t,a)}}function rl(e,t,r){var a=dc(e),n={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null};if(al(e))nl(t,n);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,l=s(i,r);if(n.hasEagerState=!0,n.eagerState=l,pa(l,i)){var o=t.interleaved;return null===o?(n.next=n,Bs(t)):(n.next=o.next,o.next=n),void(t.interleaved=n)}}catch(Ye){}null!==(r=Vs(e,t,n,a))&&(uc(r,e,a,n=cc()),sl(r,t,a))}}function al(e){var t=e.alternate;return e===pi||null!==t&&t===pi}function nl(e,t){bi=vi=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function sl(e,t,r){if(0!==(4194240&r)){var a=t.lanes;r|=a&=e.pendingLanes,t.lanes=r,St(e,r)}}var il={readContext:Us,useCallback:Ni,useContext:Ni,useEffect:Ni,useImperativeHandle:Ni,useInsertionEffect:Ni,useLayoutEffect:Ni,useMemo:Ni,useReducer:Ni,useRef:Ni,useState:Ni,useDebugValue:Ni,useDeferredValue:Ni,useTransition:Ni,useMutableSource:Ni,useSyncExternalStore:Ni,useId:Ni,unstable_isNewReconciler:!1},ll={readContext:Us,useCallback:function(e,t){return Si().memoizedState=[e,void 0===t?null:t],e},useContext:Us,useEffect:Hi,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Bi(4194308,4,$i.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Bi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bi(4,2,e,t)},useMemo:function(e,t){var r=Si();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var a=Si();return t=void 0!==r?r(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=tl.bind(null,pi,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},Si().memoizedState=e},useState:Fi,useDebugValue:Ki,useDeferredValue:function(e){return Si().memoizedState=e},useTransition:function(){var e=Fi(!1),t=e[0];return e=Zi.bind(null,e[1]),Si().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var a=pi,n=Si();if(hs){if(void 0===r)throw Error(s(407));r=r()}else{if(r=t(),null===Fo)throw Error(s(349));0!==(30&mi)||Pi(a,t,r)}n.memoizedState=r;var i={value:r,getSnapshot:t};return n.queue=i,Hi(Li.bind(null,a,i,e),[e]),a.flags|=2048,Ui(9,Di.bind(null,a,i,r,t),void 0,null),r},useId:function(){var e=Si(),t=Fo.identifierPrefix;if(hs){var r=is;t=":"+t+"R"+(r=(ss&~(1<<32-ht(ss)-1)).toString(32)+r),0<(r=yi++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=wi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ol={readContext:Us,useCallback:Xi,useContext:Us,useEffect:Wi,useImperativeHandle:Yi,useInsertionEffect:qi,useLayoutEffect:Gi,useMemo:Ji,useReducer:Ci,useRef:zi,useState:function(){return Ci(_i)},useDebugValue:Ki,useDeferredValue:function(e){return Qi(Ti(),gi.memoizedState,e)},useTransition:function(){return[Ci(_i)[0],Ti().memoizedState]},useMutableSource:Oi,useSyncExternalStore:Ri,useId:el,unstable_isNewReconciler:!1},cl={readContext:Us,useCallback:Xi,useContext:Us,useEffect:Wi,useImperativeHandle:Yi,useInsertionEffect:qi,useLayoutEffect:Gi,useMemo:Ji,useReducer:Ai,useRef:zi,useState:function(){return Ai(_i)},useDebugValue:Ki,useDeferredValue:function(e){var t=Ti();return null===gi?t.memoizedState=e:Qi(t,gi.memoizedState,e)},useTransition:function(){return[Ai(_i)[0],Ti().memoizedState]},useMutableSource:Oi,useSyncExternalStore:Ri,useId:el,unstable_isNewReconciler:!1};function dl(e,t){if(e&&e.defaultProps){for(var r in t=M({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function ul(e,t,r,a){r=null===(r=r(a,t=e.memoizedState))||void 0===r?t:M({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var fl={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var a=cc(),n=dc(e),s=$s(a,n);s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=Ys(e,s,n))&&(uc(t,e,n,a),Ks(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=cc(),n=dc(e),s=$s(a,n);s.tag=1,s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=Ys(e,s,n))&&(uc(t,e,n,a),Ks(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=cc(),a=dc(e),n=$s(r,a);n.tag=2,void 0!==t&&null!==t&&(n.callback=t),null!==(t=Ys(e,n,a))&&(uc(t,e,a,r),Ks(t,e,a))}};function hl(e,t,r,a,n,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!ga(r,a)||!ga(n,s))}function ml(e,t,r){var a=!1,n=In,s=t.contextType;return"object"===typeof s&&null!==s?s=Us(s):(n=Bn(t)?Un:Mn.current,s=(a=null!==(a=t.contextTypes)&&void 0!==a)?zn(e,n):In),t=new t(r,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=fl,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),t}function pl(e,t,r,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&fl.enqueueReplaceState(t,t.state,null)}function gl(e,t,r,a){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs={},qs(e);var s=t.contextType;"object"===typeof s&&null!==s?n.context=Us(s):(s=Bn(t)?Un:Mn.current,n.context=zn(e,s)),n.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ul(e,t,s,r),n.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof n.getSnapshotBeforeUpdate||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||(t=n.state,"function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),t!==n.state&&fl.enqueueReplaceState(n,n.state,null),Js(e,r,n,a),n.state=e.memoizedState),"function"===typeof n.componentDidMount&&(e.flags|=4194308)}function xl(e,t){try{var r="",a=t;do{r+=B(a),a=a.return}while(a);var n=r}catch(at){n="\nError generating stack: "+at.message+"\n"+at.stack}return{value:e,source:t,stack:n,digest:null}}function vl(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function bl(e,t){try{console.error(t.value)}catch(Qe){setTimeout(function(){throw Qe})}}var yl="function"===typeof WeakMap?WeakMap:Map;function wl(e,t,r){(r=$s(-1,r)).tag=3,r.payload={element:null};var a=t.value;return r.callback=function(){Zo||(Zo=!0,ec=a),bl(0,t)},r}function Nl(e,t,r){(r=$s(-1,r)).tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var n=t.value;r.payload=function(){return a(n)},r.callback=function(){bl(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(r.callback=function(){bl(0,t),"function"!==typeof a&&(null===tc?tc=new Set([this]):tc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function jl(e,t,r){var a=e.pingCache;if(null===a){a=e.pingCache=new yl;var n=new Set;a.set(t,n)}else void 0===(n=a.get(t))&&(n=new Set,a.set(t,n));n.has(r)||(n.add(r),e=Dc.bind(null,e,t,r),t.then(e,e))}function kl(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function El(e,t,r,a,n){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=$s(-1,1)).tag=2,Ys(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=n,e)}var Sl=y.ReactCurrentOwner,Tl=!1;function _l(e,t,r,a){t.child=null===e?As(t,null,r,a):Cs(t,e.child,r,a)}function Cl(e,t,r,a,n){r=r.render;var s=t.ref;return Fs(t,n),a=ki(e,t,r,a,s,n),r=Ei(),null===e||Tl?(hs&&r&&cs(t),t.flags|=1,_l(e,t,a,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Ql(e,t,n))}function Al(e,t,r,a,n){if(null===e){var s=r.type;return"function"!==typeof s||Bc(s)||void 0!==s.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Hc(r.type,null,a,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ol(e,t,s,a,n))}if(s=e.child,0===(e.lanes&n)){var i=s.memoizedProps;if((r=null!==(r=r.compare)?r:ga)(i,a)&&e.ref===t.ref)return Ql(e,t,n)}return t.flags|=1,(e=Vc(s,a)).ref=t.ref,e.return=t,t.child=e}function Ol(e,t,r,a,n){if(null!==e){var s=e.memoizedProps;if(ga(s,a)&&e.ref===t.ref){if(Tl=!1,t.pendingProps=a=s,0===(e.lanes&n))return t.lanes=e.lanes,Ql(e,t,n);0!==(131072&e.flags)&&(Tl=!0)}}return Dl(e,t,r,a,n)}function Rl(e,t,r){var a=t.pendingProps,n=a.children,s=null!==e?e.memoizedState:null;if("hidden"===a.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ln(Vo,Bo),Bo|=r;else{if(0===(1073741824&r))return e=null!==s?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ln(Vo,Bo),Bo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=null!==s?s.baseLanes:r,Ln(Vo,Bo),Bo|=a}else null!==s?(a=s.baseLanes|r,t.memoizedState=null):a=r,Ln(Vo,Bo),Bo|=a;return _l(e,t,n,r),t.child}function Pl(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Dl(e,t,r,a,n){var s=Bn(r)?Un:Mn.current;return s=zn(t,s),Fs(t,n),r=ki(e,t,r,a,s,n),a=Ei(),null===e||Tl?(hs&&a&&cs(t),t.flags|=1,_l(e,t,r,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Ql(e,t,n))}function Ll(e,t,r,a,n){if(Bn(r)){var s=!0;qn(t)}else s=!1;if(Fs(t,n),null===t.stateNode)Jl(e,t),ml(t,r,a),gl(t,r,a,n),a=!0;else if(null===e){var i=t.stateNode,l=t.memoizedProps;i.props=l;var o=i.context,c=r.contextType;"object"===typeof c&&null!==c?c=Us(c):c=zn(t,c=Bn(r)?Un:Mn.current);var d=r.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==a||o!==c)&&pl(t,i,a,c),Ws=!1;var f=t.memoizedState;i.state=f,Js(t,a,i,n),o=t.memoizedState,l!==a||f!==o||Fn.current||Ws?("function"===typeof d&&(ul(t,r,d,a),o=t.memoizedState),(l=Ws||hl(t,r,l,a,f,o,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=o),i.props=a,i.state=o,i.context=c,a=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,Gs(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:dl(t.type,l),i.props=c,u=t.pendingProps,f=i.context,"object"===typeof(o=r.contextType)&&null!==o?o=Us(o):o=zn(t,o=Bn(r)?Un:Mn.current);var h=r.getDerivedStateFromProps;(d="function"===typeof h||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==u||f!==o)&&pl(t,i,a,o),Ws=!1,f=t.memoizedState,i.state=f,Js(t,a,i,n);var m=t.memoizedState;l!==u||f!==m||Fn.current||Ws?("function"===typeof h&&(ul(t,r,h,a),m=t.memoizedState),(c=Ws||hl(t,r,c,a,f,m,o)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(a,m,o),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(a,m,o)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=m),i.props=a,i.state=m,i.context=o,a=c):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),a=!1)}return Il(e,t,r,a,s,n)}function Il(e,t,r,a,n,s){Pl(e,t);var i=0!==(128&t.flags);if(!a&&!i)return n&&Gn(t,r,!1),Ql(e,t,s);a=t.stateNode,Sl.current=t;var l=i&&"function"!==typeof r.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&i?(t.child=Cs(t,e.child,null,s),t.child=Cs(t,null,l,s)):_l(e,t,l,s),t.memoizedState=a.state,n&&Gn(t,r,!0),t.child}function Ml(e){var t=e.stateNode;t.pendingContext?Hn(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Hn(0,t.context,!1),ni(e,t.containerInfo)}function Fl(e,t,r,a,n){return Ns(),js(n),t.flags|=256,_l(e,t,r,a),t.child}var Ul,zl,Bl,Vl,Hl={dehydrated:null,treeContext:null,retryLane:0};function Wl(e){return{baseLanes:e,cachePool:null,transitions:null}}function ql(e,t,r){var a,n=t.pendingProps,i=oi.current,l=!1,o=0!==(128&t.flags);if((a=o)||(a=(null===e||null!==e.memoizedState)&&0!==(2&i)),a?(l=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Ln(oi,1&i),null===e)return vs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=n.children,e=n.fallback,l?(n=t.mode,l=t.child,o={mode:"hidden",children:o},0===(1&n)&&null!==l?(l.childLanes=0,l.pendingProps=o):l=qc(o,n,0,null),e=Wc(e,n,r,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Wl(r),t.memoizedState=Hl,e):Gl(t,o));if(null!==(i=e.memoizedState)&&null!==(a=i.dehydrated))return function(e,t,r,a,n,i,l){if(r)return 256&t.flags?(t.flags&=-257,$l(e,t,l,a=vl(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=a.fallback,n=t.mode,a=qc({mode:"visible",children:a.children},n,0,null),(i=Wc(i,n,l,null)).flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,0!==(1&t.mode)&&Cs(t,e.child,null,l),t.child.memoizedState=Wl(l),t.memoizedState=Hl,i);if(0===(1&t.mode))return $l(e,t,l,null);if("$!"===n.data){if(a=n.nextSibling&&n.nextSibling.dataset)var o=a.dgst;return a=o,$l(e,t,l,a=vl(i=Error(s(419)),a,void 0))}if(o=0!==(l&e.childLanes),Tl||o){if(null!==(a=Fo)){switch(l&-l){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}0!==(n=0!==(n&(a.suspendedLanes|l))?0:n)&&n!==i.retryLane&&(i.retryLane=n,Hs(e,n),uc(a,e,n,-1))}return kc(),$l(e,t,l,a=vl(Error(s(421))))}return"$?"===n.data?(t.flags|=128,t.child=e.child,t=Ic.bind(null,e),n._reactRetry=t,null):(e=i.treeContext,fs=vn(n.nextSibling),us=t,hs=!0,ms=null,null!==e&&(rs[as++]=ss,rs[as++]=is,rs[as++]=ns,ss=e.id,is=e.overflow,ns=t),t=Gl(t,a.children),t.flags|=4096,t)}(e,t,o,n,a,i,r);if(l){l=n.fallback,o=t.mode,a=(i=e.child).sibling;var c={mode:"hidden",children:n.children};return 0===(1&o)&&t.child!==i?((n=t.child).childLanes=0,n.pendingProps=c,t.deletions=null):(n=Vc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==a?l=Vc(a,l):(l=Wc(l,o,r,null)).flags|=2,l.return=t,n.return=t,n.sibling=l,t.child=n,n=l,l=t.child,o=null===(o=e.child.memoizedState)?Wl(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=e.childLanes&~r,t.memoizedState=Hl,n}return e=(l=e.child).sibling,n=Vc(l,{mode:"visible",children:n.children}),0===(1&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Gl(e,t){return(t=qc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function $l(e,t,r,a){return null!==a&&js(a),Cs(t,e.child,null,r),(e=Gl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Yl(e,t,r){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),Ms(e.return,t,r)}function Kl(e,t,r,a,n){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:n}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=a,s.tail=r,s.tailMode=n)}function Xl(e,t,r){var a=t.pendingProps,n=a.revealOrder,s=a.tail;if(_l(e,t,a.children,r),0!==(2&(a=oi.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Yl(e,r,t);else if(19===e.tag)Yl(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Ln(oi,a),0===(1&t.mode))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;null!==r;)null!==(e=r.alternate)&&null===ci(e)&&(n=r),r=r.sibling;null===(r=n)?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),Kl(t,!1,n,r,s);break;case"backwards":for(r=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===ci(e)){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}Kl(t,!0,r,null,s);break;case"together":Kl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Jl(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ql(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),qo|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(r=Vc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Vc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Zl(e,t){if(!hs)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;null!==r;)null!==r.alternate&&(a=r),r=r.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function eo(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,a=0;if(t)for(var n=e.child;null!==n;)r|=n.lanes|n.childLanes,a|=14680064&n.subtreeFlags,a|=14680064&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)r|=n.lanes|n.childLanes,a|=n.subtreeFlags,a|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function to(e,t,r){var a=t.pendingProps;switch(ds(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return eo(t),null;case 1:case 17:return Bn(t.type)&&Vn(),eo(t),null;case 3:return a=t.stateNode,si(),Dn(Fn),Dn(Mn),ui(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(ys(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ms&&(pc(ms),ms=null))),zl(e,t),eo(t),null;case 5:li(t);var n=ai(ri.current);if(r=t.type,null!==e&&null!=t.stateNode)Bl(e,t,r,a,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(null===t.stateNode)throw Error(s(166));return eo(t),null}if(e=ai(ei.current),ys(t)){a=t.stateNode,r=t.type;var i=t.memoizedProps;switch(a[wn]=t,a[Nn]=i,e=0!==(1&t.mode),r){case"dialog":$a("cancel",a),$a("close",a);break;case"iframe":case"object":case"embed":$a("load",a);break;case"video":case"audio":for(n=0;n<Ha.length;n++)$a(Ha[n],a);break;case"source":$a("error",a);break;case"img":case"image":case"link":$a("error",a),$a("load",a);break;case"details":$a("toggle",a);break;case"input":X(a,i),$a("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},$a("invalid",a);break;case"textarea":ne(a,i),$a("invalid",a)}for(var o in xe(r,i),n=null,i)if(i.hasOwnProperty(o)){var c=i[o];"children"===o?"string"===typeof c?a.textContent!==c&&(!0!==i.suppressHydrationWarning&&ln(a.textContent,c,e),n=["children",c]):"number"===typeof c&&a.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&ln(a.textContent,c,e),n=["children",""+c]):l.hasOwnProperty(o)&&null!=c&&"onScroll"===o&&$a("scroll",a)}switch(r){case"input":G(a),Z(a,i,!0);break;case"textarea":G(a),ie(a);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(a.onclick=on)}a=n,t.updateQueue=a,null!==a&&(t.flags|=4)}else{o=9===n.nodeType?n:n.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=le(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=o.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof a.is?e=o.createElement(r,{is:a.is}):(e=o.createElement(r),"select"===r&&(o=e,a.multiple?o.multiple=!0:a.size&&(o.size=a.size))):e=o.createElementNS(e,r),e[wn]=t,e[Nn]=a,Ul(e,t,!1,!1),t.stateNode=e;e:{switch(o=ve(r,a),r){case"dialog":$a("cancel",e),$a("close",e),n=a;break;case"iframe":case"object":case"embed":$a("load",e),n=a;break;case"video":case"audio":for(n=0;n<Ha.length;n++)$a(Ha[n],e);n=a;break;case"source":$a("error",e),n=a;break;case"img":case"image":case"link":$a("error",e),$a("load",e),n=a;break;case"details":$a("toggle",e),n=a;break;case"input":X(e,a),n=K(e,a),$a("invalid",e);break;case"option":default:n=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},n=M({},a,{value:void 0}),$a("invalid",e);break;case"textarea":ne(e,a),n=ae(e,a),$a("invalid",e)}for(i in xe(r,n),c=n)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?pe(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&de(e,d):"children"===i?"string"===typeof d?("textarea"!==r||""!==d)&&ue(e,d):"number"===typeof d&&ue(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(l.hasOwnProperty(i)?null!=d&&"onScroll"===i&&$a("scroll",e):null!=d&&b(e,i,d,o))}switch(r){case"input":G(e),Z(e,a,!1);break;case"textarea":G(e),ie(e);break;case"option":null!=a.value&&e.setAttribute("value",""+W(a.value));break;case"select":e.multiple=!!a.multiple,null!=(i=a.value)?re(e,!!a.multiple,i,!1):null!=a.defaultValue&&re(e,!!a.multiple,a.defaultValue,!0);break;default:"function"===typeof n.onClick&&(e.onclick=on)}switch(r){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return eo(t),null;case 6:if(e&&null!=t.stateNode)Vl(e,t,e.memoizedProps,a);else{if("string"!==typeof a&&null===t.stateNode)throw Error(s(166));if(r=ai(ri.current),ai(ei.current),ys(t)){if(a=t.stateNode,r=t.memoizedProps,a[wn]=t,(i=a.nodeValue!==r)&&null!==(e=us))switch(e.tag){case 3:ln(a.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&ln(a.nodeValue,r,0!==(1&e.mode))}i&&(t.flags|=4)}else(a=(9===r.nodeType?r:r.ownerDocument).createTextNode(a))[wn]=t,t.stateNode=a}return eo(t),null;case 13:if(Dn(oi),a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(hs&&null!==fs&&0!==(1&t.mode)&&0===(128&t.flags))ws(),Ns(),t.flags|=98560,i=!1;else if(i=ys(t),null!==a&&null!==a.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[wn]=t}else Ns(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;eo(t),i=!1}else null!==ms&&(pc(ms),ms=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((a=null!==a)!==(null!==e&&null!==e.memoizedState)&&a&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&oi.current)?0===Ho&&(Ho=3):kc())),null!==t.updateQueue&&(t.flags|=4),eo(t),null);case 4:return si(),zl(e,t),null===e&&Xa(t.stateNode.containerInfo),eo(t),null;case 10:return Is(t.type._context),eo(t),null;case 19:if(Dn(oi),null===(i=t.memoizedState))return eo(t),null;if(a=0!==(128&t.flags),null===(o=i.rendering))if(a)Zl(i,!1);else{if(0!==Ho||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=ci(e))){for(t.flags|=128,Zl(i,!1),null!==(a=o.updateQueue)&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=r,r=t.child;null!==r;)e=a,(i=r).flags&=14680066,null===(o=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ln(oi,1&oi.current|2),t.child}e=e.sibling}null!==i.tail&&tt()>Jo&&(t.flags|=128,a=!0,Zl(i,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=ci(o))){if(t.flags|=128,a=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Zl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!hs)return eo(t),null}else 2*tt()-i.renderingStartTime>Jo&&1073741824!==r&&(t.flags|=128,a=!0,Zl(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(r=i.last)?r.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=tt(),t.sibling=null,r=oi.current,Ln(oi,a?1&r|2:1&r),t):(eo(t),null);case 22:case 23:return yc(),a=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==a&&(t.flags|=8192),a&&0!==(1&t.mode)?0!==(1073741824&Bo)&&(eo(t),6&t.subtreeFlags&&(t.flags|=8192)):eo(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function ro(e,t){switch(ds(t),t.tag){case 1:return Bn(t.type)&&Vn(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return si(),Dn(Fn),Dn(Mn),ui(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return li(t),null;case 13:if(Dn(oi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));Ns()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Dn(oi),null;case 4:return si(),null;case 10:return Is(t.type._context),null;case 22:case 23:return yc(),null;default:return null}}Ul=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},zl=function(){},Bl=function(e,t,r,a){var n=e.memoizedProps;if(n!==a){e=t.stateNode,ai(ei.current);var s,i=null;switch(r){case"input":n=K(e,n),a=K(e,a),i=[];break;case"select":n=M({},n,{value:void 0}),a=M({},a,{value:void 0}),i=[];break;case"textarea":n=ae(e,n),a=ae(e,a),i=[];break;default:"function"!==typeof n.onClick&&"function"===typeof a.onClick&&(e.onclick=on)}for(d in xe(r,a),r=null,n)if(!a.hasOwnProperty(d)&&n.hasOwnProperty(d)&&null!=n[d])if("style"===d){var o=n[d];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(l.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in a){var c=a[d];if(o=null!=n?n[d]:void 0,a.hasOwnProperty(d)&&c!==o&&(null!=c||null!=o))if("style"===d)if(o){for(s in o)!o.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&o[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(i||(i=[]),i.push(d,r)),r=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,o=o?o.__html:void 0,null!=c&&o!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(l.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&$a("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Vl=function(e,t,r,a){r!==a&&(t.flags|=4)};var ao=!1,no=!1,so="function"===typeof WeakSet?WeakSet:Set,io=null;function lo(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(rt){Pc(e,t,rt)}else r.current=null}function oo(e,t,r){try{r()}catch(rt){Pc(e,t,rt)}}var co=!1;function uo(e,t,r){var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var n=a=a.next;do{if((n.tag&e)===e){var s=n.destroy;n.destroy=void 0,void 0!==s&&oo(t,r,s)}n=n.next}while(n!==a)}}function fo(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var a=r.create;r.destroy=a()}r=r.next}while(r!==t)}}function ho(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function mo(e){var t=e.alternate;null!==t&&(e.alternate=null,mo(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[wn],delete t[Nn],delete t[kn],delete t[En],delete t[Sn])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function po(e){return 5===e.tag||3===e.tag||4===e.tag}function go(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||po(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function xo(e,t,r){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=on));else if(4!==a&&null!==(e=e.child))for(xo(e,t,r),e=e.sibling;null!==e;)xo(e,t,r),e=e.sibling}function vo(e,t,r){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==a&&null!==(e=e.child))for(vo(e,t,r),e=e.sibling;null!==e;)vo(e,t,r),e=e.sibling}var bo=null,yo=!1;function wo(e,t,r){for(r=r.child;null!==r;)No(e,t,r),r=r.sibling}function No(e,t,r){if(ft&&"function"===typeof ft.onCommitFiberUnmount)try{ft.onCommitFiberUnmount(ut,r)}catch(st){}switch(r.tag){case 5:no||lo(r,t);case 6:var a=bo,n=yo;bo=null,wo(e,t,r),yo=n,null!==(bo=a)&&(yo?(e=bo,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):bo.removeChild(r.stateNode));break;case 18:null!==bo&&(yo?(e=bo,r=r.stateNode,8===e.nodeType?xn(e.parentNode,r):1===e.nodeType&&xn(e,r),Jt(e)):xn(bo,r.stateNode));break;case 4:a=bo,n=yo,bo=r.stateNode.containerInfo,yo=!0,wo(e,t,r),bo=a,yo=n;break;case 0:case 11:case 14:case 15:if(!no&&(null!==(a=r.updateQueue)&&null!==(a=a.lastEffect))){n=a=a.next;do{var s=n,i=s.destroy;s=s.tag,void 0!==i&&(0!==(2&s)||0!==(4&s))&&oo(r,t,i),n=n.next}while(n!==a)}wo(e,t,r);break;case 1:if(!no&&(lo(r,t),"function"===typeof(a=r.stateNode).componentWillUnmount))try{a.props=r.memoizedProps,a.state=r.memoizedState,a.componentWillUnmount()}catch(st){Pc(r,t,st)}wo(e,t,r);break;case 21:wo(e,t,r);break;case 22:1&r.mode?(no=(a=no)||null!==r.memoizedState,wo(e,t,r),no=a):wo(e,t,r);break;default:wo(e,t,r)}}function jo(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new so),t.forEach(function(t){var a=Mc.bind(null,e,t);r.has(t)||(r.add(t),t.then(a,a))})}}function ko(e,t){var r=t.deletions;if(null!==r)for(var a=0;a<r.length;a++){var n=r[a];try{var i=e,l=t,o=l;e:for(;null!==o;){switch(o.tag){case 5:bo=o.stateNode,yo=!1;break e;case 3:case 4:bo=o.stateNode.containerInfo,yo=!0;break e}o=o.return}if(null===bo)throw Error(s(160));No(i,l,n),bo=null,yo=!1;var c=n.alternate;null!==c&&(c.return=null),n.return=null}catch(Ye){Pc(n,t,Ye)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)Eo(t,e),t=t.sibling}function Eo(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ko(t,e),So(e),4&a){try{uo(3,e,e.return),fo(3,e)}catch($e){Pc(e,e.return,$e)}try{uo(5,e,e.return)}catch($e){Pc(e,e.return,$e)}}break;case 1:ko(t,e),So(e),512&a&&null!==r&&lo(r,r.return);break;case 5:if(ko(t,e),So(e),512&a&&null!==r&&lo(r,r.return),32&e.flags){var n=e.stateNode;try{ue(n,"")}catch($e){Pc(e,e.return,$e)}}if(4&a&&null!=(n=e.stateNode)){var i=e.memoizedProps,l=null!==r?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===o&&"radio"===i.type&&null!=i.name&&J(n,i),ve(o,l);var d=ve(o,i);for(l=0;l<c.length;l+=2){var u=c[l],f=c[l+1];"style"===u?pe(n,f):"dangerouslySetInnerHTML"===u?de(n,f):"children"===u?ue(n,f):b(n,u,f,d)}switch(o){case"input":Q(n,i);break;case"textarea":se(n,i);break;case"select":var h=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!i.multiple;var m=i.value;null!=m?re(n,!!i.multiple,m,!1):h!==!!i.multiple&&(null!=i.defaultValue?re(n,!!i.multiple,i.defaultValue,!0):re(n,!!i.multiple,i.multiple?[]:"",!1))}n[Nn]=i}catch($e){Pc(e,e.return,$e)}}break;case 6:if(ko(t,e),So(e),4&a){if(null===e.stateNode)throw Error(s(162));n=e.stateNode,i=e.memoizedProps;try{n.nodeValue=i}catch($e){Pc(e,e.return,$e)}}break;case 3:if(ko(t,e),So(e),4&a&&null!==r&&r.memoizedState.isDehydrated)try{Jt(t.containerInfo)}catch($e){Pc(e,e.return,$e)}break;case 4:default:ko(t,e),So(e);break;case 13:ko(t,e),So(e),8192&(n=e.child).flags&&(i=null!==n.memoizedState,n.stateNode.isHidden=i,!i||null!==n.alternate&&null!==n.alternate.memoizedState||(Xo=tt())),4&a&&jo(e);break;case 22:if(u=null!==r&&null!==r.memoizedState,1&e.mode?(no=(d=no)||u,ko(t,e),no=d):ko(t,e),So(e),8192&a){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(io=e,u=e.child;null!==u;){for(f=io=u;null!==io;){switch(m=(h=io).child,h.tag){case 0:case 11:case 14:case 15:uo(4,h,h.return);break;case 1:lo(h,h.return);var p=h.stateNode;if("function"===typeof p.componentWillUnmount){a=h,r=h.return;try{t=a,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch($e){Pc(a,r,$e)}}break;case 5:lo(h,h.return);break;case 22:if(null!==h.memoizedState){Ao(f);continue}}null!==m?(m.return=h,io=m):Ao(f)}u=u.sibling}e:for(u=null,f=e;;){if(5===f.tag){if(null===u){u=f;try{n=f.stateNode,d?"function"===typeof(i=n.style).setProperty?i.setProperty("display","none","important"):i.display="none":(o=f.stateNode,l=void 0!==(c=f.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,o.style.display=me("display",l))}catch($e){Pc(e,e.return,$e)}}}else if(6===f.tag){if(null===u)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch($e){Pc(e,e.return,$e)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ko(t,e),So(e),4&a&&jo(e);case 21:}}function So(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(po(r)){var a=r;break e}r=r.return}throw Error(s(160))}switch(a.tag){case 5:var n=a.stateNode;32&a.flags&&(ue(n,""),a.flags&=-33),vo(e,go(e),n);break;case 3:case 4:var i=a.stateNode.containerInfo;xo(e,go(e),i);break;default:throw Error(s(161))}}catch(zt){Pc(e,e.return,zt)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function To(e,t,r){io=e,_o(e,t,r)}function _o(e,t,r){for(var a=0!==(1&e.mode);null!==io;){var n=io,s=n.child;if(22===n.tag&&a){var i=null!==n.memoizedState||ao;if(!i){var l=n.alternate,o=null!==l&&null!==l.memoizedState||no;l=ao;var c=no;if(ao=i,(no=o)&&!c)for(io=n;null!==io;)o=(i=io).child,22===i.tag&&null!==i.memoizedState?Oo(n):null!==o?(o.return=i,io=o):Oo(n);for(;null!==s;)io=s,_o(s,t,r),s=s.sibling;io=n,ao=l,no=c}Co(e)}else 0!==(8772&n.subtreeFlags)&&null!==s?(s.return=n,io=s):Co(e)}}function Co(e){for(;null!==io;){var t=io;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:no||fo(5,t);break;case 1:var a=t.stateNode;if(4&t.flags&&!no)if(null===r)a.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:dl(t.type,r.memoizedProps);a.componentDidUpdate(n,r.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Qs(t,i,a);break;case 3:var l=t.updateQueue;if(null!==l){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Qs(t,l,r)}break;case 5:var o=t.stateNode;if(null===r&&4&t.flags){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var f=u.dehydrated;null!==f&&Jt(f)}}}break;default:throw Error(s(163))}no||512&t.flags&&ho(t)}catch(h){Pc(t,t.return,h)}}if(t===e){io=null;break}if(null!==(r=t.sibling)){r.return=t.return,io=r;break}io=t.return}}function Ao(e){for(;null!==io;){var t=io;if(t===e){io=null;break}var r=t.sibling;if(null!==r){r.return=t.return,io=r;break}io=t.return}}function Oo(e){for(;null!==io;){var t=io;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{fo(4,t)}catch(zt){Pc(t,r,zt)}break;case 1:var a=t.stateNode;if("function"===typeof a.componentDidMount){var n=t.return;try{a.componentDidMount()}catch(zt){Pc(t,n,zt)}}var s=t.return;try{ho(t)}catch(zt){Pc(t,s,zt)}break;case 5:var i=t.return;try{ho(t)}catch(zt){Pc(t,i,zt)}}}catch(zt){Pc(t,t.return,zt)}if(t===e){io=null;break}var l=t.sibling;if(null!==l){l.return=t.return,io=l;break}io=t.return}}var Ro,Po=Math.ceil,Do=y.ReactCurrentDispatcher,Lo=y.ReactCurrentOwner,Io=y.ReactCurrentBatchConfig,Mo=0,Fo=null,Uo=null,zo=0,Bo=0,Vo=Pn(0),Ho=0,Wo=null,qo=0,Go=0,$o=0,Yo=null,Ko=null,Xo=0,Jo=1/0,Qo=null,Zo=!1,ec=null,tc=null,rc=!1,ac=null,nc=0,sc=0,ic=null,lc=-1,oc=0;function cc(){return 0!==(6&Mo)?tt():-1!==lc?lc:lc=tt()}function dc(e){return 0===(1&e.mode)?1:0!==(2&Mo)&&0!==zo?zo&-zo:null!==ks.transition?(0===oc&&(oc=Nt()),oc):0!==(e=Tt)?e:e=void 0===(e=window.event)?16:sr(e.type)}function uc(e,t,r,a){if(50<sc)throw sc=0,ic=null,Error(s(185));Et(e,r,a),0!==(2&Mo)&&e===Fo||(e===Fo&&(0===(2&Mo)&&(Go|=r),4===Ho&&gc(e,zo)),fc(e,a),1===r&&0===Mo&&0===(1&t.mode)&&(Jo=tt()+500,Yn&&Jn()))}function fc(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,n=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-ht(s),l=1<<i,o=n[i];-1===o?0!==(l&r)&&0===(l&a)||(n[i]=yt(l,t)):o<=t&&(e.expiredLanes|=l),s&=~l}}(e,t);var a=bt(e,e===Fo?zo:0);if(0===a)null!==r&&Je(r),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(null!=r&&Je(r),1===t)0===e.tag?function(e){Yn=!0,Xn(e)}(xc.bind(null,e)):Xn(xc.bind(null,e)),pn(function(){0===(6&Mo)&&Jn()}),r=null;else{switch(_t(a)){case 1:r=it;break;case 4:r=lt;break;case 16:default:r=ot;break;case 536870912:r=dt}r=Fc(r,hc.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function hc(e,t){if(lc=-1,oc=0,0!==(6&Mo))throw Error(s(327));var r=e.callbackNode;if(Oc()&&e.callbackNode!==r)return null;var a=bt(e,e===Fo?zo:0);if(0===a)return null;if(0!==(30&a)||0!==(a&e.expiredLanes)||t)t=Ec(e,a);else{t=a;var n=Mo;Mo|=2;var i=jc();for(Fo===e&&zo===t||(Qo=null,Jo=tt()+500,wc(e,t));;)try{Tc();break}catch(st){Nc(e,st)}Ls(),Do.current=i,Mo=n,null!==Uo?t=0:(Fo=null,zo=0,t=Ho)}if(0!==t){if(2===t&&(0!==(n=wt(e))&&(a=n,t=mc(e,n))),1===t)throw r=Wo,wc(e,0),gc(e,a),fc(e,tt()),r;if(6===t)gc(e,a);else{if(n=e.current.alternate,0===(30&a)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var a=0;a<r.length;a++){var n=r[a],s=n.getSnapshot;n=n.value;try{if(!pa(s(),n))return!1}catch(l){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(n)&&(2===(t=Ec(e,a))&&(0!==(i=wt(e))&&(a=i,t=mc(e,i))),1===t))throw r=Wo,wc(e,0),gc(e,a),fc(e,tt()),r;switch(e.finishedWork=n,e.finishedLanes=a,t){case 0:case 1:throw Error(s(345));case 2:case 5:Ac(e,Ko,Qo);break;case 3:if(gc(e,a),(130023424&a)===a&&10<(t=Xo+500-tt())){if(0!==bt(e,0))break;if(((n=e.suspendedLanes)&a)!==a){cc(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=fn(Ac.bind(null,e,Ko,Qo),t);break}Ac(e,Ko,Qo);break;case 4:if(gc(e,a),(4194240&a)===a)break;for(t=e.eventTimes,n=-1;0<a;){var l=31-ht(a);i=1<<l,(l=t[l])>n&&(n=l),a&=~i}if(a=n,10<(a=(120>(a=tt()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*Po(a/1960))-a)){e.timeoutHandle=fn(Ac.bind(null,e,Ko,Qo),a);break}Ac(e,Ko,Qo);break;default:throw Error(s(329))}}}return fc(e,tt()),e.callbackNode===r?hc.bind(null,e):null}function mc(e,t){var r=Yo;return e.current.memoizedState.isDehydrated&&(wc(e,t).flags|=256),2!==(e=Ec(e,t))&&(t=Ko,Ko=r,null!==t&&pc(t)),e}function pc(e){null===Ko?Ko=e:Ko.push.apply(Ko,e)}function gc(e,t){for(t&=~$o,t&=~Go,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ht(t),a=1<<r;e[r]=-1,t&=~a}}function xc(e){if(0!==(6&Mo))throw Error(s(327));Oc();var t=bt(e,0);if(0===(1&t))return fc(e,tt()),null;var r=Ec(e,t);if(0!==e.tag&&2===r){var a=wt(e);0!==a&&(t=a,r=mc(e,a))}if(1===r)throw r=Wo,wc(e,0),gc(e,t),fc(e,tt()),r;if(6===r)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ac(e,Ko,Qo),fc(e,tt()),null}function vc(e,t){var r=Mo;Mo|=1;try{return e(t)}finally{0===(Mo=r)&&(Jo=tt()+500,Yn&&Jn())}}function bc(e){null!==ac&&0===ac.tag&&0===(6&Mo)&&Oc();var t=Mo;Mo|=1;var r=Io.transition,a=Tt;try{if(Io.transition=null,Tt=1,e)return e()}finally{Tt=a,Io.transition=r,0===(6&(Mo=t))&&Jn()}}function yc(){Bo=Vo.current,Dn(Vo)}function wc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,hn(r)),null!==Uo)for(r=Uo.return;null!==r;){var a=r;switch(ds(a),a.tag){case 1:null!==(a=a.type.childContextTypes)&&void 0!==a&&Vn();break;case 3:si(),Dn(Fn),Dn(Mn),ui();break;case 5:li(a);break;case 4:si();break;case 13:case 19:Dn(oi);break;case 10:Is(a.type._context);break;case 22:case 23:yc()}r=r.return}if(Fo=e,Uo=e=Vc(e.current,null),zo=Bo=t,Ho=0,Wo=null,$o=Go=qo=0,Ko=Yo=null,null!==zs){for(t=0;t<zs.length;t++)if(null!==(a=(r=zs[t]).interleaved)){r.interleaved=null;var n=a.next,s=r.pending;if(null!==s){var i=s.next;s.next=n,a.next=i}r.pending=a}zs=null}return e}function Nc(e,t){for(;;){var r=Uo;try{if(Ls(),fi.current=il,vi){for(var a=pi.memoizedState;null!==a;){var n=a.queue;null!==n&&(n.pending=null),a=a.next}vi=!1}if(mi=0,xi=gi=pi=null,bi=!1,yi=0,Lo.current=null,null===r||null===r.return){Ho=1,Wo=t,Uo=null;break}e:{var i=e,l=r.return,o=r,c=t;if(t=zo,o.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=o,f=u.tag;if(0===(1&u.mode)&&(0===f||11===f||15===f)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=kl(l);if(null!==m){m.flags&=-257,El(m,l,o,0,t),1&m.mode&&jl(i,d,t),c=d;var p=(t=m).updateQueue;if(null===p){var g=new Set;g.add(c),t.updateQueue=g}else p.add(c);break e}if(0===(1&t)){jl(i,d,t),kc();break e}c=Error(s(426))}else if(hs&&1&o.mode){var x=kl(l);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),El(x,l,o,0,t),js(xl(c,o));break e}}i=c=xl(c,o),4!==Ho&&(Ho=2),null===Yo?Yo=[i]:Yo.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Xs(i,wl(0,c,t));break e;case 1:o=c;var v=i.type,b=i.stateNode;if(0===(128&i.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===tc||!tc.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,Xs(i,Nl(i,o,t));break e}}i=i.return}while(null!==i)}Cc(r)}catch(y){t=y,Uo===r&&null!==r&&(Uo=r=r.return);continue}break}}function jc(){var e=Do.current;return Do.current=il,null===e?il:e}function kc(){0!==Ho&&3!==Ho&&2!==Ho||(Ho=4),null===Fo||0===(268435455&qo)&&0===(268435455&Go)||gc(Fo,zo)}function Ec(e,t){var r=Mo;Mo|=2;var a=jc();for(Fo===e&&zo===t||(Qo=null,wc(e,t));;)try{Sc();break}catch(Ge){Nc(e,Ge)}if(Ls(),Mo=r,Do.current=a,null!==Uo)throw Error(s(261));return Fo=null,zo=0,Ho}function Sc(){for(;null!==Uo;)_c(Uo)}function Tc(){for(;null!==Uo&&!Ze();)_c(Uo)}function _c(e){var t=Ro(e.alternate,e,Bo);e.memoizedProps=e.pendingProps,null===t?Cc(e):Uo=t,Lo.current=null}function Cc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=to(r,t,Bo)))return void(Uo=r)}else{if(null!==(r=ro(r,t)))return r.flags&=32767,void(Uo=r);if(null===e)return Ho=6,void(Uo=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Uo=t);Uo=t=e}while(null!==t);0===Ho&&(Ho=5)}function Ac(e,t,r){var a=Tt,n=Io.transition;try{Io.transition=null,Tt=1,function(e,t,r,a){do{Oc()}while(null!==ac);if(0!==(6&Mo))throw Error(s(327));r=e.finishedWork;var n=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-ht(r),s=1<<n;t[n]=0,a[n]=-1,e[n]=-1,r&=~s}}(e,i),e===Fo&&(Uo=Fo=null,zo=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||rc||(rc=!0,Fc(ot,function(){return Oc(),null})),i=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||i){i=Io.transition,Io.transition=null;var l=Tt;Tt=1;var o=Mo;Mo|=4,Lo.current=null,function(e,t){if(cn=Zt,wa(e=ya())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(a&&0!==a.rangeCount){r=a.anchorNode;var n=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{r.nodeType,i.nodeType}catch(kt){r=null;break e}var l=0,o=-1,c=-1,d=0,u=0,f=e,h=null;t:for(;;){for(var m;f!==r||0!==n&&3!==f.nodeType||(o=l+n),f!==i||0!==a&&3!==f.nodeType||(c=l+a),3===f.nodeType&&(l+=f.nodeValue.length),null!==(m=f.firstChild);)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++d===n&&(o=l),h===i&&++u===a&&(c=l),null!==(m=f.nextSibling))break;h=(f=h).parentNode}f=m}r=-1===o||-1===c?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(dn={focusedElem:e,selectionRange:r},Zt=!1,io=t;null!==io;)if(e=(t=io).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,io=e;else for(;null!==io;){t=io;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,x=p.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:dl(t.type,g),x);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(s(163))}}catch(kt){Pc(t,t.return,kt)}if(null!==(e=t.sibling)){e.return=t.return,io=e;break}io=t.return}p=co,co=!1}(e,r),Eo(r,e),Na(dn),Zt=!!cn,dn=cn=null,e.current=r,To(r,e,n),et(),Mo=o,Tt=l,Io.transition=i}else e.current=r;if(rc&&(rc=!1,ac=e,nc=n),i=e.pendingLanes,0===i&&(tc=null),function(e){if(ft&&"function"===typeof ft.onCommitFiberRoot)try{ft.onCommitFiberRoot(ut,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),fc(e,tt()),null!==t)for(a=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],a(n.value,{componentStack:n.stack,digest:n.digest});if(Zo)throw Zo=!1,e=ec,ec=null,e;0!==(1&nc)&&0!==e.tag&&Oc(),i=e.pendingLanes,0!==(1&i)?e===ic?sc++:(sc=0,ic=e):sc=0,Jn()}(e,t,r,a)}finally{Io.transition=n,Tt=a}return null}function Oc(){if(null!==ac){var e=_t(nc),t=Io.transition,r=Tt;try{if(Io.transition=null,Tt=16>e?16:e,null===ac)var a=!1;else{if(e=ac,ac=null,nc=0,0!==(6&Mo))throw Error(s(331));var n=Mo;for(Mo|=4,io=e.current;null!==io;){var i=io,l=i.child;if(0!==(16&io.flags)){var o=i.deletions;if(null!==o){for(var c=0;c<o.length;c++){var d=o[c];for(io=d;null!==io;){var u=io;switch(u.tag){case 0:case 11:case 15:uo(8,u,i)}var f=u.child;if(null!==f)f.return=u,io=f;else for(;null!==io;){var h=(u=io).sibling,m=u.return;if(mo(u),u===d){io=null;break}if(null!==h){h.return=m,io=h;break}io=m}}}var p=i.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(null!==g)}}io=i}}if(0!==(2064&i.subtreeFlags)&&null!==l)l.return=i,io=l;else e:for(;null!==io;){if(0!==(2048&(i=io).flags))switch(i.tag){case 0:case 11:case 15:uo(9,i,i.return)}var v=i.sibling;if(null!==v){v.return=i.return,io=v;break e}io=i.return}}var b=e.current;for(io=b;null!==io;){var y=(l=io).child;if(0!==(2064&l.subtreeFlags)&&null!==y)y.return=l,io=y;else e:for(l=b;null!==io;){if(0!==(2048&(o=io).flags))try{switch(o.tag){case 0:case 11:case 15:fo(9,o)}}catch(N){Pc(o,o.return,N)}if(o===l){io=null;break e}var w=o.sibling;if(null!==w){w.return=o.return,io=w;break e}io=o.return}}if(Mo=n,Jn(),ft&&"function"===typeof ft.onPostCommitFiberRoot)try{ft.onPostCommitFiberRoot(ut,e)}catch(N){}a=!0}return a}finally{Tt=r,Io.transition=t}}return!1}function Rc(e,t,r){e=Ys(e,t=wl(0,t=xl(r,t),1),1),t=cc(),null!==e&&(Et(e,1,t),fc(e,t))}function Pc(e,t,r){if(3===e.tag)Rc(e,e,r);else for(;null!==t;){if(3===t.tag){Rc(t,e,r);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===tc||!tc.has(a))){t=Ys(t,e=Nl(t,e=xl(r,e),1),1),e=cc(),null!==t&&(Et(t,1,e),fc(t,e));break}}t=t.return}}function Dc(e,t,r){var a=e.pingCache;null!==a&&a.delete(t),t=cc(),e.pingedLanes|=e.suspendedLanes&r,Fo===e&&(zo&r)===r&&(4===Ho||3===Ho&&(130023424&zo)===zo&&500>tt()-Xo?wc(e,0):$o|=r),fc(e,t)}function Lc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=xt,0===(130023424&(xt<<=1))&&(xt=4194304)));var r=cc();null!==(e=Hs(e,t))&&(Et(e,t,r),fc(e,r))}function Ic(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Lc(e,r)}function Mc(e,t){var r=0;switch(e.tag){case 13:var a=e.stateNode,n=e.memoizedState;null!==n&&(r=n.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(s(314))}null!==a&&a.delete(t),Lc(e,r)}function Fc(e,t){return Xe(e,t)}function Uc(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zc(e,t,r,a){return new Uc(e,t,r,a)}function Bc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Vc(e,t){var r=e.alternate;return null===r?((r=zc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Hc(e,t,r,a,n,i){var l=2;if(a=e,"function"===typeof e)Bc(e)&&(l=1);else if("string"===typeof e)l=5;else e:switch(e){case j:return Wc(r.children,n,i,t);case k:l=8,n|=8;break;case E:return(e=zc(12,r,t,2|n)).elementType=E,e.lanes=i,e;case C:return(e=zc(13,r,t,n)).elementType=C,e.lanes=i,e;case A:return(e=zc(19,r,t,n)).elementType=A,e.lanes=i,e;case P:return qc(r,n,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:l=10;break e;case T:l=9;break e;case _:l=11;break e;case O:l=14;break e;case R:l=16,a=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=zc(l,r,t,n)).elementType=e,t.type=a,t.lanes=i,t}function Wc(e,t,r,a){return(e=zc(7,e,a,t)).lanes=r,e}function qc(e,t,r,a){return(e=zc(22,e,a,t)).elementType=P,e.lanes=r,e.stateNode={isHidden:!1},e}function Gc(e,t,r){return(e=zc(6,e,null,t)).lanes=r,e}function $c(e,t,r){return(t=zc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Yc(e,t,r,a,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jt(0),this.expirationTimes=jt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jt(0),this.identifierPrefix=a,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Kc(e,t,r,a,n,s,i,l,o){return e=new Yc(e,t,r,l,o),1===t?(t=1,!0===s&&(t|=8)):t=0,s=zc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:a,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},qs(s),e}function Xc(e){if(!e)return In;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Bn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var r=e.type;if(Bn(r))return Wn(e,r,t)}return t}function Jc(e,t,r,a,n,s,i,l,o){return(e=Kc(r,a,!0,e,0,s,0,l,o)).context=Xc(null),r=e.current,(s=$s(a=cc(),n=dc(r))).callback=void 0!==t&&null!==t?t:null,Ys(r,s,n),e.current.lanes=n,Et(e,n,a),fc(e,a),e}function Qc(e,t,r,a){var n=t.current,s=cc(),i=dc(n);return r=Xc(r),null===t.context?t.context=r:t.pendingContext=r,(t=$s(s,i)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),null!==(e=Ys(n,t,i))&&(uc(e,n,i,s),Ks(e,n,i)),i}function Zc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function ed(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function td(e,t){ed(e,t),(e=e.alternate)&&ed(e,t)}Ro=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Fn.current)Tl=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return Tl=!1,function(e,t,r){switch(t.tag){case 3:Ml(t),Ns();break;case 5:ii(t);break;case 1:Bn(t.type)&&qn(t);break;case 4:ni(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,n=t.memoizedProps.value;Ln(Os,a._currentValue),a._currentValue=n;break;case 13:if(null!==(a=t.memoizedState))return null!==a.dehydrated?(Ln(oi,1&oi.current),t.flags|=128,null):0!==(r&t.child.childLanes)?ql(e,t,r):(Ln(oi,1&oi.current),null!==(e=Ql(e,t,r))?e.sibling:null);Ln(oi,1&oi.current);break;case 19:if(a=0!==(r&t.childLanes),0!==(128&e.flags)){if(a)return Xl(e,t,r);t.flags|=128}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),Ln(oi,oi.current),a)break;return null;case 22:case 23:return t.lanes=0,Rl(e,t,r)}return Ql(e,t,r)}(e,t,r);Tl=0!==(131072&e.flags)}else Tl=!1,hs&&0!==(1048576&t.flags)&&os(t,ts,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Jl(e,t),e=t.pendingProps;var n=zn(t,Mn.current);Fs(t,r),n=ki(null,t,a,e,n,r);var i=Ei();return t.flags|=1,"object"===typeof n&&null!==n&&"function"===typeof n.render&&void 0===n.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Bn(a)?(i=!0,qn(t)):i=!1,t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,qs(t),n.updater=fl,t.stateNode=n,n._reactInternals=t,gl(t,a,e,r),t=Il(null,t,a,!0,i,r)):(t.tag=0,hs&&i&&cs(t),_l(null,t,n,r),t=t.child),t;case 16:a=t.elementType;e:{switch(Jl(e,t),e=t.pendingProps,a=(n=a._init)(a._payload),t.type=a,n=t.tag=function(e){if("function"===typeof e)return Bc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===_)return 11;if(e===O)return 14}return 2}(a),e=dl(a,e),n){case 0:t=Dl(null,t,a,e,r);break e;case 1:t=Ll(null,t,a,e,r);break e;case 11:t=Cl(null,t,a,e,r);break e;case 14:t=Al(null,t,a,dl(a.type,e),r);break e}throw Error(s(306,a,""))}return t;case 0:return a=t.type,n=t.pendingProps,Dl(e,t,a,n=t.elementType===a?n:dl(a,n),r);case 1:return a=t.type,n=t.pendingProps,Ll(e,t,a,n=t.elementType===a?n:dl(a,n),r);case 3:e:{if(Ml(t),null===e)throw Error(s(387));a=t.pendingProps,n=(i=t.memoizedState).element,Gs(e,t),Js(t,a,null,r);var l=t.memoizedState;if(a=l.element,i.isDehydrated){if(i={element:a,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Fl(e,t,a,r,n=xl(Error(s(423)),t));break e}if(a!==n){t=Fl(e,t,a,r,n=xl(Error(s(424)),t));break e}for(fs=vn(t.stateNode.containerInfo.firstChild),us=t,hs=!0,ms=null,r=As(t,null,a,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(Ns(),a===n){t=Ql(e,t,r);break e}_l(e,t,a,r)}t=t.child}return t;case 5:return ii(t),null===e&&vs(t),a=t.type,n=t.pendingProps,i=null!==e?e.memoizedProps:null,l=n.children,un(a,n)?l=null:null!==i&&un(a,i)&&(t.flags|=32),Pl(e,t),_l(e,t,l,r),t.child;case 6:return null===e&&vs(t),null;case 13:return ql(e,t,r);case 4:return ni(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=Cs(t,null,a,r):_l(e,t,a,r),t.child;case 11:return a=t.type,n=t.pendingProps,Cl(e,t,a,n=t.elementType===a?n:dl(a,n),r);case 7:return _l(e,t,t.pendingProps,r),t.child;case 8:case 12:return _l(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(a=t.type._context,n=t.pendingProps,i=t.memoizedProps,l=n.value,Ln(Os,a._currentValue),a._currentValue=l,null!==i)if(pa(i.value,l)){if(i.children===n.children&&!Fn.current){t=Ql(e,t,r);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var o=i.dependencies;if(null!==o){l=i.child;for(var c=o.firstContext;null!==c;){if(c.context===a){if(1===i.tag){(c=$s(-1,r&-r)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,null!==(c=i.alternate)&&(c.lanes|=r),Ms(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(10===i.tag)l=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(l=i.return))throw Error(s(341));l.lanes|=r,null!==(o=l.alternate)&&(o.lanes|=r),Ms(l,r,t),l=i.sibling}else l=i.child;if(null!==l)l.return=i;else for(l=i;null!==l;){if(l===t){l=null;break}if(null!==(i=l.sibling)){i.return=l.return,l=i;break}l=l.return}i=l}_l(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,a=t.pendingProps.children,Fs(t,r),a=a(n=Us(n)),t.flags|=1,_l(e,t,a,r),t.child;case 14:return n=dl(a=t.type,t.pendingProps),Al(e,t,a,n=dl(a.type,n),r);case 15:return Ol(e,t,t.type,t.pendingProps,r);case 17:return a=t.type,n=t.pendingProps,n=t.elementType===a?n:dl(a,n),Jl(e,t),t.tag=1,Bn(a)?(e=!0,qn(t)):e=!1,Fs(t,r),ml(t,a,n),gl(t,a,n,r),Il(null,t,a,!0,e,r);case 19:return Xl(e,t,r);case 22:return Rl(e,t,r)}throw Error(s(156,t.tag))};var rd="function"===typeof reportError?reportError:function(e){console.error(e)};function ad(e){this._internalRoot=e}function nd(e){this._internalRoot=e}function sd(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function id(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ld(){}function od(e,t,r,a,n){var s=r._reactRootContainer;if(s){var i=s;if("function"===typeof n){var l=n;n=function(){var e=Zc(i);l.call(e)}}Qc(t,i,e,n)}else i=function(e,t,r,a,n){if(n){if("function"===typeof a){var s=a;a=function(){var e=Zc(i);s.call(e)}}var i=Jc(t,a,e,0,null,!1,0,"",ld);return e._reactRootContainer=i,e[jn]=i.current,Xa(8===e.nodeType?e.parentNode:e),bc(),i}for(;n=e.lastChild;)e.removeChild(n);if("function"===typeof a){var l=a;a=function(){var e=Zc(o);l.call(e)}}var o=Kc(e,0,!1,null,0,!1,0,"",ld);return e._reactRootContainer=o,e[jn]=o.current,Xa(8===e.nodeType?e.parentNode:e),bc(function(){Qc(t,o,r,a)}),o}(r,t,e,n,a);return Zc(i)}nd.prototype.render=ad.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Qc(e,t,null,null)},nd.prototype.unmount=ad.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;bc(function(){Qc(null,e,null,null)}),t[jn]=null}},nd.prototype.unstable_scheduleHydration=function(e){if(e){var t=Rt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Vt.length&&0!==t&&t<Vt[r].priority;r++);Vt.splice(r,0,e),0===r&&Gt(e)}},Ct=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=vt(t.pendingLanes);0!==r&&(St(t,1|r),fc(t,tt()),0===(6&Mo)&&(Jo=tt()+500,Jn()))}break;case 13:bc(function(){var t=Hs(e,1);if(null!==t){var r=cc();uc(t,e,1,r)}}),td(e,1)}},At=function(e){if(13===e.tag){var t=Hs(e,134217728);if(null!==t)uc(t,e,134217728,cc());td(e,134217728)}},Ot=function(e){if(13===e.tag){var t=dc(e),r=Hs(e,t);if(null!==r)uc(r,e,t,cc());td(e,t)}},Rt=function(){return Tt},Pt=function(e,t){var r=Tt;try{return Tt=e,t()}finally{Tt=r}},we=function(e,t,r){switch(t){case"input":if(Q(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var n=An(a);if(!n)throw Error(s(90));$(a),Q(a,n)}}}break;case"textarea":se(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Te=vc,_e=bc;var cd={usingClientEntryPoint:!1,Events:[_n,Cn,An,Ee,Se,vc]},dd={findFiberByHostInstance:Tn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ud={bundleType:dd.bundleType,version:dd.version,rendererPackageName:dd.rendererPackageName,rendererConfig:dd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:dd.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var fd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fd.isDisabled&&fd.supportsFiber)try{ut=fd.inject(ud),ft=fd}catch(Ke){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cd,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!sd(t))throw Error(s(200));return function(e,t,r){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:N,key:null==a?null:""+a,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!sd(e))throw Error(s(299));var r=!1,a="",n=rd;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onRecoverableError&&(n=t.onRecoverableError)),t=Kc(e,1,!1,null,0,r,0,a,n),e[jn]=t.current,Xa(8===e.nodeType?e.parentNode:e),new ad(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return bc(e)},t.hydrate=function(e,t,r){if(!id(t))throw Error(s(200));return od(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!sd(e))throw Error(s(405));var a=null!=r&&r.hydratedSources||null,n=!1,i="",l=rd;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(n=!0),void 0!==r.identifierPrefix&&(i=r.identifierPrefix),void 0!==r.onRecoverableError&&(l=r.onRecoverableError)),t=Jc(t,null,e,1,null!=r?r:null,n,0,i,l),e[jn]=t.current,Xa(e),a)for(e=0;e<a.length;e++)n=(n=(r=a[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new nd(t)},t.render=function(e,t,r){if(!id(t))throw Error(s(200));return od(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!id(e))throw Error(s(40));return!!e._reactRootContainer&&(bc(function(){od(null,null,e,!1,function(){e._reactRootContainer=null,e[jn]=null})}),!0)},t.unstable_batchedUpdates=vc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,a){if(!id(r))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return od(e,t,r,!1,a)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,r)=>{e.exports=r(234)},950:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(730)},994:(e,t,r)=>{r.d(t,{planningEngine:()=>a});const a=new class{constructor(){this.timeSlots=this.generateTimeSlots(),this.weekCache=new Map,this.slotCache=new Map}generateTimeSlots(){return[{start:"07:30",end:"08:30",isPause:!1,index:0},{start:"08:30",end:"09:30",isPause:!1,index:1},{start:"09:30",end:"10:30",isPause:!1,index:2},{start:"10:30",end:"11:30",isPause:!1,index:3},{start:"11:30",end:"12:30",isPause:!1,index:4},{start:"12:30",end:"13:30",isPause:!0,pauseType:"meridienne",index:5},{start:"13:30",end:"14:30",isPause:!1,index:6},{start:"14:30",end:"15:30",isPause:!1,index:7},{start:"15:30",end:"16:30",isPause:!1,index:8},{start:"16:30",end:"17:30",isPause:!1,index:9}]}calculateSlotPosition(e,t){const r="".concat(e.id,"-").concat(t.toISOString().split("T")[0]);if(this.slotCache.has(r))return this.slotCache.get(r);const a=e.start_date?e.start_date.split("T")[0]:null,n=t.toISOString().split("T")[0];if(console.log("\ud83d\udd0d Calcul position:",{slotDate:a,cellDate:n,slotId:e.id}),a!==n)return this.slotCache.set(r,null),null;if(!e.start_time){const e={top:0,height:100,isMultiDay:!0};return this.slotCache.set(r,e),e}const s=this.parseTime(e.start_time),i=this.parseTime(e.end_time||e.start_time),l=Math.max(0,s-450),o=Math.min(600,i-450),c=l/600*100,d=(o-l)/600*100;console.log("\ud83d\udcca Position calcul\xe9e:",{startTime:e.start_time,endTime:e.end_time,startOffset:l,endOffset:o,top:"".concat(c,"%"),height:"".concat(d,"%")});const u={top:Math.max(0,Math.min(100,c)),height:Math.max(3,Math.min(100,d)),startSlotIndex:Math.floor(l/60),endSlotIndex:Math.floor(o/60),duration:(i-s)/60,isMultiDay:!1};return this.slotCache.set(r,u),u}parseTime(e){if(!e)return 0;const[t,r]=e.split(":").map(Number);return 60*t+r}getISOWeekNumber(e){if(!e||!(e instanceof Date)||isNaN(e.getTime()))return 1;const t=new Date(e.getTime()),r=t.getDay(),a=r>=4?4-r:-3-r;t.setDate(t.getDate()+a);const n=new Date(t.getFullYear(),0,4),s=n.getDay(),i=s>=4?4-s:-3-s;n.setDate(n.getDate()+i);const l=t.getTime()-n.getTime();return Math.floor(l/6048e5)+1}generateYearWeeks(e){const t=e.getFullYear();if(this.weekCache.has(t))return this.weekCache.get(t);const r=e.getFullYear(),a=[];let n,s;e.getMonth()>=7?(n=new Date(r,7,1),s=new Date(r+1,6,31)):(n=new Date(r-1,7,1),s=new Date(r,6,31));let i=this.getWeekDays(n);for(;i[0]<=s;){i[6]>=n&&i[0]<=s&&a.push([...i]);const e=new Date(i[0]);if(e.setDate(e.getDate()+7),i=this.getWeekDays(e),i[0]>s)break}return this.weekCache.set(t,a),a}getWeekDays(e){const t=new Date(e),r=t.getDay(),a=0===r?6:r-1;return t.setDate(t.getDate()-a),Array.from({length:7},(e,r)=>{const a=new Date(t);return a.setDate(t.getDate()+r),a})}filterSlotsForWeek(e,t){return e.filter(e=>{const r=e.start_date.split("T")[0];return t.some(e=>e.toISOString().split("T")[0]===r)})}detectConflicts(e,t){const r=t.toISOString().split("T")[0],a=e.filter(e=>e.start_date.split("T")[0]===r),n=[];for(let s=0;s<a.length;s++)for(let e=s+1;e<a.length;e++){const t=a[s],r=a[e];this.slotsOverlap(t,r)&&n.push([t,r])}return n}slotsOverlap(e,t){if(!e.start_time||!t.start_time)return!1;const r=this.parseTime(e.start_time),a=this.parseTime(e.end_time||e.start_time),n=this.parseTime(t.start_time);return r<this.parseTime(t.end_time||t.start_time)&&a>n}calculateDropPosition(e,t){const r=e.clientY,a=e.currentTarget.querySelector(".time-slot-container");if(!a)return null;const n=a.getBoundingClientRect(),s=r-n.top,i=n.height/t.length,l=Math.floor(s/i),o=Math.max(0,Math.min(l,t.length-1)),c=t[o];return{timeSlot:c,time:(s-o*i)/i<=.5?c.start:c.end,index:o}}validateSlot(e){const t=[];if(e.start_date||t.push("Date de d\xe9but requise"),e.start_time&&e.end_time){const r=this.parseTime(e.start_time);this.parseTime(e.end_time)<=r&&t.push("L'heure de fin doit \xeatre apr\xe8s l'heure de d\xe9but")}return e.student_id||t.push("\xc9tudiant requis"),t}clearCache(){this.weekCache.clear(),this.slotCache.clear()}invalidateSlotCache(e){const t=[];for(const[r,a]of this.slotCache.entries())(r.includes("-".concat(e,"-"))||r.startsWith("".concat(e,"-")))&&t.push(r);t.forEach(e=>this.slotCache.delete(e)),console.log("\ud83d\uddd1\ufe0f Cache invalid\xe9 pour le cr\xe9neau ".concat(e))}formatDate(e){return e&&e instanceof Date&&!isNaN(e.getTime())?e.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"Date invalide"}formatDisplayDate(e){return e&&e instanceof Date&&!isNaN(e.getTime())?e.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"}):"Date invalide"}isWeekend(e){if(!e||!(e instanceof Date)||isNaN(e.getTime()))return!1;const t=e.getDay();return 0===t||6===t}}}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,r),s.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(a,n){if(1&n&&(a=this(a)),8&n)return a;if("object"===typeof a&&a){if(4&n&&a.__esModule)return a;if(16&n&&"function"===typeof a.then)return a}var s=Object.create(null);r.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&n&&a;("object"==typeof l||"function"==typeof l)&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach(e=>i[e]=()=>a[e]);return i.default=()=>a,r.d(s,i),s}})(),r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};r.r(a),r.d(a,{hasBrowserEnv:()=>ua,hasStandardBrowserEnv:()=>ha,hasStandardBrowserWebWorkerEnv:()=>ma,navigator:()=>fa,origin:()=>pa});var n,s=r(43),i=r.t(s,2),l=r(391),o=r(950),c=r.t(o,2);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},d.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(n||(n={}));const u="popstate";function f(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(Ge){}}}function m(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,r,a){return void 0===r&&(r=null),d({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?x(t):t,{state:r,key:t&&t.key||a||Math.random().toString(36).substr(2,8)})}function g(e){let{pathname:t="/",search:r="",hash:a=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function x(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}function v(e,t,r,a){void 0===a&&(a={});let{window:s=document.defaultView,v5Compat:i=!1}=a,l=s.history,o=n.Pop,c=null,h=x();function x(){return(l.state||{idx:null}).idx}function v(){o=n.Pop;let e=x(),t=null==e?null:e-h;h=e,c&&c({action:o,location:y.location,delta:t})}function b(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,r="string"===typeof e?e:g(e);return r=r.replace(/ $/,"%20"),f(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==h&&(h=0,l.replaceState(d({},l.state,{idx:h}),""));let y={get action(){return o},get location(){return e(s,l)},listen(e){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(u,v),c=e,()=>{s.removeEventListener(u,v),c=null}},createHref:e=>t(s,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=n.Push;let a=p(y.location,e,t);r&&r(a,e),h=x()+1;let d=m(a,h),u=y.createHref(a);try{l.pushState(d,"",u)}catch(f){if(f instanceof DOMException&&"DataCloneError"===f.name)throw f;s.location.assign(u)}i&&c&&c({action:o,location:y.location,delta:1})},replace:function(e,t){o=n.Replace;let a=p(y.location,e,t);r&&r(a,e),h=x();let s=m(a,h),d=y.createHref(a);l.replaceState(s,"",d),i&&c&&c({action:o,location:y.location,delta:0})},go:e=>l.go(e)};return y}var b;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(b||(b={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function y(e,t,r){return void 0===r&&(r="/"),w(e,t,r,!1)}function w(e,t,r,a){let n=L(("string"===typeof t?x(t):t).pathname||"/",r);if(null==n)return null;let s=N(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every((e,r)=>e===t[r]);return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let i=null;for(let l=0;null==i&&l<s.length;++l){let e=D(n);i=R(s[l],e,a)}return i}function N(e,t,r,a){void 0===t&&(t=[]),void 0===r&&(r=[]),void 0===a&&(a="");let n=(e,n,s)=>{let i={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:n,route:e};i.relativePath.startsWith("/")&&(f(i.relativePath.startsWith(a),'Absolute route path "'+i.relativePath+'" nested under path "'+a+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(a.length));let l=z([a,i.relativePath]),o=r.concat(i);e.children&&e.children.length>0&&(f(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),N(e.children,t,o,l)),(null!=e.path||e.index)&&t.push({path:l,score:O(l,e.index),routesMeta:o})};return e.forEach((e,t)=>{var r;if(""!==e.path&&null!=(r=e.path)&&r.includes("?"))for(let a of j(e.path))n(e,t,a);else n(e,t)}),t}function j(e){let t=e.split("/");if(0===t.length)return[];let[r,...a]=t,n=r.endsWith("?"),s=r.replace(/\?$/,"");if(0===a.length)return n?[s,""]:[s];let i=j(a.join("/")),l=[];return l.push(...i.map(e=>""===e?s:[s,e].join("/"))),n&&l.push(...i),l.map(t=>e.startsWith("/")&&""===t?"/":t)}const k=/^:[\w-]+$/,E=3,S=2,T=1,_=10,C=-2,A=e=>"*"===e;function O(e,t){let r=e.split("/"),a=r.length;return r.some(A)&&(a+=C),t&&(a+=S),r.filter(e=>!A(e)).reduce((e,t)=>e+(k.test(t)?E:""===t?T:_),a)}function R(e,t,r){void 0===r&&(r=!1);let{routesMeta:a}=e,n={},s="/",i=[];for(let l=0;l<a.length;++l){let e=a[l],o=l===a.length-1,c="/"===s?t:t.slice(s.length)||"/",d=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:o},c),u=e.route;if(!d&&o&&r&&!a[a.length-1].route.index&&(d=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(n,d.params),i.push({params:n,pathname:z([s,d.pathname]),pathnameBase:B(z([s,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(s=z([s,d.pathnameBase]))}return i}function P(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,a]=function(e,t,r){void 0===t&&(t=!1);void 0===r&&(r=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let a=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,r)=>(a.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(a.push({paramName:"*"}),n+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":""!==e&&"/"!==e&&(n+="(?:(?=\\/|$))");let s=new RegExp(n,t?void 0:"i");return[s,a]}(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let s=n[0],i=s.replace(/(.)\/+$/,"$1"),l=n.slice(1);return{params:a.reduce((e,t,r)=>{let{paramName:a,isOptional:n}=t;if("*"===a){let e=l[r]||"";i=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const o=l[r];return e[a]=n&&!o?void 0:(o||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:i,pattern:e}}function D(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function L(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&"/"!==a?null:e.slice(r)||"/"}function I(e,t,r,a){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function M(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function F(e,t){let r=M(e);return t?r.map((e,t)=>t===r.length-1?e.pathname:e.pathnameBase):r.map(e=>e.pathnameBase)}function U(e,t,r,a){let n;void 0===a&&(a=!1),"string"===typeof e?n=x(e):(n=d({},e),f(!n.pathname||!n.pathname.includes("?"),I("?","pathname","search",n)),f(!n.pathname||!n.pathname.includes("#"),I("#","pathname","hash",n)),f(!n.search||!n.search.includes("#"),I("#","search","hash",n)));let s,i=""===e||""===n.pathname,l=i?"/":n.pathname;if(null==l)s=r;else{let e=t.length-1;if(!a&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}s=e>=0?t[e]:"/"}let o=function(e,t){void 0===t&&(t="/");let{pathname:r,search:a="",hash:n=""}="string"===typeof e?x(e):e,s=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)}),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:s,search:V(a),hash:H(n)}}(n,s),c=l&&"/"!==l&&l.endsWith("/"),u=(i||"."===l)&&r.endsWith("/");return o.pathname.endsWith("/")||!c&&!u||(o.pathname+="/"),o}const z=e=>e.join("/").replace(/\/\/+/g,"/"),B=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),V=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",H=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function W(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const q=["post","put","patch","delete"],G=(new Set(q),["get",...q]);new Set(G),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Y.apply(this,arguments)}const K=s.createContext(null);const X=s.createContext(null);const J=s.createContext(null);const Q=s.createContext(null);const Z=s.createContext({outlet:null,matches:[],isDataRoute:!1});const ee=s.createContext(null);function te(){return null!=s.useContext(Q)}function re(){return te()||f(!1),s.useContext(Q).location}function ae(e){s.useContext(J).static||s.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=s.useContext(Z);return e?function(){let{router:e}=pe(he.UseNavigateStable),t=xe(me.UseNavigateStable),r=s.useRef(!1);return ae(()=>{r.current=!0}),s.useCallback(function(a,n){void 0===n&&(n={}),r.current&&("number"===typeof a?e.navigate(a):e.navigate(a,Y({fromRouteId:t},n)))},[e,t])}():function(){te()||f(!1);let e=s.useContext(K),{basename:t,future:r,navigator:a}=s.useContext(J),{matches:n}=s.useContext(Z),{pathname:i}=re(),l=JSON.stringify(F(n,r.v7_relativeSplatPath)),o=s.useRef(!1);return ae(()=>{o.current=!0}),s.useCallback(function(r,n){if(void 0===n&&(n={}),!o.current)return;if("number"===typeof r)return void a.go(r);let s=U(r,JSON.parse(l),i,"path"===n.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:z([t,s.pathname])),(n.replace?a.replace:a.push)(s,n.state,n)},[t,a,l,i,e])}()}const se=s.createContext(null);function ie(e,t){let{relative:r}=void 0===t?{}:t,{future:a}=s.useContext(J),{matches:n}=s.useContext(Z),{pathname:i}=re(),l=JSON.stringify(F(n,a.v7_relativeSplatPath));return s.useMemo(()=>U(e,JSON.parse(l),i,"path"===r),[e,l,i,r])}function le(e,t,r,a){te()||f(!1);let{navigator:i}=s.useContext(J),{matches:l}=s.useContext(Z),o=l[l.length-1],c=o?o.params:{},d=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let u,h=re();if(t){var m;let e="string"===typeof t?x(t):t;"/"===d||(null==(m=e.pathname)?void 0:m.startsWith(d))||f(!1),u=e}else u=h;let p=u.pathname||"/",g=p;if("/"!==d){let e=d.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let v=y(e,{pathname:g});let b=fe(v&&v.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:z([d,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:z([d,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,r,a);return t&&b?s.createElement(Q.Provider,{value:{location:Y({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:n.Pop}},b):b}function oe(){let e=function(){var e;let t=s.useContext(ee),r=ge(me.UseRouteError),a=xe(me.UseRouteError);if(void 0!==t)return t;return null==(e=r.errors)?void 0:e[a]}(),t=W(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a};return s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),r?s.createElement("pre",{style:n},r):null,null)}const ce=s.createElement(oe,null);class de extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?s.createElement(Z.Provider,{value:this.props.routeContext},s.createElement(ee.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ue(e){let{routeContext:t,match:r,children:a}=e,n=s.useContext(K);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),s.createElement(Z.Provider,{value:t},a)}function fe(e,t,r,a){var n;if(void 0===t&&(t=[]),void 0===r&&(r=null),void 0===a&&(a=null),null==e){var i;if(!r)return null;if(r.errors)e=r.matches;else{if(!(null!=(i=a)&&i.v7_partialHydration&&0===t.length&&!r.initialized&&r.matches.length>0))return null;e=r.matches}}let l=e,o=null==(n=r)?void 0:n.errors;if(null!=o){let e=l.findIndex(e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id]));e>=0||f(!1),l=l.slice(0,Math.min(l.length,e+1))}let c=!1,d=-1;if(r&&a&&a.v7_partialHydration)for(let s=0;s<l.length;s++){let e=l[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=s),e.route.id){let{loaderData:t,errors:a}=r,n=e.route.loader&&void 0===t[e.route.id]&&(!a||void 0===a[e.route.id]);if(e.route.lazy||n){c=!0,l=d>=0?l.slice(0,d+1):[l[0]];break}}}return l.reduceRight((e,a,n)=>{let i,u=!1,f=null,h=null;var m;r&&(i=o&&a.route.id?o[a.route.id]:void 0,f=a.route.errorElement||ce,c&&(d<0&&0===n?(m="route-fallback",!1||ve[m]||(ve[m]=!0),u=!0,h=null):d===n&&(u=!0,h=a.route.hydrateFallbackElement||null)));let p=t.concat(l.slice(0,n+1)),g=()=>{let t;return t=i?f:u?h:a.route.Component?s.createElement(a.route.Component,null):a.route.element?a.route.element:e,s.createElement(ue,{match:a,routeContext:{outlet:e,matches:p,isDataRoute:null!=r},children:t})};return r&&(a.route.ErrorBoundary||a.route.errorElement||0===n)?s.createElement(de,{location:r.location,revalidation:r.revalidation,component:f,error:i,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var he=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(he||{}),me=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(me||{});function pe(e){let t=s.useContext(K);return t||f(!1),t}function ge(e){let t=s.useContext(X);return t||f(!1),t}function xe(e){let t=function(){let e=s.useContext(Z);return e||f(!1),e}(),r=t.matches[t.matches.length-1];return r.route.id||f(!1),r.route.id}const ve={};function be(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}i.startTransition;function ye(e){let{to:t,replace:r,state:a,relative:n}=e;te()||f(!1);let{future:i,static:l}=s.useContext(J),{matches:o}=s.useContext(Z),{pathname:c}=re(),d=ne(),u=U(t,F(o,i.v7_relativeSplatPath),c,"path"===n),h=JSON.stringify(u);return s.useEffect(()=>d(JSON.parse(h),{replace:r,state:a,relative:n}),[d,h,n,r,a]),null}function we(e){return function(e){let t=s.useContext(Z).outlet;return t?s.createElement(se.Provider,{value:e},t):t}(e.context)}function Ne(e){f(!1)}function je(e){let{basename:t="/",children:r=null,location:a,navigationType:i=n.Pop,navigator:l,static:o=!1,future:c}=e;te()&&f(!1);let d=t.replace(/^\/*/,"/"),u=s.useMemo(()=>({basename:d,navigator:l,static:o,future:Y({v7_relativeSplatPath:!1},c)}),[d,c,l,o]);"string"===typeof a&&(a=x(a));let{pathname:h="/",search:m="",hash:p="",state:g=null,key:v="default"}=a,b=s.useMemo(()=>{let e=L(h,d);return null==e?null:{location:{pathname:e,search:m,hash:p,state:g,key:v},navigationType:i}},[d,h,m,p,g,v,i]);return null==b?null:s.createElement(J.Provider,{value:u},s.createElement(Q.Provider,{children:r,value:b}))}function ke(e){let{children:t,location:r}=e;return le(Ee(t),r)}new Promise(()=>{});s.Component;function Ee(e,t){void 0===t&&(t=[]);let r=[];return s.Children.forEach(e,(e,a)=>{if(!s.isValidElement(e))return;let n=[...t,a];if(e.type===s.Fragment)return void r.push.apply(r,Ee(e.props.children,n));e.type!==Ne&&f(!1),e.props.index&&e.props.children&&f(!1);let i={id:e.props.id||n.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Ee(e.props.children,n)),r.push(i)}),r}function Se(){return Se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Se.apply(this,arguments)}function Te(e,t){if(null==e)return{};var r,a,n={},s=Object.keys(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const _e=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ce=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"];try{window.__reactRouterVersion="6"}catch(Ge){}const Ae=s.createContext({isTransitioning:!1});new Map;const Oe=i.startTransition;c.flushSync,i.useId;function Re(e){let{basename:t,children:r,future:a,window:n}=e,i=s.useRef();var l;null==i.current&&(i.current=(void 0===(l={window:n,v5Compat:!0})&&(l={}),v(function(e,t){let{pathname:r,search:a,hash:n}=e.location;return p("",{pathname:r,search:a,hash:n},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:g(t)},null,l)));let o=i.current,[c,d]=s.useState({action:o.action,location:o.location}),{v7_startTransition:u}=a||{},f=s.useCallback(e=>{u&&Oe?Oe(()=>d(e)):d(e)},[d,u]);return s.useLayoutEffect(()=>o.listen(f),[o,f]),s.useEffect(()=>be(a),[a]),s.createElement(je,{basename:t,children:r,location:c.location,navigationType:c.action,navigator:o,future:a})}const Pe="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,De=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Le=s.forwardRef(function(e,t){let r,{onClick:a,relative:n,reloadDocument:i,replace:l,state:o,target:c,to:d,preventScrollReset:u,viewTransition:h}=e,m=Te(e,_e),{basename:p}=s.useContext(J),x=!1;if("string"===typeof d&&De.test(d)&&(r=d,Pe))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),r=L(t.pathname,p);t.origin===e.origin&&null!=r?d=r+t.search+t.hash:x=!0}catch(Ge){}let v=function(e,t){let{relative:r}=void 0===t?{}:t;te()||f(!1);let{basename:a,navigator:n}=s.useContext(J),{hash:i,pathname:l,search:o}=ie(e,{relative:r}),c=l;return"/"!==a&&(c="/"===l?a:z([a,l])),n.createHref({pathname:c,search:o,hash:i})}(d,{relative:n}),b=function(e,t){let{target:r,replace:a,state:n,preventScrollReset:i,relative:l,viewTransition:o}=void 0===t?{}:t,c=ne(),d=re(),u=ie(e,{relative:l});return s.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,r)){t.preventDefault();let r=void 0!==a?a:g(d)===g(u);c(e,{replace:r,state:n,preventScrollReset:i,relative:l,viewTransition:o})}},[d,c,u,a,n,r,e,i,l,o])}(d,{replace:l,state:o,target:c,preventScrollReset:u,relative:n,viewTransition:h});return s.createElement("a",Se({},m,{href:r||v,onClick:x||i?a:function(e){a&&a(e),e.defaultPrevented||b(e)},ref:t,target:c}))});const Ie=s.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:a=!1,className:n="",end:i=!1,style:l,to:o,viewTransition:c,children:d}=e,u=Te(e,Ce),h=ie(o,{relative:u.relative}),m=re(),p=s.useContext(X),{navigator:g,basename:x}=s.useContext(J),v=null!=p&&function(e,t){void 0===t&&(t={});let r=s.useContext(Ae);null==r&&f(!1);let{basename:a}=Ue(Me.useViewTransitionState),n=ie(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=L(r.currentLocation.pathname,a)||r.currentLocation.pathname,l=L(r.nextLocation.pathname,a)||r.nextLocation.pathname;return null!=P(n.pathname,l)||null!=P(n.pathname,i)}(h)&&!0===c,b=g.encodeLocation?g.encodeLocation(h).pathname:h.pathname,y=m.pathname,w=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;a||(y=y.toLowerCase(),w=w?w.toLowerCase():null,b=b.toLowerCase()),w&&x&&(w=L(w,x)||w);const N="/"!==b&&b.endsWith("/")?b.length-1:b.length;let j,k=y===b||!i&&y.startsWith(b)&&"/"===y.charAt(N),E=null!=w&&(w===b||!i&&w.startsWith(b)&&"/"===w.charAt(b.length)),S={isActive:k,isPending:E,isTransitioning:v},T=k?r:void 0;j="function"===typeof n?n(S):[n,k?"active":null,E?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let _="function"===typeof l?l(S):l;return s.createElement(Le,Se({},u,{"aria-current":T,className:j,ref:t,style:_,to:o,viewTransition:c}),"function"===typeof d?d(S):d)});var Me,Fe;function Ue(e){let t=s.useContext(K);return t||f(!1),t}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Me||(Me={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Fe||(Fe={}));function ze(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function Ve(e){var t=function(e,t){if("object"!=Be(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=Be(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Be(t)?t:t+""}function He(e,t,r){return(t=Ve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function We(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function qe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?We(Object(r),!0).forEach(function(t){He(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):We(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let Ge={data:""},$e=e=>"object"==typeof window?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||Ge,Ye=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Ke=/\/\*[^]*?\*\/|  +/g,Xe=/\n+/g,Je=(e,t)=>{let r="",a="",n="";for(let s in e){let i=e[s];"@"==s[0]?"i"==s[1]?r=s+" "+i+";":a+="f"==s[1]?Je(i,s):s+"{"+Je(i,"k"==s[1]?"":t)+"}":"object"==typeof i?a+=Je(i,t?t.replace(/([^,])+/g,e=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):s):null!=i&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=Je.p?Je.p(s,i):s+":"+i+";")}return r+(t&&n?t+"{"+n+"}":n)+a},Qe={},Ze=e=>{if("object"==typeof e){let t="";for(let r in e)t+=r+Ze(e[r]);return t}return e},et=(e,t,r,a,n)=>{let s=Ze(e),i=Qe[s]||(Qe[s]=(e=>{let t=0,r=11;for(;t<e.length;)r=101*r+e.charCodeAt(t++)>>>0;return"go"+r})(s));if(!Qe[i]){let t=s!==e?e:(e=>{let t,r,a=[{}];for(;t=Ye.exec(e.replace(Ke,""));)t[4]?a.shift():t[3]?(r=t[3].replace(Xe," ").trim(),a.unshift(a[0][r]=a[0][r]||{})):a[0][t[1]]=t[2].replace(Xe," ").trim();return a[0]})(e);Qe[i]=Je(n?{["@keyframes "+i]:t}:t,r?"":"."+i)}let l=r&&Qe.g?Qe.g:null;return r&&(Qe.g=Qe[i]),((e,t,r,a)=>{a?t.data=t.data.replace(a,e):-1===t.data.indexOf(e)&&(t.data=r?e+t.data:t.data+e)})(Qe[i],t,a,l),i};function tt(e){let t=this||{},r=e.call?e(t.p):e;return et(r.unshift?r.raw?((e,t,r)=>e.reduce((e,a,n)=>{let s=t[n];if(s&&s.call){let e=s(r),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;s=t?"."+t:e&&"object"==typeof e?e.props?"":Je(e,""):!1===e?"":e}return e+a+(null==s?"":s)},""))(r,[].slice.call(arguments,1),t.p):r.reduce((e,r)=>Object.assign(e,r&&r.call?r(t.p):r),{}):r,$e(t.target),t.g,t.o,t.k)}tt.bind({g:1});let rt,at,nt,st=tt.bind({k:1});function it(e,t){let r=this||{};return function(){let a=arguments;function n(s,i){let l=Object.assign({},s),o=l.className||n.className;r.p=Object.assign({theme:at&&at()},l),r.o=/ *go\d+/.test(o),l.className=tt.apply(r,a)+(o?" "+o:""),t&&(l.ref=i);let c=e;return e[0]&&(c=l.as||e,delete l.as),nt&&c[0]&&nt(l),rt(c,l)}return t?t(n):n}}var lt,ot,ct,dt,ut,ft,ht,mt,pt,gt,xt,vt,bt,yt,wt,Nt,jt=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,kt=(()=>{let e=0;return()=>(++e).toString()})(),Et=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),St=(e,t)=>{switch(t.type){case 0:return qe(qe({},e),{},{toasts:[t.toast,...e.toasts].slice(0,20)});case 1:return qe(qe({},e),{},{toasts:e.toasts.map(e=>e.id===t.toast.id?qe(qe({},e),t.toast):e)});case 2:let{toast:r}=t;return St(e,{type:e.toasts.find(e=>e.id===r.id)?1:0,toast:r});case 3:let{toastId:a}=t;return qe(qe({},e),{},{toasts:e.toasts.map(e=>e.id===a||void 0===a?qe(qe({},e),{},{dismissed:!0,visible:!1}):e)});case 4:return void 0===t.toastId?qe(qe({},e),{},{toasts:[]}):qe(qe({},e),{},{toasts:e.toasts.filter(e=>e.id!==t.toastId)});case 5:return qe(qe({},e),{},{pausedAt:t.time});case 6:let n=t.time-(e.pausedAt||0);return qe(qe({},e),{},{pausedAt:void 0,toasts:e.toasts.map(e=>qe(qe({},e),{},{pauseDuration:e.pauseDuration+n}))})}},Tt=[],_t={toasts:[],pausedAt:void 0},Ct=e=>{_t=St(_t,e),Tt.forEach(e=>{e(_t)})},At={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Ot=e=>(t,r)=>{let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blank",r=arguments.length>2?arguments[2]:void 0;return qe(qe({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0},r),{},{id:(null==r?void 0:r.id)||kt()})}(t,e,r);return Ct({type:2,toast:a}),a.id},Rt=(e,t)=>Ot("blank")(e,t);Rt.error=Ot("error"),Rt.success=Ot("success"),Rt.loading=Ot("loading"),Rt.custom=Ot("custom"),Rt.dismiss=e=>{Ct({type:3,toastId:e})},Rt.remove=e=>Ct({type:4,toastId:e}),Rt.promise=(e,t,r)=>{let a=Rt.loading(t.loading,qe(qe({},r),null==r?void 0:r.loading));return"function"==typeof e&&(e=e()),e.then(e=>{let n=t.success?jt(t.success,e):void 0;return n?Rt.success(n,qe(qe({id:a},r),null==r?void 0:r.success)):Rt.dismiss(a),e}).catch(e=>{let n=t.error?jt(t.error,e):void 0;n?Rt.error(n,qe(qe({id:a},r),null==r?void 0:r.error)):Rt.dismiss(a)}),e};var Pt=(e,t)=>{Ct({type:1,toast:{id:e,height:t}})},Dt=()=>{Ct({type:5,time:Date.now()})},Lt=new Map,It=e=>{let{toasts:t,pausedAt:r}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,r]=(0,s.useState)(_t),a=(0,s.useRef)(_t);(0,s.useEffect)(()=>(a.current!==_t&&r(_t),Tt.push(r),()=>{let e=Tt.indexOf(r);e>-1&&Tt.splice(e,1)}),[]);let n=t.toasts.map(t=>{var r,a,n;return qe(qe(qe(qe({},e),e[t.type]),t),{},{removeDelay:t.removeDelay||(null==(r=e[t.type])?void 0:r.removeDelay)||(null==e?void 0:e.removeDelay),duration:t.duration||(null==(a=e[t.type])?void 0:a.duration)||(null==e?void 0:e.duration)||At[t.type],style:qe(qe(qe({},e.style),null==(n=e[t.type])?void 0:n.style),t.style)})});return qe(qe({},t),{},{toasts:n})}(e);(0,s.useEffect)(()=>{if(r)return;let e=Date.now(),a=t.map(t=>{if(t.duration===1/0)return;let r=(t.duration||0)+t.pauseDuration-(e-t.createdAt);if(!(r<0))return setTimeout(()=>Rt.dismiss(t.id),r);t.visible&&Rt.dismiss(t.id)});return()=>{a.forEach(e=>e&&clearTimeout(e))}},[t,r]);let a=(0,s.useCallback)(()=>{r&&Ct({type:6,time:Date.now()})},[r]),n=(0,s.useCallback)((e,r)=>{let{reverseOrder:a=!1,gutter:n=8,defaultPosition:s}=r||{},i=t.filter(t=>(t.position||s)===(e.position||s)&&t.height),l=i.findIndex(t=>t.id===e.id),o=i.filter((e,t)=>t<l&&e.visible).length;return i.filter(e=>e.visible).slice(...a?[o+1]:[0,o]).reduce((e,t)=>e+(t.height||0)+n,0)},[t]);return(0,s.useEffect)(()=>{t.forEach(e=>{if(e.dismissed)!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(Lt.has(e))return;let r=setTimeout(()=>{Lt.delete(e),Ct({type:4,toastId:e})},t);Lt.set(e,r)}(e.id,e.removeDelay);else{let t=Lt.get(e.id);t&&(clearTimeout(t),Lt.delete(e.id))}})},[t]),{toasts:t,handlers:{updateHeight:Pt,startPause:Dt,endPause:a,calculateOffset:n}}},Mt=st(lt||(lt=ze(["\nfrom {\n  transform: scale(0) rotate(45deg);\n\topacity: 0;\n}\nto {\n transform: scale(1) rotate(45deg);\n  opacity: 1;\n}"]))),Ft=st(ot||(ot=ze(["\nfrom {\n  transform: scale(0);\n  opacity: 0;\n}\nto {\n  transform: scale(1);\n  opacity: 1;\n}"]))),Ut=st(ct||(ct=ze(["\nfrom {\n  transform: scale(0) rotate(90deg);\n\topacity: 0;\n}\nto {\n  transform: scale(1) rotate(90deg);\n\topacity: 1;\n}"]))),zt=it("div")(dt||(dt=ze(["\n  width: 20px;\n  opacity: 0;\n  height: 20px;\n  border-radius: 10px;\n  background: ",";\n  position: relative;\n  transform: rotate(45deg);\n\n  animation: "," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n  animation-delay: 100ms;\n\n  &:after,\n  &:before {\n    content: '';\n    animation: "," 0.15s ease-out forwards;\n    animation-delay: 150ms;\n    position: absolute;\n    border-radius: 3px;\n    opacity: 0;\n    background: ",";\n    bottom: 9px;\n    left: 4px;\n    height: 2px;\n    width: 12px;\n  }\n\n  &:before {\n    animation: "," 0.15s ease-out forwards;\n    animation-delay: 180ms;\n    transform: rotate(90deg);\n  }\n"])),e=>e.primary||"#ff4b4b",Mt,Ft,e=>e.secondary||"#fff",Ut),Bt=st(ut||(ut=ze(["\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n"]))),Vt=it("div")(ft||(ft=ze(["\n  width: 12px;\n  height: 12px;\n  box-sizing: border-box;\n  border: 2px solid;\n  border-radius: 100%;\n  border-color: ",";\n  border-right-color: ",";\n  animation: "," 1s linear infinite;\n"])),e=>e.secondary||"#e0e0e0",e=>e.primary||"#616161",Bt),Ht=st(ht||(ht=ze(["\nfrom {\n  transform: scale(0) rotate(45deg);\n\topacity: 0;\n}\nto {\n  transform: scale(1) rotate(45deg);\n\topacity: 1;\n}"]))),Wt=st(mt||(mt=ze(["\n0% {\n\theight: 0;\n\twidth: 0;\n\topacity: 0;\n}\n40% {\n  height: 0;\n\twidth: 6px;\n\topacity: 1;\n}\n100% {\n  opacity: 1;\n  height: 10px;\n}"]))),qt=it("div")(pt||(pt=ze(["\n  width: 20px;\n  opacity: 0;\n  height: 20px;\n  border-radius: 10px;\n  background: ",";\n  position: relative;\n  transform: rotate(45deg);\n\n  animation: "," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n  animation-delay: 100ms;\n  &:after {\n    content: '';\n    box-sizing: border-box;\n    animation: "," 0.2s ease-out forwards;\n    opacity: 0;\n    animation-delay: 200ms;\n    position: absolute;\n    border-right: 2px solid;\n    border-bottom: 2px solid;\n    border-color: ",";\n    bottom: 6px;\n    left: 6px;\n    height: 10px;\n    width: 6px;\n  }\n"])),e=>e.primary||"#61d345",Ht,Wt,e=>e.secondary||"#fff"),Gt=it("div")(gt||(gt=ze(["\n  position: absolute;\n"]))),$t=it("div")(xt||(xt=ze(["\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-width: 20px;\n  min-height: 20px;\n"]))),Yt=st(vt||(vt=ze(["\nfrom {\n  transform: scale(0.6);\n  opacity: 0.4;\n}\nto {\n  transform: scale(1);\n  opacity: 1;\n}"]))),Kt=it("div")(bt||(bt=ze(["\n  position: relative;\n  transform: scale(0.6);\n  opacity: 0.4;\n  min-width: 20px;\n  animation: "," 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n"])),Yt),Xt=e=>{let{toast:t}=e,{icon:r,type:a,iconTheme:n}=t;return void 0!==r?"string"==typeof r?s.createElement(Kt,null,r):r:"blank"===a?null:s.createElement($t,null,s.createElement(Vt,qe({},n)),"loading"!==a&&s.createElement(Gt,null,"error"===a?s.createElement(zt,qe({},n)):s.createElement(qt,qe({},n))))},Jt=e=>"\n0% {transform: translate3d(0,".concat(-200*e,"%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n"),Qt=e=>"\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,".concat(-150*e,"%,-1px) scale(.6); opacity:0;}\n"),Zt=it("div")(yt||(yt=ze(["\n  display: flex;\n  align-items: center;\n  background: #fff;\n  color: #363636;\n  line-height: 1.3;\n  will-change: transform;\n  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);\n  max-width: 350px;\n  pointer-events: auto;\n  padding: 8px 10px;\n  border-radius: 8px;\n"]))),er=it("div")(wt||(wt=ze(["\n  display: flex;\n  justify-content: center;\n  margin: 4px 10px;\n  color: inherit;\n  flex: 1 1 auto;\n  white-space: pre-line;\n"]))),tr=s.memo(e=>{let{toast:t,position:r,style:a,children:n}=e,i=t.height?((e,t)=>{let r=e.includes("top")?1:-1,[a,n]=Et()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[Jt(r),Qt(r)];return{animation:t?"".concat(st(a)," 0.35s cubic-bezier(.21,1.02,.73,1) forwards"):"".concat(st(n)," 0.4s forwards cubic-bezier(.06,.71,.55,1)")}})(t.position||r||"top-center",t.visible):{opacity:0},l=s.createElement(Xt,{toast:t}),o=s.createElement(er,qe({},t.ariaProps),jt(t.message,t));return s.createElement(Zt,{className:t.className,style:qe(qe(qe({},i),a),t.style)},"function"==typeof n?n({icon:l,message:o}):s.createElement(s.Fragment,null,l,o))});!function(e,t,r,a){Je.p=t,rt=e,at=r,nt=a}(s.createElement);var rr=e=>{let{id:t,className:r,style:a,onHeightUpdate:n,children:i}=e,l=s.useCallback(e=>{if(e){let r=()=>{let r=e.getBoundingClientRect().height;n(t,r)};r(),new MutationObserver(r).observe(e,{subtree:!0,childList:!0,characterData:!0})}},[t,n]);return s.createElement("div",{ref:l,className:r,style:a},i)},ar=tt(Nt||(Nt=ze(["\n  z-index: 9999;\n  > * {\n    pointer-events: auto;\n  }\n"]))),nr=e=>{let{reverseOrder:t,position:r="top-center",toastOptions:a,gutter:n,children:i,containerStyle:l,containerClassName:o}=e,{toasts:c,handlers:d}=It(a);return s.createElement("div",{id:"_rht_toaster",style:qe({position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none"},l),className:o,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(e=>{let a=e.position||r,l=((e,t)=>{let r=e.includes("top"),a=r?{top:0}:{bottom:0},n=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return qe(qe({left:0,right:0,display:"flex",position:"absolute",transition:Et()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:"translateY(".concat(t*(r?1:-1),"px)")},a),n)})(a,d.calculateOffset(e,{reverseOrder:t,gutter:n,defaultPosition:r}));return s.createElement(rr,{id:e.id,key:e.id,onHeightUpdate:d.updateHeight,className:e.visible?ar:"",style:l},"custom"===e.type?jt(e.message,e):i?i(e):s.createElement(tr,{toast:e,position:a}))}))},sr=Rt;function ir(e,t){return function(){return e.apply(t,arguments)}}const{toString:lr}=Object.prototype,{getPrototypeOf:or}=Object,{iterator:cr,toStringTag:dr}=Symbol,ur=(fr=Object.create(null),e=>{const t=lr.call(e);return fr[t]||(fr[t]=t.slice(8,-1).toLowerCase())});var fr;const hr=e=>(e=e.toLowerCase(),t=>ur(t)===e),mr=e=>t=>typeof t===e,{isArray:pr}=Array,gr=mr("undefined");function xr(e){return null!==e&&!gr(e)&&null!==e.constructor&&!gr(e.constructor)&&yr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const vr=hr("ArrayBuffer");const br=mr("string"),yr=mr("function"),wr=mr("number"),Nr=e=>null!==e&&"object"===typeof e,jr=e=>{if("object"!==ur(e))return!1;const t=or(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(dr in e)&&!(cr in e)},kr=hr("Date"),Er=hr("File"),Sr=hr("Blob"),Tr=hr("FileList"),_r=hr("URLSearchParams"),[Cr,Ar,Or,Rr]=["ReadableStream","Request","Response","Headers"].map(hr);function Pr(e,t){let r,a,{allOwnKeys:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),pr(e))for(r=0,a=e.length;r<a;r++)t.call(null,e[r],r,e);else{if(xr(e))return;const a=n?Object.getOwnPropertyNames(e):Object.keys(e),s=a.length;let i;for(r=0;r<s;r++)i=a[r],t.call(null,e[i],i,e)}}function Dr(e,t){if(xr(e))return null;t=t.toLowerCase();const r=Object.keys(e);let a,n=r.length;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Lr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,Ir=e=>!gr(e)&&e!==Lr;const Mr=(Fr="undefined"!==typeof Uint8Array&&or(Uint8Array),e=>Fr&&e instanceof Fr);var Fr;const Ur=hr("HTMLFormElement"),zr=(e=>{let{hasOwnProperty:t}=e;return(e,r)=>t.call(e,r)})(Object.prototype),Br=hr("RegExp"),Vr=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),a={};Pr(r,(r,n)=>{let s;!1!==(s=t(r,n,e))&&(a[n]=s||r)}),Object.defineProperties(e,a)};const Hr=hr("AsyncFunction"),Wr=((e,t)=>{return e?setImmediate:t?(r="axios@".concat(Math.random()),a=[],Lr.addEventListener("message",e=>{let{source:t,data:n}=e;t===Lr&&n===r&&a.length&&a.shift()()},!1),e=>{a.push(e),Lr.postMessage(r,"*")}):e=>setTimeout(e);var r,a})("function"===typeof setImmediate,yr(Lr.postMessage)),qr="undefined"!==typeof queueMicrotask?queueMicrotask.bind(Lr):"undefined"!==typeof process&&process.nextTick||Wr,Gr={isArray:pr,isArrayBuffer:vr,isBuffer:xr,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||yr(e.append)&&("formdata"===(t=ur(e))||"object"===t&&yr(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&vr(e.buffer),t},isString:br,isNumber:wr,isBoolean:e=>!0===e||!1===e,isObject:Nr,isPlainObject:jr,isEmptyObject:e=>{if(!Nr(e)||xr(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(Ge){return!1}},isReadableStream:Cr,isRequest:Ar,isResponse:Or,isHeaders:Rr,isUndefined:gr,isDate:kr,isFile:Er,isBlob:Sr,isRegExp:Br,isFunction:yr,isStream:e=>Nr(e)&&yr(e.pipe),isURLSearchParams:_r,isTypedArray:Mr,isFileList:Tr,forEach:Pr,merge:function e(){const{caseless:t}=Ir(this)&&this||{},r={},a=(a,n)=>{const s=t&&Dr(r,n)||n;jr(r[s])&&jr(a)?r[s]=e(r[s],a):jr(a)?r[s]=e({},a):pr(a)?r[s]=a.slice():r[s]=a};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&Pr(arguments[n],a);return r},extend:function(e,t,r){let{allOwnKeys:a}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Pr(t,(t,a)=>{r&&yr(t)?e[a]=ir(t,r):e[a]=t},{allOwnKeys:a}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,a)=>{let n,s,i;const l={};if(t=t||{},null==e)return t;do{for(n=Object.getOwnPropertyNames(e),s=n.length;s-- >0;)i=n[s],a&&!a(i,e,t)||l[i]||(t[i]=e[i],l[i]=!0);e=!1!==r&&or(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:ur,kindOfTest:hr,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;const a=e.indexOf(t,r);return-1!==a&&a===r},toArray:e=>{if(!e)return null;if(pr(e))return e;let t=e.length;if(!wr(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[cr]).call(e);let a;for(;(a=r.next())&&!a.done;){const r=a.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{let r;const a=[];for(;null!==(r=e.exec(t));)a.push(r);return a},isHTMLForm:Ur,hasOwnProperty:zr,hasOwnProp:zr,reduceDescriptors:Vr,freezeMethods:e=>{Vr(e,(t,r)=>{if(yr(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const a=e[r];yr(a)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))})},toObjectSet:(e,t)=>{const r={},a=e=>{e.forEach(e=>{r[e]=!0})};return pr(e)?a(e):a(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,r){return t.toUpperCase()+r}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:Dr,global:Lr,isContextDefined:Ir,isSpecCompliantForm:function(e){return!!(e&&yr(e.append)&&"FormData"===e[dr]&&e[cr])},toJSONObject:e=>{const t=new Array(10),r=(e,a)=>{if(Nr(e)){if(t.indexOf(e)>=0)return;if(xr(e))return e;if(!("toJSON"in e)){t[a]=e;const n=pr(e)?[]:{};return Pr(e,(e,t)=>{const s=r(e,a+1);!gr(s)&&(n[t]=s)}),t[a]=void 0,n}}return e};return r(e,0)},isAsyncFn:Hr,isThenable:e=>e&&(Nr(e)||yr(e))&&yr(e.then)&&yr(e.catch),setImmediate:Wr,asap:qr,isIterable:e=>null!=e&&yr(e[cr])};function $r(e,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}Gr.inherits($r,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Gr.toJSONObject(this.config),code:this.code,status:this.status}}});const Yr=$r.prototype,Kr={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Kr[e]={value:e}}),Object.defineProperties($r,Kr),Object.defineProperty(Yr,"isAxiosError",{value:!0}),$r.from=(e,t,r,a,n,s)=>{const i=Object.create(Yr);return Gr.toFlatObject(e,i,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),$r.call(i,e.message,t,r,a,n),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};const Xr=$r;function Jr(e){return Gr.isPlainObject(e)||Gr.isArray(e)}function Qr(e){return Gr.endsWith(e,"[]")?e.slice(0,-2):e}function Zr(e,t,r){return e?e.concat(t).map(function(e,t){return e=Qr(e),!r&&t?"["+e+"]":e}).join(r?".":""):t}const ea=Gr.toFlatObject(Gr,{},null,function(e){return/^is[A-Z]/.test(e)});const ta=function(e,t,r){if(!Gr.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const a=(r=Gr.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!Gr.isUndefined(t[e])})).metaTokens,n=r.visitor||c,s=r.dots,i=r.indexes,l=(r.Blob||"undefined"!==typeof Blob&&Blob)&&Gr.isSpecCompliantForm(t);if(!Gr.isFunction(n))throw new TypeError("visitor must be a function");function o(e){if(null===e)return"";if(Gr.isDate(e))return e.toISOString();if(Gr.isBoolean(e))return e.toString();if(!l&&Gr.isBlob(e))throw new Xr("Blob is not supported. Use a Buffer instead.");return Gr.isArrayBuffer(e)||Gr.isTypedArray(e)?l&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,r,n){let l=e;if(e&&!n&&"object"===typeof e)if(Gr.endsWith(r,"{}"))r=a?r:r.slice(0,-2),e=JSON.stringify(e);else if(Gr.isArray(e)&&function(e){return Gr.isArray(e)&&!e.some(Jr)}(e)||(Gr.isFileList(e)||Gr.endsWith(r,"[]"))&&(l=Gr.toArray(e)))return r=Qr(r),l.forEach(function(e,a){!Gr.isUndefined(e)&&null!==e&&t.append(!0===i?Zr([r],a,s):null===i?r:r+"[]",o(e))}),!1;return!!Jr(e)||(t.append(Zr(n,r,s),o(e)),!1)}const d=[],u=Object.assign(ea,{defaultVisitor:c,convertValue:o,isVisitable:Jr});if(!Gr.isObject(e))throw new TypeError("data must be an object");return function e(r,a){if(!Gr.isUndefined(r)){if(-1!==d.indexOf(r))throw Error("Circular reference detected in "+a.join("."));d.push(r),Gr.forEach(r,function(r,s){!0===(!(Gr.isUndefined(r)||null===r)&&n.call(t,r,Gr.isString(s)?s.trim():s,a,u))&&e(r,a?a.concat(s):[s])}),d.pop()}}(e),t};function ra(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function aa(e,t){this._pairs=[],e&&ta(e,this,t)}const na=aa.prototype;na.append=function(e,t){this._pairs.push([e,t])},na.toString=function(e){const t=e?function(t){return e.call(this,t,ra)}:ra;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const sa=aa;function ia(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function la(e,t,r){if(!t)return e;const a=r&&r.encode||ia;Gr.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let s;if(s=n?n(t,r):Gr.isURLSearchParams(t)?t.toString():new sa(t,r).toString(a),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const oa=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Gr.forEach(this.handlers,function(t){null!==t&&e(t)})}},ca={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},da={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:sa,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},ua="undefined"!==typeof window&&"undefined"!==typeof document,fa="object"===typeof navigator&&navigator||void 0,ha=ua&&(!fa||["ReactNative","NativeScript","NS"].indexOf(fa.product)<0),ma="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,pa=ua&&window.location.href||"http://localhost",ga=qe(qe({},a),da);const xa=function(e){function t(e,r,a,n){let s=e[n++];if("__proto__"===s)return!0;const i=Number.isFinite(+s),l=n>=e.length;if(s=!s&&Gr.isArray(a)?a.length:s,l)return Gr.hasOwnProp(a,s)?a[s]=[a[s],r]:a[s]=r,!i;a[s]&&Gr.isObject(a[s])||(a[s]=[]);return t(e,r,a[s],n)&&Gr.isArray(a[s])&&(a[s]=function(e){const t={},r=Object.keys(e);let a;const n=r.length;let s;for(a=0;a<n;a++)s=r[a],t[s]=e[s];return t}(a[s])),!i}if(Gr.isFormData(e)&&Gr.isFunction(e.entries)){const r={};return Gr.forEachEntry(e,(e,a)=>{t(function(e){return Gr.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),a,r,0)}),r}return null};const va={transitional:ca,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",a=r.indexOf("application/json")>-1,n=Gr.isObject(e);n&&Gr.isHTMLForm(e)&&(e=new FormData(e));if(Gr.isFormData(e))return a?JSON.stringify(xa(e)):e;if(Gr.isArrayBuffer(e)||Gr.isBuffer(e)||Gr.isStream(e)||Gr.isFile(e)||Gr.isBlob(e)||Gr.isReadableStream(e))return e;if(Gr.isArrayBufferView(e))return e.buffer;if(Gr.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(n){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return ta(e,new ga.classes.URLSearchParams,qe({visitor:function(e,t,r,a){return ga.isNode&&Gr.isBuffer(e)?(this.append(t,e.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=Gr.isFileList(e))||r.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return ta(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return n||a?(t.setContentType("application/json",!1),function(e,t,r){if(Gr.isString(e))try{return(t||JSON.parse)(e),Gr.trim(e)}catch(Ge){if("SyntaxError"!==Ge.name)throw Ge}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||va.transitional,r=t&&t.forcedJSONParsing,a="json"===this.responseType;if(Gr.isResponse(e)||Gr.isReadableStream(e))return e;if(e&&Gr.isString(e)&&(r&&!this.responseType||a)){const r=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(e)}catch(Ge){if(r){if("SyntaxError"===Ge.name)throw Xr.from(Ge,Xr.ERR_BAD_RESPONSE,this,null,this.response);throw Ge}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ga.classes.FormData,Blob:ga.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Gr.forEach(["delete","get","head","post","put","patch"],e=>{va.headers[e]={}});const ba=va,ya=Gr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),wa=Symbol("internals");function Na(e){return e&&String(e).trim().toLowerCase()}function ja(e){return!1===e||null==e?e:Gr.isArray(e)?e.map(ja):String(e)}function ka(e,t,r,a,n){return Gr.isFunction(a)?a.call(this,t,r):(n&&(t=r),Gr.isString(t)?Gr.isString(a)?-1!==t.indexOf(a):Gr.isRegExp(a)?a.test(t):void 0:void 0)}class Ea{constructor(e){e&&this.set(e)}set(e,t,r){const a=this;function n(e,t,r){const n=Na(t);if(!n)throw new Error("header name must be a non-empty string");const s=Gr.findKey(a,n);(!s||void 0===a[s]||!0===r||void 0===r&&!1!==a[s])&&(a[s||t]=ja(e))}const s=(e,t)=>Gr.forEach(e,(e,r)=>n(e,r,t));if(Gr.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(Gr.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let r,a,n;return e&&e.split("\n").forEach(function(e){n=e.indexOf(":"),r=e.substring(0,n).trim().toLowerCase(),a=e.substring(n+1).trim(),!r||t[r]&&ya[r]||("set-cookie"===r?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t})(e),t);else if(Gr.isObject(e)&&Gr.isIterable(e)){let r,a,n={};for(const t of e){if(!Gr.isArray(t))throw TypeError("Object iterator must return a key-value pair");n[a=t[0]]=(r=n[a])?Gr.isArray(r)?[...r,t[1]]:[r,t[1]]:t[1]}s(n,t)}else null!=e&&n(t,e,r);return this}get(e,t){if(e=Na(e)){const r=Gr.findKey(this,e);if(r){const e=this[r];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(e);)t[a[1]]=a[2];return t}(e);if(Gr.isFunction(t))return t.call(this,e,r);if(Gr.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Na(e)){const r=Gr.findKey(this,e);return!(!r||void 0===this[r]||t&&!ka(0,this[r],r,t))}return!1}delete(e,t){const r=this;let a=!1;function n(e){if(e=Na(e)){const n=Gr.findKey(r,e);!n||t&&!ka(0,r[n],n,t)||(delete r[n],a=!0)}}return Gr.isArray(e)?e.forEach(n):n(e),a}clear(e){const t=Object.keys(this);let r=t.length,a=!1;for(;r--;){const n=t[r];e&&!ka(0,this[n],n,e,!0)||(delete this[n],a=!0)}return a}normalize(e){const t=this,r={};return Gr.forEach(this,(a,n)=>{const s=Gr.findKey(r,n);if(s)return t[s]=ja(a),void delete t[n];const i=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}(n):String(n).trim();i!==n&&delete t[n],t[i]=ja(a),r[i]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return Gr.forEach(this,(r,a)=>{null!=r&&!1!==r&&(t[a]=e&&Gr.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,r]=e;return t+": "+r}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var r=arguments.length,a=new Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];return a.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[wa]=this[wa]={accessors:{}}).accessors,r=this.prototype;function a(e){const a=Na(e);t[a]||(!function(e,t){const r=Gr.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+r,{value:function(e,r,n){return this[a].call(this,t,e,r,n)},configurable:!0})})}(r,e),t[a]=!0)}return Gr.isArray(e)?e.forEach(a):a(e),this}}Ea.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Gr.reduceDescriptors(Ea.prototype,(e,t)=>{let{value:r}=e,a=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(e){this[a]=e}}}),Gr.freezeMethods(Ea);const Sa=Ea;function Ta(e,t){const r=this||ba,a=t||r,n=Sa.from(a.headers);let s=a.data;return Gr.forEach(e,function(e){s=e.call(r,s,n.normalize(),t?t.status:void 0)}),n.normalize(),s}function _a(e){return!(!e||!e.__CANCEL__)}function Ca(e,t,r){Xr.call(this,null==e?"canceled":e,Xr.ERR_CANCELED,t,r),this.name="CanceledError"}Gr.inherits(Ca,Xr,{__CANCEL__:!0});const Aa=Ca;function Oa(e,t,r){const a=r.config.validateStatus;r.status&&a&&!a(r.status)?t(new Xr("Request failed with status code "+r.status,[Xr.ERR_BAD_REQUEST,Xr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}const Ra=function(e,t){e=e||10;const r=new Array(e),a=new Array(e);let n,s=0,i=0;return t=void 0!==t?t:1e3,function(l){const o=Date.now(),c=a[i];n||(n=o),r[s]=l,a[s]=o;let d=i,u=0;for(;d!==s;)u+=r[d++],d%=e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),o-n<t)return;const f=c&&o-c;return f?Math.round(1e3*u/f):void 0}};const Pa=function(e,t){let r,a,n=0,s=1e3/t;const i=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();n=s,r=null,a&&(clearTimeout(a),a=null),e(...t)};return[function(){const e=Date.now(),t=e-n;for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];t>=s?i(o,e):(r=o,a||(a=setTimeout(()=>{a=null,i(r)},s-t)))},()=>r&&i(r)]},Da=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=0;const n=Ra(50,250);return Pa(r=>{const s=r.loaded,i=r.lengthComputable?r.total:void 0,l=s-a,o=n(l);a=s;e({loaded:s,total:i,progress:i?s/i:void 0,bytes:l,rate:o||void 0,estimated:o&&i&&s<=i?(i-s)/o:void 0,event:r,lengthComputable:null!=i,[t?"download":"upload"]:!0})},r)},La=(e,t)=>{const r=null!=e;return[a=>t[0]({lengthComputable:r,total:e,loaded:a}),t[1]]},Ia=e=>function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return Gr.asap(()=>e(...r))},Ma=ga.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,ga.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(ga.origin),ga.navigator&&/(msie|trident)/i.test(ga.navigator.userAgent)):()=>!0,Fa=ga.hasStandardBrowserEnv?{write(e,t,r,a,n,s){const i=[e+"="+encodeURIComponent(t)];Gr.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),Gr.isString(a)&&i.push("path="+a),Gr.isString(n)&&i.push("domain="+n),!0===s&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Ua(e,t,r){let a=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(a||0==r)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const za=e=>e instanceof Sa?qe({},e):e;function Ba(e,t){t=t||{};const r={};function a(e,t,r,a){return Gr.isPlainObject(e)&&Gr.isPlainObject(t)?Gr.merge.call({caseless:a},e,t):Gr.isPlainObject(t)?Gr.merge({},t):Gr.isArray(t)?t.slice():t}function n(e,t,r,n){return Gr.isUndefined(t)?Gr.isUndefined(e)?void 0:a(void 0,e,0,n):a(e,t,0,n)}function s(e,t){if(!Gr.isUndefined(t))return a(void 0,t)}function i(e,t){return Gr.isUndefined(t)?Gr.isUndefined(e)?void 0:a(void 0,e):a(void 0,t)}function l(r,n,s){return s in t?a(r,n):s in e?a(void 0,r):void 0}const o={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(e,t,r)=>n(za(e),za(t),0,!0)};return Gr.forEach(Object.keys(qe(qe({},e),t)),function(a){const s=o[a]||n,i=s(e[a],t[a],a);Gr.isUndefined(i)&&s!==l||(r[a]=i)}),r}const Va=e=>{const t=Ba({},e);let r,{data:a,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:i,headers:l,auth:o}=t;if(t.headers=l=Sa.from(l),t.url=la(Ua(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Gr.isFormData(a))if(ga.hasStandardBrowserEnv||ga.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(!1!==(r=l.getContentType())){const[e,...t]=r?r.split(";").map(e=>e.trim()).filter(Boolean):[];l.setContentType([e||"multipart/form-data",...t].join("; "))}if(ga.hasStandardBrowserEnv&&(n&&Gr.isFunction(n)&&(n=n(t)),n||!1!==n&&Ma(t.url))){const e=s&&i&&Fa.read(i);e&&l.set(s,e)}return t},Ha="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,r){const a=Va(e);let n=a.data;const s=Sa.from(a.headers).normalize();let i,l,o,c,d,{responseType:u,onUploadProgress:f,onDownloadProgress:h}=a;function m(){c&&c(),d&&d(),a.cancelToken&&a.cancelToken.unsubscribe(i),a.signal&&a.signal.removeEventListener("abort",i)}let p=new XMLHttpRequest;function g(){if(!p)return;const a=Sa.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders());Oa(function(e){t(e),m()},function(e){r(e),m()},{data:u&&"text"!==u&&"json"!==u?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:a,config:e,request:p}),p=null}p.open(a.method.toUpperCase(),a.url,!0),p.timeout=a.timeout,"onloadend"in p?p.onloadend=g:p.onreadystatechange=function(){p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(g)},p.onabort=function(){p&&(r(new Xr("Request aborted",Xr.ECONNABORTED,e,p)),p=null)},p.onerror=function(){r(new Xr("Network Error",Xr.ERR_NETWORK,e,p)),p=null},p.ontimeout=function(){let t=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const n=a.transitional||ca;a.timeoutErrorMessage&&(t=a.timeoutErrorMessage),r(new Xr(t,n.clarifyTimeoutError?Xr.ETIMEDOUT:Xr.ECONNABORTED,e,p)),p=null},void 0===n&&s.setContentType(null),"setRequestHeader"in p&&Gr.forEach(s.toJSON(),function(e,t){p.setRequestHeader(t,e)}),Gr.isUndefined(a.withCredentials)||(p.withCredentials=!!a.withCredentials),u&&"json"!==u&&(p.responseType=a.responseType),h&&([o,d]=Da(h,!0),p.addEventListener("progress",o)),f&&p.upload&&([l,c]=Da(f),p.upload.addEventListener("progress",l),p.upload.addEventListener("loadend",c)),(a.cancelToken||a.signal)&&(i=t=>{p&&(r(!t||t.type?new Aa(null,e,p):t),p.abort(),p=null)},a.cancelToken&&a.cancelToken.subscribe(i),a.signal&&(a.signal.aborted?i():a.signal.addEventListener("abort",i)));const x=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(a.url);x&&-1===ga.protocols.indexOf(x)?r(new Xr("Unsupported protocol "+x+":",Xr.ERR_BAD_REQUEST,e)):p.send(n||null)})},Wa=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let r,a=new AbortController;const n=function(e){if(!r){r=!0,i();const t=e instanceof Error?e:this.reason;a.abort(t instanceof Xr?t:new Aa(t instanceof Error?t.message:t))}};let s=t&&setTimeout(()=>{s=null,n(new Xr("timeout ".concat(t," of ms exceeded"),Xr.ETIMEDOUT))},t);const i=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(n):e.removeEventListener("abort",n)}),e=null)};e.forEach(e=>e.addEventListener("abort",n));const{signal:l}=a;return l.unsubscribe=()=>Gr.asap(i),l}};function qa(e,t){this.v=e,this.k=t}function Ga(e){return function(){return new $a(e.apply(this,arguments))}}function $a(e){var t,r;function a(t,r){try{var s=e[t](r),i=s.value,l=i instanceof qa;Promise.resolve(l?i.v:i).then(function(r){if(l){var o="return"===t?"return":"next";if(!i.k||r.done)return a(o,r);r=e[o](r).value}n(s.done?"return":"normal",r)},function(e){a("throw",e)})}catch(e){n("throw",e)}}function n(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?a(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise(function(s,i){var l={key:e,arg:n,resolve:s,reject:i,next:null};r?r=r.next=l:(t=r=l,a(e,n))})},"function"!=typeof e.return&&(this.return=void 0)}function Ya(e){return new qa(e,0)}function Ka(e){var t={},r=!1;function a(t,a){return r=!0,a=new Promise(function(r){r(e[t](a))}),{done:!1,value:new qa(a,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return r?(r=!1,e):a("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(r)throw r=!1,e;return a("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return r?(r=!1,e):a("return",e)}),t}function Xa(e){var t,r,a,n=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,a=Symbol.iterator);n--;){if(r&&null!=(t=e[r]))return t.call(e);if(a&&null!=(t=e[a]))return new Ja(t.call(e));r="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function Ja(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Ja=function(e){this.s=e,this.n=e.next},Ja.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new Ja(e)}$a.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},$a.prototype.next=function(e){return this._invoke("next",e)},$a.prototype.throw=function(e){return this._invoke("throw",e)},$a.prototype.return=function(e){return this._invoke("return",e)};const Qa=function*(e,t){let r=e.byteLength;if(!t||r<t)return void(yield e);let a,n=0;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},Za=function(){var e=Ga(function*(e,t){var r,a=!1,n=!1;try{for(var s,i=Xa(en(e));a=!(s=yield Ya(i.next())).done;a=!1){const e=s.value;yield*Ka(Xa(Qa(e,t)))}}catch(l){n=!0,r=l}finally{try{a&&null!=i.return&&(yield Ya(i.return()))}finally{if(n)throw r}}});return function(t,r){return e.apply(this,arguments)}}(),en=function(){var e=Ga(function*(e){if(e[Symbol.asyncIterator])return void(yield*Ka(Xa(e)));const t=e.getReader();try{for(;;){const{done:e,value:r}=yield Ya(t.read());if(e)break;yield r}}finally{yield Ya(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),tn=(e,t,r,a)=>{const n=Za(e,t);let s,i=0,l=e=>{s||(s=!0,a&&a(e))};return new ReadableStream({async pull(e){try{const{done:t,value:a}=await n.next();if(t)return l(),void e.close();let s=a.byteLength;if(r){let e=i+=s;r(e)}e.enqueue(new Uint8Array(a))}catch(t){throw l(t),t}},cancel:e=>(l(e),n.return())},{highWaterMark:2})},rn="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,an=rn&&"function"===typeof ReadableStream,nn=rn&&("function"===typeof TextEncoder?(sn=new TextEncoder,e=>sn.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var sn;const ln=function(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return!!e(...r)}catch(Ge){return!1}},on=an&&ln(()=>{let e=!1;const t=new Request(ga.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),cn=an&&ln(()=>Gr.isReadableStream(new Response("").body)),dn={stream:cn&&(e=>e.body)};var un;rn&&(un=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!dn[e]&&(dn[e]=Gr.isFunction(un[e])?t=>t[e]():(t,r)=>{throw new Xr("Response type '".concat(e,"' is not supported"),Xr.ERR_NOT_SUPPORT,r)})}));const fn=async(e,t)=>{const r=Gr.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(Gr.isBlob(e))return e.size;if(Gr.isSpecCompliantForm(e)){const t=new Request(ga.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Gr.isArrayBufferView(e)||Gr.isArrayBuffer(e)?e.byteLength:(Gr.isURLSearchParams(e)&&(e+=""),Gr.isString(e)?(await nn(e)).byteLength:void 0)})(t):r},hn=rn&&(async e=>{let{url:t,method:r,data:a,signal:n,cancelToken:s,timeout:i,onDownloadProgress:l,onUploadProgress:o,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:f}=Va(e);c=c?(c+"").toLowerCase():"text";let h,m=Wa([n,s&&s.toAbortSignal()],i);const p=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let g;try{if(o&&on&&"get"!==r&&"head"!==r&&0!==(g=await fn(d,a))){let e,r=new Request(t,{method:"POST",body:a,duplex:"half"});if(Gr.isFormData(a)&&(e=r.headers.get("content-type"))&&d.setContentType(e),r.body){const[e,t]=La(g,Da(Ia(o)));a=tn(r.body,65536,e,t)}}Gr.isString(u)||(u=u?"include":"omit");const n="credentials"in Request.prototype;h=new Request(t,qe(qe({},f),{},{signal:m,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:a,duplex:"half",credentials:n?u:void 0}));let s=await fetch(h,f);const i=cn&&("stream"===c||"response"===c);if(cn&&(l||i&&p)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=s[t]});const t=Gr.toFiniteNumber(s.headers.get("content-length")),[r,a]=l&&La(t,Da(Ia(l),!0))||[];s=new Response(tn(s.body,65536,r,()=>{a&&a(),p&&p()}),e)}c=c||"text";let x=await dn[Gr.findKey(dn,c)||"text"](s,e);return!i&&p&&p(),await new Promise((t,r)=>{Oa(t,r,{data:x,headers:Sa.from(s.headers),status:s.status,statusText:s.statusText,config:e,request:h})})}catch(x){if(p&&p(),x&&"TypeError"===x.name&&/Load failed|fetch/i.test(x.message))throw Object.assign(new Xr("Network Error",Xr.ERR_NETWORK,e,h),{cause:x.cause||x});throw Xr.from(x,x&&x.code,e,h)}}),mn={http:null,xhr:Ha,fetch:hn};Gr.forEach(mn,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(Ge){}Object.defineProperty(e,"adapterName",{value:t})}});const pn=e=>"- ".concat(e),gn=e=>Gr.isFunction(e)||null===e||!1===e,xn=e=>{e=Gr.isArray(e)?e:[e];const{length:t}=e;let r,a;const n={};for(let s=0;s<t;s++){let t;if(r=e[s],a=r,!gn(r)&&(a=mn[(t=String(r)).toLowerCase()],void 0===a))throw new Xr("Unknown adapter '".concat(t,"'"));if(a)break;n[t||"#"+s]=a}if(!a){const e=Object.entries(n).map(e=>{let[t,r]=e;return"adapter ".concat(t," ")+(!1===r?"is not supported by the environment":"is not available in the build")});let r=t?e.length>1?"since :\n"+e.map(pn).join("\n"):" "+pn(e[0]):"as no adapter specified";throw new Xr("There is no suitable adapter to dispatch the request "+r,"ERR_NOT_SUPPORT")}return a};function vn(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Aa(null,e)}function bn(e){vn(e),e.headers=Sa.from(e.headers),e.data=Ta.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return xn(e.adapter||ba.adapter)(e).then(function(t){return vn(e),t.data=Ta.call(e,e.transformResponse,t),t.headers=Sa.from(t.headers),t},function(t){return _a(t)||(vn(e),t&&t.response&&(t.response.data=Ta.call(e,e.transformResponse,t.response),t.response.headers=Sa.from(t.response.headers))),Promise.reject(t)})}const yn="1.11.0",wn={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{wn[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Nn={};wn.transitional=function(e,t,r){function a(e,t){return"[Axios v"+yn+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return(r,n,s)=>{if(!1===e)throw new Xr(a(n," has been removed"+(t?" in "+t:"")),Xr.ERR_DEPRECATED);return t&&!Nn[n]&&(Nn[n]=!0,console.warn(a(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,s)}},wn.spelling=function(e){return(t,r)=>(console.warn("".concat(r," is likely a misspelling of ").concat(e)),!0)};const jn={assertOptions:function(e,t,r){if("object"!==typeof e)throw new Xr("options must be an object",Xr.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const s=a[n],i=t[s];if(i){const t=e[s],r=void 0===t||i(t,s,e);if(!0!==r)throw new Xr("option "+s+" must be "+r,Xr.ERR_BAD_OPTION_VALUE);continue}if(!0!==r)throw new Xr("Unknown option "+s,Xr.ERR_BAD_OPTION)}},validators:wn},kn=jn.validators;class En{constructor(e){this.defaults=e||{},this.interceptors={request:new oa,response:new oa}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{r.stack?t&&!String(r.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(r.stack+="\n"+t):r.stack=t}catch(Ge){}}throw r}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=Ba(this.defaults,t);const{transitional:r,paramsSerializer:a,headers:n}=t;void 0!==r&&jn.assertOptions(r,{silentJSONParsing:kn.transitional(kn.boolean),forcedJSONParsing:kn.transitional(kn.boolean),clarifyTimeoutError:kn.transitional(kn.boolean)},!1),null!=a&&(Gr.isFunction(a)?t.paramsSerializer={serialize:a}:jn.assertOptions(a,{encode:kn.function,serialize:kn.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),jn.assertOptions(t,{baseUrl:kn.spelling("baseURL"),withXsrfToken:kn.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=n&&Gr.merge(n.common,n[t.method]);n&&Gr.forEach(["delete","get","head","post","put","patch","common"],e=>{delete n[e]}),t.headers=Sa.concat(s,n);const i=[];let l=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(l=l&&e.synchronous,i.unshift(e.fulfilled,e.rejected))});const o=[];let c;this.interceptors.response.forEach(function(e){o.push(e.fulfilled,e.rejected)});let d,u=0;if(!l){const e=[bn.bind(this),void 0];for(e.unshift(...i),e.push(...o),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=i.length;let f=t;for(u=0;u<d;){const e=i[u++],t=i[u++];try{f=e(f)}catch(h){t.call(this,h);break}}try{c=bn.call(this,f)}catch(h){return Promise.reject(h)}for(u=0,d=o.length;u<d;)c=c.then(o[u++],o[u++]);return c}getUri(e){return la(Ua((e=Ba(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}Gr.forEach(["delete","get","head","options"],function(e){En.prototype[e]=function(t,r){return this.request(Ba(r||{},{method:e,url:t,data:(r||{}).data}))}}),Gr.forEach(["post","put","patch"],function(e){function t(t){return function(r,a,n){return this.request(Ba(n||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:a}))}}En.prototype[e]=t(),En.prototype[e+"Form"]=t(!0)});const Sn=En;class Tn{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const r=this;this.promise.then(e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null}),this.promise.then=e=>{let t;const a=new Promise(e=>{r.subscribe(e),t=e}).then(e);return a.cancel=function(){r.unsubscribe(t)},a},e(function(e,a,n){r.reason||(r.reason=new Aa(e,a,n),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new Tn(function(t){e=t});return{token:t,cancel:e}}}const _n=Tn;const Cn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Cn).forEach(e=>{let[t,r]=e;Cn[r]=t});const An=Cn;const On=function e(t){const r=new Sn(t),a=ir(Sn.prototype.request,r);return Gr.extend(a,Sn.prototype,r,{allOwnKeys:!0}),Gr.extend(a,r,null,{allOwnKeys:!0}),a.create=function(r){return e(Ba(t,r))},a}(ba);On.Axios=Sn,On.CanceledError=Aa,On.CancelToken=_n,On.isCancel=_a,On.VERSION=yn,On.toFormData=ta,On.AxiosError=Xr,On.Cancel=On.CanceledError,On.all=function(e){return Promise.all(e)},On.spread=function(e){return function(t){return e.apply(null,t)}},On.isAxiosError=function(e){return Gr.isObject(e)&&!0===e.isAxiosError},On.mergeConfig=Ba,On.AxiosHeaders=Sa,On.formToJSON=e=>xa(Gr.isHTMLForm(e)?new FormData(e):e),On.getAdapter=xn,On.HttpStatusCode=An,On.default=On;const Rn=On;var Pn=r(579);const Dn=(0,s.createContext)(),Ln=()=>{const e=(0,s.useContext)(Dn);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},In=e=>{let{children:t}=e;const[r,a]=(0,s.useState)(null),[n,i]=(0,s.useState)(!0);(0,s.useEffect)(()=>{const e=localStorage.getItem("token");e&&(Rn.defaults.headers.common.Authorization="Bearer ".concat(e))},[]),(0,s.useEffect)(()=>{(async()=>{if(localStorage.getItem("token"))try{const e=await Rn.get("/api/auth/verify");e.data.success?a(e.data.user):(localStorage.removeItem("token"),delete Rn.defaults.headers.common.Authorization)}catch(e){console.error("Erreur de v\xe9rification du token:",e),localStorage.removeItem("token"),delete Rn.defaults.headers.common.Authorization}i(!1)})()},[]);const l={user:r,loading:n,login:async(e,t)=>{try{const r=await Rn.post("/api/auth/login",{username:e,password:t});if(r.data.success){const{token:e,user:t}=r.data;return localStorage.setItem("token",e),Rn.defaults.headers.common.Authorization="Bearer ".concat(e),a(t),sr.success("Connexion r\xe9ussie"),!0}return sr.error(r.data.message||"Erreur de connexion"),!1}catch(s){var r,n;return console.error("Erreur de connexion:",s),sr.error((null===(r=s.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.message)||"Erreur de connexion"),!1}},logout:async()=>{try{await Rn.post("/api/auth/logout")}catch(e){console.error("Erreur lors de la d\xe9connexion:",e)}finally{localStorage.removeItem("token"),delete Rn.defaults.headers.common.Authorization,a(null),sr.success("D\xe9connexion r\xe9ussie")}}};return(0,Pn.jsx)(Dn.Provider,{value:l,children:t})},Mn=(0,s.createContext)(),Fn=()=>{const e=(0,s.useContext)(Mn);if(!e)throw new Error("useSchoolYear must be used within a SchoolYearProvider");return e},Un=e=>{let{children:t}=e;const[r]=(0,s.useState)((()=>{const e=(new Date).getFullYear(),t=[];for(let r=-5;r<=5;r++){const a=e+r;t.push({value:"".concat(a,"-").concat(a+1),label:"".concat(a,"-").concat(a+1),startYear:a,endYear:a+1})}return t})()),[a,n]=(0,s.useState)(()=>{const e=(new Date).getFullYear();let t;return t=(new Date).getMonth()>=7?e:e-1,"2025-2026"});(0,s.useEffect)(()=>{localStorage.setItem("selectedSchoolYear",a)},[a]),(0,s.useEffect)(()=>{const e=localStorage.getItem("selectedSchoolYear");"2025-2026"!==e?(n("2025-2026"),localStorage.setItem("selectedSchoolYear","2025-2026")):e&&r.some(t=>t.value===e)&&n(e)},[r]);const i={selectedYear:a,availableYears:r,changeSchoolYear:e=>{n(e)},getCurrentYearInfo:()=>r.find(e=>e.value===a)||r[5]};return(0,Pn.jsx)(Mn.Provider,{value:i,children:t})};var zn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Bn=["color","size","strokeWidth","absoluteStrokeWidth","children"];var Vn=(e,t)=>{const r=(0,s.forwardRef)((r,a)=>{let{color:n="currentColor",size:i=24,strokeWidth:l=2,absoluteStrokeWidth:o,children:c}=r,d=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(r,Bn);return(0,s.createElement)("svg",qe(qe({ref:a},zn),{},{width:i,height:i,stroke:n,strokeWidth:o?24*Number(l)/Number(i):l,className:"lucide lucide-".concat((u=e,u.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()))},d),[...t.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...(Array.isArray(c)?c:[c])||[]]);var u});return r.displayName="".concat(e),r};const Hn=Vn("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Wn=Vn("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),qn=Vn("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Gn=Vn("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),$n=()=>{const[e,t]=(0,s.useState)(""),[r,a]=(0,s.useState)(""),[n,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)(!1),{login:c}=Ln(),d=ne();return(0,Pn.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-primary-100 py-12 px-4 sm:px-6 lg:px-8",children:(0,Pn.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)("div",{className:"mx-auto h-16 w-16 bg-primary-600 rounded-full flex items-center justify-center",children:(0,Pn.jsx)("svg",{className:"h-8 w-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pn.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Pn.jsx)("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"U52 BTS \xc9lectrotechnique"}),(0,Pn.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Application de planification et suivi"})]}),(0,Pn.jsxs)("div",{className:"bg-white py-8 px-6 shadow-xl rounded-lg",children:[(0,Pn.jsxs)("form",{className:"space-y-6",onSubmit:async t=>{t.preventDefault(),o(!0);await c(e,r)&&d("/"),o(!1)},children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{htmlFor:"username",className:"label",children:"Nom d'utilisateur"}),(0,Pn.jsxs)("div",{className:"relative",children:[(0,Pn.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Pn.jsx)(Hn,{className:"h-5 w-5 text-gray-400"})}),(0,Pn.jsx)("input",{id:"username",name:"username",type:"text",required:!0,className:"input pl-10",placeholder:"admin",value:e,onChange:e=>t(e.target.value)})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{htmlFor:"password",className:"label",children:"Mot de passe"}),(0,Pn.jsxs)("div",{className:"relative",children:[(0,Pn.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Pn.jsx)(Wn,{className:"h-5 w-5 text-gray-400"})}),(0,Pn.jsx)("input",{id:"password",name:"password",type:n?"text":"password",required:!0,className:"input pl-10 pr-10",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",value:r,onChange:e=>a(e.target.value)}),(0,Pn.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>i(!n),children:n?(0,Pn.jsx)(qn,{className:"h-5 w-5 text-gray-400"}):(0,Pn.jsx)(Gn,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,Pn.jsx)("div",{children:(0,Pn.jsx)("button",{type:"submit",disabled:l,className:"w-full btn btn-primary flex justify-center items-center",children:l?(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):"Se connecter"})})]}),(0,Pn.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,Pn.jsx)("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"\ud83d\udd11 Identifiants de test"}),(0,Pn.jsxs)("p",{className:"text-xs text-blue-700",children:[(0,Pn.jsx)("strong",{children:"Utilisateur:"})," admin",(0,Pn.jsx)("br",{}),(0,Pn.jsx)("strong",{children:"Mot de passe:"})," admin123"]})]})]})]})})},Yn=Vn("FolderOpen",[["path",{d:"m6 14 1.45-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.55 6a2 2 0 0 1-1.94 1.5H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H18a2 2 0 0 1 2 2v2",key:"1nmvlm"}]]),Kn=Vn("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Xn=Vn("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Jn=Vn("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Qn=Vn("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),Zn=()=>{const[e,t]=(0,s.useState)({totalProjects:0,activeProjects:0,completedProjects:0,totalStudents:0,totalGroups:0}),[r,a]=(0,s.useState)([]),[n,i]=(0,s.useState)(!0);(0,s.useEffect)(()=>{l()},[]);const l=async()=>{try{const[e,r]=await Promise.all([Rn.get("/api/projects"),Rn.get("/api/projects/stats/overview")]);e.data.success&&a(e.data.data.slice(0,5)),r.data.success&&t(r.data.data)}catch(e){console.error("Erreur lors du chargement du tableau de bord:",e),sr.error("Erreur lors du chargement des donn\xe9es")}finally{i(!1)}},o=e=>{const t=new Date,r=new Date(e.start_date),a=new Date(e.end_date);return t<r?(0,Pn.jsx)("span",{className:"badge badge-info",children:"\xc0 venir"}):t>=r&&t<=a?(0,Pn.jsx)("span",{className:"badge badge-success",children:"En cours"}):(0,Pn.jsx)("span",{className:"badge badge-warning",children:"Termin\xe9"})};return n?(0,Pn.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Tableau de bord"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Vue d'ensemble de l'\xe9preuve U52 BTS \xc9lectrotechnique"})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[(0,Pn.jsx)("div",{className:"card",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(Yn,{className:"h-8 w-8 text-primary-600"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Projets/Chantiers"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:e.total_projects||0})]})})]})}),(0,Pn.jsx)("div",{className:"card",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(Kn,{className:"h-8 w-8 text-green-600"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Projets/Chantiers Actifs"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:e.active_projects||0})]})})]})}),(0,Pn.jsx)("div",{className:"card",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(Xn,{className:"h-8 w-8 text-green-600"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Projets/Chantiers Termin\xe9s"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:e.completed_projects||0})]})})]})}),(0,Pn.jsx)("div",{className:"card",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(Jn,{className:"h-8 w-8 text-blue-600"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"\xc9tudiants"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:e.totalStudents||0})]})})]})})]}),(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pn.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Projets/Chantiers r\xe9cents"}),(0,Pn.jsx)("a",{href:"/projects",className:"text-sm text-primary-600 hover:text-primary-500",children:"Voir tous les projets/chantiers \u2192"})]}),0===r.length?(0,Pn.jsxs)("div",{className:"text-center py-8",children:[(0,Pn.jsx)(Yn,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Aucun projet"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Commencez par cr\xe9er votre premier projet U52."})]}):(0,Pn.jsx)("div",{className:"overflow-hidden",children:(0,Pn.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pn.jsx)("thead",{className:"bg-gray-50",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Projet"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\xc9tudiants"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date de fin"})]})}),(0,Pn.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(e=>(0,Pn.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pn.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,Pn.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,Pn.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsx)("div",{className:"text-sm text-gray-900",children:e.type||"Non d\xe9fini"})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:o(e)}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.student_count||0}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.end_date?new Date(e.end_date).toLocaleDateString("fr-FR"):"Non d\xe9finie"})]},e.id))})]})})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Pn.jsx)(Qn,{className:"h-6 w-6 text-primary-600 mr-2"}),(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"\xc9preuve U52"})]}),(0,Pn.jsxs)("div",{className:"space-y-3",children:[(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3"}),(0,Pn.jsx)("span",{className:"text-sm text-gray-700",children:"Phase 1 : Planification"})]}),(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full mr-3"}),(0,Pn.jsx)("span",{className:"text-sm text-gray-700",children:"Phase 2 : Pilotage"})]}),(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-3"}),(0,Pn.jsx)("span",{className:"text-sm text-gray-700",children:"Phase 3 : Soutenance"})]})]})]}),(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Pn.jsx)(Xn,{className:"h-6 w-6 text-green-600 mr-2"}),(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Comp\xe9tences \xe9valu\xe9es"})]}),(0,Pn.jsxs)("div",{className:"space-y-3",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsx)("div",{children:(0,Pn.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"C1 : Recenser et prendre en compte les normes, les r\xe9glementations applicables au projet/chantier"})}),(0,Pn.jsx)("span",{className:"badge badge-info",children:"5 points"})]}),(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsx)("div",{children:(0,Pn.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"C3 : G\xe9rer les risques et les al\xe9as li\xe9s \xe0 la r\xe9alisation des t\xe2ches"})}),(0,Pn.jsx)("span",{className:"badge badge-info",children:"5 points"})]}),(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsx)("div",{children:(0,Pn.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"C12 : G\xe9rer et conduire (y compris avec les documents de : organisation, planification, suivi, pilotage, r\xe9ception etc.) le projet/chantier professionnel"})}),(0,Pn.jsx)("span",{className:"badge badge-info",children:"10 points"})]})]})]})]})]})},es=Vn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),ts=Vn("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),rs=Vn("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),as=Vn("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ns=()=>{const[e,t]=(0,s.useState)([]),[r,a]=(0,s.useState)(!0),[n,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)(null),[c,d]=(0,s.useState)({title:"",description:"",start_date:"",end_date:"",executors:"",type:""});(0,s.useEffect)(()=>{u()},[]);const u=async()=>{try{const e=await Rn.get("/api/projects");e.data.success&&t(e.data.data)}catch(e){console.error("Erreur lors du chargement des projets:",e),sr.error("Erreur lors du chargement des projets")}finally{a(!1)}},f=()=>{d({title:"",description:"",start_date:"",end_date:"",executors:"",type:""})},h=e=>{const t=new Date,r=new Date(e.start_date),a=new Date(e.end_date);return e.start_date&&e.end_date?t<r?(0,Pn.jsx)("span",{className:"badge badge-info",children:"\xc0 venir"}):t>=r&&t<=a?(0,Pn.jsx)("span",{className:"badge badge-success",children:"En cours"}):(0,Pn.jsx)("span",{className:"badge badge-warning",children:"Termin\xe9"}):(0,Pn.jsx)("span",{className:"badge badge-info",children:"Non d\xe9fini"})};return r?(0,Pn.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"CONDUITE DE PROJET/CHANTIER"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Gestion des projets support de l'\xe9preuve"})]}),(0,Pn.jsxs)("button",{onClick:()=>i(!0),className:"btn btn-primary flex items-center",children:[(0,Pn.jsx)(es,{className:"h-4 w-4 mr-2"}),"Nouveau projet"]})]}),(0,Pn.jsx)("div",{className:"card",children:0===e.length?(0,Pn.jsxs)("div",{className:"text-center py-8",children:[(0,Pn.jsx)(ts,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Aucun projet"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Commencez par cr\xe9er votre premier projet U52."})]}):(0,Pn.jsx)("div",{className:"overflow-hidden",children:(0,Pn.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pn.jsx)("thead",{className:"bg-gray-50",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Projet"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\xc9tudiants"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"P\xe9riode"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Pn.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,Pn.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pn.jsxs)("td",{className:"px-6 py-4",children:[(0,Pn.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,Pn.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsx)("div",{className:"text-sm text-gray-900",children:e.type||"Non d\xe9fini"})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:h(e)}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)(Jn,{className:"h-4 w-4 mr-1 text-gray-400"}),e.student_count||0]})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,Pn.jsxs)("div",{children:[e.start_date&&(0,Pn.jsxs)("div",{children:["D\xe9but: ",new Date(e.start_date).toLocaleDateString("fr-FR")]}),e.end_date&&(0,Pn.jsxs)("div",{children:["Fin: ",new Date(e.end_date).toLocaleDateString("fr-FR")]})]})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,Pn.jsxs)("div",{className:"flex space-x-2",children:[(0,Pn.jsx)("button",{onClick:()=>(e=>{o(e),d({title:e.title,description:e.description||"",start_date:e.start_date||"",end_date:e.end_date||"",executors:e.executors||"",type:e.type||""}),i(!0)})(e),className:"text-primary-600 hover:text-primary-900",children:(0,Pn.jsx)(rs,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer ce projet ?"))try{await Rn.delete("/api/projects/".concat(e)),sr.success("Projet supprim\xe9 avec succ\xe8s"),u()}catch(t){console.error("Erreur lors de la suppression:",t),sr.error("Erreur lors de la suppression")}})(e.id),className:"text-red-600 hover:text-red-900",children:(0,Pn.jsx)(as,{className:"h-4 w-4"})})]})})]},e.id))})]})})}),n&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>i(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,Pn.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{l?(await Rn.put("/api/projects/".concat(l.id),c),sr.success("Projet mis \xe0 jour avec succ\xe8s")):(await Rn.post("/api/projects",c),sr.success("Projet cr\xe9\xe9 avec succ\xe8s")),i(!1),o(null),f(),u()}catch(a){var t,r;console.error("Erreur lors de la sauvegarde:",a),sr.error((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Erreur lors de la sauvegarde")}},children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:l?"Modifier le projet":"Nouveau projet"})}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Titre du projet *"}),(0,Pn.jsx)("input",{type:"text",required:!0,className:"input",value:c.title,onChange:e=>d(qe(qe({},c),{},{title:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Description"}),(0,Pn.jsx)("textarea",{className:"input",rows:"3",value:c.description,onChange:e=>d(qe(qe({},c),{},{description:e.target.value}))})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Date de d\xe9but"}),(0,Pn.jsx)("input",{type:"date",className:"input",value:c.start_date,onChange:e=>d(qe(qe({},c),{},{start_date:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Date de fin"}),(0,Pn.jsx)("input",{type:"date",className:"input",value:c.end_date,onChange:e=>d(qe(qe({},c),{},{end_date:e.target.value}))})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Ex\xe9cutants"}),(0,Pn.jsx)("input",{type:"text",className:"input",placeholder:"\xc9quipe, entreprise...",value:c.executors,onChange:e=>d(qe(qe({},c),{},{executors:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Type de projet"}),(0,Pn.jsxs)("select",{className:"input",value:c.type,onChange:e=>d(qe(qe({},c),{},{type:e.target.value})),children:[(0,Pn.jsx)("option",{value:"",children:"S\xe9lectionner un type"}),(0,Pn.jsx)("option",{value:"atelier",children:"Atelier"}),(0,Pn.jsx)("option",{value:"entreprise",children:"Entreprise"}),(0,Pn.jsx)("option",{value:"laboratoire",children:"Laboratoire"}),(0,Pn.jsx)("option",{value:"simulation",children:"Simulation"}),(0,Pn.jsx)("option",{value:"autre",children:"Autre"})]})]})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsx)("button",{type:"submit",className:"btn btn-primary sm:ml-3 sm:w-auto",children:l?"Mettre \xe0 jour":"Cr\xe9er"}),(0,Pn.jsx)("button",{type:"button",className:"btn btn-secondary sm:mt-0 sm:w-auto",onClick:()=>{i(!1),o(null),f()},children:"Annuler"})]})]})})]})})]})},ss=Vn("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),is=Vn("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),ls=Vn("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),os=Vn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),cs=Vn("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),ds=Vn("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),us=Vn("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),fs=e=>{let{onImport:t,onClose:r}=e;const[a,n]=(0,s.useState)(null),[i,l]=(0,s.useState)(null),[o,c]=(0,s.useState)({}),[d,u]=(0,s.useState)(!1),f=[{key:"first_name",label:"Pr\xe9nom",required:!0},{key:"last_name",label:"Nom",required:!0},{key:"date_de_naissance",label:"Date de naissance",required:!1},{key:"class",label:"Classe",required:!1},{key:"group_name",label:"Groupe",required:!1},{key:"project_title",label:"Projet",required:!1},{key:"role",label:"R\xf4le",required:!1}],h=e=>{if(!e||"string"!==typeof e)return[];if(!(e=e.trim()))return[];let t=",";const r=[",",";","\t"].map(t=>({sep:t,count:(e.match(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"))||[]).length})).reduce((e,t)=>t.count>e.count?t:e);r.count>0&&(t=r.sep);return e.split(t).map(e=>(((e=e.trim()).startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"))&&(e=e.slice(1,-1)),e))},m=e=>{const t=new FileReader;t.onload=e=>{try{const t=e.target.result,r=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n").filter(e=>e.trim());if(0===r.length)return void sr.error("Le fichier CSV est vide");const a=h(r[0]);if(0===a.length)return void sr.error("Impossible de parser les en-t\xeates du fichier CSV");const n={},s=e=>e.toLowerCase().trim().replace(/[\xe9\xe8\xea\xeb]/g,"e").replace(/[\xe0\xe2\xe4]/g,"a").replace(/[\xee\xef]/g,"i").replace(/[\xf4\xf6]/g,"o").replace(/[\xfb\xfc\xf9]/g,"u").replace(/[\xe7]/g,"c").replace(/[^a-z0-9]/g,"");f.filter(e=>e.required).forEach(e=>{const t=a.findIndex(t=>{const r=s(t),a=s(e.label),n=s(e.key);return r===a||r===n||r.includes(a)||a.includes(r)||"first_name"===e.key&&(r.includes("prenom")||r.includes("first"))||"last_name"===e.key&&(r.includes("nom")||r.includes("last")||r.includes("derniere"))||"date_de_naissance"===e.key&&(r.includes("naissance")||r.includes("date")||r.includes("birth"))});-1===t||Object.values(n).includes(t)||(n[e.key]=t)}),f.filter(e=>!e.required).forEach(e=>{const t=a.findIndex(t=>{const r=s(t),a=s(e.label),n=s(e.key);return r===a||r===n||r.includes(a)||a.includes(r)||"class"===e.key&&(r.includes("classe")||r.includes("niveau"))||"group_name"===e.key&&(r.includes("groupe")||r.includes("group"))||"project_title"===e.key&&(r.includes("projet")||r.includes("project"))||"role"===e.key&&(r.includes("role")||r.includes("fonction"))});-1===t||Object.values(n).includes(t)||(n[e.key]=t)}),c(n),l({headers:a,sampleData:r.slice(1,4).map(e=>h(e))})}catch(t){console.error("Erreur lors du parsing CSV:",t),sr.error("Erreur lors du parsing du fichier CSV")}},t.onerror=()=>{sr.error("Erreur lors de la lecture du fichier")},t.readAsText(e,"UTF-8")};return(0,Pn.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:[(0,Pn.jsx)("style",{children:"\n        select option {\n          padding: 8px;\n          margin: 2px 0;\n          border-radius: 4px;\n        }\n        select option:disabled {\n          opacity: 0.6;\n        }\n      "}),(0,Pn.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,Pn.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Pn.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Import CSV - \xc9tudiants"}),(0,Pn.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:(0,Pn.jsx)(os,{size:24})})]}),(0,Pn.jsxs)("div",{className:"mb-6",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"S\xe9lectionner un fichier CSV"}),(0,Pn.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,Pn.jsx)("input",{type:"file",accept:".csv",onChange:e=>{const t=e.target.files[0];if(t){t.name.toLowerCase().endsWith(".csv")||"text/csv"===t.type||"application/csv"===t.type?(n(t),c({}),l(null),m(t)):sr.error("Veuillez s\xe9lectionner un fichier CSV valide (.csv)")}},className:"hidden",id:"csv-file"}),(0,Pn.jsxs)("label",{htmlFor:"csv-file",className:"cursor-pointer",children:[(0,Pn.jsx)(ss,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,Pn.jsx)("p",{className:"text-gray-600",children:"Cliquez pour s\xe9lectionner un fichier CSV"}),(0,Pn.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Format attendu: Pr\xe9nom, Nom, Classe, Groupe, Projet, R\xf4le"})]})]})]}),i&&(0,Pn.jsxs)("div",{className:"mb-6",children:[(0,Pn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Mapping des champs"}),(0,Pn.jsx)("button",{onClick:()=>c({}),className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"R\xe9initialiser le mapping"})]}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:f.map(e=>(0,Pn.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pn.jsxs)("label",{className:"flex-1 text-sm font-medium text-gray-700",children:[e.label,e.required&&(0,Pn.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,Pn.jsxs)("select",{value:o[e.key]||"",onChange:t=>{return r=e.key,a=t.target.value,void c(e=>{const t=qe({},e);if(""!==a&&void 0!==a&&null!==a){const e=parseInt(a);Object.keys(t).forEach(a=>{a!==r&&t[a]===e&&delete t[a]}),t[r]=e}else delete t[r];return t});var r,a},className:"flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm bg-white",style:{minHeight:"40px"},children:[(0,Pn.jsx)("option",{value:"",children:"-- S\xe9lectionner --"}),i.headers.map((t,r)=>{const a=Object.values(o).includes(r),n=o[e.key]===r;return(0,Pn.jsxs)("option",{value:r,disabled:a&&!n,style:{color:a&&!n?"#9CA3AF":"#374151",backgroundColor:a&&!n?"#F3F4F6":"white"},children:[t," ",a&&!n?"(d\xe9j\xe0 utilis\xe9)":""]},r)})]}),void 0!==o[e.key]&&(0,Pn.jsx)(cs,{className:"h-5 w-5 text-green-500"})]},e.key))})]}),i&&(0,Pn.jsxs)("div",{className:"mb-6",children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Aper\xe7u des donn\xe9es"}),(0,Pn.jsx)("div",{className:"overflow-x-auto",children:(0,Pn.jsxs)("table",{className:"min-w-full border border-gray-300",children:[(0,Pn.jsx)("thead",{children:(0,Pn.jsx)("tr",{className:"bg-gray-50",children:i.headers.map((e,t)=>(0,Pn.jsx)("th",{className:"border border-gray-300 px-3 py-2 text-sm font-medium text-gray-700",children:e},t))})}),(0,Pn.jsx)("tbody",{children:i.sampleData.map((e,t)=>(0,Pn.jsx)("tr",{className:"bg-white",children:e.map((e,t)=>(0,Pn.jsx)("td",{className:"border border-gray-300 px-3 py-2 text-sm text-gray-900",children:e},t))},t))})]})})]}),i&&(0,Pn.jsxs)("div",{className:"mb-6",children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Validation"}),(0,Pn.jsx)("div",{className:"space-y-2",children:f.filter(e=>e.required).map(e=>(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[void 0!==o[e.key]?(0,Pn.jsx)(cs,{className:"h-5 w-5 text-green-500"}):(0,Pn.jsx)(ds,{className:"h-5 w-5 text-red-500"}),(0,Pn.jsxs)("span",{className:"text-sm ".concat(void 0!==o[e.key]?"text-green-700":"text-red-700"),children:[e.label," ",void 0!==o[e.key]?"mapp\xe9":"non mapp\xe9"]})]},e.key))})]}),(0,Pn.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,Pn.jsx)("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Annuler"}),(0,Pn.jsx)("button",{onClick:async()=>{if(a){u(!0);try{const e=new FileReader;e.onload=async e=>{try{const a=e.target.result,n=a.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n").filter(e=>e.trim());if(0===n.length)return void sr.error("Le fichier CSV est vide");const s=n.slice(1).map(e=>{const t=h(e),r={};return Object.entries(o).forEach(e=>{let[a,n]=e;n>=0&&n<t.length&&(r[a]=t[n])}),r});await t(s),sr.success("".concat(s.length," \xe9tudiants import\xe9s avec succ\xe8s")),r()}catch(a){console.error("Erreur lors de l'import:",a),sr.error("Erreur lors de l'import: "+a.message)}},e.readAsText(a,"UTF-8")}catch(e){sr.error("Erreur lors de l'import: "+e.message)}finally{u(!1)}}},disabled:!a||d||!f.filter(e=>e.required).every(e=>void 0!==o[e.key]),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:d?(0,Pn.jsxs)(Pn.Fragment,{children:[(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,Pn.jsx)("span",{children:"Import en cours..."})]}):(0,Pn.jsxs)(Pn.Fragment,{children:[(0,Pn.jsx)(us,{className:"h-4 w-4"}),(0,Pn.jsx)("span",{children:"Importer"})]})})]})]})]})},hs=()=>{const{selectedYear:e}=Fn(),[t,r]=(0,s.useState)([]),[a,n]=(0,s.useState)([]),[i,l]=(0,s.useState)(!0),[o,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(!1),[f,h]=(0,s.useState)(null),[m,p]=(0,s.useState)([]),[g,x]=(0,s.useState)(!1),[v,b]=(0,s.useState)({first_name:"",last_name:"",date_de_naissance:"",email:"",class:"",project_id:"",role:"",school_year:e});(0,s.useEffect)(()=>{y()},[e]),(0,s.useEffect)(()=>{b(t=>qe(qe({},t),{},{school_year:e}))},[e]),(0,s.useEffect)(()=>{x(m.length===t.length&&t.length>0)},[m,t]);const y=async()=>{try{const[t,a]=await Promise.all([Rn.get("/api/students?school_year=".concat(e)),Rn.get("/api/projects")]);t.data.success&&r(t.data.data),a.data.success&&n(a.data.data)}catch(t){console.error("Erreur lors du chargement des donn\xe9es:",t),sr.error("Erreur lors du chargement des donn\xe9es")}finally{l(!1)}},w=()=>{b({first_name:"",last_name:"",date_de_naissance:"",email:"",class:"",project_id:"",role:""})};return i?(0,Pn.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"\xc9tudiants"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Gestion des \xe9tudiants et des groupes"})]}),(0,Pn.jsxs)("div",{className:"flex space-x-3",children:[m.length>0&&(0,Pn.jsxs)("button",{onClick:async()=>{if(0===m.length)return void sr.error("Aucun \xe9tudiant s\xe9lectionn\xe9");const e="\xcates-vous s\xfbr de vouloir supprimer ".concat(m.length," \xe9tudiant(s) ? Cette action est irr\xe9versible.");if(window.confirm(e))try{const e=await Rn.delete("/api/students/bulk",{data:{student_ids:m}});e.data.success&&(sr.success(e.data.message),p([]),x(!1),y())}catch(a){var t,r;console.error("Erreur lors de la suppression en masse:",a),sr.error((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Erreur lors de la suppression en masse")}},className:"btn btn-danger flex items-center",children:[(0,Pn.jsx)(as,{className:"h-4 w-4 mr-2"}),"Supprimer (",m.length,")"]}),(0,Pn.jsxs)("button",{onClick:()=>u(!0),className:"btn btn-secondary flex items-center",children:[(0,Pn.jsx)(ss,{className:"h-4 w-4 mr-2"}),"Import CSV"]}),(0,Pn.jsxs)("button",{onClick:()=>c(!0),className:"btn btn-primary flex items-center",children:[(0,Pn.jsx)(es,{className:"h-4 w-4 mr-2"}),"Nouvel \xe9tudiant"]})]})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Pn.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,Pn.jsx)("div",{className:"p-5",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(Jn,{className:"h-6 w-6 text-gray-400"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total \xe9tudiants"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:t.length})]})})]})})}),(0,Pn.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,Pn.jsx)("div",{className:"p-5",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(Hn,{className:"h-6 w-6 text-gray-400"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Projets"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:a.length})]})})]})})})]}),(0,Pn.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:0===t.length?(0,Pn.jsxs)("div",{className:"text-center py-12",children:[(0,Pn.jsx)(Jn,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Aucun \xe9tudiant"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Commencez par ajouter un \xe9tudiant."}),(0,Pn.jsx)("div",{className:"mt-6",children:(0,Pn.jsxs)("button",{onClick:()=>c(!0),className:"btn btn-primary",children:[(0,Pn.jsx)(es,{className:"h-4 w-4 mr-2"}),"Ajouter un \xe9tudiant"]})})]}):(0,Pn.jsx)("div",{className:"overflow-x-auto",children:(0,Pn.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pn.jsx)("thead",{className:"bg-gray-50",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12",children:(0,Pn.jsx)("button",{onClick:()=>{g?(p([]),x(!1)):(p(t.map(e=>e.id)),x(!0))},className:"flex items-center justify-center w-6 h-6 text-gray-400 hover:text-gray-600",children:g?(0,Pn.jsx)(is,{className:"h-5 w-5 text-blue-600"}):(0,Pn.jsx)(ls,{className:"h-5 w-5"})})}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\xc9tudiant"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Classe"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Groupe"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date de naissance"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Pn.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,Pn.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsx)("button",{onClick:()=>{return t=e.id,void p(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"flex items-center justify-center w-6 h-6 text-gray-400 hover:text-gray-600",children:m.includes(e.id)?(0,Pn.jsx)(is,{className:"h-5 w-5 text-blue-600"}):(0,Pn.jsx)(ls,{className:"h-5 w-5"})})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,Pn.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:(0,Pn.jsx)(Hn,{className:"h-6 w-6 text-primary-600"})})}),(0,Pn.jsx)("div",{className:"ml-4",children:(0,Pn.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]})})]})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.class||"Non d\xe9finie"}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.group_name||"Non assign\xe9"}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.date_de_naissance?new Date(e.date_de_naissance).toLocaleDateString("fr-FR"):"Non renseign\xe9e"}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.email||"Non renseign\xe9"}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,Pn.jsxs)("div",{className:"flex space-x-2",children:[(0,Pn.jsx)("button",{onClick:()=>(e=>{h(e);let t="";if(e.date_de_naissance)try{if(e.date_de_naissance.includes("/")){const[r,a,n]=e.date_de_naissance.split("/");t="".concat(n,"-").concat(a.padStart(2,"0"),"-").concat(r.padStart(2,"0"))}else t=e.date_de_naissance}catch(r){console.error("Erreur de format de date:",r),t=""}b({first_name:e.first_name,last_name:e.last_name,date_de_naissance:t,email:e.email||"",class:e.class||"",project_id:e.project_id||"",role:e.role||""}),c(!0)})(e),className:"text-primary-600 hover:text-primary-900",children:(0,Pn.jsx)(rs,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer cet \xe9tudiant ?"))try{await Rn.delete("/api/students/".concat(e)),sr.success("\xc9tudiant supprim\xe9 avec succ\xe8s"),y()}catch(t){console.error("Erreur lors de la suppression:",t),sr.error("Erreur lors de la suppression")}})(e.id),className:"text-red-600 hover:text-red-900",children:(0,Pn.jsx)(as,{className:"h-4 w-4"})})]})})]},e.id))})]})})}),o&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>c(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,Pn.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{f?(await Rn.put("/api/students/".concat(f.id),v),sr.success("\xc9tudiant mis \xe0 jour avec succ\xe8s")):(await Rn.post("/api/students",v),sr.success("\xc9tudiant cr\xe9\xe9 avec succ\xe8s")),c(!1),h(null),w(),y()}catch(a){var t,r;console.error("Erreur lors de la sauvegarde:",a),sr.error((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Erreur lors de la sauvegarde")}},children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:f?"Modifier l'\xe9tudiant":"Nouvel \xe9tudiant"})}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Pr\xe9nom *"}),(0,Pn.jsx)("input",{type:"text",required:!0,className:"input",value:v.first_name,onChange:e=>b(qe(qe({},v),{},{first_name:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Nom *"}),(0,Pn.jsx)("input",{type:"text",required:!0,className:"input",value:v.last_name,onChange:e=>b(qe(qe({},v),{},{last_name:e.target.value}))})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Date de naissance"}),(0,Pn.jsx)("input",{type:"date",className:"input",value:v.date_de_naissance,onChange:e=>b(qe(qe({},v),{},{date_de_naissance:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Email"}),(0,Pn.jsx)("input",{type:"email",className:"input",placeholder:"exemple@email.com",value:v.email,onChange:e=>b(qe(qe({},v),{},{email:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Classe"}),(0,Pn.jsx)("input",{type:"text",className:"input",placeholder:"BTS \xc9lectrotechnique 2\xe8me ann\xe9e",value:v.class,onChange:e=>b(qe(qe({},v),{},{class:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Projet"}),(0,Pn.jsxs)("select",{className:"input",value:v.project_id,onChange:e=>b(qe(qe({},v),{},{project_id:e.target.value})),children:[(0,Pn.jsx)("option",{value:"",children:"S\xe9lectionner un projet"}),a.map(e=>(0,Pn.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"R\xf4le dans le projet"}),(0,Pn.jsxs)("select",{className:"input",value:v.role,onChange:e=>b(qe(qe({},v),{},{role:e.target.value})),children:[(0,Pn.jsx)("option",{value:"",children:"S\xe9lectionner un r\xf4le"}),(0,Pn.jsx)("option",{value:"conducteur",children:"Conducteur de projet"}),(0,Pn.jsx)("option",{value:"executant",children:"Ex\xe9cutant"}),(0,Pn.jsx)("option",{value:"assistant",children:"Assistant"}),(0,Pn.jsx)("option",{value:"observateur",children:"Observateur"})]})]})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsx)("button",{type:"submit",className:"btn btn-primary sm:ml-3 sm:w-auto",children:f?"Mettre \xe0 jour":"Cr\xe9er"}),(0,Pn.jsx)("button",{type:"button",className:"btn btn-secondary sm:mt-0 sm:w-auto",onClick:()=>{c(!1),h(null),w()},children:"Annuler"})]})]})})]})}),d&&(0,Pn.jsx)(fs,{onImport:async e=>{try{const t=await Rn.post("/api/students/bulk",{students:e});if(t.data.success){const{summary:e}=t.data;sr.success("Import termin\xe9: ".concat(e.success," succ\xe8s, ").concat(e.error," erreurs, ").concat(e.skipped," ignor\xe9s")),y()}}catch(a){var t,r;console.error("Erreur lors de l'import:",a),sr.error((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Erreur lors de l'import")}},onClose:()=>u(!1)})]})},ms=Vn("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),ps=Vn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),gs=()=>{var e;const{selectedYear:t}=Fn(),[r,a]=(0,s.useState)([]),[n,i]=(0,s.useState)([]),[l,o]=(0,s.useState)(!0),[c,d]=(0,s.useState)(!1),[u,f]=(0,s.useState)(!1),[h,m]=(0,s.useState)(null),[p,g]=(0,s.useState)(null),[x,v]=(0,s.useState)([]),[b,y]=(0,s.useState)(""),[w,N]=(0,s.useState)({name:"",description:"",school_year:t});(0,s.useEffect)(()=>{j()},[t]),(0,s.useEffect)(()=>{N(e=>qe(qe({},e),{},{school_year:t}))},[t]);const j=async()=>{try{const[e,r]=await Promise.all([Rn.get("/api/classes?school_year=".concat(t)),Rn.get("/api/students?school_year=".concat(t))]);e.data.success&&a(e.data.data),r.data.success&&i(r.data.data)}catch(e){console.error("Erreur lors du chargement des donn\xe9es:",e),sr.error("Erreur lors du chargement des donn\xe9es")}finally{o(!1)}},k=async e=>{try{const t=await Rn.get("/api/classes/".concat(e.id));t.data.success&&(g(t.data.data),v(t.data.data.students||[]))}catch(t){console.error("Erreur lors du chargement de la classe:",t),sr.error("Erreur lors du chargement de la classe")}},E=e=>{g(e),f(!0),v([]),y("")},S=n.filter(e=>{var t;return!(null!==p&&void 0!==p&&null!==(t=p.students)&&void 0!==t&&t.some(t=>t.id===e.id))&&(e.first_name.toLowerCase().includes(b.toLowerCase())||e.last_name.toLowerCase().includes(b.toLowerCase()))});return l?(0,Pn.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,Pn.jsxs)("div",{className:"p-6",children:[(0,Pn.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Pn.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des Classes"}),(0,Pn.jsxs)("button",{onClick:()=>d(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[(0,Pn.jsx)(es,{className:"h-5 w-5"}),(0,Pn.jsx)("span",{children:"Nouvelle Classe"})]})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,Pn.jsx)("div",{className:"lg:col-span-1",children:(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,Pn.jsxs)("h2",{className:"text-lg font-semibold mb-4",children:["Classes (",t,")"]}),(0,Pn.jsxs)("div",{className:"space-y-2",children:[r.map(e=>(0,Pn.jsx)("div",{className:"p-3 rounded-lg border cursor-pointer transition-colors ".concat((null===p||void 0===p?void 0:p.id)===e.id?"bg-blue-50 border-blue-300":"bg-gray-50 border-gray-200 hover:bg-gray-100"),onClick:()=>k(e),children:(0,Pn.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,Pn.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),(0,Pn.jsxs)("div",{className:"flex space-x-1",children:[(0,Pn.jsx)("button",{onClick:t=>{t.stopPropagation(),E(e)},className:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Assigner des \xe9tudiants",children:(0,Pn.jsx)(ms,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{m(e),N({name:e.name,description:e.description||"",school_year:e.school_year}),d(!0)})(e)},className:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Modifier la classe",children:(0,Pn.jsx)(rs,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer cette classe ?"))try{await Rn.delete("/api/classes/".concat(e)),sr.success("Classe supprim\xe9e avec succ\xe8s"),j()}catch(t){console.error("Erreur lors de la suppression:",t),sr.error("Erreur lors de la suppression de la classe")}})(e.id)},className:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Supprimer la classe",children:(0,Pn.jsx)(as,{className:"h-4 w-4"})})]})]})},e.id)),0===r.length&&(0,Pn.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Aucune classe cr\xe9\xe9e"})]})]})}),(0,Pn.jsx)("div",{className:"lg:col-span-2",children:p?(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,Pn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Pn.jsxs)("h2",{className:"text-lg font-semibold",children:['\xc9tudiants de la classe "',p.name,'"']}),(0,Pn.jsx)("button",{onClick:()=>g(null),className:"text-gray-500 hover:text-gray-700",children:(0,Pn.jsx)(os,{className:"h-5 w-5"})})]}),(0,Pn.jsxs)("div",{className:"mb-6",children:[(0,Pn.jsxs)("h3",{className:"text-md font-medium mb-3",children:["\xc9tudiants assign\xe9s (",(null===(e=p.students)||void 0===e?void 0:e.length)||0,")"]}),p.students&&p.students.length>0?(0,Pn.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:(0,Pn.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pn.jsx)("thead",{className:"bg-gray-50",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Nom Pr\xe9nom"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date de naissance"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Actions"})]})}),(0,Pn.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:p.students.map(e=>(0,Pn.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap border-r border-gray-200",children:(0,Pn.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsx)("div",{className:"text-sm text-gray-900",children:e.date_de_naissance?new Date(e.date_de_naissance).toLocaleDateString("fr-FR"):"Non renseign\xe9e"})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,Pn.jsx)("button",{onClick:()=>(async e=>{try{await Rn.delete("/api/classes/".concat(p.id,"/students"),{data:{student_ids:[e]}}),sr.success("\xc9tudiant retir\xe9 de la classe"),k(p)}catch(t){console.error("Erreur lors de la suppression:",t),sr.error("Erreur lors de la suppression de l'\xe9tudiant")}})(e.id),className:"text-red-600 hover:bg-red-100 p-1 rounded transition-colors",title:"Retirer de la classe",children:(0,Pn.jsx)(os,{className:"h-4 w-4"})})})]},e.id))})]})}):(0,Pn.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[(0,Pn.jsx)(Jn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pn.jsx)("p",{className:"text-gray-500",children:"Aucun \xe9tudiant assign\xe9 \xe0 cette classe"})]})]}),(0,Pn.jsx)("div",{className:"flex justify-end",children:(0,Pn.jsxs)("button",{onClick:()=>E(p),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[(0,Pn.jsx)(ms,{className:"h-4 w-4"}),(0,Pn.jsx)("span",{children:"Assigner des \xe9tudiants"})]})})]}):(0,Pn.jsx)("div",{className:"bg-white rounded-lg shadow p-6 flex items-center justify-center h-64",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)(Jn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pn.jsx)("p",{className:"text-gray-500",children:"S\xe9lectionnez une classe pour voir ses \xe9tudiants"})]})})})]}),c&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>d(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,Pn.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{h?(await Rn.put("/api/classes/".concat(h.id),w),sr.success("Classe modifi\xe9e avec succ\xe8s")):(await Rn.post("/api/classes",w),sr.success("Classe cr\xe9\xe9e avec succ\xe8s")),d(!1),m(null),N({name:"",description:"",school_year:t}),j()}catch(r){console.error("Erreur lors de la sauvegarde:",r),sr.error("Erreur lors de la sauvegarde de la classe")}},children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:h?"Modifier la classe":"Nouvelle classe"})}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom de la classe *"}),(0,Pn.jsx)("input",{type:"text",required:!0,value:w.name,onChange:e=>N(qe(qe({},w),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ex: BTS \xc9lectrotechnique 1A"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,Pn.jsx)("textarea",{value:w.description,onChange:e=>N(qe(qe({},w),{},{description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:"Description optionnelle de la classe"})]})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsx)("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:h?"Modifier":"Cr\xe9er"}),(0,Pn.jsx)("button",{type:"button",onClick:()=>{d(!1),m(null),N({name:"",description:"",school_year:t})},className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Annuler"})]})]})})]})}),u&&p&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>f(!1)}),(0,Pn.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:['Assigner des \xe9tudiants \xe0 "',p.name,'"']})}),(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsxs)("div",{className:"relative",children:[(0,Pn.jsx)(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,Pn.jsx)("input",{type:"text",placeholder:"Rechercher un \xe9tudiant...",value:b,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,Pn.jsx)("div",{className:"max-h-96 overflow-y-auto border border-gray-200 rounded-lg",children:S.length>0?(0,Pn.jsxs)("div",{className:"bg-white",children:[(0,Pn.jsx)("div",{className:"bg-gray-50 border-b border-gray-200",children:(0,Pn.jsxs)("div",{className:"grid grid-cols-12 gap-4 px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:[(0,Pn.jsx)("div",{className:"col-span-1"}),(0,Pn.jsx)("div",{className:"col-span-4",children:"Nom Pr\xe9nom"}),(0,Pn.jsx)("div",{className:"col-span-3",children:"Date de naissance"}),(0,Pn.jsx)("div",{className:"col-span-4",children:"Classe"})]})}),(0,Pn.jsx)("div",{className:"divide-y divide-gray-200",children:S.map(e=>(0,Pn.jsxs)("div",{className:"grid grid-cols-12 gap-4 px-4 py-3 cursor-pointer transition-colors ".concat(x.some(t=>t.id===e.id)?"bg-blue-50":"hover:bg-gray-50"),onClick:()=>(e=>{v(t=>{const r=t.some(t=>t.id===e.id);return r?t.filter(t=>t.id!==e.id):[...t,e]})})(e),children:[(0,Pn.jsx)("div",{className:"col-span-1 flex items-center justify-center",children:x.some(t=>t.id===e.id)&&(0,Pn.jsx)(cs,{className:"h-5 w-5 text-blue-600"})}),(0,Pn.jsx)("div",{className:"col-span-4",children:(0,Pn.jsxs)("p",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]})}),(0,Pn.jsx)("div",{className:"col-span-3",children:(0,Pn.jsx)("p",{className:"text-sm text-gray-600",children:e.date_de_naissance?new Date(e.date_de_naissance).toLocaleDateString("fr-FR"):"Non renseign\xe9e"})}),(0,Pn.jsx)("div",{className:"col-span-4",children:(0,Pn.jsx)("p",{className:"text-sm text-gray-600",children:e.class||"Non d\xe9finie"})})]},e.id))})]}):(0,Pn.jsxs)("div",{className:"p-8 text-center",children:[(0,Pn.jsx)(Jn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pn.jsx)("p",{className:"text-gray-500",children:b?"Aucun \xe9tudiant trouv\xe9":"Tous les \xe9tudiants sont d\xe9j\xe0 assign\xe9s \xe0 cette classe"})]})}),x.length>0&&(0,Pn.jsx)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:(0,Pn.jsxs)("p",{className:"text-sm text-blue-800",children:[x.length," \xe9tudiant(s) s\xe9lectionn\xe9(s)"]})})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsxs)("button",{onClick:async()=>{if(0!==x.length)try{const e=x.map(e=>e.id);await Rn.post("/api/classes/".concat(p.id,"/students"),{student_ids:e}),sr.success("".concat(x.length," \xe9tudiant(s) assign\xe9(s) \xe0 la classe")),f(!1),v([]),y(""),k(p),j()}catch(e){console.error("Erreur lors de l'assignation:",e),sr.error("Erreur lors de l'assignation des \xe9tudiants")}else sr.error("Aucun \xe9tudiant s\xe9lectionn\xe9")},disabled:0===x.length,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm disabled:bg-gray-400 disabled:cursor-not-allowed",children:["Assigner ",x.length," \xe9tudiant(s)"]}),(0,Pn.jsx)("button",{type:"button",onClick:()=>{f(!1),v([]),y("")},className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Annuler"})]})]})]})})]})},xs=()=>{const[e,t]=(0,s.useState)([]),[r,a]=(0,s.useState)([]),[n,i]=(0,s.useState)([]),[l,o]=(0,s.useState)(!0),[c,d]=(0,s.useState)(!1),[u,f]=(0,s.useState)(!1),[h,m]=(0,s.useState)(null),[p,g]=(0,s.useState)({name:"",project_id:""});(0,s.useEffect)(()=>{x()},[]);const x=async()=>{try{const[e,r,n]=await Promise.all([Rn.get("/api/students/groups/all"),Rn.get("/api/students"),Rn.get("/api/projects")]);e.data.success&&t(e.data.data),r.data.success&&a(r.data.data),n.data.success&&i(n.data.data)}catch(e){console.error("Erreur lors du chargement des donn\xe9es:",e),sr.error("Erreur lors du chargement des donn\xe9es")}finally{o(!1)}};return l?(0,Pn.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des groupes"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Cr\xe9ez et g\xe9rez les groupes d'\xe9tudiants"})]}),(0,Pn.jsxs)("div",{className:"flex space-x-3",children:[(0,Pn.jsxs)("button",{onClick:()=>f(!0),className:"btn btn-secondary flex items-center",disabled:0===r.filter(e=>!e.group_id).length,title:0===r.filter(e=>!e.group_id).length?"Aucun \xe9tudiant sans groupe":"Affecter ".concat(r.filter(e=>!e.group_id).length," \xe9tudiant(s) sans groupe"),children:[(0,Pn.jsx)(Hn,{className:"h-4 w-4 mr-2"}),"Affecter des \xe9tudiants (",r.filter(e=>!e.group_id).length,")"]}),r.filter(e=>e.group_id).length>0&&(0,Pn.jsxs)("button",{onClick:()=>{window.confirm("\xcates-vous s\xfbr de vouloir retirer tous les \xe9tudiants de leurs groupes ?\n\n".concat(r.filter(e=>e.group_id).length," \xe9tudiant(s) seront retir\xe9(s) de leurs groupes respectifs."))&&(async()=>{try{await Rn.post("/api/students/reset-all-groups"),sr.success("Tous les \xe9tudiants ont \xe9t\xe9 retir\xe9s de leurs groupes"),x()}catch(e){console.error("Erreur lors de la r\xe9initialisation:",e),sr.error("Erreur lors de la r\xe9initialisation des groupes")}})()},className:"btn btn-warning flex items-center",title:"Retirer tous les \xe9tudiants de leurs groupes",children:[(0,Pn.jsx)(as,{className:"h-4 w-4 mr-2"}),"R\xe9initialiser tous (",r.filter(e=>e.group_id).length,")"]}),(0,Pn.jsxs)("button",{onClick:()=>d(!0),className:"btn btn-primary flex items-center",children:[(0,Pn.jsx)(es,{className:"h-4 w-4 mr-2"}),"Nouveau groupe"]}),(0,Pn.jsxs)("button",{onClick:async()=>{try{const e=await Rn.post("/api/students/groups",{name:"Groupe Test",project_id:""});if(e.data.success){const t=e.data.data.id,a=r.filter(e=>!e.group_id).slice(0,5);a.length>0?(await Rn.post("/api/students/bulk-assign-group",{student_ids:a.map(e=>e.id),group_id:t}),sr.success("Groupe de test cr\xe9\xe9 avec ".concat(a.length," \xe9tudiants"))):sr.success("Groupe de test cr\xe9\xe9 (aucun \xe9tudiant disponible)"),x()}}catch(e){console.error("Erreur lors du test:",e),sr.error("Erreur lors du test")}},className:"btn btn-secondary flex items-center",title:"Cr\xe9er un groupe de test avec des \xe9tudiants",children:[(0,Pn.jsx)(Hn,{className:"h-4 w-4 mr-2"}),"Test"]}),(0,Pn.jsxs)("button",{onClick:async()=>{try{const e=["Groupe A","Groupe B","Groupe C"],t=[];for(const r of e){const e=await Rn.post("/api/students/groups",{name:r,project_id:""});e.data.success&&t.push(e.data.data)}const a=r.filter(e=>!e.group_id),n=Math.floor(a.length/t.length);for(let r=0;r<t.length;r++){const e=r*n,s=r===t.length-1?a.length:e+n,i=a.slice(e,s);i.length>0&&await Rn.post("/api/students/bulk-assign-group",{student_ids:i.map(e=>e.id),group_id:t[r].id})}sr.success("".concat(t.length," groupes cr\xe9\xe9s avec des \xe9tudiants")),x()}catch(e){console.error("Erreur lors de la cr\xe9ation des groupes:",e),sr.error("Erreur lors de la cr\xe9ation des groupes")}},className:"btn btn-success flex items-center",title:"Cr\xe9er 3 groupes avec des \xe9tudiants",children:[(0,Pn.jsx)(Jn,{className:"h-4 w-4 mr-2"}),"Cr\xe9er 3 groupes"]}),(0,Pn.jsxs)("button",{onClick:async()=>{try{const t=r.filter(t=>t.group_id&&!e.find(e=>e.id===t.group_id));if(t.length>0){const e=await Rn.post("/api/students/groups",{name:"Groupe Orphelin",project_id:""});if(e.data.success){const r=e.data.data.id;await Rn.post("/api/students/bulk-assign-group",{student_ids:t.map(e=>e.id),group_id:r}),sr.success("Groupe cr\xe9\xe9 pour ".concat(t.length," \xe9tudiants orphelins")),x()}}else sr.success("Aucun \xe9tudiant orphelin trouv\xe9")}catch(t){console.error("Erreur lors de la correction:",t),sr.error("Erreur lors de la correction")}},className:"btn btn-warning flex items-center",title:"Corriger les affectations de groupes orphelins",children:[(0,Pn.jsx)(Hn,{className:"h-4 w-4 mr-2"}),"Corriger"]})]})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Pn.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,Pn.jsx)("div",{className:"p-5",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(Jn,{className:"h-6 w-6 text-gray-400"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total groupes"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:e.length})]})})]})})}),(0,Pn.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,Pn.jsx)("div",{className:"p-5",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(Hn,{className:"h-6 w-6 text-gray-400"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total \xe9tudiants"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:r.length})]})})]})})}),(0,Pn.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,Pn.jsx)("div",{className:"p-5",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(Hn,{className:"h-6 w-6 text-gray-400"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Sans groupe"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:r.filter(e=>!e.group_id).length})]})})]})})})]}),(0,Pn.jsxs)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:[(0,Pn.jsxs)("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:[(0,Pn.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Gestion des groupes"}),(0,Pn.jsx)("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Cr\xe9ez et g\xe9rez les groupes d'\xe9tudiants"})]}),0===e.length?(0,Pn.jsxs)("div",{className:"text-center py-12",children:[(0,Pn.jsx)(Jn,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Aucun groupe"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Cr\xe9ez votre premier groupe pour organiser les \xe9tudiants."}),(0,Pn.jsx)("div",{className:"mt-6",children:(0,Pn.jsxs)("button",{onClick:()=>d(!0),className:"btn btn-primary",children:[(0,Pn.jsx)(es,{className:"h-4 w-4 mr-2"}),"Cr\xe9er un groupe"]})})]}):(0,Pn.jsx)("div",{className:"overflow-x-auto",children:(0,Pn.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pn.jsx)("thead",{className:"bg-gray-50",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Groupe"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Projet associ\xe9"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\xc9tudiants"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:"Actions"})]})}),(0,Pn.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(t=>{const a=r.filter(e=>e.group_id===t.id);return(0,Pn.jsxs)(s.Fragment,{children:[(0,Pn.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.name})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.project_title||"Aucun projet"}),(0,Pn.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)(Jn,{className:"h-4 w-4 mr-2 text-gray-400"}),a.length," \xe9tudiant",a.length>1?"s":""]}),0===a.length&&(0,Pn.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Aucun \xe9tudiant assign\xe9"})]}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,Pn.jsxs)("div",{className:"flex space-x-2",children:[(0,Pn.jsxs)("button",{onClick:()=>(e=>{m(e),g({name:e.name,project_id:e.project_id||""}),d(!0)})(t),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-primary-700 bg-primary-100 hover:bg-primary-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",title:"Modifier le groupe",children:[(0,Pn.jsx)(rs,{className:"h-3 w-3 mr-1"}),"Modifier"]}),0===a.length&&r.filter(e=>!e.group_id).length>0&&(0,Pn.jsxs)("button",{onClick:()=>{f(!0),setTimeout(()=>{const e=document.getElementById("bulk-group-select");e&&(e.value=t.id)},100)},className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-green-700 bg-green-100 hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",title:"Affecter des \xe9tudiants \xe0 ce groupe",children:[(0,Pn.jsx)(Hn,{className:"h-3 w-3 mr-1"}),"Affecter"]}),(0,Pn.jsxs)("button",{onClick:()=>(async t=>{const a=e.find(e=>e.id===t),n=r.filter(e=>e.group_id===t);if(window.confirm('\xcates-vous s\xfbr de vouloir supprimer le groupe "'.concat(null===a||void 0===a?void 0:a.name,'" ?\n\n').concat(n.length," \xe9tudiant(s) seront retir\xe9(s) du groupe et redeviendront disponibles pour une nouvelle affectation.")))try{const e=await Rn.delete("/api/students/groups/".concat(t));sr.success(e.data.message||"Groupe supprim\xe9 avec succ\xe8s"),x()}catch(l){var s,i;console.error("Erreur lors de la suppression du groupe:",l),sr.error((null===(s=l.response)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.message)||"Erreur lors de la suppression du groupe")}})(t.id),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",title:"Supprimer le groupe",children:[(0,Pn.jsx)(as,{className:"h-3 w-3 mr-1"}),"Supprimer"]})]})})]}),(0,Pn.jsx)("tr",{className:"bg-gray-50",children:(0,Pn.jsx)("td",{colSpan:"4",className:"px-6 py-3",children:a.length>0?(0,Pn.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,Pn.jsx)("div",{className:"font-medium mb-2 text-gray-800",children:"\xc9tudiants du groupe :"}),(0,Pn.jsx)("div",{className:"space-y-1",children:a.map(e=>(0,Pn.jsxs)("div",{className:"flex items-center space-x-2 bg-white px-3 py-2 rounded border",children:[(0,Pn.jsx)(Hn,{className:"h-4 w-4 text-blue-500"}),(0,Pn.jsxs)("span",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),e.role&&(0,Pn.jsx)("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:e.role})]},e.id))})]}):(0,Pn.jsxs)("div",{className:"text-sm text-gray-500 text-center py-2",children:[(0,Pn.jsx)(Hn,{className:"h-4 w-4 mx-auto mb-1 text-gray-400"}),"Aucun \xe9tudiant assign\xe9 \xe0 ce groupe"]})})})]},t.id)})})]})})]}),(0,Pn.jsxs)("div",{className:"bg-gray-100 p-4 rounded-lg",children:[(0,Pn.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"D\xe9bogage"}),(0,Pn.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,Pn.jsxs)("div",{children:["Total groupes: ",e.length]}),(0,Pn.jsxs)("div",{children:["Total \xe9tudiants: ",r.length]}),(0,Pn.jsxs)("div",{children:["\xc9tudiants avec groupe: ",r.filter(e=>e.group_id).length]}),(0,Pn.jsxs)("div",{children:["\xc9tudiants sans groupe: ",r.filter(e=>!e.group_id).length]}),(0,Pn.jsxs)("div",{className:"mt-2",children:[(0,Pn.jsx)("strong",{children:"Groupes:"}),e.map(e=>(0,Pn.jsxs)("div",{className:"ml-4",children:["- ",e.name," (ID: ",e.id,") - ",r.filter(t=>t.group_id===e.id).length," \xe9tudiants"]},e.id))]}),(0,Pn.jsxs)("div",{className:"mt-2",children:[(0,Pn.jsx)("strong",{children:"\xc9tudiants avec group_id:"}),r.filter(e=>e.group_id).map(e=>(0,Pn.jsxs)("div",{className:"ml-4",children:["- ",e.first_name," ",e.last_name," (group_id: ",e.group_id,", group_name: ",e.group_name||"null",")"]},e.id))]})]})]}),c&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>d(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,Pn.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{h?(await Rn.put("/api/students/groups/".concat(h.id),p),sr.success("Groupe mis \xe0 jour avec succ\xe8s")):(await Rn.post("/api/students/groups",p),sr.success("Groupe cr\xe9\xe9 avec succ\xe8s")),d(!1),m(null),g({name:"",project_id:""}),x()}catch(a){var t,r;console.error("Erreur lors de la sauvegarde du groupe:",a),sr.error((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Erreur lors de la sauvegarde du groupe")}},children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:h?"Modifier le groupe":"Nouveau groupe"})}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Nom du groupe *"}),(0,Pn.jsx)("input",{type:"text",required:!0,className:"input",placeholder:"Groupe A",value:p.name,onChange:e=>g(qe(qe({},p),{},{name:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Projet associ\xe9"}),(0,Pn.jsxs)("select",{className:"input",value:p.project_id,onChange:e=>g(qe(qe({},p),{},{project_id:e.target.value})),children:[(0,Pn.jsx)("option",{value:"",children:"Aucun projet"}),n.map(e=>(0,Pn.jsx)("option",{value:e.id,children:e.title},e.id))]})]})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsx)("button",{type:"submit",className:"btn btn-primary sm:ml-3 sm:w-auto",children:h?"Mettre \xe0 jour":"Cr\xe9er le groupe"}),(0,Pn.jsx)("button",{type:"button",className:"btn btn-secondary sm:mt-0 sm:w-auto",onClick:()=>{d(!1),m(null),g({name:"",project_id:""})},children:"Annuler"})]})]})})]})}),u&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>f(!1)}),(0,Pn.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Affecter des \xe9tudiants \xe0 un groupe"})}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Groupe de destination"}),(0,Pn.jsxs)("select",{className:"input",id:"bulk-group-select",children:[(0,Pn.jsx)("option",{value:"",children:"S\xe9lectionner un groupe"}),e.map(e=>(0,Pn.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("label",{className:"label",children:["\xc9tudiants sans groupe (",r.filter(e=>!e.group_id).length,")"]}),(0,Pn.jsx)("div",{className:"max-h-40 overflow-y-auto border border-gray-300 rounded-md p-2",children:0===r.filter(e=>!e.group_id).length?(0,Pn.jsx)("div",{className:"text-sm text-gray-500 py-2 text-center",children:"Aucun \xe9tudiant sans groupe"}):r.filter(e=>!e.group_id).map(e=>(0,Pn.jsxs)("label",{className:"flex items-center space-x-2 py-1",children:[(0,Pn.jsx)("input",{type:"checkbox",value:e.id,className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),(0,Pn.jsxs)("span",{className:"text-sm text-gray-900",children:[e.first_name," ",e.last_name]})]},e.id))})]})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsx)("button",{type:"button",className:"btn btn-primary sm:ml-3 sm:w-auto",onClick:()=>{const e=document.getElementById("bulk-group-select").value,t=Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(e=>e.value);e?0!==t.length?(async(e,t)=>{try{await Rn.post("/api/students/bulk-assign-group",{student_ids:e,group_id:t}),sr.success("".concat(e.length," \xe9tudiant(s) affect\xe9(s) au groupe avec succ\xe8s")),f(!1),x()}catch(r){console.error("Erreur lors de l'affectation:",r),sr.error("Erreur lors de l'affectation des \xe9tudiants")}})(t,e):sr.error("Veuillez s\xe9lectionner au moins un \xe9tudiant"):sr.error("Veuillez s\xe9lectionner un groupe")},children:"Affecter les \xe9tudiants"}),(0,Pn.jsx)("button",{type:"button",className:"btn btn-secondary sm:mt-0 sm:w-auto",onClick:()=>f(!1),children:"Annuler"})]})]})]})})]})},vs=Vn("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),bs=Vn("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),ys=Vn("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),ws=Vn("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Ns=Vn("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),js=Vn("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ks=Vn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var Es=r(994);const Ss=e=>{let{weeks:t,slots:r,selectedWeek:a,onWeekClick:n,currentViewState:i,onViewStateChange:l}=e;const o=(0,s.useMemo)(()=>t.map(e=>{const t=Es.planningEngine.filterSlotsForWeek(r,e),a=t.reduce((e,r)=>e+Es.planningEngine.detectConflicts(t,new Date(r.start_date)).length,0);return{week:e,slotCount:t.length,conflicts:a/2,weekNumber:Es.planningEngine.getISOWeekNumber(e[0])}}),[t,r]),c=(0,s.useCallback)(e=>{n(e),l&&l({selectedWeek:e,viewMode:"year"})},[n,l]),d=(0,s.useMemo)(()=>{const e=[];let r=null;return t.forEach((t,a)=>{const n=t[0],s=n.getMonth(),i=n.getFullYear(),l="".concat(i,"-").concat(s);l!==r&&(r=l,e.push({weekIndex:a,month:s,year:i,monthName:n.toLocaleDateString("fr-FR",{month:"long"})}))}),e},[t]);return(0,Pn.jsxs)("div",{className:"bg-white border-b border-gray-200 w-full",children:[(0,Pn.jsx)("div",{className:"mb-1",children:(0,Pn.jsx)("h4",{className:"text-xs font-semibold text-gray-700 mb-0.5",children:"Vue chronologique"})}),(0,Pn.jsx)("div",{className:"flex border-b border-gray-300 mb-1 relative w-full",children:o.map((e,r)=>{const n=a&&a[0]&&e.week[0]&&a[0].getTime()===e.week[0].getTime(),s=r<t.length-1&&e.week.some(e=>{const t=new Date(e);return t.setDate(t.getDate()+1),e.getMonth()!==t.getMonth()});return(0,Pn.jsxs)("div",{className:"flex-1 min-w-0 h-4 border-r border-gray-300 flex items-center justify-center text-[8px] font-medium cursor-pointer transition-all duration-200 relative ".concat(n?"bg-blue-500 text-white":e.slotCount>0?e.conflicts>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800":"bg-gray-50 text-gray-600 hover:bg-gray-100"),onClick:()=>c(e.week),title:"Semaine ".concat(e.weekNumber," - ").concat(e.slotCount," cr\xe9neaux").concat(e.conflicts>0?" - ".concat(e.conflicts," conflits"):""),children:[(0,Pn.jsx)("span",{className:"truncate px-0.5",children:e.weekNumber}),e.conflicts>0&&(0,Pn.jsx)("div",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"}),e.slotCount>0&&0===e.conflicts&&(0,Pn.jsx)("div",{className:"absolute bottom-0 right-0 w-2 h-2 bg-green-500 rounded-full"}),s&&r<t.length-1&&(0,Pn.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-0.5 bg-gray-500",style:{right:"-1px"}})]},"week-".concat(e.week[0].getTime(),"-").concat(r))})}),(0,Pn.jsx)("div",{className:"flex relative w-full",children:d.map((e,r)=>{var a;const n=r===d.length-1,s=((null===(a=d[r+1])||void 0===a?void 0:a.weekIndex)||t.length)-e.weekIndex;return(0,Pn.jsxs)("div",{className:"flex items-center justify-center text-[8px] font-medium text-gray-700 relative",style:{flex:s,minWidth:0},children:[(0,Pn.jsx)("span",{className:"truncate px-0.5 font-semibold text-gray-800",children:e.monthName}),!n&&(0,Pn.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-0.5 bg-gray-500",style:{right:"-1px"}})]},"month-".concat(e.year,"-").concat(e.month,"-").concat(r))})})]})},Ts=e=>{let{selectedWeek:t,slots:r,onSlotEdit:a,onSlotDelete:n,onSlotCreate:i,onSlotResize:l,onSlotMove:o,onSlotCopy:c,onSlotPaste:d,copiedSlot:u,currentViewState:f,onViewStateChange:h}=e;const m=(0,s.useMemo)(()=>[{time:"07:30",index:0},{time:"08:30",index:1},{time:"09:30",index:2},{time:"10:30",index:3},{time:"11:30",index:4},{time:"12:30",index:5},{time:"13:30",index:6},{time:"14:30",index:7},{time:"15:30",index:8},{time:"16:30",index:9},{time:"17:30",index:10}],[]),p=(0,s.useMemo)(()=>t&&r?r.filter(e=>{const r=e.start_date?e.start_date.split("T")[0]:null;return t.some(e=>{const t=e.toISOString().split("T")[0];return r===t})}):[],[t,r]),g=(0,s.useCallback)(e=>{a&&a(e)},[a]),x=((0,s.useCallback)(e=>{n&&n(e)},[n]),(0,s.useCallback)(e=>{c&&c(e)},[c]),(0,s.useCallback)(e=>{d&&u&&d(u,e)},[d,u])),v=e=>e&&e instanceof Date&&!isNaN(e.getTime())?e.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"}):"Date invalide",b=e=>{if(!e||!(e instanceof Date)||isNaN(e.getTime()))return!1;const t=e.getDay();return 0===t||6===t};return t?(0,Pn.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,Pn.jsxs)("div",{className:"mb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"D\xe9tails de la semaine"}),(0,Pn.jsxs)("p",{className:"text-sm text-gray-500",children:[v(t[0])," - ",v(t[6])]})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-8 border border-gray-200 rounded-lg overflow-hidden",children:[(0,Pn.jsxs)("div",{className:"bg-gray-50 border-r",children:[(0,Pn.jsx)("div",{className:"h-12 border-b flex items-center justify-center text-xs font-medium text-gray-700",children:"Heures"}),m.map(e=>(0,Pn.jsx)("div",{className:"h-8 border-b border-gray-200 flex items-center justify-center text-xs text-gray-600 bg-gray-50",children:e.time},e.time))]}),t.map((e,t)=>{const r=v(e),a=p.filter(t=>{const r=t.start_date?t.start_date.split("T")[0]:null,a=(e=>e&&e instanceof Date&&!isNaN(e.getTime())?e.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"Date invalide")(e);return r===a});return(0,Pn.jsxs)("div",{className:"border-r ".concat(6===t?"border-r-0":""),children:[(0,Pn.jsxs)("div",{className:"h-12 border-b flex flex-col items-center justify-center text-xs font-medium ".concat(b(e)?"bg-gray-100 text-gray-600":"bg-white text-gray-900"),children:[(0,Pn.jsx)("div",{className:"font-bold",children:r.split(" ")[0]}),(0,Pn.jsx)("div",{children:e.getDate()})]}),m.map((e,t)=>{const r=a.find(t=>{if(!t.start_time)return!1;return t.start_time===e.time});return(0,Pn.jsx)("div",{className:"h-8 border-b border-gray-200 relative ".concat(r?"bg-blue-50":"bg-white"),children:r&&(0,Pn.jsxs)("div",{className:"absolute inset-1 bg-blue-500 text-white text-xs p-1 rounded cursor-pointer hover:bg-blue-600 transition-colors",onClick:()=>g(r),title:"".concat(r.student_name||"\xc9tudiant"," - ").concat(r.start_time," \xe0 ").concat(r.end_time),children:[(0,Pn.jsx)("div",{className:"truncate font-medium",children:r.student_name||"\xc9tudiant"}),(0,Pn.jsxs)("div",{className:"text-xs opacity-90",children:[r.start_time," - ",r.end_time]})]})},t)})]},t)})]}),(0,Pn.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,Pn.jsxs)("div",{className:"text-sm text-gray-500",children:[p.length," cr\xe9neau",p.length>1?"x":""," cette semaine"]}),(0,Pn.jsxs)("div",{className:"flex space-x-2",children:[u&&(0,Pn.jsx)("button",{onClick:()=>x(t[0]),className:"px-3 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600 transition-colors",children:"Coller"}),(0,Pn.jsx)("button",{onClick:()=>i&&i(t[0]),className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"Nouveau cr\xe9neau"})]})]})]}):(0,Pn.jsx)("div",{className:"flex items-center justify-center h-32 text-gray-500",children:"S\xe9lectionnez une semaine pour voir les d\xe9tails"})};if("undefined"!==typeof document){const e=document.createElement("style");e.textContent="\n  .drop-zone-active {\n    background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%) !important;\n    border-color: #3b82f6 !important;\n    box-shadow: inset 0 0 0 2px #3b82f6 !important;\n    transform: scale(1.02);\n    transition: all 0.2s ease-in-out;\n  }\n  \n  .slot-card {\n    backdrop-filter: blur(4px);\n  }\n  \n  .slot-card:hover {\n    transform: translateY(-1px);\n    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);\n  }\n  \n  .resize-handle:hover {\n    background: rgba(255, 255, 255, 0.95) !important;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  }\n  \n  .time-slot-container {\n    background: linear-gradient(180deg, #f8fafc 0%, #ffffff 100%);\n  }\n",document.head.appendChild(e)}const _s=e=>e&&e instanceof Date&&!isNaN(e.getTime())?e.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):(console.error("Date invalide dans formatDate:",e),"Date invalide"),Cs=e=>{if(!e||!(e instanceof Date)||isNaN(e.getTime()))return!1;const t=e.getDay();return 0===t||6===t},As=e=>(e=>{if(!e||!(e instanceof Date)||isNaN(e.getTime()))return 1;const t=new Date(e.getTime()),r=t.getDay(),a=r>=4?4-r:-3-r;t.setDate(t.getDate()+a);const n=new Date(t.getFullYear(),0,4),s=n.getDay(),i=s>=4?4-s:-3-s;n.setDate(n.getDate()+i);const l=t.getTime()-n.getTime();return Math.floor(l/6048e5)+1})(e),Os=e=>{let{slots:t,onSlotEdit:r,onSlotDelete:a,onSlotMove:n,onSlotCreate:i,onSlotResize:l,onSlotCopy:o,onSlotPaste:c,copiedSlot:d,currentViewState:u,onViewStateChange:f}=e;const[h,m]=(0,s.useState)(new Date),[p,g]=(0,s.useState)("year"),[x,v]=(0,s.useState)(()=>{const e=new Date;if(isNaN(e.getTime())){const e=new Date(2025,8,1);return Es.planningEngine.getWeekDays(e)}return Es.planningEngine.getWeekDays(e)});(0,s.useEffect)(()=>{u&&(u.selectedWeek&&!x&&v(u.selectedWeek),u.viewMode&&u.viewMode!==p&&g(u.viewMode))},[]);const b=(0,s.useCallback)(()=>{f&&f({selectedWeek:x,viewMode:p})},[x,p,f]);(0,s.useEffect)(()=>{b()},[b]);const y=(0,s.useMemo)(()=>Es.planningEngine.timeSlots,[]),w=(0,s.useMemo)(()=>"year"===p?Es.planningEngine.generateYearWeeks(h):"month"===p&&Es.planningEngine.getMonthWeeks?Es.planningEngine.getMonthWeeks(h):[],[p,h]),N=(0,s.useMemo)(()=>t.filter(e=>e&&e.id&&e.start_date&&e.first_name&&e.last_name),[t]),j=(0,s.useCallback)(e=>{const t=e.getFullYear();return e.getMonth()>=7?"".concat(t,"-").concat(t+1):"".concat(t-1,"-").concat(t)},[]),k=(0,s.useCallback)(e=>{const t=new Date(h);"month"===p?(t.setMonth(h.getMonth()+e),v(null)):"year"===p?(t.setFullYear(h.getFullYear()+e),v(null)):(t.setDate(h.getDate()+7*e),v(Es.planningEngine.getWeekDays(t))),m(t)},[h,p]),E=(0,s.useCallback)(e=>{v(e)},[]),S=(0,s.useCallback)((e,t)=>{l&&l(e,t),setTimeout(()=>{const e=new Event("resize-complete");document.dispatchEvent(e)},200)},[l]),T=(0,s.useCallback)(()=>{g("month"),v(null)},[]);return(0,Pn.jsxs)("div",{className:"h-full flex flex-col bg-white w-full",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-gray-50 to-blue-50 shadow-sm",children:[(0,Pn.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pn.jsx)("button",{onClick:()=>k(-1),className:"p-3 hover:bg-white hover:shadow-md rounded-xl transition-all duration-200 text-gray-600 hover:text-blue-600",children:(0,Pn.jsx)(js,{className:"h-6 w-6"})}),(0,Pn.jsx)("h2",{className:"text-2xl font-bold bg-gradient-to-r from-gray-800 to-blue-800 bg-clip-text text-transparent",children:"week"===p&&x?(0,Pn.jsxs)(Pn.Fragment,{children:["Semaine du ",x[0].getDate(),"/",x[0].getMonth()+1," au ",x[6].getDate(),"/",x[6].getMonth()+1,"/",x[6].getFullYear()]}):"year"===p?(0,Pn.jsxs)(Pn.Fragment,{children:["Ann\xe9e scolaire ",j(h)]}):(0,Pn.jsxs)(Pn.Fragment,{children:[(_=h,["Janvier","F\xe9vrier","Mars","Avril","Mai","Juin","Juillet","Ao\xfbt","Septembre","Octobre","Novembre","D\xe9cembre"][_.getMonth()])," ",h.getFullYear()]})}),(0,Pn.jsx)("button",{onClick:()=>k(1),className:"p-3 hover:bg-white hover:shadow-md rounded-xl transition-all duration-200 text-gray-600 hover:text-blue-600",children:(0,Pn.jsx)(ks,{className:"h-6 w-6"})})]}),(0,Pn.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pn.jsx)("button",{onClick:()=>m(new Date),className:"px-4 py-2 text-sm bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 shadow-md hover:shadow-lg transition-all duration-200 font-medium",children:"\ud83d\udcc5 Aujourd'hui"}),(0,Pn.jsxs)("div",{className:"flex bg-white rounded-xl p-1 shadow-md",children:["week"===p&&(0,Pn.jsx)("button",{onClick:T,className:"px-3 py-2 text-sm rounded-lg transition-all duration-200 hover:bg-gray-100 text-gray-600 font-medium",children:"\u2190 Retour"}),(0,Pn.jsxs)("button",{onClick:()=>{"month"===p?(g("week"),v(Es.planningEngine.getWeekDays(h))):"week"===p&&T()},className:"px-4 py-2 text-sm rounded-lg transition-all duration-200 font-medium ".concat("week"===p?"bg-blue-100 text-blue-700 shadow-sm":"hover:bg-gray-100 text-gray-700"),children:["\ud83d\udcca ","month"===p?"Semaine":"Courante"]}),(0,Pn.jsx)("button",{onClick:()=>g("month"),className:"px-4 py-2 text-sm rounded-lg transition-all duration-200 font-medium ".concat("month"===p?"bg-blue-100 text-blue-700 shadow-sm":"hover:bg-gray-100 text-gray-700"),children:"\ud83d\udcc5 Mois"}),(0,Pn.jsx)("button",{onClick:()=>g("year"),className:"px-4 py-2 text-sm rounded-lg transition-all duration-200 font-medium ".concat("year"===p?"bg-blue-100 text-blue-700 shadow-sm":"hover:bg-gray-100 text-gray-700"),children:"\ud83d\udcc8 Ann\xe9e"})]})]})]}),d&&(0,Pn.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-blue-200 p-4 shadow-sm",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pn.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:(0,Pn.jsx)("span",{className:"text-white text-sm",children:"\ud83d\udccb"})}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("span",{className:"text-sm font-bold text-blue-800",children:"Cr\xe9neau copi\xe9"}),(0,Pn.jsxs)("div",{className:"text-xs text-blue-600",children:[d.first_name," ",d.last_name," - ",d.start_time," \xe0 ",d.end_time]})]})]}),(0,Pn.jsx)("button",{onClick:()=>o&&o(null),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-all duration-200 font-medium",children:"\u2715 Annuler"})]})}),"month"===p&&w.length>1&&(0,Pn.jsx)("div",{className:"border-b bg-gradient-to-r from-blue-50 to-indigo-50",children:(0,Pn.jsxs)("div",{className:"grid grid-cols-8 text-xs",children:[(0,Pn.jsx)("div",{className:"border-r bg-gray-100"}),w.map((e,t)=>{const r=e[0],a=e[6],n=e.some(e=>_s(e)===_s(new Date));return(0,Pn.jsxs)("div",{className:"border-r p-2 text-center cursor-pointer transition-all duration-200 ".concat(n?"bg-blue-100 border-blue-300":"bg-white border-gray-200 hover:bg-blue-50"),onClick:()=>E(e),title:"Cliquer pour voir cette semaine en d\xe9tail",children:[(0,Pn.jsxs)("div",{className:"font-semibold text-gray-700",children:["Semaine ",As(e[0])]}),(0,Pn.jsxs)("div",{className:"text-gray-500 mt-1",children:[r.getDate(),"/",r.getMonth()+1," - ",a.getDate(),"/",a.getMonth()+1]}),(0,Pn.jsx)("div",{className:"text-xs text-blue-600 mt-1 opacity-75",children:"\ud83d\udd0d Voir d\xe9tail"})]},t)})]})}),(0,Pn.jsxs)("div",{className:"flex-1 overflow-auto bg-gradient-to-br from-gray-50 to-blue-50 w-full",children:["year"===p?(0,Pn.jsxs)("div",{className:"h-full flex flex-col",children:[(0,Pn.jsx)(Ss,{weeks:w,slots:N,selectedWeek:x,onWeekClick:E,currentViewState:u,onViewStateChange:f}),x&&(0,Pn.jsx)(Ts,{selectedWeek:x,slots:N,onSlotEdit:r,onSlotDelete:a,onSlotCreate:i,onSlotResize:S,onSlotMove:n,onSlotCopy:o,onSlotPaste:c,copiedSlot:d,currentViewState:u,onViewStateChange:f})]}):"month"===p?(0,Pn.jsx)("div",{className:"space-y-2 p-4",children:w.map((e,t)=>{const a=e.some(e=>_s(e)===_s(new Date)),n=N.filter(t=>{const r=t.start_date?t.start_date.split("T")[0]:null;return e.some(e=>_s(e)===r)}).length;return(0,Pn.jsxs)("div",{className:"grid grid-cols-8 border-2 relative group ".concat(a?"border-blue-400 bg-gradient-to-r from-blue-25 to-blue-50 shadow-lg":"border-gray-200 bg-white hover:border-blue-300 hover:bg-gradient-to-r hover:from-blue-25 hover:to-blue-50 shadow-md hover:shadow-lg"," rounded-xl overflow-hidden transition-all duration-300 cursor-pointer"),onClick:()=>E(e),title:"Cliquer pour voir la semaine ".concat(As(e[0])," en d\xe9tail (").concat(n," cr\xe9neaux)"),children:[(0,Pn.jsxs)("div",{className:"absolute top-3 right-3 z-10 bg-blue-500 text-white text-xs px-3 py-1 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-300 shadow-md",children:[n," cr\xe9neaux"]}),(0,Pn.jsxs)("div",{className:"border-r bg-gray-50",children:[(0,Pn.jsxs)("div",{className:"h-12 border-b flex flex-col items-center justify-center text-xs font-medium text-gray-700",children:[(0,Pn.jsx)("div",{children:As(e[0])}),n>0&&(0,Pn.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-1"})]}),y.filter((e,t)=>t%4===0).map((e,t)=>(0,Pn.jsx)("div",{className:"h-6 border-b border-gray-200 flex items-center justify-center text-xs text-gray-600 bg-gray-50",children:e.time},e.time))]}),e.map((e,t)=>{const a=(e=>e&&e instanceof Date&&!isNaN(e.getTime())?e.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"}):(console.error("Date invalide dans formatDisplayDate:",e),"Date invalide"))(e),n=N.filter(t=>(t.start_date?t.start_date.split("T")[0]:null)===_s(e));return(0,Pn.jsxs)("div",{className:"border-r min-h-full ".concat(6===t?"border-r-0":""," ").concat(a.isCurrentMonth?"":"opacity-60"),children:[(0,Pn.jsxs)("div",{className:"h-16 border-b-2 border-gray-300 flex flex-col items-center justify-center transition-all duration-200 ".concat(a.isCurrentMonth?_s(e)===_s(new Date)?"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-700 border-blue-300 shadow-inner":Cs?"bg-gradient-to-r from-gray-100 to-gray-150":"bg-gradient-to-r from-white to-gray-50":"bg-gray-200 text-gray-400"),children:[(0,Pn.jsx)("div",{className:"text-xs font-bold",children:a.dayName}),(0,Pn.jsx)("div",{className:"text-lg font-bold transition-all duration-200 ".concat(_s(e)===_s(new Date)?"bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center shadow-md":""),children:a.dayNumber})]}),(0,Pn.jsx)("div",{className:"relative h-24 p-1",children:n.map((e,t)=>(0,Pn.jsx)("div",{className:"\n                              absolute left-1 right-1 rounded-sm border-l-2 text-xs p-1 cursor-pointer\n                              transition-all duration-200 hover:shadow-md\n                              ".concat(1===e.phase?"bg-blue-400 border-blue-500":2===e.phase?"bg-orange-400 border-orange-500":3===e.phase?"bg-green-400 border-green-500":"bg-gray-400 border-gray-500","\n                            "),style:{top:"".concat(16*t,"px"),height:"14px",zIndex:1},onClick:()=>r&&r(e),title:"".concat(e.first_name," ").concat(e.last_name," - Phase ").concat(e.phase," - ").concat(e.start_time||"Toute la journ\xe9e"),children:(0,Pn.jsxs)("div",{className:"truncate text-xs font-medium",children:[e.first_name," ",e.last_name," - P",e.phase]})},"".concat(e.id,"-").concat(t)))})]},t)})]},t)})}):null,"week"===p&&(0,Pn.jsx)(Ts,{selectedWeek:x||Es.planningEngine.getWeekDays(h),slots:N,onSlotEdit:r,onSlotDelete:a,onSlotCreate:i,onSlotResize:l,onSlotMove:n,onSlotCopy:o,onSlotPaste:c,copiedSlot:d,currentViewState:u,onViewStateChange:f})]}),(0,Pn.jsx)("div",{className:"border-t bg-gray-50 p-3",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center space-x-6",children:[(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)("div",{className:"w-4 h-4 bg-blue-400 border-l-4 border-blue-500 rounded-sm"}),(0,Pn.jsx)("span",{className:"text-sm text-gray-600",children:"Phase 1 - Planification"})]}),(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)("div",{className:"w-4 h-4 bg-orange-400 border-l-4 border-orange-500 rounded-sm"}),(0,Pn.jsx)("span",{className:"text-sm text-gray-600",children:"Phase 2 - Pilotage"})]}),(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)("div",{className:"w-4 h-4 bg-green-400 border-l-4 border-green-500 rounded-sm"}),(0,Pn.jsx)("span",{className:"text-sm text-gray-600",children:"Phase 3 - Soutenance"})]})]})})]});var _},Rs=Vn("Folder",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}]]),Ps=Vn("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Ds=e=>{let{slot:t,students:r,projects:a,onSave:n,onClose:i}=e;const[l,o]=(0,s.useState)({student_id:"",project_id:"",phase:1,phase_name:"Planification",start_date:"",end_date:"",start_time:"",end_time:"",location:"",notes:"",status:"scheduled",color:"#3B82F6"}),[c,d]=(0,s.useState)({});(0,s.useEffect)(()=>{if(t)o({student_id:t.student_id||"",project_id:t.project_id||"",phase:t.phase||1,phase_name:t.phase_name||"Planification",start_date:t.start_date?t.start_date.split("T")[0]:"",end_date:t.end_date?t.end_date.split("T")[0]:"",start_time:t.start_time||"",end_time:t.end_time||"",location:t.location||"",notes:t.notes||"",status:t.status||"scheduled",color:t.color||"#3B82F6"});else{const e=(new Date).toISOString().split("T")[0];o(t=>qe(qe({},t),{},{start_date:e,end_date:e,start_time:"09:00",end_time:"10:00"}))}},[t]);const u=[{value:1,name:"Planification",color:"#3B82F6"},{value:2,name:"Pilotage",color:"#F59E0B"},{value:3,name:"Soutenance",color:"#10B981"}],f=e=>{const{name:t,value:r}=e.target;if("phase"===t){const e=u.find(e=>e.value===parseInt(r));o(t=>qe(qe({},t),{},{phase:parseInt(r),phase_name:(null===e||void 0===e?void 0:e.name)||"",color:(null===e||void 0===e?void 0:e.color)||"#3B82F6"}))}else o(e=>qe(qe({},e),{},{[t]:r}));c[t]&&d(e=>qe(qe({},e),{},{[t]:""}))},h=e=>"".concat(e.first_name," ").concat(e.last_name," (").concat(e.class,")");return(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:i}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full",children:(0,Pn.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{const e={};return l.student_id||(e.student_id="L'\xe9tudiant est requis"),l.phase||(e.phase="La phase est requise"),l.start_date||(e.start_date="La date de d\xe9but est requise"),l.end_date||(e.end_date="La date de fin est requise"),l.start_date&&l.end_date&&l.start_date>l.end_date&&(e.end_date="La date de fin doit \xeatre apr\xe8s la date de d\xe9but"),l.start_time&&l.end_time&&l.start_time>=l.end_time&&(e.end_time="L'heure de fin doit \xeatre apr\xe8s l'heure de d\xe9but"),d(e),0===Object.keys(e).length})()&&n(l)},children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:t?"Modifier le cr\xe9neau":"Nouveau cr\xe9neau"}),(0,Pn.jsx)("button",{type:"button",onClick:i,className:"text-gray-400 hover:text-gray-600",children:(0,Pn.jsx)(os,{className:"h-6 w-6"})})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("label",{className:"label",children:[(0,Pn.jsx)(Hn,{className:"h-4 w-4 mr-1"}),"\xc9tudiant *"]}),(0,Pn.jsxs)("select",{name:"student_id",value:l.student_id,onChange:f,className:"input ".concat(c.student_id?"border-red-500":""),required:!0,children:[(0,Pn.jsx)("option",{value:"",children:"S\xe9lectionner un \xe9tudiant"}),r.map(e=>(0,Pn.jsx)("option",{value:e.id,children:h(e)},e.id))]}),c.student_id&&(0,Pn.jsx)("p",{className:"text-red-500 text-sm mt-1",children:c.student_id})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("label",{className:"label",children:[(0,Pn.jsx)(Rs,{className:"h-4 w-4 mr-1"}),"Projet"]}),(0,Pn.jsxs)("select",{name:"project_id",value:l.project_id,onChange:f,className:"input",children:[(0,Pn.jsx)("option",{value:"",children:"Aucun projet"}),a.map(e=>(0,Pn.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Phase *"}),(0,Pn.jsx)("select",{name:"phase",value:l.phase,onChange:f,className:"input ".concat(c.phase?"border-red-500":""),required:!0,children:u.map(e=>(0,Pn.jsxs)("option",{value:e.value,children:["Phase ",e.value," - ",e.name]},e.value))}),c.phase&&(0,Pn.jsx)("p",{className:"text-red-500 text-sm mt-1",children:c.phase})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Statut"}),(0,Pn.jsx)("select",{name:"status",value:l.status,onChange:f,className:"input",children:[{value:"scheduled",label:"Programm\xe9",color:"text-blue-600"},{value:"in_progress",label:"En cours",color:"text-orange-600"},{value:"completed",label:"Termin\xe9",color:"text-green-600"},{value:"cancelled",label:"Annul\xe9",color:"text-red-600"}].map(e=>(0,Pn.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("label",{className:"label",children:[(0,Pn.jsx)(ts,{className:"h-4 w-4 mr-1"}),"Date de d\xe9but *"]}),(0,Pn.jsx)("input",{type:"date",name:"start_date",value:l.start_date,onChange:f,className:"input ".concat(c.start_date?"border-red-500":""),required:!0}),c.start_date&&(0,Pn.jsx)("p",{className:"text-red-500 text-sm mt-1",children:c.start_date})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("label",{className:"label",children:[(0,Pn.jsx)(ts,{className:"h-4 w-4 mr-1"}),"Date de fin *"]}),(0,Pn.jsx)("input",{type:"date",name:"end_date",value:l.end_date,onChange:f,className:"input ".concat(c.end_date?"border-red-500":""),required:!0}),c.end_date&&(0,Pn.jsx)("p",{className:"text-red-500 text-sm mt-1",children:c.end_date})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("label",{className:"label",children:[(0,Pn.jsx)(bs,{className:"h-4 w-4 mr-1"}),"Heure de d\xe9but"]}),(0,Pn.jsx)("input",{type:"time",name:"start_time",value:l.start_time,onChange:f,className:"input"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("label",{className:"label",children:[(0,Pn.jsx)(bs,{className:"h-4 w-4 mr-1"}),"Heure de fin"]}),(0,Pn.jsx)("input",{type:"time",name:"end_time",value:l.end_time,onChange:f,className:"input ".concat(c.end_time?"border-red-500":"")}),c.end_time&&(0,Pn.jsx)("p",{className:"text-red-500 text-sm mt-1",children:c.end_time})]}),(0,Pn.jsxs)("div",{className:"md:col-span-2",children:[(0,Pn.jsxs)("label",{className:"label",children:[(0,Pn.jsx)(Ps,{className:"h-4 w-4 mr-1"}),"Lieu"]}),(0,Pn.jsx)("input",{type:"text",name:"location",value:l.location,onChange:f,className:"input",placeholder:"Salle, atelier, entreprise..."})]}),(0,Pn.jsxs)("div",{className:"md:col-span-2",children:[(0,Pn.jsxs)("label",{className:"label",children:[(0,Pn.jsx)(us,{className:"h-4 w-4 mr-1"}),"Notes"]}),(0,Pn.jsx)("textarea",{name:"notes",value:l.notes,onChange:f,rows:3,className:"input",placeholder:"Notes additionnelles..."})]})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsx)("button",{type:"submit",className:"btn btn-primary sm:ml-3 sm:w-auto",children:t?"Mettre \xe0 jour":"Cr\xe9er"}),(0,Pn.jsx)("button",{type:"button",onClick:i,className:"btn btn-secondary sm:mt-0 sm:w-auto",children:"Annuler"})]})]})})]})})},Ls=Vn("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),Is=Vn("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Ms=e=>{let{slots:t,onSlotCreate:r,onSlotDelete:a,students:n,projects:i,onValidateSchedule:l}=e;const[o,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(!1),[f,h]=(0,s.useState)({baseSlot:null,frequency:"weekly",interval:1,endDate:"",daysOfWeek:[],excludeDates:[]}),m=e=>{const t=[],r=new Date(e.baseSlot.start_date),a=new Date(e.endDate);let n=new Date(r);for(;n<=a;){const r=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][n.getDay()];if(e.daysOfWeek.includes(r)){const r=n.toISOString().split("T")[0];if(!e.excludeDates.includes(r)){const a=qe(qe({},e.baseSlot),{},{id:void 0,start_date:r,end_date:r});t.push(a)}}n.setDate(n.getDate()+7*e.interval)}return t};return(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Outils avanc\xe9s"})}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,Pn.jsx)("button",{onClick:()=>c(!0),className:"flex items-center justify-center p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)(Ls,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),(0,Pn.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Cr\xe9er des r\xe9currences"}),(0,Pn.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Cr\xe9neaux r\xe9p\xe9titifs"})]})}),(0,Pn.jsx)("button",{onClick:()=>{const e={slots:t,students:n,projects:i,exportDate:(new Date).toISOString(),version:"1.0"},r=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download="planning-export-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a),sr.success("Planning export\xe9 avec succ\xe8s")},className:"flex items-center justify-center p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-green-400 hover:bg-green-50 transition-colors",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)(Is,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),(0,Pn.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Exporter"}),(0,Pn.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Sauvegarder le planning"})]})}),(0,Pn.jsx)("button",{onClick:()=>u(!0),className:"flex items-center justify-center p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-400 hover:bg-purple-50 transition-colors",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)(ss,{className:"h-8 w-8 text-purple-600 mx-auto mb-2"}),(0,Pn.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Importer"}),(0,Pn.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Charger un planning"})]})}),(0,Pn.jsx)("button",{onClick:()=>{const e=[];t.forEach((r,a)=>{t.slice(a+1).forEach(t=>{if(r.student_id===t.student_id&&r.start_date===t.start_date&&r.start_time&&t.start_time&&r.end_time&&t.end_time){const a=new Date("".concat(r.start_date,"T").concat(r.start_time)),n=new Date("".concat(r.start_date,"T").concat(r.end_time)),s=new Date("".concat(t.start_date,"T").concat(t.start_time));a<new Date("".concat(t.start_date,"T").concat(t.end_time))&&n>s&&e.push({type:"conflict",message:"Conflit entre ".concat(r.first_name," ").concat(r.last_name," et ").concat(t.first_name," ").concat(t.last_name),slots:[r,t]})}})}),t.forEach(t=>{if(t.start_time&&t.end_time){const r=new Date("2000-01-01T".concat(t.start_time)),a=(new Date("2000-01-01T".concat(t.end_time))-r)/36e5;a>8&&e.push({type:"long_duration",message:"Cr\xe9neau trop long pour ".concat(t.first_name," ").concat(t.last_name," (").concat(a,"h)"),slot:t})}}),n.forEach(r=>{t.some(e=>e.student_id===r.id)||e.push({type:"no_slots",message:"".concat(r.first_name," ").concat(r.last_name," n'a aucun cr\xe9neau"),student:r})}),0===e.length?sr.success("Planning valid\xe9 avec succ\xe8s !"):(sr.error("".concat(e.length," probl\xe8me").concat(e.length>1?"s":""," d\xe9tect\xe9").concat(e.length>1?"s":"")),console.log("Probl\xe8mes d\xe9tect\xe9s:",e)),l&&l(e)},className:"flex items-center justify-center p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-orange-400 hover:bg-orange-50 transition-colors",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)(Xn,{className:"h-8 w-8 text-orange-600 mx-auto mb-2"}),(0,Pn.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Valider"}),(0,Pn.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"V\xe9rifier le planning"})]})})]})]}),o&&(0,Pn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Pn.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cr\xe9er des cr\xe9neaux r\xe9currents"}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fr\xe9quence"}),(0,Pn.jsxs)("select",{value:f.frequency,onChange:e=>h(qe(qe({},f),{},{frequency:e.target.value})),className:"w-full input",children:[(0,Pn.jsx)("option",{value:"weekly",children:"Hebdomadaire"}),(0,Pn.jsx)("option",{value:"biweekly",children:"Bi-hebdomadaire"}),(0,Pn.jsx)("option",{value:"monthly",children:"Mensuel"})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jours de la semaine"}),(0,Pn.jsx)("div",{className:"grid grid-cols-2 gap-2",children:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].map(e=>(0,Pn.jsxs)("label",{className:"flex items-center",children:[(0,Pn.jsx)("input",{type:"checkbox",checked:f.daysOfWeek.includes(e),onChange:t=>{const r=t.target.checked?[...f.daysOfWeek,e]:f.daysOfWeek.filter(t=>t!==e);h(qe(qe({},f),{},{daysOfWeek:r}))},className:"mr-2"}),(0,Pn.jsx)("span",{className:"text-sm",children:"monday"===e?"Lundi":"tuesday"===e?"Mardi":"wednesday"===e?"Mercredi":"thursday"===e?"Jeudi":"friday"===e?"Vendredi":"saturday"===e?"Samedi":"Dimanche"})]},e))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de fin"}),(0,Pn.jsx)("input",{type:"date",value:f.endDate,onChange:e=>h(qe(qe({},f),{},{endDate:e.target.value})),className:"w-full input"})]})]}),(0,Pn.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,Pn.jsx)("button",{onClick:()=>c(!1),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Annuler"}),(0,Pn.jsx)("button",{onClick:async()=>{if(f.baseSlot)try{const e=m(f);for(const t of e)await r(t);sr.success("".concat(e.length," cr\xe9neaux r\xe9currents cr\xe9\xe9s")),c(!1),h({baseSlot:null,frequency:"weekly",interval:1,endDate:"",daysOfWeek:[],excludeDates:[]})}catch(e){sr.error("Erreur lors de la cr\xe9ation des cr\xe9neaux r\xe9currents")}else sr.error("Veuillez s\xe9lectionner un cr\xe9neau de base")},className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Cr\xe9er"})]})]})}),d&&(0,Pn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Pn.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Importer un planning"}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fichier JSON"}),(0,Pn.jsx)("input",{type:"file",accept:".json",onChange:e=>{const t=e.target.files[0];if(!t)return;const a=new FileReader;a.onload=e=>{try{const t=JSON.parse(e.target.result);if(!t.slots||!Array.isArray(t.slots))return void sr.error("Format de fichier invalide");t.slots.forEach(e=>{r(e)}),sr.success("".concat(t.slots.length," cr\xe9neaux import\xe9s")),u(!1)}catch(t){sr.error("Erreur lors de l'import du fichier")}},a.readAsText(t)},className:"w-full input"})]}),(0,Pn.jsx)("p",{className:"text-sm text-gray-500",children:"S\xe9lectionnez un fichier JSON export\xe9 depuis cette application."})]}),(0,Pn.jsx)("div",{className:"flex justify-end mt-6",children:(0,Pn.jsx)("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Fermer"})})]})})]})},Fs=Vn("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Us=Vn("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),zs=e=>{let{slots:t,students:r,projects:a}=e;const n=(0,s.useMemo)(()=>{if(!t||!r||!a)return null;const e=t.length,n=r.length,s=a.length,i=t.reduce((e,t)=>(e[t.phase]=(e[t.phase]||0)+1,e),{}),l=t.reduce((e,t)=>{const r="".concat(t.first_name," ").concat(t.last_name);return e[r]=(e[r]||0)+1,e},{}),o=t.reduce((e,t)=>{if(t.start_time&&t.end_time){const r=new Date("2000-01-01T".concat(t.start_time));return e+(new Date("2000-01-01T".concat(t.end_time))-r)/36e5}return e},0),c=t.reduce((e,t)=>{const r="".concat(t.first_name," ").concat(t.last_name);if(t.start_time&&t.end_time){const a=new Date("2000-01-01T".concat(t.start_time)),n=(new Date("2000-01-01T".concat(t.end_time))-a)/36e5;e[r]=(e[r]||0)+n}return e},{}),d=t.reduce((e,t)=>{const r=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"][new Date(t.start_date).getDay()];return e[r]=(e[r]||0)+1,e},{}),u=[],f=Math.max(...Object.values(l)),h=Object.entries(l).filter(e=>{let[t,r]=e;return r>.8*f}).map(e=>{let[t,r]=e;return{name:t,count:r}});h.length>0&&u.push({type:"warning",message:"".concat(h.length," \xe9tudiant").concat(h.length>1?"s":""," avec une charge \xe9lev\xe9e"),details:h.map(e=>"".concat(e.name," (").concat(e.count," cr\xe9neaux)")).join(", ")});const m=Math.max(...Object.values(d)),p=Object.entries(d).filter(e=>{let[t,r]=e;return r>.8*m}).map(e=>{let[t,r]=e;return{day:t,count:r}});p.length>0&&u.push({type:"info",message:"".concat(p.length," jour").concat(p.length>1?"s":""," avec beaucoup de cr\xe9neaux"),details:p.map(e=>"".concat(e.day," (").concat(e.count," cr\xe9neaux)")).join(", ")});const g=new Set(t.map(e=>e.student_id)),x=r.filter(e=>!g.has(e.id));return x.length>0&&u.push({type:"error",message:"".concat(x.length," \xe9tudiant").concat(x.length>1?"s":""," sans cr\xe9neaux"),details:x.map(e=>"".concat(e.first_name," ").concat(e.last_name)).join(", ")}),{totalSlots:e,totalStudents:n,totalProjects:s,totalHours:o,phaseDistribution:i,studentDistribution:l,hoursPerStudent:c,dayDistribution:d,suggestions:u}},[t,r,a]);return n?(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,Pn.jsx)("div",{className:"card",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,Pn.jsx)(ts,{className:"h-6 w-6 text-blue-600"})}),(0,Pn.jsxs)("div",{className:"ml-4",children:[(0,Pn.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total cr\xe9neaux"}),(0,Pn.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:n.totalSlots})]})]})}),(0,Pn.jsx)("div",{className:"card",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,Pn.jsx)(Jn,{className:"h-6 w-6 text-green-600"})}),(0,Pn.jsxs)("div",{className:"ml-4",children:[(0,Pn.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"\xc9tudiants"}),(0,Pn.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:n.totalStudents})]})]})}),(0,Pn.jsx)("div",{className:"card",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,Pn.jsx)(Fs,{className:"h-6 w-6 text-purple-600"})}),(0,Pn.jsxs)("div",{className:"ml-4",children:[(0,Pn.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Projets"}),(0,Pn.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:n.totalProjects})]})]})}),(0,Pn.jsx)("div",{className:"card",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,Pn.jsx)(bs,{className:"h-6 w-6 text-orange-600"})}),(0,Pn.jsxs)("div",{className:"ml-4",children:[(0,Pn.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Heures totales"}),(0,Pn.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[n.totalHours.toFixed(1),"h"]})]})]})})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"R\xe9partition par phase"}),(0,Pn.jsx)("div",{className:"space-y-3",children:Object.entries(n.phaseDistribution).map(e=>{let[t,r]=e;return(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Phase ",t]}),(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:(0,Pn.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(r/n.totalSlots*100,"%")}})}),(0,Pn.jsx)("span",{className:"text-sm text-gray-600 w-8",children:r})]})]},t)})})]}),(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"R\xe9partition par jour"}),(0,Pn.jsx)("div",{className:"space-y-3",children:["Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"].map(e=>{const t=n.dayDistribution[e]||0;return(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e}),(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:(0,Pn.jsx)("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"".concat(t/Math.max(...Object.values(n.dayDistribution))*100,"%")}})}),(0,Pn.jsx)("span",{className:"text-sm text-gray-600 w-8",children:t})]})]},e)})})]})]}),n.suggestions.length>0&&(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Suggestions d'optimisation"}),(0,Pn.jsx)("div",{className:"space-y-3",children:n.suggestions.map((e,t)=>(0,Pn.jsx)("div",{className:"p-3 rounded-lg border-l-4 ".concat("error"===e.type?"bg-red-50 border-red-400":"warning"===e.type?"bg-yellow-50 border-yellow-400":"bg-blue-50 border-blue-400"),children:(0,Pn.jsxs)("div",{className:"flex items-start",children:[(0,Pn.jsx)("div",{className:"p-1 rounded-full ".concat("error"===e.type?"bg-red-100":"warning"===e.type?"bg-yellow-100":"bg-blue-100"),children:"error"===e.type?(0,Pn.jsx)(Fs,{className:"h-4 w-4 text-red-600"}):"warning"===e.type?(0,Pn.jsx)(Kn,{className:"h-4 w-4 text-yellow-600"}):(0,Pn.jsx)(Us,{className:"h-4 w-4 text-blue-600"})}),(0,Pn.jsxs)("div",{className:"ml-3",children:[(0,Pn.jsx)("p",{className:"text-sm font-medium ".concat("error"===e.type?"text-red-800":"warning"===e.type?"text-yellow-800":"text-blue-800"),children:e.message}),e.details&&(0,Pn.jsx)("p",{className:"text-sm mt-1 ".concat("error"===e.type?"text-red-700":"warning"===e.type?"text-yellow-700":"text-blue-700"),children:e.details})]})]})},t))})]}),(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Charge de travail par \xe9tudiant"}),(0,Pn.jsx)("div",{className:"space-y-3",children:Object.entries(n.hoursPerStudent).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).slice(0,10).map(e=>{let[t,r]=e;return(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsx)("span",{className:"text-sm font-medium text-gray-700",children:t}),(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:(0,Pn.jsx)("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:"".concat(r/Math.max(...Object.values(n.hoursPerStudent))*100,"%")}})}),(0,Pn.jsxs)("span",{className:"text-sm text-gray-600 w-12",children:[r.toFixed(1),"h"]})]})]},t)})})]})]}):(0,Pn.jsx)("div",{className:"card",children:(0,Pn.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})})})},Bs=()=>{const[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)([]),[i,l]=(0,s.useState)([]),[o,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!0),[f,h]=(0,s.useState)(!1),[m,p]=(0,s.useState)(null),[g,x]=(0,s.useState)(null),[v,b]=(0,s.useState)("all"),[y,w]=(0,s.useState)("hyperplanning"),[N,j]=(0,s.useState)(null),[k,E]=(0,s.useState)([]),[S,T]=(0,s.useState)([]),[_,C]=(0,s.useState)(!1),[A,O]=(0,s.useState)([]),[R,P]=(0,s.useState)(!1),[D,L]=(0,s.useState)(null),[I,M]=(0,s.useState)({selectedWeek:null,viewMode:"hyperplanning"});(0,s.useEffect)(()=>{B()},[]);const F=(0,s.useCallback)((e,t)=>{const r={id:Date.now(),action:e,data:t,timestamp:(new Date).toISOString(),description:U(e,t)};T(e=>[r,...e.slice(0,49)]),L(r)},[]),U=(e,t)=>{switch(e){case"create":return"Cr\xe9ation du cr\xe9neau ".concat(t.first_name," ").concat(t.last_name);case"update":return"Modification du cr\xe9neau ".concat(t.first_name," ").concat(t.last_name);case"delete":return"Suppression du cr\xe9neau ".concat(t.first_name," ").concat(t.last_name);case"move":return"D\xe9placement du cr\xe9neau ".concat(t.first_name," ").concat(t.last_name);case"resize":return"Redimensionnement du cr\xe9neau ".concat(t.first_name," ").concat(t.last_name);case"delete_all":return"Suppression de tous les cr\xe9neaux (".concat(t.slots.length," cr\xe9neau").concat(t.slots.length>1?"x":"",")");default:return"Action inconnue"}},z=(0,s.useCallback)(function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=e.filter(e=>e.id!==r&&e.start_date===t.start_date&&e.student_id===t.student_id&&e.start_time&&t.start_time&&e.end_time&&t.end_time&&(e.start_time<t.end_time&&e.end_time>t.start_time||t.start_time<e.end_time&&t.end_time>e.start_time));return O(a),a.length>0},[e]),B=async function(){try{u(!0);const[r,a,s,i]=await Promise.all([Rn.get("/api/planning"),Rn.get("/api/students"),Rn.get("/api/projects"),Rn.get("/api/planning/stats")]);if(r.data.success){const a=r.data.data;if(JSON.stringify(a)!==JSON.stringify(e)){const e=a.filter(e=>e&&e.id&&e.start_date&&e.end_date&&e.first_name&&e.last_name&&e.project_title).map(e=>{const t=e=>{if(!e)return(new Date).toISOString().split("T")[0];if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;if(/^\d{2}\/\d{2}\/\d{4}$/.test(e)){const[t,r,a]=e.split("/");return"".concat(a,"-").concat(r.padStart(2,"0"),"-").concat(t.padStart(2,"0"))}return e.includes("T")?e.split("T")[0]:(new Date).toISOString().split("T")[0]};return qe(qe({},e),{},{start_date:t(e.start_date),end_date:t(e.end_date),start_time:e.start_time||"08:00",end_time:e.end_time||"12:00",first_name:e.first_name||"\xc9tudiant",last_name:e.last_name||"Inconnu",project_title:e.project_title||"Projet",phase:e.phase||1,location:e.location||"Atelier",notes:e.notes||"",status:e.status||"scheduled",color:e.color||"#3B82F6"})});t(e)}}a.data.success&&n(a.data.data),s.data.success&&l(s.data.data),i.data.success&&c(i.data.data)}catch(r){console.error("Erreur lors du chargement des donn\xe9es:",r),sr.error("Erreur lors du chargement des donn\xe9es")}finally{u(!1)}},V=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;p(null),x(e),h(!0)},H=e=>{p(e),x(null),h(!0)},W=async t=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer ce cr\xe9neau ?"))try{const r=e.find(e=>e.id===t);r&&F("delete",r);(await Rn.delete("/api/planning/".concat(t))).data.success&&(sr.success("Cr\xe9neau supprim\xe9 avec succ\xe8s"),B())}catch(r){console.error("Erreur lors de la suppression:",r),sr.error("Erreur lors de la suppression du cr\xe9neau")}},q=async e=>{try{let t;if(e.id){if(t=await Rn.put("/api/planning/".concat(e.id),e),t.data.success){const{planningEngine:t}=await Promise.resolve().then(r.bind(r,994));t.invalidateSlotCache(e.id),sr.success("Cr\xe9neau mis \xe0 jour avec succ\xe8s")}}else t=await Rn.post("/api/planning",e),t.data.success&&sr.success("Cr\xe9neau cr\xe9\xe9 avec succ\xe8s");t.data.success&&B(!0)}catch(t){console.error("Erreur lors de la sauvegarde:",t),sr.error("Erreur lors de la sauvegarde du cr\xe9neau")}},G=e=>{null===e?(j(null),sr.success("Copie annul\xe9e")):(j(e),sr.success("Cr\xe9neau copi\xe9 ! Cliquez sur un emplacement libre pour le coller."))},$=(e,t,r)=>{const a=t.split(":").map(Number),n=r.split(":").map(Number),s=60*a[0]+a[1],i=60*n[0]+n[1]-s,l=e.split(":").map(Number),o=60*l[0]+l[1]+i,c=Math.floor(o/60),d=o%60;return"".concat(c.toString().padStart(2,"0"),":").concat(d.toString().padStart(2,"0"))},Y=e=>({1:"bg-blue-100 text-blue-800",2:"bg-orange-100 text-orange-800",3:"bg-green-100 text-green-800"}[e]||"bg-gray-100 text-gray-800"),K=e=>({1:"Planification",2:"Pilotage",3:"Soutenance"}[e]||"Phase inconnue"),X="all"===v?e:e.filter(e=>e.phase.toString()===v);return d?(0,Pn.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Planification"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Gestion des cr\xe9neaux de planification pour les trois phases"})]}),(0,Pn.jsxs)("button",{onClick:V,className:"btn btn-primary flex items-center",children:[(0,Pn.jsx)(es,{className:"h-4 w-4 mr-2"}),"Nouveau cr\xe9neau"]})]}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(e=>{const t=o.find(t=>t.phase===e)||{total_slots:0,scheduled:0,in_progress:0,completed:0};return(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pn.jsxs)("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(Y(e)),children:["Phase ",e,": ",K(e)]}),(0,Pn.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:t.total_slots})]}),(0,Pn.jsxs)("div",{className:"space-y-2",children:[(0,Pn.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Pn.jsx)("span",{className:"text-gray-500",children:"Programm\xe9s"}),(0,Pn.jsx)("span",{className:"font-medium",children:t.scheduled})]}),(0,Pn.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Pn.jsx)("span",{className:"text-gray-500",children:"En cours"}),(0,Pn.jsx)("span",{className:"font-medium",children:t.in_progress})]}),(0,Pn.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Pn.jsx)("span",{className:"text-gray-500",children:"Termin\xe9s"}),(0,Pn.jsx)("span",{className:"font-medium",children:t.completed})]})]})]},e)})}),(0,Pn.jsx)(Ms,{slots:e,onSlotCreate:V,onSlotDelete:W,students:a,projects:i,onValidateSchedule:e=>{console.log("Probl\xe8mes de validation:",e)}}),(0,Pn.jsx)(zs,{slots:e,students:a,projects:i}),(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pn.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Vue :"}),(0,Pn.jsxs)("div",{className:"flex bg-gray-200 rounded-lg p-1",children:[(0,Pn.jsx)("button",{onClick:()=>w("hyperplanning"),className:"px-4 py-2 text-sm rounded-md transition-colors ".concat("hyperplanning"===y?"bg-white shadow-sm text-gray-900":"text-gray-600 hover:bg-gray-300"),children:"Planning"}),(0,Pn.jsx)("button",{onClick:()=>w("table"),className:"px-4 py-2 text-sm rounded-md transition-colors ".concat("table"===y?"bg-white shadow-sm text-gray-900":"text-gray-600 hover:bg-gray-300"),children:"Tableau"})]})]}),(0,Pn.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pn.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Phase :"}),(0,Pn.jsxs)("select",{value:v,onChange:e=>b(e.target.value),className:"input w-48",children:[(0,Pn.jsx)("option",{value:"all",children:"Toutes les phases"}),(0,Pn.jsx)("option",{value:"1",children:"Phase 1 - Planification"}),(0,Pn.jsx)("option",{value:"2",children:"Phase 2 - Pilotage"}),(0,Pn.jsx)("option",{value:"3",children:"Phase 3 - Soutenance"})]})]})]}),(0,Pn.jsxs)("div",{className:"border-t pt-4",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsxs)("button",{onClick:()=>P(!R),className:"px-3 py-1.5 text-sm rounded-md transition-colors ".concat(R?"bg-blue-100 text-blue-700 border border-blue-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:"Mode s\xe9lection multiple (Shift + Clic)",children:[(0,Pn.jsx)(vs,{className:"h-4 w-4 mr-1"}),"S\xe9lection multiple"]}),k.length>0&&(0,Pn.jsxs)(Pn.Fragment,{children:[(0,Pn.jsxs)("button",{onClick:async()=>{if(0!==k.length&&window.confirm("\xcates-vous s\xfbr de vouloir supprimer ".concat(k.length," cr\xe9neau").concat(k.length>1?"x":""," ?")))try{await Promise.all(k.map(e=>W(e.id))),E([]),sr.success("".concat(k.length," cr\xe9neau").concat(k.length>1?"x":""," supprim\xe9").concat(k.length>1?"s":""))}catch(e){sr.error("Erreur lors de la suppression multiple")}},className:"px-3 py-1.5 text-sm bg-red-100 text-red-700 rounded-md hover:bg-red-200 transition-colors",title:"Supprimer ".concat(k.length," cr\xe9neau").concat(k.length>1?"x":""),children:[(0,Pn.jsx)(as,{className:"h-4 w-4 mr-1"}),"Supprimer (",k.length,")"]}),(0,Pn.jsxs)("button",{onClick:()=>G(k[0]),className:"px-3 py-1.5 text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",title:"Copier le premier cr\xe9neau s\xe9lectionn\xe9",children:[(0,Pn.jsx)(vs,{className:"h-4 w-4 mr-1"}),"Copier"]})]}),(0,Pn.jsxs)("button",{onClick:()=>C(!_),className:"px-3 py-1.5 text-sm bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 transition-colors",title:"Historique des modifications",children:[(0,Pn.jsx)(bs,{className:"h-4 w-4 mr-1"}),"Historique"]}),(0,Pn.jsxs)("button",{onClick:async()=>{if(D)try{switch(D.action){case"create":await W(D.data.id);break;case"delete":case"update":case"move":case"resize":await q(D.data);break;case"delete_all":for(const e of D.data.slots)await q(e);break;default:sr.error("Type d'action non support\xe9 pour l'annulation")}sr.success("Action annul\xe9e"),L(null)}catch(e){sr.error("Impossible d'annuler cette action")}else sr.error("Aucune action \xe0 annuler")},disabled:!D,className:"px-3 py-1.5 text-sm rounded-md transition-colors ".concat(D?"bg-orange-100 text-orange-700 hover:bg-orange-200":"bg-gray-100 text-gray-400 cursor-not-allowed"),title:"Annuler la derni\xe8re action (Ctrl+Z)",children:[(0,Pn.jsx)(ys,{className:"h-4 w-4 mr-1"}),"Annuler"]}),(0,Pn.jsxs)("button",{onClick:async()=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer TOUS les cr\xe9neaux ? Cette action est irr\xe9versible."))try{u(!0),F("delete_all",{slots:[...e]}),await Rn.delete("/api/planning/"),t([]),E([]),P(!1),sr.success("Tous les cr\xe9neaux ont \xe9t\xe9 supprim\xe9s avec succ\xe8s")}catch(r){console.error("Erreur lors de la suppression de tous les cr\xe9neaux:",r),sr.error("Erreur lors de la suppression de tous les cr\xe9neaux")}finally{u(!1)}},className:"px-3 py-1.5 text-sm bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",title:"Supprimer tous les cr\xe9neaux",children:[(0,Pn.jsx)(as,{className:"h-4 w-4 mr-1"}),"Supprimer tout"]})]}),(0,Pn.jsx)("div",{className:"text-xs text-gray-500",children:(0,Pn.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pn.jsx)("span",{children:"Ctrl+N : Nouveau"}),(0,Pn.jsx)("span",{children:"Ctrl+C : Copier"}),(0,Pn.jsx)("span",{children:"Ctrl+V : Coller"}),(0,Pn.jsx)("span",{children:"Ctrl+Z : Annuler"}),(0,Pn.jsx)("span",{children:"Delete : Supprimer"}),(0,Pn.jsx)("span",{children:"\xc9chap : D\xe9s\xe9lectionner"})]})})]}),A.length>0&&(0,Pn.jsx)("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)(ws,{className:"h-4 w-4 text-red-600 mr-2"}),(0,Pn.jsxs)("span",{className:"text-sm font-medium text-red-800",children:[A.length," cr\xe9neau",A.length>1?"x":""," en conflit d\xe9tect\xe9",A.length>1?"s":""]})]})})]}),_&&(0,Pn.jsxs)("div",{className:"mt-4 border-t pt-4",children:[(0,Pn.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Historique des modifications"}),(0,Pn.jsx)("div",{className:"max-h-40 overflow-y-auto space-y-2",children:0===S.length?(0,Pn.jsx)("p",{className:"text-sm text-gray-500",children:"Aucune modification r\xe9cente"}):S.slice(0,10).map(e=>(0,Pn.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Pn.jsx)("span",{className:"text-gray-700",children:e.description}),(0,Pn.jsx)("span",{className:"text-gray-500",children:new Date(e.timestamp).toLocaleTimeString()})]},e.id))})]})]}),"hyperplanning"===y&&(0,Pn.jsx)("div",{className:"card p-0 h-[600px]",children:(0,Pn.jsx)(Os,{slots:X,onSlotEdit:H,onSlotDelete:W,onSlotMove:async(t,a,n)=>{try{const s=e.find(e=>e.id===t);if(!s)return void sr.error("Cr\xe9neau non trouv\xe9");const i=qe(qe({},s),{},{start_date:a,start_time:n,end_date:a});if(z(i,t)){if(!window.confirm("\u26a0\ufe0f Conflit d\xe9tect\xe9 ! ".concat(A.length," cr\xe9neau").concat(A.length>1?"x":""," en conflit.\n\nVoulez-vous continuer ?")))return}F("move",s);if((await Rn.put("/api/planning/".concat(t),i)).data.success){const{planningEngine:e}=await Promise.resolve().then(r.bind(r,994));e.invalidateSlotCache(t),sr.success("Cr\xe9neau d\xe9plac\xe9 avec succ\xe8s"),B(!0)}}catch(s){console.error("Erreur lors du d\xe9placement:",s),s.response&&s.response.data?(console.error("D\xe9tails de l'erreur:",s.response.data),sr.error(s.response.data.message||"Erreur lors du d\xe9placement du cr\xe9neau")):sr.error("Erreur lors du d\xe9placement du cr\xe9neau")}},onSlotCreate:V,onSlotResize:async(e,t)=>{try{const a=qe(qe({},e),{},{start_time:t.start_time,end_time:t.end_time});if(z(a,e.id)){if(!window.confirm("\u26a0\ufe0f Conflit d\xe9tect\xe9 ! ".concat(A.length," cr\xe9neau").concat(A.length>1?"x":""," en conflit.\n\nVoulez-vous continuer ?")))return}F("resize",e);if((await Rn.put("/api/planning/".concat(e.id),a)).data.success){const{planningEngine:t}=await Promise.resolve().then(r.bind(r,994));t.invalidateSlotCache(e.id),sr.success("Cr\xe9neau redimensionn\xe9 avec succ\xe8s"),B(!0)}}catch(a){console.error("Erreur lors du redimensionnement:",a),sr.error("Erreur lors du redimensionnement du cr\xe9neau")}},onSlotCopy:G,onSlotPaste:async(e,t)=>{if(N)try{const r=qe(qe({},N),{},{id:void 0,start_date:e,start_time:t,end_time:$(t,N.start_time,N.end_time)});console.log("Collage du cr\xe9neau:",r);(await Rn.post("/api/planning",r)).data.success&&(sr.success("Cr\xe9neau coll\xe9 avec succ\xe8s"),j(null),B(!0))}catch(r){console.error("Erreur lors du collage:",r),sr.error("Erreur lors du collage du cr\xe9neau")}else sr.error("Aucun cr\xe9neau copi\xe9")},copiedSlot:N,selectedSlots:k,onSlotSelect:function(e){E(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?t=>{const r=t.find(t=>t.id===e.id);return r?t.filter(t=>t.id!==e.id):[...t,e]}:[e])},isMultiSelect:R,conflictSlots:A,currentViewState:I,onViewStateChange:M})}),"table"===y&&X.length>0&&(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Liste des cr\xe9neaux (",X.length,")"]}),(0,Pn.jsx)("div",{className:"overflow-x-auto",children:(0,Pn.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pn.jsx)("thead",{className:"bg-gray-50",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phase"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\xc9tudiant"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jour"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Heure"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Projet"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lieu"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Pn.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:X.map(e=>{const t=new Date(e.start_date);return(0,Pn.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(Y(e.phase)),children:["Phase ",e.phase]})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsx)("div",{className:"flex items-center",children:(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,Pn.jsx)("div",{className:"text-sm text-gray-500",children:e.class})]})})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsxs)("div",{className:"text-sm text-gray-900",children:[t.getDate(),"/",["Jan","F\xe9v","Mar","Avr","Mai","Juin","Juil","Ao\xfbt","Sep","Oct","Nov","D\xe9c"][t.getMonth()],"/",t.getFullYear()]})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsx)("div",{className:"text-sm text-gray-900",children:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"][t.getDay()]})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsx)("div",{className:"text-sm text-gray-900",children:e.start_time?(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("div",{children:e.start_time.substring(0,5)}),e.end_time&&(0,Pn.jsxs)("div",{className:"text-xs text-gray-500",children:["\u2192 ",e.end_time.substring(0,5)]})]}):(0,Pn.jsx)("span",{className:"text-gray-400 italic",children:"Non d\xe9finie"})})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsx)("div",{className:"text-sm text-gray-900",children:e.project_title||(0,Pn.jsx)("span",{className:"text-gray-400 italic",children:"Aucun"})})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsx)("div",{className:"text-sm text-gray-900",children:e.location||(0,Pn.jsx)("span",{className:"text-gray-400 italic",children:"Non d\xe9fini"})})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("scheduled"===e.status?"bg-blue-100 text-blue-800":"in_progress"===e.status?"bg-yellow-100 text-yellow-800":"completed"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"scheduled"===e.status?"Programm\xe9":"in_progress"===e.status?"En cours":"completed"===e.status?"Termin\xe9":"Annul\xe9"})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)("button",{onClick:()=>H(e),className:"text-blue-600 hover:text-blue-900",title:"Modifier",children:(0,Pn.jsx)(Ns,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:()=>W(e.id),className:"text-red-600 hover:text-red-900",title:"Supprimer",children:(0,Pn.jsx)(as,{className:"h-4 w-4"})})]})})]},e.id)})})]})})]}),f&&(0,Pn.jsx)(Ds,{slot:m||g,students:a,projects:i,onSave:q,onClose:()=>{h(!1),p(null),x(null)}})]})},Vs=Vn("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),Hs=Vn("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Ws=e=>{let{student:t,evaluations:r,globalScore:a,globalComments:n,competenceInfo:s,evaluationType:i,evaluationMode:l,directNotes:o}=e;if(console.log("\ud83d\udda8\ufe0f Mode d'\xe9valuation:",l),console.log("\ud83d\udda8\ufe0f DirectNotes:",o),!t)return console.log("\u274c Donn\xe9es \xe9tudiant manquantes pour l'impression:",{student:t}),(0,Pn.jsxs)("div",{style:{padding:"20px",textAlign:"center"},children:[(0,Pn.jsx)("h3",{children:"Erreur d'impression"}),(0,Pn.jsx)("p",{children:"Donn\xe9es \xe9tudiant manquantes pour g\xe9n\xe9rer l'impression."})]});r&&0!==Object.keys(r).length||console.log("\u26a0\ufe0f Aucune \xe9valuation trouv\xe9e, affichage avec donn\xe9es vides");const c={C1:"Recenser et prendre en compte les normes, les r\xe9glementations applicables au projet/chantier",C3:"G\xe9rer les risques et les al\xe9as li\xe9s \xe0 la r\xe9alisation des t\xe2ches",C12:"G\xe9rer et conduire (y compris avec les documents de : organisation, planification, suivi, pilotage, r\xe9ception etc.) le projet/chantier professionnel"},d={C1:["Les contraintes et ressources normatives et r\xe8glementaires dont celles li\xe9es \xe0 la qualit\xe9, la s\xe9curit\xe9, la sant\xe9 et l'environnement sont prises en compte tout au long du projet/chantier","Les t\xe2ches sont r\xe9parties en fonction des habilitations, des certifications des \xe9quipiers en tenant compte du planning des autres intervenants (monteur-c\xe2bleurs, autres corps d'\xe9tat, sous-traitants)","Les intervenants sont inform\xe9s sur les r\xe8gles li\xe9es \xe0 la sant\xe9, la s\xe9curit\xe9 et l'environnement applicable dans le cadre du projet/chantier","La bonne utilisation des dispositifs de protection des personnes et des biens est contr\xf4l\xe9e"],C3:["Les diff\xe9rentes \xe9tapes de l'activit\xe9 sont adapt\xe9es pour tenir compte des nouvelles solutions retenues et des circonstances","Des solutions pour pallier les al\xe9as sont propos\xe9es \xe0 la hi\xe9rarchie","La mise en \u0153uvre des mesures de pr\xe9vention est pr\xe9vue","La pr\xe9sence des dispositifs de protection des personnes et des biens est contr\xf4l\xe9e","Les dispositifs de protection des personnes et des biens sont utilis\xe9s","Les intervenants sont inform\xe9s sur les r\xe8gles li\xe9es \xe0 la sant\xe9, la s\xe9curit\xe9 et l'environnement, applicables dans le cadre du projet/chantier","Toutes les r\xe8gles de sant\xe9, de s\xe9curit\xe9 et d'environnement sont respect\xe9es tout au long du projet/chantier","Les risques li\xe9s \xe0 l'activit\xe9 sont identifi\xe9s et recens\xe9s","Des solutions pour pr\xe9venir les risques sont propos\xe9es et valid\xe9es","Les al\xe9as sont g\xe9r\xe9s"],C12:["Les informations \xe9crites et orales relatives au projet/chantier sont collect\xe9es","La liste et la disponibilit\xe9 des mat\xe9riels, \xe9quipements, outillages et outils num\xe9riques n\xe9cessaires sont v\xe9rifi\xe9es","L'intervention est planifi\xe9e","La dur\xe9e du projet/chantier est \xe9valu\xe9e","Les approvisionnements sont planifi\xe9s","Le projet/chantier est organis\xe9 pour qu'il soit men\xe9 de mani\xe8re \xe9co-responsable","Les t\xe2ches sont r\xe9parties en fonction des habilitations, des certifications des \xe9quipiers en tenant compte du planning des autres intervenants","Les revues de projet sont effectu\xe9es","Les situations impr\xe9vues, d\xe9licates, conflictuelles sont g\xe9r\xe9es en lien avec la hi\xe9rarchie","Les arbitrages n\xe9cessaires en fonction des contraintes rencontr\xe9es sont pris","Les diff\xe9rentes \xe9tapes du planning sont respect\xe9es ou adapt\xe9es","La qualit\xe9 et la conformit\xe9 des travaux r\xe9alis\xe9s, y compris par la sous-traitance, sont contr\xf4l\xe9es","Les indicateurs (co\xfbts, d\xe9lais, qualit\xe9) de suivi du projet/chantier sont renseign\xe9s","Les intervenants sont inform\xe9s sur les r\xe8gles li\xe9es \xe0 la sant\xe9, la s\xe9curit\xe9 et l'environnement, applicables dans le cadre du projet/chantier","Les dispositifs de protection des personnes et des biens sont pr\xe9sents et bien utilis\xe9s","Les r\xe8gles de sant\xe9, de s\xe9curit\xe9 et environnementales sont respect\xe9es tout au long du projet/chantier","L'\xe9quipe est anim\xe9e pour mener \xe0 bien le projet/chantier"]};return(0,Pn.jsxs)("div",{className:"print-container",style:{width:"210mm",height:"297mm",margin:"0 auto",padding:"8mm 6mm 8mm 6mm",backgroundColor:"white",fontFamily:"Arial, sans-serif",fontSize:"9pt",lineHeight:"1.1"},children:[(0,Pn.jsxs)("div",{style:{textAlign:"center",marginBottom:"2mm",borderBottom:"1px solid #1e40af",paddingBottom:"1mm"},children:[(0,Pn.jsx)("h1",{style:{fontSize:"14pt",fontWeight:"bold",margin:"0 0 1mm 0",color:"#1e40af"},children:"GRILLE D'\xc9VALUATION U52"}),(0,Pn.jsx)("div",{style:{fontSize:"10pt",color:"#6b7280"},children:"\xc9valuation des comp\xe9tences professionnelles"})]}),(0,Pn.jsx)("div",{style:{textAlign:"center",marginBottom:"3mm",padding:"2mm",backgroundColor:"#eff6ff",border:"2px solid #3b82f6",borderRadius:"2mm"},children:(0,Pn.jsxs)("div",{style:{fontSize:"16pt",fontWeight:"bold",color:"#1e40af",textTransform:"uppercase"},children:[t.firstName||t.student_name||"N/A"," ",t.lastName||""]})}),(0,Pn.jsxs)("div",{style:{marginBottom:"2mm",padding:"1mm",backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"1mm"},children:[(0,Pn.jsx)("div",{style:{fontSize:"9pt",fontWeight:"bold",marginBottom:"1mm"},children:"Informations de l'\xe9valuation"}),(0,Pn.jsxs)("div",{style:{fontSize:"8pt",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1mm"},children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("strong",{children:"\xc9tudiant :"})," ",(0,Pn.jsxs)("span",{style:{fontSize:"12pt",fontWeight:"bold"},children:[t.firstName||t.student_name||"N/A"," ",t.lastName||""]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("strong",{children:"Date :"})," ",(new Date).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("strong",{children:"Nom de l'activit\xe9 :"})," ",t.activity_name||(()=>{for(const t of["C1","C3","C12"]){var e;if(null!==(e=r[t])&&void 0!==e&&e.activity_name)return r[t].activity_name}return"Non sp\xe9cifi\xe9"})()]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("strong",{children:"Type d'activit\xe9 :"})," ",(()=>{const e=t.activity_type||(()=>{for(const t of["C1","C3","C12"]){var e;if(null!==(e=r[t])&&void 0!==e&&e.activity_type)return r[t].activity_type}return null})();return"entreprise"===e||"Activit\xe9s observ\xe9es en entreprise"===e?"En entreprise":"centre"===e||"Activit\xe9s observ\xe9es en centre de formation"===e?"En centre de formation":e||"Non sp\xe9cifi\xe9"})()]})]})]}),["C1","C3","C12"].map(e=>{const t=r&&r[e]?r[e]:null;if(!t)return(0,Pn.jsxs)("div",{style:{marginBottom:"2mm"},children:[(0,Pn.jsxs)("h3",{style:{fontSize:"10pt",fontWeight:"bold",margin:"0 0 1mm 0",color:"#1f2937",backgroundColor:"#e5e7eb",padding:"1mm",borderRadius:"1mm"},children:[e," - ",c[e]]}),(0,Pn.jsx)("div",{style:{padding:"1mm",textAlign:"center",color:"#6b7280",fontStyle:"italic",backgroundColor:"#f9fafb",border:"1px dashed #d1d5db",borderRadius:"1mm",fontSize:"8pt"},children:"Aucune \xe9valuation disponible pour cette comp\xe9tence"})]},e);const a=d[e]||[],n=(e=>{if(o&&o[e]){const t=o[e];return t.N1?1:t.N2?2:t.N3?3:t.N4?4:0}const t=r[e];if(!t||!t.criteria)return 0;const a=[];if(Object.values(t.criteria).forEach(e=>{e.evaluated&&(e.N1?a.push(1):e.N2?a.push(2):e.N3?a.push(3):e.N4&&a.push(4))}),0===a.length)return 0;const n=a.reduce((e,t)=>e+t,0)/a.length;return Math.floor(n)})(e);return(0,Pn.jsxs)("div",{style:{marginBottom:"2mm"},children:[(0,Pn.jsxs)("h3",{style:{fontSize:"10pt",fontWeight:"bold",margin:"0 0 1mm 0",color:"#1f2937",backgroundColor:"#e5e7eb",padding:"1mm",borderRadius:"1mm"},children:[e," - ",c[e]]}),(0,Pn.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"7pt",marginBottom:"1mm"},children:[(0,Pn.jsx)("thead",{children:(0,Pn.jsxs)("tr",{style:{backgroundColor:"#f3f4f6"},children:[(0,Pn.jsx)("th",{style:{border:"1px solid #d1d5db",padding:"0.5mm",textAlign:"left",width:"60%",height:"4mm"},children:"Crit\xe8res d'\xe9valuation"}),(0,Pn.jsx)("th",{style:{border:"1px solid #d1d5db",padding:"0.3mm",textAlign:"center",width:"10%",height:"4mm"},children:"\xc9valu\xe9"}),(0,Pn.jsx)("th",{style:{border:"1px solid #d1d5db",padding:"0.3mm",textAlign:"center",width:"7.5%",height:"4mm"},children:"N1"}),(0,Pn.jsx)("th",{style:{border:"1px solid #d1d5db",padding:"0.3mm",textAlign:"center",width:"7.5%",height:"4mm"},children:"N2"}),(0,Pn.jsx)("th",{style:{border:"1px solid #d1d5db",padding:"0.3mm",textAlign:"center",width:"7.5%",height:"4mm"},children:"N3"}),(0,Pn.jsx)("th",{style:{border:"1px solid #d1d5db",padding:"0.3mm",textAlign:"center",width:"7.5%",height:"4mm"},children:"N4"})]})}),(0,Pn.jsxs)("tbody",{children:[(0,Pn.jsxs)("tr",{style:{backgroundColor:"#fef3c7",fontWeight:"bold"},children:[(0,Pn.jsx)("td",{style:{border:"1px solid #d1d5db",padding:"0.5mm",textAlign:"center",height:"4mm"}}),(0,Pn.jsx)("td",{style:{border:"1px solid #d1d5db",padding:"0.3mm",textAlign:"center",height:"4mm"},children:"\u2713"}),[1,2,3,4].map(e=>{const t=n===e;return(0,Pn.jsx)("td",{style:{border:"1px solid #d1d5db",padding:"0.3mm",textAlign:"center",backgroundColor:t?"#dbeafe":"transparent",height:"4mm"},children:t?(0,Pn.jsx)("span",{style:{color:"#dc2626",fontWeight:"bold",fontSize:"10pt"},children:"\u2717"}):""},e)})]}),a.map((e,r)=>{const a=t.criteria&&t.criteria[e];return(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("td",{style:{border:"1px solid #d1d5db",padding:"0.5mm",fontSize:"7pt",height:"4mm"},children:e}),(0,Pn.jsx)("td",{style:{border:"1px solid #d1d5db",padding:"0.3mm",textAlign:"center",height:"4mm"},children:a&&a.evaluated?"\u2713":""}),["N1","N2","N3","N4"].map((e,t)=>{const r=a&&a[e];return(0,Pn.jsx)("td",{style:{border:"1px solid #d1d5db",padding:"0.3mm",textAlign:"center",height:"4mm"},children:r?(0,Pn.jsx)("span",{style:{color:"#dc2626",fontWeight:"bold",fontSize:"10pt"},children:"\u2717"}):""},e)})]},r)})]})]})]},e)}),(0,Pn.jsxs)("div",{style:{marginTop:"2mm",padding:"1mm",textAlign:"center",border:"1px solid #1e40af",borderRadius:"1mm",backgroundColor:"#eff6ff"},children:[(0,Pn.jsxs)("div",{style:{fontSize:"12pt",fontWeight:"bold",color:"#1e40af",marginBottom:"1mm"},children:["Note globale : ",(a||0).toFixed(2),"/20"]}),n&&(0,Pn.jsx)("div",{style:{fontSize:"8pt",fontStyle:"italic",color:"#6b7280",marginTop:"1mm"},children:n})]})]})},qs=e=>{let{student:t,competences:r=null,evaluation:a=null,evaluationType:n="U52",onSave:i,onCancel:l,initialShowPrintPreview:o=!1}=e;const[c,d]=(0,s.useState)({}),[u,f]=(0,s.useState)(0),[h,m]=(0,s.useState)(""),[p,g]=(0,s.useState)(""),[x,v]=(0,s.useState)(""),[b,y]=(0,s.useState)(""),[w,N]=(0,s.useState)(!1),[j,k]=(0,s.useState)(o),[E,S]=(0,s.useState)("criteria"),[T,_]=(0,s.useState)({});(0,s.useEffect)(()=>{o&&w&&(console.log("\ud83d\udda8\ufe0f Ouverture automatique de l'impression - donn\xe9es charg\xe9es"),k(!0))},[o,w]);const C=(0,s.useRef)(null),A="U51"===n?{C2:{name:"Extraire les informations n\xe9cessaires \xe0 la r\xe9alisation des t\xe2ches",maxScore:5,description:"Analyser la demande client et extraire les informations techniques n\xe9cessaires"},C13:{name:"Mesurer les grandeurs caract\xe9ristiques d'un ouvrage, d'une installation, d'un \xe9quipement \xe9lectrique",maxScore:5,description:"Effectuer des mesures et contr\xf4les sur des installations \xe9lectriques"},C17:{name:"R\xe9aliser un diagnostic de performance y compris \xe9nerg\xe9tique, de s\xe9curit\xe9, d'un ouvrage, d'une installation, d'un \xe9quipement \xe9lectrique",maxScore:5,description:"Diagnostiquer les performances et proposer des am\xe9liorations"},C18:{name:"R\xe9aliser des op\xe9rations de maintenance sur un ouvrage, une installation, un \xe9quipement \xe9lectrique",maxScore:5,description:"Effectuer la maintenance pr\xe9ventive et corrective"}}:{C1:{name:"Organisation et planification",maxScore:5,description:"Planifier et organiser les activit\xe9s en tenant compte des contraintes r\xe9glementaires, de s\xe9curit\xe9 et des ressources disponibles"},C3:{name:"Gestion des risques et s\xe9curit\xe9",maxScore:5,description:"Identifier, \xe9valuer et g\xe9rer les risques, proposer des solutions de pr\xe9vention et adapter les activit\xe9s aux circonstances"},C12:{name:"Conduite de projet",maxScore:10,description:"Piloter un projet de bout en bout, coordonner les \xe9quipes, g\xe9rer les d\xe9lais et les ressources, assurer la qualit\xe9 et la communication"}},O=(0,s.useMemo)(()=>{const e="U51"===n?{C2:{"La demande client/utilisateur est analys\xe9e":{N1:!1,N2:!1,N3:!1,N4:!1},"Les informations n\xe9cessaires \xe0 l'analyse et aux mesures sont extraites des documents":{N1:!1,N2:!1,N3:!1,N4:!1},"Les informations relatives aux prescriptions techniques et aux r\xe9glementations sont recueillies":{N1:!1,N2:!1,N3:!1,N4:!1},"Les conditions de la maintenance sont prises en compte":{N1:!1,N2:!1,N3:!1,N4:!1},"Les risques professionnels sont identifi\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Les habilitations et les certifications sont v\xe9rifi\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Les informations \xe9crites et orales n\xe9cessaires sont collect\xe9es et hi\xe9rarchis\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Les informations \xe9crites et orales collect\xe9es sont pertinentes pour l'activit\xe9":{N1:!1,N2:!1,N3:!1,N4:!1}},C13:{"La proc\xe9dure d\xe9finie est appliqu\xe9e":{N1:!1,N2:!1,N3:!1,N4:!1},"L'installation et l'environnement de travail sont pris en compte":{N1:!1,N2:!1,N3:!1,N4:!1},"Le niveau d'habilitation n\xe9cessaire avant l'intervention est d\xe9termin\xe9":{N1:!1,N2:!1,N3:!1,N4:!1},"Les actions de pr\xe9vention et de s\xe9curit\xe9 sont mises en \u0153uvre":{N1:!1,N2:!1,N3:!1,N4:!1},"Les appareils de mesures sont install\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Les mesures sont collect\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Les enregistrements sont r\xe9alis\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Les informations venant des objets connect\xe9s sont exploit\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Les contr\xf4les (locaux ou \xe0 distance) sont effectu\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Les essais associ\xe9s sont effectu\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1}},C17:{"Le processus de diagnostic est appliqu\xe9":{N1:!1,N2:!1,N3:!1,N4:!1},"Les conditions de la maintenance sont prises en compte":{N1:!1,N2:!1,N3:!1,N4:!1},"Le niveau d'habilitation n\xe9cessaire est d\xe9termin\xe9":{N1:!1,N2:!1,N3:!1,N4:!1},"Les appareils de mesures sont s\xe9lectionn\xe9s et install\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Les actions de pr\xe9vention et de s\xe9curit\xe9 sont mises en \u0153uvre":{N1:!1,N2:!1,N3:!1,N4:!1},"Les mesures sont collect\xe9es et enregistr\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Les informations venant des objets connect\xe9s sont collect\xe9es et enregistr\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Le diagnostic est pertinent":{N1:!1,N2:!1,N3:!1,N4:!1},"Suite au diagnostic, des modifications de l'installation sont propos\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Suite au diagnostic, des recommandations, des r\xe9glages, des am\xe9liorations de l'installation sont propos\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1}},C18:{"Le protocole de maintenance est pris en compte":{N1:!1,N2:!1,N3:!1,N4:!1},"Le niveau d'habilitation n\xe9cessaire est d\xe9termin\xe9":{N1:!1,N2:!1,N3:!1,N4:!1},"Les actions de pr\xe9vention et de s\xe9curit\xe9 sont mises en \u0153uvre":{N1:!1,N2:!1,N3:!1,N4:!1},"La zone d'intervention est pr\xe9par\xe9e":{N1:!1,N2:!1,N3:!1,N4:!1},"Les op\xe9rations de maintenance pr\xe9ventive sont r\xe9alis\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Le dysfonctionnement est diagnostiqu\xe9":{N1:!1,N2:!1,N3:!1,N4:!1},"Les op\xe9rations de d\xe9pannage sont r\xe9alis\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Les contr\xf4les (locaux ou \xe0 distance) sont effectu\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Les essais associ\xe9s sont effectu\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Le fonctionnement de l'installation est v\xe9rifi\xe9 par rapport aux prescriptions":{N1:!1,N2:!1,N3:!1,N4:!1},"Les fiches de contr\xf4les, carnet de maintenance et/ou applications sp\xe9cifiques sont compl\xe9t\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1}}}:{C1:{"Les contraintes et ressources normatives et r\xe8glementaires dont celles li\xe9es \xe0 la qualit\xe9, la s\xe9curit\xe9, la sant\xe9 et l'environnement sont prises en compte tout au long du projet/chantier":{N1:!1,N2:!1,N3:!1,N4:!1},"Les t\xe2ches sont r\xe9parties en fonction des habilitations, des certifications des \xe9quipiers en tenant compte du planning des autres intervenants (monteur-c\xe2bleurs, autres corps d'\xe9tat, sous-traitants)":{N1:!1,N2:!1,N3:!1,N4:!1},"Les intervenants sont inform\xe9s sur les r\xe8gles li\xe9es \xe0 la sant\xe9, la s\xe9curit\xe9 et l'environnement applicable dans le cadre du projet/chantier":{N1:!1,N2:!1,N3:!1,N4:!1},"La bonne utilisation des dispositifs de protection des personnes et des biens est contr\xf4l\xe9e":{N1:!1,N2:!1,N3:!1,N4:!1}},C3:{"Les diff\xe9rentes \xe9tapes de l'activit\xe9 sont adapt\xe9es pour tenir compte des nouvelles solutions retenues et des circonstances":{N1:!1,N2:!1,N3:!1,N4:!1},"Des solutions pour pallier les al\xe9as sont propos\xe9es \xe0 la hi\xe9rarchie":{N1:!1,N2:!1,N3:!1,N4:!1},"La mise en \u0153uvre des mesures de pr\xe9vention est pr\xe9vue":{N1:!1,N2:!1,N3:!1,N4:!1},"La pr\xe9sence des dispositifs de protection des personnes et des biens est contr\xf4l\xe9e":{N1:!1,N2:!1,N3:!1,N4:!1},"Les dispositifs de protection des personnes et des biens sont utilis\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Les intervenants sont inform\xe9s sur les r\xe8gles li\xe9es \xe0 la sant\xe9, la s\xe9curit\xe9 et l'environnement, applicables dans le cadre du projet/chantier":{N1:!1,N2:!1,N3:!1,N4:!1},"Toutes les r\xe8gles de sant\xe9, de s\xe9curit\xe9 et d'environnement sont respect\xe9es tout au long du projet/chantier":{N1:!1,N2:!1,N3:!1,N4:!1},"Les risques li\xe9s \xe0 l'activit\xe9 sont identifi\xe9s et recens\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Des solutions pour pr\xe9venir les risques sont propos\xe9es et valid\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Les al\xe9as sont g\xe9r\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1}},C12:{"Les informations \xe9crites et orales relatives au projet/chantier sont collect\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"La liste et la disponibilit\xe9 des mat\xe9riels, \xe9quipements, outillages et outils num\xe9riques n\xe9cessaires sont v\xe9rifi\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"L'intervention est planifi\xe9e":{N1:!1,N2:!1,N3:!1,N4:!1},"La dur\xe9e du projet/chantier est \xe9valu\xe9e":{N1:!1,N2:!1,N3:!1,N4:!1},"Les approvisionnements sont planifi\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Le projet/chantier est organis\xe9 pour qu'il soit men\xe9 de mani\xe8re \xe9co-responsable":{N1:!1,N2:!1,N3:!1,N4:!1},"Les t\xe2ches sont r\xe9parties en fonction des habilitations, des certifications des \xe9quipiers en tenant compte du planning des autres intervenants":{N1:!1,N2:!1,N3:!1,N4:!1},"Les revues de projet sont effectu\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Les situations impr\xe9vues, d\xe9licates, conflictuelles sont g\xe9r\xe9es en lien avec la hi\xe9rarchie":{N1:!1,N2:!1,N3:!1,N4:!1},"Les arbitrages n\xe9cessaires en fonction des contraintes rencontr\xe9es sont pris":{N1:!1,N2:!1,N3:!1,N4:!1},"Les diff\xe9rentes \xe9tapes du planning sont respect\xe9es ou adapt\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"La qualit\xe9 et la conformit\xe9 des travaux r\xe9alis\xe9s, y compris par la sous-traitance, sont contr\xf4l\xe9es":{N1:!1,N2:!1,N3:!1,N4:!1},"Les indicateurs (co\xfbts, d\xe9lais, qualit\xe9) de suivi du projet/chantier sont renseign\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Les intervenants sont inform\xe9s sur les r\xe8gles li\xe9es \xe0 la sant\xe9, la s\xe9curit\xe9 et l'environnement, applicables dans le cadre du projet/chantier":{N1:!1,N2:!1,N3:!1,N4:!1},"Les dispositifs de protection des personnes et des biens sont pr\xe9sents et bien utilis\xe9s":{N1:!1,N2:!1,N3:!1,N4:!1},"Les r\xe8gles de sant\xe9, de s\xe9curit\xe9 et environnementales sont respect\xe9es tout au long du projet/chantier":{N1:!1,N2:!1,N3:!1,N4:!1},"L'\xe9quipe est anim\xe9e pour mener \xe0 bien le projet/chantier":{N1:!1,N2:!1,N3:!1,N4:!1}}},t={};return Object.keys(e).forEach(r=>{t[r]={},Object.keys(e[r]).forEach(a=>{t[r][a]=qe({evaluated:!0},e[r][a])})}),t},[]),R=r||A,P=(0,s.useMemo)(()=>{if(r){const e={};return Object.keys(r).forEach(t=>{const a=r[t];e[t]={},a.indicators.forEach(r=>{e[t][r]={evaluated:!0,N1:!1,N2:!1,N3:!1,N4:!1}})}),e}return O},[r,O]),D=(0,s.useCallback)(()=>{if(!R||0===Object.keys(R).length)return;const e={},t={};if(Object.keys(R).forEach(r=>{e[r]={score:0,comments:"",criteria:qe({},P[r]||{})},t[r]={N1:!1,N2:!1,N3:!1,N4:!1}}),d(e),_(t),!a){const e=(new Date).toISOString().slice(0,16);g(e),v(""),y("")}N(!0)},[R,P,a]);(0,s.useEffect)(()=>{if(!c||0===Object.keys(c).length)return void f(0);const e=[];Object.entries(c).forEach(t=>{let[r,a]=t;if("GLOBAL"===r)return;const n=(R[r]||{}).maxScore||0;let s=a.score||0;if("direct"===E&&T[r]){const e=T[r];s=e.N1?0:e.N2?.4*n:e.N3?.75*n:e.N4?n:0}if(s>0&&n>0){const t=s/n*20;e.push(t)}});const t=e.length>0?Math.round(e.reduce((e,t)=>e+t,0)/e.length*100)/100:0;f(t)},[c,R,E,T]);const L=(0,s.useCallback)(async()=>{if(null!==t&&void 0!==t&&t.id&&a){N(!1);try{if(a.existingScores){console.log("\ud83d\udcca Chargement des donn\xe9es existantes depuis les param\xe8tres:",a.existingScores);const e={};if(Object.entries(a.existingScores).forEach(t=>{let[r,a]=t;const n=qe({},P[r]||{});if(a.criteria&&"string"===typeof a.criteria)try{const e=JSON.parse(a.criteria);Object.entries(e).forEach(e=>{let[t,r]=e;n[t]&&(n[t]={evaluated:!1!==r.evaluated,N1:r.N1||!1,N2:r.N2||!1,N3:r.N3||!1,N4:r.N4||!1})})}catch(s){console.error("Erreur lors du parsing des crit\xe8res:",s)}e[r]={criteria:n,score:a.score||0,comments:a.comments||""}}),d(e),a.evaluated_at){const e=new Date(a.evaluated_at).toISOString().slice(0,16);g(e)}a.activity_name&&v(a.activity_name),a.activity_type&&("entreprise"===a.activity_type?y("Activit\xe9s observ\xe9es en entreprise"):"centre"===a.activity_type?y("Activit\xe9s observ\xe9es en centre de formation"):y(a.activity_type)),a.global_comments&&m(a.global_comments);const t={};let r=!1;return Object.entries(e).forEach(e=>{let[a,n]=e;if(t[a]={N1:!1,N2:!1,N3:!1,N4:!1},n.score>0){const e=Object.values(n.criteria||{}).some(e=>e&&!1!==e.evaluated&&(e.N1||e.N2||e.N3||e.N4));if(console.log("\ud83d\udd0d V\xe9rification ".concat(a,": score=").concat(n.score,", hasEvaluatedCriteria=").concat(e)),!e){var s;const e=(null===(s=R[a])||void 0===s?void 0:s.maxScore)||0,i=n.score/e*100;i<=25?t[a].N1=!0:i<=50?t[a].N2=!0:i<=75?t[a].N3=!0:t[a].N4=!0,r=!0,console.log("\ud83d\udd0d D\xe9tection mode direct pour ".concat(a,": score ").concat(n.score,"/").concat(e," (").concat(i.toFixed(1),"%) -> ").concat(t[a].N1?"N1":t[a].N2?"N2":t[a].N3?"N3":"N4"))}}}),_(t),r?(S("direct"),console.log("\u2705 Mode direct d\xe9tect\xe9 et appliqu\xe9")):(S("criteria"),console.log("\u2705 Mode crit\xe8res d\xe9tect\xe9 et appliqu\xe9")),console.log("\u2705 setIsDataLoaded(true) appel\xe9 - premi\xe8re branche"),void N(!0)}const e=await Rn.get("/api/evaluations/student/".concat(t.id));if(e.data.success&&e.data.data){const t=e.data.data.filter(e=>e.type===n&&e.evaluated_at===a.evaluated_at);if(t.length>0){const e={};t.forEach(t=>{const r=t.competence,a=qe({},P[r]||{});if(t.criteria)try{const e=JSON.parse(t.criteria);Object.entries(e).forEach(e=>{let[t,r]=e;a[t]&&(a[t]=qe({},r))})}catch(Ge){console.error("Erreur lors du parsing des crit\xe8res:",Ge)}e[r]={criteria:a,score:t.score||0,comments:t.comments||""}}),d(e);const r={};let a=!1;if(Object.entries(e).forEach(e=>{let[t,n]=e;if(r[t]={N1:!1,N2:!1,N3:!1,N4:!1},n.score>0){const e=Object.values(n.criteria||{}).some(e=>e&&!1!==e.evaluated&&(e.N1||e.N2||e.N3||e.N4));if(console.log("\ud83d\udd0d V\xe9rification API ".concat(t,": score=").concat(n.score,", hasEvaluatedCriteria=").concat(e)),!e){var s;const e=(null===(s=R[t])||void 0===s?void 0:s.maxScore)||0,i=n.score/e*100;i<=25?r[t].N1=!0:i<=50?r[t].N2=!0:i<=75?r[t].N3=!0:r[t].N4=!0,a=!0,console.log("\ud83d\udd0d D\xe9tection mode direct API pour ".concat(t,": score ").concat(n.score,"/").concat(e," (").concat(i.toFixed(1),"%) -> ").concat(r[t].N1?"N1":r[t].N2?"N2":r[t].N3?"N3":"N4"))}}}),_(r),a?(S("direct"),console.log("\u2705 Mode direct d\xe9tect\xe9 et appliqu\xe9 (API)")):(S("criteria"),console.log("\u2705 Mode crit\xe8res d\xe9tect\xe9 et appliqu\xe9 (API)")),t.length>0){const e=t[0];if(e.evaluated_at){const t=new Date(e.evaluated_at).toISOString().slice(0,16);g(t)}e.activity_name&&v(e.activity_name),e.activity_type&&("entreprise"===e.activity_type?y("Activit\xe9s observ\xe9es en entreprise"):"centre"===e.activity_type?y("Activit\xe9s observ\xe9es en centre de formation"):y(e.activity_type))}}else D()}else D();console.log("\u2705 setIsDataLoaded(true) appel\xe9 - deuxi\xe8me branche"),N(!0)}catch(e){console.error("\u274c Erreur lors du chargement de l'\xe9valuation:",e),D()}}},[null===t||void 0===t?void 0:t.id,P,n,null===a||void 0===a?void 0:a.id,R]);(0,s.useEffect)(()=>{w||(null!==t&&void 0!==t&&t.id&&a?L():D())},[null===t||void 0===t?void 0:t.id,null===a||void 0===a?void 0:a.id,L,D]);const I=e=>{if(S(e),"direct"===e){const e={};Object.keys(R).forEach(t=>{e[t]={N1:!1,N2:!1,N3:!1,N4:!1}}),_(e)}};return t?(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{className:"relative",children:[(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Grille d'\xe9valuation compl\xe8te"}),(0,Pn.jsx)("p",{className:"text-2xl font-bold text-gray-900 mb-2",children:t.student_name||"".concat(t.first_name," ").concat(t.last_name)})]}),(0,Pn.jsx)("button",{onClick:l,className:"absolute top-0 right-0 text-gray-400 hover:text-gray-600",children:(0,Pn.jsx)(os,{className:"h-6 w-6"})})]}),(0,Pn.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udcc5 Date et heure d'\xe9valuation"}),(0,Pn.jsx)("input",{type:"datetime-local",value:p,onChange:e=>g(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0}),(0,Pn.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Cette date/heure permettra de distinguer les diff\xe9rentes sessions d'\xe9valuation"})]}),(0,Pn.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"\ud83c\udfaf Mode d'\xe9valuation"}),(0,Pn.jsxs)("div",{className:"flex space-x-4",children:[(0,Pn.jsxs)("label",{className:"flex items-center",children:[(0,Pn.jsx)("input",{type:"radio",name:"evaluationMode",value:"criteria",checked:"criteria"===E,onChange:e=>I(e.target.value),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 focus:ring-2"}),(0,Pn.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"\ud83d\udccb \xc9valuation par crit\xe8res d\xe9taill\xe9s"})]}),(0,Pn.jsxs)("label",{className:"flex items-center",children:[(0,Pn.jsx)("input",{type:"radio",name:"evaluationMode",value:"direct",checked:"direct"===E,onChange:e=>I(e.target.value),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 focus:ring-2"}),(0,Pn.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"\u26a1 Note directe (N1, N2, N3, N4)"})]})]}),(0,Pn.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"criteria"===E?"\xc9valuez chaque crit\xe8re individuellement pour une \xe9valuation pr\xe9cise":"Attribuez directement une note globale pour chaque comp\xe9tence"})]}),(0,Pn.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udccb Nom de l'activit\xe9"}),(0,Pn.jsx)("input",{type:"text",value:x||"",onChange:e=>{v(e.target.value)},placeholder:"Saisir le nom de l'activit\xe9 \xe9valu\xe9e",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm"}),(0,Pn.jsxs)("div",{className:"mt-4",children:[(0,Pn.jsx)("span",{className:"block text-sm font-medium text-gray-700 mb-3",children:"\ud83c\udfe2 Type d'activit\xe9"}),(0,Pn.jsxs)("div",{className:"space-y-2",children:[(0,Pn.jsxs)("label",{className:"flex items-center",children:[(0,Pn.jsx)("input",{type:"radio",name:"activityType",value:"Activit\xe9s observ\xe9es en entreprise",checked:"Activit\xe9s observ\xe9es en entreprise"===b,onChange:e=>{y(e.target.value)},className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300",disabled:!1}),(0,Pn.jsxs)("span",{className:"ml-2 text-sm text-gray-700",children:["\ud83c\udfed Activit\xe9s observ\xe9es en entreprise ",(0,Pn.jsx)("span",{className:"text-xs text-gray-500",children:"(coeff. 1/3)"})]})]}),(0,Pn.jsxs)("label",{className:"flex items-center",children:[(0,Pn.jsx)("input",{type:"radio",name:"activityType",value:"Activit\xe9s observ\xe9es en centre de formation",checked:"Activit\xe9s observ\xe9es en centre de formation"===b,onChange:e=>{y(e.target.value)},className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300",disabled:!1}),(0,Pn.jsxs)("span",{className:"ml-2 text-sm text-gray-700",children:["\ud83c\udf93 Activit\xe9s observ\xe9es en centre de formation ",(0,Pn.jsx)("span",{className:"text-xs text-gray-500",children:"(coeff. 2/3)"})]})]})]})]})]}),Object.keys(R||{}).map(e=>{const t=R[e]||{},r=t.name||"Comp\xe9tence ".concat(e),a=t.description||"Description non disponible",n=t.maxScore||0,s=c[e]||{score:0,comments:"",criteria:P[e]||{}},i=T[e]||{N1:!1,N2:!1,N3:!1,N4:!1};return P&&P[e]?(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:[e," - ",r]}),(0,Pn.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:a}),(0,Pn.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Note maximale: ",n,"/20"]})]}),(0,Pn.jsxs)("div",{className:"ml-4 text-right",children:[(0,Pn.jsxs)("div",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-lg font-semibold",children:["Note: ",s.score||0,"/",n]}),(0,Pn.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[n>0?Math.round((s.score||0)/n*100):0,"%"]}),"direct"===E&&T[e]&&(0,Pn.jsx)("div",{className:"mt-2",children:T[e].N1||T[e].N2||T[e].N3||T[e].N4?(0,Pn.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"\u2713 Comp\xe9tence \xe9valu\xe9e"}):(0,Pn.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"\u23f3 Non \xe9valu\xe9e"})})]})]})}),(0,Pn.jsx)("div",{className:"overflow-x-auto",children:(0,Pn.jsxs)("table",{className:"min-w-full border border-gray-300",children:[(0,Pn.jsx)("thead",{className:"bg-gray-50",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border",children:"Crit\xe8res d'\xe9valuation"}),(0,Pn.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border",children:"\xc9valu\xe9"}),(0,Pn.jsxs)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border",children:["N1",(0,Pn.jsx)("br",{}),"0%"]}),(0,Pn.jsxs)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border",children:["N2",(0,Pn.jsx)("br",{}),"40%"]}),(0,Pn.jsxs)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border",children:["N3",(0,Pn.jsx)("br",{}),"75%"]}),(0,Pn.jsxs)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border",children:["N4",(0,Pn.jsx)("br",{}),"100%"]})]})}),(0,Pn.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:["direct"===E&&(0,Pn.jsxs)("tr",{className:"bg-orange-50 border-t-2 border-orange-200",children:[(0,Pn.jsx)("td",{className:"px-4 py-2 text-sm font-semibold text-orange-700 border",children:"\u26a1 Note directe"}),(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:(0,Pn.jsx)("span",{className:"text-green-600 font-bold",children:"\u2713"})}),["N1","N2","N3","N4"].map(t=>{const r=i[t];return(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:(0,Pn.jsx)("button",{type:"button",onClick:()=>((e,t)=>{var r;_(r=>{const a=qe({},r);return a[e]={N1:!1,N2:!1,N3:!1,N4:!1},a[e][t]=!0,a});const a=(null===(r=R[e])||void 0===r?void 0:r.maxScore)||0;let n=0;switch(t){case"N1":default:n=0;break;case"N2":n=.4*a;break;case"N3":n=.75*a;break;case"N4":n=a}d(t=>qe(qe({},t),{},{[e]:qe(qe({},t[e]),{},{score:n})}))})(e,t),className:"flex items-center justify-center w-8 h-8 mx-auto border-2 rounded transition-colors ".concat(r?"bg-orange-500 text-white border-orange-500":"border-gray-300 hover:border-orange-400"),children:r?(0,Pn.jsx)("span",{className:"text-white font-bold text-lg",children:"\u2717"}):(0,Pn.jsx)("span",{className:"text-gray-300 text-lg",children:"\u25a1"})})},t)})]}),"criteria"===E&&(()=>{const e=s.criteria||{},t=Object.values(e).filter(e=>!1!==e.evaluated);if(0===t.length)return(0,Pn.jsxs)("tr",{className:"bg-yellow-50 border-t-2 border-yellow-200",children:[(0,Pn.jsx)("td",{className:"px-4 py-2 text-sm font-semibold text-gray-700 border",children:"\ud83d\udcca Moyenne des croix"}),(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:"-"}),(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:"-"}),(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:"-"}),(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:"-"}),(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:"-"})]});let r=0,a=0,n=0,i=0;t.forEach(e=>{e.N1&&r++,e.N2&&a++,e.N3&&n++,e.N4&&i++});const l=r+a+n+i;let o="",c="";if(l>0){const e=(1*r+2*a+3*n+4*i)/l;o="\u2717",c="text-red-600";const t=e<=1.5?o:"",s=e>1.5&&e<=2.5?o:"",d=e>2.5&&e<=3.5?o:"",u=e>3.5?o:"";return(0,Pn.jsxs)("tr",{className:"bg-blue-50 border-t-2 border-blue-200",children:[(0,Pn.jsxs)("td",{className:"px-4 py-2 text-sm font-semibold text-blue-700 border",children:["\ud83d\udcca Moyenne des croix (",Math.round(100*e)/100,")"]}),(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:(0,Pn.jsx)("span",{className:"text-green-600 font-bold",children:"\u2713"})}),(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:(0,Pn.jsx)("span",{className:"font-bold text-lg ".concat(c),children:t})}),(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:(0,Pn.jsx)("span",{className:"font-bold text-lg ".concat(c),children:s})}),(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:(0,Pn.jsx)("span",{className:"font-bold text-lg ".concat(c),children:d})}),(0,Pn.jsx)("td",{className:"px-4 py-2 text-center border",children:(0,Pn.jsx)("span",{className:"font-bold text-lg ".concat(c),children:u})})]})}return null})(),Object.entries(s.criteria||{}).map(t=>{let[r,a]=t;return(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("td",{className:"px-4 py-3 text-base text-gray-900 border align-top",children:r}),(0,Pn.jsx)("td",{className:"px-4 py-3 text-center border",children:"criteria"===E?(0,Pn.jsx)("input",{type:"checkbox",checked:!1!==(a||{}).evaluated,onChange:t=>((e,t,r)=>{d(a=>{var n;const s=qe({},a);s[e]||(s[e]={score:0,comments:"",criteria:qe({},P[e]||{})}),s[e].criteria[t].evaluated=r,r||Object.keys(s[e].criteria[t]).forEach(r=>{"evaluated"!==r&&(s[e].criteria[t][r]=!1)});const i={N1:0,N2:.4,N3:.75,N4:1};let l=0,o=0;Object.entries(s[e].criteria).forEach(e=>{let[t,r]=e;!1!==r.evaluated&&(o++,Object.entries(r).forEach(e=>{let[t,r]=e;r&&"evaluated"!==t&&(l+=i[t])}))});const c=(null===(n=R[e])||void 0===n?void 0:n.maxScore)||0;if(o>0&&c>0){const t=l/o;let r;r=t<=.2?0:t<=.575?.4:t<=.875?.75:1,s[e].score=Math.round(r*c*100)/100}else s[e].score=0;return s})})(e,r,t.target.checked),className:"w-5 h-5 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}):(0,Pn.jsx)("span",{className:"text-gray-400",children:"-"})}),Object.entries(a||{}).filter(e=>{let[t]=e;return"evaluated"!==t}).map(t=>{let[n,s]=t;return(0,Pn.jsx)("td",{className:"px-4 py-3 text-center border",children:"criteria"===E?(0,Pn.jsx)("button",{type:"button",onClick:()=>((e,t,r)=>{d(a=>{var n;const s=qe({},a);s[e]||(s[e]={score:0,comments:"",criteria:qe({},P[e]||{})}),Object.keys(s[e].criteria[t]).forEach(r=>{"evaluated"!==r&&(s[e].criteria[t][r]=!1)}),s[e].criteria[t][r]=!0,s[e].criteria[t].evaluated=!0;const i={N1:0,N2:.4,N3:.75,N4:1};let l=0,o=0;Object.entries(s[e].criteria).forEach(e=>{let[t,r]=e;if(!1!==r.evaluated){o++;let e=0;Object.entries(r).forEach(t=>{let[r,a]=t;a&&"evaluated"!==r&&i[r]>e&&(e=i[r])}),l+=e}});const c=(null===(n=R[e])||void 0===n?void 0:n.maxScore)||0;if(o>0&&c>0){const t=l/o;let r;r=t<=.2?0:t<=.575?.4:t<=.875?.75:1,s[e].score=Math.round(r*c*100)/100}else s[e].score=0;return s})})(e,r,n),className:"flex items-center justify-center w-8 h-8 mx-auto border-2 border-gray-300 rounded hover:border-gray-400 transition-colors",disabled:!1===(a||{}).evaluated,children:s?(0,Pn.jsx)("span",{className:"text-green-600 font-bold text-lg",children:"\u2713"}):(0,Pn.jsx)("span",{className:"text-gray-300 text-lg",children:"\u25a1"})}):(0,Pn.jsx)("span",{className:"text-gray-300 text-lg",children:"\u25a1"})},n)})]},r)})]})]})}),(0,Pn.jsxs)("div",{className:"mt-4",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commentaires"}),(0,Pn.jsx)("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:"3",placeholder:"Observations, remarques...",value:s.comments,onChange:t=>((e,t)=>{d(r=>qe(qe({},r),{},{[e]:qe(qe({},r[e]),{},{comments:t})}))})(e,t.target.value)})]})]},e):(console.warn("\u274c Crit\xe8res manquants pour ".concat(e,", ignorer")),null)}),"direct"===E&&(0,Pn.jsxs)("div",{className:"card bg-gradient-to-r from-orange-50 to-yellow-50 border-orange-200",children:[(0,Pn.jsxs)("div",{className:"mb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-orange-900",children:"\u26a1 R\xe9sum\xe9 des comp\xe9tences \xe9valu\xe9es"}),(0,Pn.jsx)("p",{className:"text-sm text-orange-700",children:"Statut des comp\xe9tences en mode d'\xe9valuation directe"})]}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:Object.keys(R||{}).map(e=>{var t,r;const a=T[e]||{N1:!1,N2:!1,N3:!1,N4:!1},n=a.N1||a.N2||a.N3||a.N4,s=a.N1?"N1":a.N2?"N2":a.N3?"N3":a.N4?"N4":null;return(0,Pn.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("div",{className:"font-medium text-gray-900",children:e}),(0,Pn.jsxs)("div",{className:"text-xs text-gray-500",children:[null===(t=R[e])||void 0===t||null===(r=t.name)||void 0===r?void 0:r.substring(0,30),"..."]})]}),(0,Pn.jsx)("div",{className:"text-right",children:n?(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["\u2713 ",s]}),(0,Pn.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"N1"===s?"0%":"N2"===s?"40%":"N3"===s?"75%":"100%"})]}):(0,Pn.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"\u23f3 Non \xe9valu\xe9e"})})]},e)})})]}),(0,Pn.jsxs)("div",{className:"card bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:[(0,Pn.jsxs)("div",{className:"mb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-blue-900",children:"Note globale de l'\xe9valuation"}),(0,Pn.jsx)("p",{className:"text-sm text-blue-700",children:"Note calcul\xe9e automatiquement sur 20 points"})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-blue-900 mb-2",children:"Note globale calcul\xe9e"}),(0,Pn.jsxs)("div",{className:"text-3xl font-bold text-blue-600",children:[u.toFixed(2),"/20"]}),(0,Pn.jsx)("p",{className:"text-sm text-blue-600 mt-1",children:"Bas\xe9e sur la moyenne pond\xe9r\xe9e des comp\xe9tences"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-blue-900 mb-2",children:"Commentaires g\xe9n\xe9raux"}),(0,Pn.jsx)("textarea",{className:"w-full px-3 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",rows:"4",placeholder:"Commentaires g\xe9n\xe9raux sur l'\xe9valuation compl\xe8te...",value:h,onChange:e=>m(e.target.value)})]})]}),(0,Pn.jsxs)("div",{className:"mt-4 p-3 bg-blue-100 rounded-lg",children:[(0,Pn.jsx)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"R\xe9partition des notes :"}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:Object.entries(c).map(e=>{let[t,r]=e;return(0,Pn.jsxs)("div",{className:"flex justify-between",children:[(0,Pn.jsxs)("span",{className:"text-blue-700",children:[t,":"]}),(0,Pn.jsxs)("span",{className:"font-medium text-blue-900",children:[r.score.toFixed(2),"/",(R[t]||{}).maxScore||0]})]},t)})})]})]}),(0,Pn.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,Pn.jsxs)("button",{type:"button",onClick:()=>{if("U51"===n){const e=window.open("","_blank"),r=(()=>{let e="\n      <div class=\"header\">\n        <h1>FICHE D'\xc9VALUATION DES COMP\xc9TENCES U51</h1>\n        <p>\xc9preuve d'analyse, diagnostic et maintenance - Date : ".concat((new Date).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}),'</p>\n      </div>\n\n      <div class="student-info">\n        <p><strong>Nom et pr\xe9nom :</strong> ').concat((null===t||void 0===t?void 0:t.student_name)||"".concat(null===t||void 0===t?void 0:t.first_name," ").concat(null===t||void 0===t?void 0:t.last_name)," &nbsp;&nbsp;&nbsp; <strong>Classe :</strong> ").concat((null===t||void 0===t?void 0:t.class_name)||(null===t||void 0===t?void 0:t.class)||"Non renseign\xe9"," &nbsp;&nbsp;&nbsp; <strong>Groupe :</strong> ").concat((null===t||void 0===t?void 0:t.group_name)||"Non assign\xe9","</p>\n        <p><strong>Nom de l'activit\xe9 :</strong> ").concat(x||"Non renseign\xe9",'</p>\n      </div>\n\n              <table>\n          <thead>\n            <tr>\n              <th style="width: 80%;">Indicateurs d\'\xe9valuation</th>\n              <th style="width: 4%;">E</th>\n              <th style="width: 4%;">N1<br/>0%</th>\n              <th style="width: 4%;">N2<br/>40%</th>\n              <th style="width: 4%;">N3<br/>75%</th>\n              <th style="width: 4%;">N4<br/>100%</th>\n            </tr>\n          </thead>\n        <tbody>\n    ');return Object.entries({C2:{name:"Extraire les informations n\xe9cessaires \xe0 la r\xe9alisation des t\xe2ches",criteria:["La demande client/utilisateur est analys\xe9e","Les informations n\xe9cessaires \xe0 l'analyse et aux mesures sont extraites des documents","Les informations relatives aux prescriptions techniques et aux r\xe9glementations sont recueillies","Les conditions de la maintenance sont prises en compte","Les risques professionnels sont identifi\xe9s","Les habilitations et les certifications sont v\xe9rifi\xe9es","Les informations \xe9crites et orales n\xe9cessaires sont collect\xe9es et hi\xe9rarchis\xe9es","Les informations \xe9crites et orales collect\xe9es sont pertinentes pour l'activit\xe9"]},C13:{name:"Mesurer les grandeurs caract\xe9ristiques d'un ouvrage, d'une installation, d'un \xe9quipement \xe9lectrique",criteria:["La proc\xe9dure d\xe9finie est appliqu\xe9e","L'installation et l'environnement de travail sont pris en compte","Le niveau d'habilitation n\xe9cessaire avant l'intervention est d\xe9termin\xe9","Les actions de pr\xe9vention et de s\xe9curit\xe9 sont mises en \u0153uvre","Les appareils de mesures sont install\xe9s","Les mesures sont collect\xe9es","Les enregistrements sont r\xe9alis\xe9s","Les informations venant des objets connect\xe9s sont exploit\xe9es","Les contr\xf4les (locaux ou \xe0 distance) sont effectu\xe9s","Les essais associ\xe9s sont effectu\xe9s"]},C17:{name:"R\xe9aliser un diagnostic de performance y compris \xe9nerg\xe9tique, de s\xe9curit\xe9, d'un ouvrage, d'une installation, d'un \xe9quipement \xe9lectrique",criteria:["Le processus de diagnostic est appliqu\xe9","Les conditions de la maintenance sont prises en compte","Le niveau d'habilitation n\xe9cessaire est d\xe9termin\xe9","Les appareils de mesures sont s\xe9lectionn\xe9s et install\xe9s","Les actions de pr\xe9vention et de s\xe9curit\xe9 sont mises en \u0153uvre","Les mesures sont collect\xe9es et enregistr\xe9es","Les informations venant des objets connect\xe9s sont collect\xe9es et enregistr\xe9es","Le diagnostic est pertinent","Suite au diagnostic, des modifications de l'installation sont propos\xe9es","Suite au diagnostic, des recommandations, des r\xe9glages, des am\xe9liorations de l'installation sont propos\xe9es"]},C18:{name:"R\xe9aliser des op\xe9rations de maintenance sur un ouvrage, une installation, un \xe9quipement \xe9lectrique",criteria:["Le protocole de maintenance est pris en compte","Le niveau d'habilitation n\xe9cessaire est d\xe9termin\xe9","Les actions de pr\xe9vention et de s\xe9curit\xe9 sont mises en \u0153uvre","La zone d'intervention est pr\xe9par\xe9e","Les op\xe9rations de maintenance pr\xe9ventive sont r\xe9alis\xe9es","Le dysfonctionnement est diagnostiqu\xe9","Les op\xe9rations de d\xe9pannage sont r\xe9alis\xe9es","Les contr\xf4les (locaux ou \xe0 distance) sont effectu\xe9s","Les essais associ\xe9s sont effectu\xe9s","Le fonctionnement de l'installation est v\xe9rifi\xe9 par rapport aux prescriptions","Les fiches de contr\xf4les, carnet de maintenance et/ou applications sp\xe9cifiques sont compl\xe9t\xe9es"]}}).forEach(t=>{let[r,a]=t;const n=c[r],s=(null===n||void 0===n?void 0:n.score)||0;e+='\n            <tr>\n              <td colspan="6" class="competence-header">\n                '.concat(r," - ").concat(a.name," - Note: ").concat(s,"/5\n              </td>\n            </tr>\n          ");const i=(()=>{if(null===n||void 0===n||!n.criteria)return{avgN1:"",avgN2:"",avgN3:"",avgN4:"",averageText:"Aucune \xe9valuation"};const e=n.criteria,t=Object.values(e).filter(e=>!1!==e.evaluated);if(0===t.length)return{avgN1:"",avgN2:"",avgN3:"",avgN4:"",averageText:"Non \xe9valu\xe9"};let r=0,a=0,s=0,i=0;t.forEach(e=>{e.N1&&r++,e.N2&&a++,e.N3&&s++,e.N4&&i++});const l=r+a+s+i;if(0===l)return{avgN1:"",avgN2:"",avgN3:"",avgN4:"",averageText:"Aucune croix"};const o=(1*r+2*a+3*s+4*i)/l;let c="",d="",u="",f="";return o<=1.5?c="\u2717":o<=2.5?d="\u2717":o<=3.5?u="\u2717":f="\u2717",{avgN1:c,avgN2:d,avgN3:u,avgN4:f,averageText:"Moyenne (".concat(Math.round(100*o)/100,")")}})();e+='\n            <tr style="background-color: #e3f2fd;">\n              <td class="criteria-cell" style="font-weight: bold; color: #1976d2;">\n                \ud83d\udcca '.concat(i.averageText,'\n              </td>\n              <td class="cross" style="background-color: #e3f2fd;">\u2713</td>\n              <td class="cross" style="background-color: #e3f2fd;">').concat(i.avgN1,'</td>\n              <td class="cross" style="background-color: #e3f2fd;">').concat(i.avgN2,'</td>\n              <td class="cross" style="background-color: #e3f2fd;">').concat(i.avgN3,'</td>\n              <td class="cross" style="background-color: #e3f2fd;">').concat(i.avgN4,"</td>\n            </tr>\n          "),a.criteria.forEach((t,r)=>{var a;const s=null===n||void 0===n||null===(a=n.criteria)||void 0===a?void 0:a[t],i=!1!==(null===s||void 0===s?void 0:s.evaluated);e+='\n            <tr>\n              <td class="criteria-cell">'.concat(t,'</td>\n              <td class="cross">').concat(i?"\u2713":"",'</td>\n              <td class="cross">').concat(null!==s&&void 0!==s&&s.N1?"\u2717":"",'</td>\n              <td class="cross">').concat(null!==s&&void 0!==s&&s.N2?"\u2717":"",'</td>\n              <td class="cross">').concat(null!==s&&void 0!==s&&s.N3?"\u2717":"",'</td>\n              <td class="cross">').concat(null!==s&&void 0!==s&&s.N4?"\u2717":"","</td>\n            </tr>\n          ")})}),e+='\n        </tbody>\n      </table>\n\n      <div class="global-note">\n        Note globale : '.concat(u,"/20\n      </div>\n    "),h&&(e+='\n        <div style="margin-top: 20px;">\n          <h4>Commentaires :</h4>\n          <div style="border: 1px solid #000; padding: 10px; min-height: 50px;">\n            '.concat(h,"\n          </div>\n        </div>\n      ")),e})();e.document.write("\n      <!DOCTYPE html>\n      <html>\n        <head>\n            <title>Fiche d'\xe9valuation U51 - ".concat((null===t||void 0===t?void 0:t.student_name)||"".concat(null===t||void 0===t?void 0:t.first_name," ").concat(null===t||void 0===t?void 0:t.last_name),"</title>\n          <style>\n            @media print {\n              @page {\n                size: A4 portrait;\n                  margin-top: 2cm;\n                  margin-left: 10mm;\n                  margin-right: 10mm;\n                  margin-bottom: 10mm;\n              }\n              body {\n                margin: 0;\n                padding: 0;\n                font-family: Arial, sans-serif;\n                  font-size: 9pt;\n                  line-height: 1.1;\n              }\n              }\n              body {\n                font-family: Arial, sans-serif;\n                font-size: 9pt;\n                line-height: 1.1;\n                margin: 0;\n                padding: 8px;\n              }\n              table {\n                width: 100%;\n                border-collapse: collapse;\n                margin-bottom: 6px;\n              }\n              th, td {\n                border: 1px solid #000;\n                padding: 2px;\n                text-align: left;\n                vertical-align: top;\n                font-size: 8pt;\n              }\n              th {\n                background-color: #f0f0f0;\n                font-weight: bold;\n                text-align: center;\n                line-height: 1.0;\n              }\n              .competence-header {\n                background-color: #e0e0e0 !important;\n                font-weight: bold;\n                text-align: left;\n                padding: 3px;\n                font-size: 9pt;\n              }\n              .criteria-cell {\n                padding-left: 8px;\n                font-size: 9pt;\n                line-height: 1.0;\n              }\n              .cross {\n                color: red;\n                font-weight: bold;\n                font-size: 10pt;\n                text-align: center;\n              }\n              .student-info {\n                border: 1px solid #000;\n                padding: 2px 4px;\n                margin-bottom: 4px;\n                background-color: #f9f9f9;\n                font-size: 10pt;\n                line-height: 1.0;\n              }\n              .student-info p {\n                margin: 1px 0;\n              }\n              .global-note {\n                border: 2px solid #000;\n                padding: 6px;\n                text-align: center;\n                font-weight: bold;\n                font-size: 10pt;\n                margin-top: 6px;\n              }\n              .header {\n                text-align: center;\n                margin-bottom: 6px;\n              }\n              .header h1 {\n                margin: 0 0 2px 0;\n                font-size: 11pt;\n                font-weight: bold;\n              }\n              .header p {\n                margin: 0;\n                font-size: 7pt;\n                color: #666;\n            }\n          </style>\n        </head>\n        <body>\n          ").concat(r,"\n            <script>\n              window.onload = function() {\n                window.print();\n                window.onafterprint = function() {\n                  window.close();\n                };\n              };\n            <\/script>\n        </body>\n      </html>\n    ")),e.document.close()}else k(!0)},className:"btn btn-outline flex items-center",title:"Imprimer la fiche d'\xe9valuation",children:[(0,Pn.jsx)(Vs,{className:"h-4 w-4 mr-2"}),"Imprimer"]}),(0,Pn.jsxs)("button",{type:"button",onClick:async()=>{try{if(!t||!t.id)return Rt.error("Erreur: Informations \xe9tudiant manquantes"),void console.error("\u274c Student object invalide:",t);if(!c||0===Object.keys(c).length)return void Rt.error("Erreur: Aucune \xe9valuation \xe0 sauvegarder");if(!p)return void Rt.error("Erreur: Veuillez saisir la date et heure d'\xe9valuation");if(!x.trim())return void Rt.error("Erreur: Veuillez saisir le nom de l'activit\xe9");if(!b)return void Rt.error("Erreur: Veuillez s\xe9lectionner le type d'activit\xe9");let e="";e="Activit\xe9s observ\xe9es en entreprise"===b?"entreprise":"Activit\xe9s observ\xe9es en centre de formation"===b?"centre":b;const r=Object.entries(c).map(r=>{let[a,s]=r,i=s.score;if("direct"===E&&T[a]){var l;const e=T[a],t=(null===(l=R[a])||void 0===l?void 0:l.maxScore)||5;i=e.N1?0:e.N2?.4*t:e.N3?.75*t:e.N4?t:0,console.log("\ud83d\udcca Mode direct - ".concat(a,": ").concat(e.N1?"N1":e.N2?"N2":e.N3?"N3":e.N4?"N4":"Aucune"," -> ").concat(i,"/").concat(t))}const o={student_id:parseInt(t.id),project_id:t.project_id?parseInt(t.project_id):null,competence:a,score:i,comments:s.comments,global_comments:h,criteria:JSON.stringify(s.criteria),type:n,evaluated_at:p,activity_name:x,activity_type:e};return console.log("\ud83d\udce4 Envoi \xe9valuation ".concat(a,":"),{competence:a,global_comments:h,global_comments_type:typeof h,global_comments_length:h?h.length:0}),o});if(a){const e=a.evaluated_at||p;await Rn.delete("/api/evaluations/student/".concat(t.id,"?type=").concat(n,"&evaluated_at=").concat(encodeURIComponent(e)));const s=r.map(e=>Rn.post("/api/evaluations",e,{headers:{"Content-Type":"application/json"}}));await Promise.all(s)}else{console.log("\ud83c\udd95 CR\xc9ATION de nouvelles \xe9valuations:",r.length,"\xe9valuations"),console.log("\ud83d\udcca Donn\xe9es \xe0 sauvegarder:",r);const e=r.map((e,t)=>(console.log("\ud83d\udcbe Sauvegarde \xe9valuation ".concat(t+1,"/").concat(r.length,":"),{student_id:e.student_id,competence:e.competence,score:e.score,type:e.type,evaluated_at:e.evaluated_at,activity_name:e.activity_name}),Rn.post("/api/evaluations",e,{headers:{"Content-Type":"application/json"}}))),t=await Promise.all(e);console.log("\u2705 Toutes les \xe9valuations sauvegard\xe9es:",t.length,"r\xe9sultats"),t.forEach((e,t)=>{console.log("\u2705 \xc9valuation ".concat(t+1," sauvegard\xe9e:"),e.data)})}Rt.success("\xc9valuation sauvegard\xe9e avec succ\xe8s"),i&&i(r)}catch(s){var e,r;console.error("\u274c Erreur compl\xe8te lors de la sauvegarde:",s);const t=(null===(e=s.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||s.message||"Erreur inconnue";Rt.error("Erreur lors de la sauvegarde: ".concat(t))}},className:"btn btn-primary flex items-center",children:[(0,Pn.jsx)(Hs,{className:"h-4 w-4 mr-2"}),"Sauvegarder l'\xe9valuation"]})]}),j&&w&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-4 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>k(!1)}),(0,Pn.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-6xl sm:w-full",children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsxs)("div",{className:"mb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Pr\xe9visualisation de l'impression"}),(0,Pn.jsxs)("p",{className:"text-sm text-gray-500",children:["Aper\xe7u de la fiche d'\xe9valuation pour ",(null===t||void 0===t?void 0:t.student_name)||"".concat(null===t||void 0===t?void 0:t.first_name," ").concat(null===t||void 0===t?void 0:t.last_name)]})]}),(0,Pn.jsx)("div",{className:"max-h-[70vh] overflow-y-auto border border-gray-200 rounded-lg",children:w?(0,Pn.jsx)("div",{ref:C,children:(0,Pn.jsx)(Ws,{student:t,evaluations:c,globalScore:u,globalComments:h,competenceInfo:R,evaluationType:n,evaluationMode:E,directNotes:T,onEdit:()=>{k(!1)}})}):(0,Pn.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,Pn.jsx)("p",{className:"text-gray-600",children:"Chargement des donn\xe9es d'\xe9valuation..."})]})})})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsxs)("button",{type:"button",onClick:()=>{const e=C.current.innerHTML,t=document.createElement("div");t.innerHTML='\n      <style>\n        @media print {\n          body * {\n            visibility: hidden;\n          }\n          .print-content, .print-content * {\n            visibility: visible;\n          }\n          .print-content {\n            position: absolute;\n            left: 0;\n            top: 0;\n            width: 100%;\n          }\n          @page {\n            size: A4 portrait;\n            margin: 20mm;\n          }\n          .print-content {\n            font-family: Arial, sans-serif;\n            font-size: 10pt;\n            line-height: 1.2;\n          }\n        }\n      </style>\n      <div class="print-content">\n        '.concat(e,"\n      </div>\n    "),t.style.position="absolute",t.style.top="-9999px",t.style.left="-9999px",document.body.appendChild(t),window.print(),setTimeout(()=>{document.body.removeChild(t)},1e3),k(!1),Rt.success("Impression lanc\xe9e")},disabled:!w,className:"btn sm:ml-3 sm:w-auto flex items-center ".concat(w?"btn-primary":"btn-secondary opacity-50 cursor-not-allowed"),children:[(0,Pn.jsx)(Vs,{className:"h-4 w-4 mr-2"}),w?"Imprimer":"Chargement..."]}),(0,Pn.jsx)("button",{type:"button",className:"btn btn-secondary sm:ml-3 sm:w-auto",onClick:()=>k(!1),children:"Annuler"})]})]})]})})]}):(0,Pn.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Pn.jsx)("div",{className:"text-gray-500",children:"Aucun \xe9tudiant s\xe9lectionn\xe9"})})},Gs=Vn("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),$s=e=>{let{isOpen:t,onClose:r,onSave:a}=e;console.log("\ud83d\udd0d TPSheetModal render - isOpen:",t);const[n,i]=(0,s.useState)({title:"FICHE DE TRAVAUX PRATIQUES",subtitle:"Titre de la fiche",objective:"Objectif :",equipment:"Mat\xe9riel n\xe9cessaire :",procedure:"Proc\xe9dure :",observations:"Observations :",conclusion:"Conclusion :"}),[l,o]=(0,s.useState)(null),c=e=>{o(e)},d=(e,t)=>{i(r=>qe(qe({},r),{},{[e]:t}))};return t?(console.log("\u2705 Modal ouvert - isOpen:",t),(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",style:{zIndex:9999},children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:r}),(0,Pn.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[(0,Pn.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 border-b",children:(0,Pn.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Pn.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Cr\xe9er une Fiche TP"}),(0,Pn.jsxs)("div",{className:"flex space-x-2",children:[(0,Pn.jsxs)("button",{onClick:()=>{console.log("T\xe9l\xe9chargement de la fiche TP:",n)},className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,Pn.jsx)(Is,{className:"h-4 w-4 mr-2"}),"T\xe9l\xe9charger"]}),(0,Pn.jsxs)("button",{onClick:()=>{a(n),r()},className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,Pn.jsx)(Hs,{className:"h-4 w-4 mr-2"}),"Sauvegarder"]}),(0,Pn.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:(0,Pn.jsx)(os,{className:"h-6 w-6"})})]})]})}),(0,Pn.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6",children:(0,Pn.jsxs)("div",{className:"mx-auto bg-white shadow-lg",style:{width:"210mm",height:"297mm",padding:"20mm"},children:[(0,Pn.jsxs)("div",{className:"text-center mb-8",children:[(0,Pn.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2 cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:()=>c("title"),children:"title"===l?(0,Pn.jsx)("input",{type:"text",value:n.title,onChange:e=>d("title",e.target.value),onBlur:()=>o(null),className:"w-full text-center text-2xl font-bold border-none outline-none bg-transparent",autoFocus:!0}):n.title}),(0,Pn.jsx)("h2",{className:"text-lg text-gray-700 cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:()=>c("subtitle"),children:"subtitle"===l?(0,Pn.jsx)("input",{type:"text",value:n.subtitle,onChange:e=>d("subtitle",e.target.value),onBlur:()=>o(null),className:"w-full text-center text-lg border-none outline-none bg-transparent",autoFocus:!0}):n.subtitle})]}),(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{className:"border-b pb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3 cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:()=>c("objective"),children:"objective"===l?(0,Pn.jsx)("input",{type:"text",value:n.objective,onChange:e=>d("objective",e.target.value),onBlur:()=>o(null),className:"w-full text-lg font-semibold border-none outline-none bg-transparent",autoFocus:!0}):n.objective}),(0,Pn.jsx)("div",{className:"ml-4",children:(0,Pn.jsx)("textarea",{className:"w-full h-20 p-2 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"D\xe9crivez l'objectif de la fiche TP...",value:n.objective,onChange:e=>d("objective",e.target.value)})})]}),(0,Pn.jsxs)("div",{className:"border-b pb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3 cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:()=>c("equipment"),children:"equipment"===l?(0,Pn.jsx)("input",{type:"text",value:n.equipment,onChange:e=>d("equipment",e.target.value),onBlur:()=>o(null),className:"w-full text-lg font-semibold border-none outline-none bg-transparent",autoFocus:!0}):n.equipment}),(0,Pn.jsx)("div",{className:"ml-4",children:(0,Pn.jsx)("textarea",{className:"w-full h-24 p-2 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Listez le mat\xe9riel n\xe9cessaire...",value:n.equipment,onChange:e=>d("equipment",e.target.value)})})]}),(0,Pn.jsxs)("div",{className:"border-b pb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3 cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:()=>c("procedure"),children:"procedure"===l?(0,Pn.jsx)("input",{type:"text",value:n.procedure,onChange:e=>d("procedure",e.target.value),onBlur:()=>o(null),className:"w-full text-lg font-semibold border-none outline-none bg-transparent",autoFocus:!0}):n.procedure}),(0,Pn.jsx)("div",{className:"ml-4",children:(0,Pn.jsx)("textarea",{className:"w-full h-32 p-2 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"D\xe9crivez la proc\xe9dure \xe9tape par \xe9tape...",value:n.procedure,onChange:e=>d("procedure",e.target.value)})})]}),(0,Pn.jsxs)("div",{className:"border-b pb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3 cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:()=>c("observations"),children:"observations"===l?(0,Pn.jsx)("input",{type:"text",value:n.observations,onChange:e=>d("observations",e.target.value),onBlur:()=>o(null),className:"w-full text-lg font-semibold border-none outline-none bg-transparent",autoFocus:!0}):n.observations}),(0,Pn.jsx)("div",{className:"ml-4",children:(0,Pn.jsx)("textarea",{className:"w-full h-24 p-2 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Notez vos observations...",value:n.observations,onChange:e=>d("observations",e.target.value)})})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3 cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:()=>c("conclusion"),children:"conclusion"===l?(0,Pn.jsx)("input",{type:"text",value:n.conclusion,onChange:e=>d("conclusion",e.target.value),onBlur:()=>o(null),className:"w-full text-lg font-semibold border-none outline-none bg-transparent",autoFocus:!0}):n.conclusion}),(0,Pn.jsx)("div",{className:"ml-4",children:(0,Pn.jsx)("textarea",{className:"w-full h-20 p-2 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Tirez vos conclusions...",value:n.conclusion,onChange:e=>d("conclusion",e.target.value)})})]})]}),(0,Pn.jsxs)("div",{className:"mt-8 pt-4 border-t text-center text-sm text-gray-500",children:[(0,Pn.jsx)("p",{children:"Date : _______________"}),(0,Pn.jsx)("p",{children:"Nom : _______________"}),(0,Pn.jsx)("p",{children:"Signature : _______________"})]})]})})]})]})})):(console.log("\u274c Modal ferm\xe9 - isOpen:",t),null)},Ys=()=>{var e;const{selectedYear:t}=Fn(),[r,a]=(0,s.useState)(!0),[n,i]=(0,s.useState)([]),[l,o]=(0,s.useState)(null),[c,d]=(0,s.useState)([]),[u,f]=(0,s.useState)(null),[h,m]=(0,s.useState)([]),[p,g]=(0,s.useState)(!1),[x,v]=(0,s.useState)(null),[b,y]=(0,s.useState)(!1),[w,N]=(0,s.useState)(""),j=async()=>{try{a(!0),console.log("\ud83d\udd04 R\xe9cup\xe9ration des donn\xe9es...");const l=await Rn.get("/api/classes?school_year=".concat(t));if(l.data.success){i(l.data.data);const t=[];for(const e of l.data.data)try{const r=await Rn.get("/api/classes/".concat(e.id,"/students"));r.data.success&&t.push(...r.data.data)}catch(s){console.error("Erreur lors du chargement des \xe9tudiants de la classe ".concat(e.id,":"),s)}console.log("\ud83d\udc65 \xc9tudiants trouv\xe9s:",t.length);try{console.log("\ud83d\udd04 Appel API /api/evaluations...");const e=await Rn.get("/api/evaluations");if(console.log("\u2705 R\xe9ponse API re\xe7ue:",e.data),e.data.success){console.log("\ud83d\udcca Total \xe9valuations dans la base:",e.data.data.length);const r=[...new Set(e.data.data.map(e=>e.type))];console.log("\ud83d\udd0d Types d'\xe9valuations trouv\xe9s:",r),console.log("\ud83d\udd0d Premi\xe8res \xe9valuations:",e.data.data.slice(0,3));const a=e.data.data.filter(e=>"U51"===e.type),n=e.data.data.filter(e=>"U52"===e.type),s=e.data.data.filter(e=>"U61"===e.type),i=e.data.data.filter(e=>"U62"===e.type);console.log("\ud83d\udcca \xc9valuations U51 trouv\xe9es dans la base:",a.length),console.log("\ud83d\udcca \xc9valuations U52 trouv\xe9es dans la base:",n.length),console.log("\ud83d\udcca \xc9valuations U61 trouv\xe9es dans la base:",s.length),console.log("\ud83d\udcca \xc9valuations U62 trouv\xe9es dans la base:",i.length),a.length>0&&console.log("\ud83d\udd0d D\xe9tail des \xe9valuations U51:",a.map(e=>({id:e.id,student_id:e.student_id,competence:e.competence,score:e.score,type:e.type,evaluated_at:e.evaluated_at,activity_name:e.activity_name,created_at:e.created_at,comments:e.comments})));const l=a.length>0?a:n;console.log("\ud83d\udd27 Utilisation des \xe9valuations pour l'affichage:",l.length,"\xe9valuations de type",l.length>0?l[0].type:"aucune");const o={};a.forEach(e=>{console.log("\ud83d\udd0d \xc9valuation U51 trouv\xe9e:",{id:e.id,student_id:e.student_id,student_id_type:typeof e.student_id,student_name:"".concat(e.first_name," ").concat(e.last_name),type:e.type,competence:e.competence,score:e.score}),o[e.student_id]||(o[e.student_id]=[]),o[e.student_id].push(e)}),console.log("\ud83d\udcca \xc9valuations group\xe9es par \xe9tudiant:",Object.keys(o).length,"\xe9tudiants");const c=[];Object.keys(o).forEach(e=>{const r=o[e],a=t.find(t=>t.id==e);if(console.log("\ud83d\udd0d Traitement \xe9tudiant:",{studentId:e,studentFound:!!a,studentName:a?"".concat(a.first_name," ").concat(a.last_name):"Non trouv\xe9",evaluationsCount:r.length}),a&&r.length>0){const t={};r.forEach(e=>{const r=e.evaluated_at||e.created_at;t[r]||(t[r]=[]),t[r].push(e)}),Object.keys(t).forEach(r=>{const n=t[r],s=k(n),i=n.map(e=>e.global_comments).filter(e=>e&&""!==e.trim()).find(e=>e)||"",l={id:"grid-".concat(e,"-").concat(r,"-").concat(Date.now()),student_id:e,student_name:"".concat(a.first_name," ").concat(a.last_name),type:"U51",created_at:r,calculated_score:s.average,has_evaluations:s.hasEvaluations,global_comments:i,evaluations:n};c.push(l),console.log("\u2705 Grille cr\xe9\xe9e pour:",a.first_name,a.last_name,"session:",r,"global_comments:",i)})}});const d=c.sort((e,t)=>{const r=e.student_name.toLowerCase(),a=t.student_name.toLowerCase();return r.localeCompare(a)});console.log("\ud83d\udcca Grilles U51 cr\xe9\xe9es:",d.length),m(d)}}catch(s){var e,r,n;console.error("\u274c Erreur lors de la r\xe9cup\xe9ration des \xe9valuations:",s),console.error("\u274c D\xe9tails de l'erreur:",{message:s.message,status:null===(e=s.response)||void 0===e?void 0:e.status,statusText:null===(r=s.response)||void 0===r?void 0:r.statusText,url:null===(n=s.config)||void 0===n?void 0:n.url})}}}catch(s){console.error("Erreur lors du chargement des donn\xe9es:",s),console.error("Erreur lors du chargement des donn\xe9es"),alert("Erreur lors du chargement des donn\xe9es")}finally{a(!1)}},k=e=>{if(!e||0===e.length)return{average:0,hasEvaluations:!1};const t=e.filter(e=>null!==e.score&&void 0!==e.score);if(0===t.length)return{average:0,hasEvaluations:!1};const r=[];t.forEach(e=>{e.competence;const t=e.score||0;if(t>0){const e=t/5*20;r.push(e)}});return{average:r.length>0?Math.round(r.reduce((e,t)=>e+t,0)/r.length*100)/100:0,hasEvaluations:!0}};(0,s.useEffect)(()=>{t&&j()},[t]);const E=e=>{console.log("\ud83d\udd27 Cr\xe9ation d'\xe9valuation pour:",e),v({student_id:e.id,student_name:"".concat(e.first_name," ").concat(e.last_name),type:"U51"}),g(!0)},S=e=>{console.log("\ud83d\udda8\ufe0f Impression de la grille:",e);const t=window.open("","_blank"),r=(e=>{var t,r;let a="\n      <div class=\"header\">\n        <h1>FICHE D'\xc9VALUATION DES COMP\xc9TENCES U51</h1>\n        <p>\xc9preuve d'analyse, diagnostic et maintenance - Date : ".concat((new Date).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}),'</p>\n      </div>\n\n      <div class="student-info">\n        <p><strong>Nom et pr\xe9nom :</strong> ').concat(e.student_name," &nbsp;&nbsp;&nbsp; <strong>Classe :</strong> ").concat((null===l||void 0===l?void 0:l.name)||"Non renseign\xe9","</p>\n        <p><strong>Nom de l'activit\xe9 :</strong> ").concat((null===(t=e.evaluations)||void 0===t||null===(r=t[0])||void 0===r?void 0:r.activity_name)||"Non renseign\xe9",'</p>\n      </div>\n\n      <table>\n        <thead>\n          <tr>\n            <th style="width: 80%;">Indicateurs d\'\xe9valuation</th>\n            <th style="width: 4%;">E</th>\n            <th style="width: 4%;">N1<br/>0%</th>\n            <th style="width: 4%;">N2<br/>40%</th>\n            <th style="width: 4%;">N3<br/>75%</th>\n            <th style="width: 4%;">N4<br/>100%</th>\n          </tr>\n        </thead>\n        <tbody>\n    ');return Object.entries({C2:{name:"Extraire les informations n\xe9cessaires \xe0 la r\xe9alisation des t\xe2ches",criteria:["La demande client/utilisateur est analys\xe9e","Les informations n\xe9cessaires \xe0 l'analyse et aux mesures sont extraites des documents","Les informations relatives aux prescriptions techniques et aux r\xe9glementations sont recueillies","Les conditions de la maintenance sont prises en compte","Les risques professionnels sont identifi\xe9s","Les habilitations et les certifications sont v\xe9rifi\xe9es","Les informations \xe9crites et orales n\xe9cessaires sont collect\xe9es et hi\xe9rarchis\xe9es","Les informations \xe9crites et orales collect\xe9es sont pertinentes pour l'activit\xe9"]},C13:{name:"Mesurer les grandeurs caract\xe9ristiques d'un ouvrage, d'une installation, d'un \xe9quipement \xe9lectrique",criteria:["La proc\xe9dure d\xe9finie est appliqu\xe9e","L'installation et l'environnement de travail sont pris en compte","Le niveau d'habilitation n\xe9cessaire avant l'intervention est d\xe9termin\xe9","Les actions de pr\xe9vention et de s\xe9curit\xe9 sont mises en \u0153uvre","Les appareils de mesures sont install\xe9s","Les mesures sont collect\xe9es","Les enregistrements sont r\xe9alis\xe9s","Les informations venant des objets connect\xe9s sont exploit\xe9es","Les contr\xf4les (locaux ou \xe0 distance) sont effectu\xe9s","Les essais associ\xe9s sont effectu\xe9s"]},C17:{name:"R\xe9aliser un diagnostic de performance y compris \xe9nerg\xe9tique, de s\xe9curit\xe9, d'un ouvrage, d'une installation, d'un \xe9quipement \xe9lectrique",criteria:["Le processus de diagnostic est appliqu\xe9","Les conditions de la maintenance sont prises en compte","Le niveau d'habilitation n\xe9cessaire est d\xe9termin\xe9","Les appareils de mesures sont s\xe9lectionn\xe9s et install\xe9s","Les actions de pr\xe9vention et de s\xe9curit\xe9 sont mises en \u0153uvre","Les mesures sont collect\xe9es et enregistr\xe9es","Les informations venant des objets connect\xe9s sont collect\xe9es et enregistr\xe9es","Le diagnostic est pertinent","Suite au diagnostic, des modifications de l'installation sont propos\xe9es","Suite au diagnostic, des recommandations, des r\xe9glages, des am\xe9liorations de l'installation sont propos\xe9es"]},C18:{name:"R\xe9aliser des op\xe9rations de maintenance sur un ouvrage, une installation, un \xe9quipement \xe9lectrique",criteria:["Le protocole de maintenance est pris en compte","Le niveau d'habilitation n\xe9cessaire est d\xe9termin\xe9","Les actions de pr\xe9vention et de s\xe9curit\xe9 sont mises en \u0153uvre","La zone d'intervention est pr\xe9par\xe9e","Les op\xe9rations de maintenance pr\xe9ventive sont r\xe9alis\xe9es","Le dysfonctionnement est diagnostiqu\xe9","Les op\xe9rations de d\xe9pannage sont r\xe9alis\xe9es","Les contr\xf4les (locaux ou \xe0 distance) sont effectu\xe9s","Les essais associ\xe9s sont effectu\xe9s","Le fonctionnement de l'installation est v\xe9rifi\xe9 par rapport aux prescriptions","Les fiches de contr\xf4les, carnet de maintenance et/ou applications sp\xe9cifiques sont compl\xe9t\xe9es"]}}).forEach(t=>{var r;let[n,s]=t;const i=null===(r=e.evaluations)||void 0===r?void 0:r.find(e=>e.competence===n),l=(null===i||void 0===i?void 0:i.score)||0;a+='\n        <tr>\n          <td colspan="6" class="competence-header">\n            '.concat(n," - ").concat(s.name," - Note: ").concat(l,"/5\n          </td>\n        </tr>\n      "),s.criteria.forEach((e,t)=>{a+='\n          <tr>\n            <td class="criteria-cell">'.concat(e,'</td>\n            <td class="cross">\u2713</td>\n            <td class="cross">').concat(l>=1?"\u2717":"",'</td>\n            <td class="cross">').concat(l>=2?"\u2717":"",'</td>\n            <td class="cross">').concat(l>=3?"\u2717":"",'</td>\n            <td class="cross">').concat(l>=4?"\u2717":"","</td>\n          </tr>\n        ")})}),a+='\n        </tbody>\n      </table>\n\n      <div class="global-note">\n        Note globale : '.concat(e.calculated_score||0,"/20\n      </div>\n    "),a})(e);t.document.write("\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Fiche d'\xe9valuation U51 - ".concat(e.student_name,"</title>\n          <style>\n            @media print {\n              @page {\n                size: A4 portrait;\n                margin-top: 2cm;\n                margin-left: 10mm;\n                margin-right: 10mm;\n                margin-bottom: 10mm;\n              }\n              body {\n                margin: 0;\n                padding: 0;\n                font-family: Arial, sans-serif;\n                font-size: 9pt;\n                line-height: 1.1;\n              }\n            }\n            body {\n              font-family: Arial, sans-serif;\n              font-size: 9pt;\n              line-height: 1.1;\n              margin: 0;\n              padding: 8px;\n            }\n            table {\n              width: 100%;\n              border-collapse: collapse;\n              margin-bottom: 6px;\n            }\n            th, td {\n              border: 1px solid #000;\n              padding: 2px;\n              text-align: left;\n              vertical-align: top;\n              font-size: 8pt;\n            }\n            th {\n              background-color: #f0f0f0;\n              font-weight: bold;\n              text-align: center;\n              line-height: 1.0;\n            }\n            .competence-header {\n              background-color: #e0e0e0 !important;\n              font-weight: bold;\n              text-align: left;\n              padding: 3px;\n              font-size: 9pt;\n            }\n            .criteria-cell {\n              padding-left: 8px;\n              font-size: 9pt;\n              line-height: 1.0;\n            }\n            .cross {\n              color: red;\n              font-weight: bold;\n              font-size: 10pt;\n              text-align: center;\n            }\n            .student-info {\n              border: 1px solid #000;\n              padding: 2px 4px;\n              margin-bottom: 4px;\n              background-color: #f9f9f9;\n              font-size: 10pt;\n              line-height: 1.0;\n            }\n            .student-info p {\n              margin: 1px 0;\n            }\n            .global-note {\n              border: 2px solid #000;\n              padding: 6px;\n              text-align: center;\n              font-weight: bold;\n              font-size: 10pt;\n              margin-top: 6px;\n            }\n            .header {\n              text-align: center;\n              margin-bottom: 6px;\n            }\n            .header h1 {\n              margin: 0 0 2px 0;\n              font-size: 11pt;\n              font-weight: bold;\n            }\n            .header p {\n              margin: 0;\n              font-size: 9pt;\n            }\n          </style>\n        </head>\n        <body>\n          ").concat(r,"\n        </body>\n      </html>\n    ")),t.document.close(),t.focus(),setTimeout(()=>{t.print()},500)},T=e=>{console.log("\ud83d\udd0d getStudentEvaluations appel\xe9 avec studentId:",e,"type:",typeof e),console.log("\ud83d\udd0d Toutes les grilles disponibles:",h.map(e=>({id:e.id,student_id:e.student_id,student_id_type:typeof e.student_id,student_name:e.student_name})));const t=h.filter(t=>{const r=parseInt(t.student_id)===parseInt(e);return console.log("\ud83d\udd0d Comparaison:",t.student_id,"===",e,"=",r),r});return console.log("\ud83d\udd0d \xc9valuations trouv\xe9es pour cet \xe9tudiant:",t),t},_=async()=>{console.log("\ud83d\udd04 Rafra\xeechissement apr\xe8s \xe9valuation...");const e=null===u||void 0===u?void 0:u.id;console.log("\ud83d\udd0d \xc9tudiant s\xe9lectionn\xe9 avant rafra\xeechissement:",e),await new Promise(e=>setTimeout(e,3e3));try{if(await j(),e){const t=c.find(t=>t.id===e);t?(console.log("\u2705 Restauration de la s\xe9lection pour:",t.first_name,t.last_name),f(t)):console.log("\u26a0\ufe0f \xc9tudiant non trouv\xe9 apr\xe8s rafra\xeechissement, ID:",e)}console.log("\u2705 Rafra\xeechissement termin\xe9")}catch(t){console.error("\u274c Erreur lors du rafra\xeechissement:",t),await j()}};return r?(0,Pn.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):(0,Pn.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,Pn.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,Pn.jsx)("div",{className:"mb-8",children:(0,Pn.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des \xe9valuations de comp\xe9tences U51"}),(0,Pn.jsx)("p",{className:"mt-2 text-gray-600",children:"\xc9valuez les comp\xe9tences des \xe9tudiants selon le r\xe9f\xe9rentiel U51"})]}),(0,Pn.jsxs)("button",{onClick:()=>{console.log("\ud83d\uddb1\ufe0f Bouton Cr\xe9er une fiche TP cliqu\xe9"),y(!0),console.log("\ud83d\udcdd showTPSheetModal d\xe9fini \xe0 true")},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[(0,Pn.jsx)(us,{className:"h-4 w-4 mr-2"}),"Cr\xe9er une fiche TP"]})]})}),0===n.length?(0,Pn.jsxs)("div",{className:"text-center py-12",children:[(0,Pn.jsx)("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:(0,Pn.jsx)(Hn,{className:"w-12 h-12 text-gray-400"})}),(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune classe trouv\xe9e"}),(0,Pn.jsx)("p",{className:"text-gray-500",children:"Aucune classe n'est disponible pour l'ann\xe9e scolaire s\xe9lectionn\xe9e."})]}):(0,Pn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,Pn.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,Pn.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"S\xe9lectionner une classe"}),(0,Pn.jsxs)("div",{className:"space-y-3",children:[(0,Pn.jsxs)("select",{value:(null===l||void 0===l?void 0:l.id)||"",onChange:e=>{const t=e.target.value,r=n.find(e=>e.id==t);r&&(async e=>{o(e),f(null);try{const t=await Rn.get("/api/classes/".concat(e.id,"/students"));t.data.success&&d(t.data.data)}catch(t){console.error("Erreur lors du chargement des \xe9tudiants:",t),console.error("Erreur lors du chargement des \xe9tudiants"),alert("Erreur lors du chargement des \xe9tudiants")}})(r)},className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:[(0,Pn.jsx)("option",{value:"",children:"-- Choisir une classe --"}),n.map(e=>(0,Pn.jsxs)("option",{value:e.id,children:[e.name," (",e.student_count," \xe9tudiant",e.student_count>1?"s":"",")"]},e.id))]}),l&&(0,Pn.jsxs)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md",children:[(0,Pn.jsx)("div",{className:"font-medium text-blue-900",children:l.name}),(0,Pn.jsxs)("div",{className:"text-sm text-blue-700",children:[l.student_count," \xe9tudiant",l.student_count>1?"s":""]})]})]})]}),l&&(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,Pn.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["\xc9tudiants - ",l.name]}),(0,Pn.jsxs)("div",{className:"relative mb-4",children:[(0,Pn.jsx)(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,Pn.jsx)("input",{type:"text",placeholder:"Rechercher un \xe9tudiant...",value:w,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto",children:c.filter(e=>"".concat(e.first_name," ").concat(e.last_name).toLowerCase().includes(w.toLowerCase())).map(e=>{const t=T(e.id),r=(e=>{const t=T(e);return 0===t.length?null:(t.reduce((e,t)=>e+(t.calculated_score||0),0)/t.length).toFixed(1)})(e.id),a=t.length>0;return(0,Pn.jsx)("div",{onClick:()=>(e=>{f(e)})(e),className:"p-3 rounded-lg border cursor-pointer transition-colors ".concat((null===u||void 0===u?void 0:u.id)===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{className:"flex-1",children:[(0,Pn.jsxs)("div",{className:"font-medium text-gray-900 text-sm",children:[e.first_name," ",e.last_name]}),(0,Pn.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.email})]}),(0,Pn.jsx)("div",{className:"text-right",children:a?(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("div",{className:"text-xs text-gray-600",children:["Moyenne: ",(0,Pn.jsxs)("span",{className:"font-semibold text-blue-600",children:[r,"/20"]})]}),(0,Pn.jsxs)("div",{className:"text-xs text-gray-500",children:[t.length," \xe9val."]})]}):(0,Pn.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"Non \xe9valu\xe9"})})]})},e.id)})})]})]}),(0,Pn.jsx)("div",{className:"lg:col-span-2",children:u?(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:[u.first_name," ",u.last_name]}),(0,Pn.jsx)("p",{className:"text-gray-600",children:u.email})]}),(0,Pn.jsxs)("button",{onClick:()=>E(u),className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-green-700 transition-colors flex items-center",children:[(0,Pn.jsx)(us,{className:"h-4 w-4 mr-2"}),"Cr\xe9er \xe9valuation"]})]})}),(()=>{const e=T(u.id);return console.log("\ud83d\udcca \xc9valuations pour l'\xe9tudiant s\xe9lectionn\xe9:",e),e.length>0?(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,Pn.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,Pn.jsx)(Gs,{className:"h-5 w-5 mr-2"}),"\xc9valuations existantes (",e.length,")"]}),(0,Pn.jsx)("div",{className:"space-y-4",children:e.map(e=>{var t;return(0,Pn.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h4",{className:"font-medium text-gray-900",children:"\xc9valuation U51"}),e.evaluations&&e.evaluations.length>0&&(0,Pn.jsxs)("div",{className:"text-sm text-gray-600 mt-1 font-bold",children:["Activit\xe9: ",e.evaluations[0].activity_name||"Non sp\xe9cifi\xe9e"]}),(0,Pn.jsxs)("p",{className:"text-sm text-gray-500",children:["Cr\xe9\xe9e le ",new Date(e.created_at).toLocaleDateString()]}),e.evaluations&&e.evaluations.length>0&&(0,Pn.jsxs)("p",{className:"text-xs text-gray-500",children:[e.evaluations.length," comp\xe9tence",e.evaluations.length>1?"s":""," \xe9valu\xe9e",e.evaluations.length>1?"s":""]})]}),(0,Pn.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"U51"})]}),(0,Pn.jsxs)("div",{className:"mb-3",children:[(0,Pn.jsxs)("div",{className:"text-sm text-gray-600",children:["Note: ",(0,Pn.jsxs)("span",{className:"font-semibold text-blue-600",children:[(null===(t=e.calculated_score)||void 0===t?void 0:t.toFixed(1))||"0.0","/20"]})]}),(()=>{console.log("\ud83d\udd0d Affichage des commentaires pour grid:",e.id),console.log("\ud83d\udd0d Structure compl\xe8te de la grille:",JSON.stringify(e,null,2));const t=(e=>{if(console.log("\ud83d\udd0d getGeneralComments appel\xe9 pour grid:",e),e.global_comments&&""!==e.global_comments.trim())return console.log("\ud83d\udcdd Commentaires globaux trouv\xe9s au niveau de la grille:",e.global_comments),e.global_comments;if(!e.evaluations||0===e.evaluations.length)return console.log("\u274c Aucune \xe9valuation trouv\xe9e dans la grille"),null;console.log("\ud83d\udcca \xc9valuations dans la grille:",e.evaluations.length),e.evaluations.forEach((e,t)=>{console.log("\ud83d\udcdd \xc9valuation ".concat(t+1,":"),{competence:e.competence,comments:e.comments,global_comments:e.global_comments,commentsType:typeof e.comments,globalCommentsType:typeof e.global_comments,commentsLength:e.comments?e.comments.length:0,globalCommentsLength:e.global_comments?e.global_comments.length:0})});const t=e.evaluations.map(e=>e.global_comments).filter(e=>e&&""!==e.trim()).find(e=>e);if(t)return console.log("\ud83d\udcdd Commentaires g\xe9n\xe9raux trouv\xe9s dans les \xe9valuations:",t),t;const r=e.evaluations.map(e=>e.comments).filter(e=>e&&""!==e.trim()).join(" | ");return console.log("\ud83d\udcdd Commentaires individuels combin\xe9s:",r),r||null})(e);return console.log("\ud83d\udcdd Commentaires r\xe9cup\xe9r\xe9s:",t),t?(0,Pn.jsxs)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:[(0,Pn.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Commentaires g\xe9n\xe9raux:"}),(0,Pn.jsx)("div",{className:"text-base text-gray-600 leading-relaxed",children:t.length>100?"".concat(t.substring(0,100),"..."):t})]}):(0,Pn.jsxs)("div",{className:"mt-2 p-2 bg-yellow-50 rounded-md border border-yellow-200",children:[(0,Pn.jsx)("div",{className:"text-xs text-yellow-700",children:"Aucun commentaire g\xe9n\xe9ral trouv\xe9"}),(0,Pn.jsxs)("div",{className:"text-xs text-yellow-600 mt-1",children:["Debug: ",e.evaluations?"".concat(e.evaluations.length," \xe9valuations"):"Pas d'\xe9valuations"]})]})})()]}),(0,Pn.jsxs)("div",{className:"flex space-x-2",children:[(0,Pn.jsxs)("button",{onClick:()=>(e=>{v(e),g(!0)})(e),className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-700 transition-colors flex items-center justify-center",children:[(0,Pn.jsx)(rs,{className:"h-4 w-4 mr-1"}),"Modifier"]}),(0,Pn.jsx)("button",{onClick:()=>S(e),className:"bg-gray-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-700 transition-colors",children:(0,Pn.jsx)(Vs,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer cette grille d'\xe9valuation ?"))try{console.log("\ud83d\uddd1\ufe0f Suppression de la grille:",e);const t={student_id:e.student_id,type:"U51",evaluated_at:e.created_at};console.log("\ud83d\udce4 Donn\xe9es de suppression:",t),await Rn.delete("/api/evaluations/session/".concat(e.student_id),{data:t}),console.log("\u2705 Grille supprim\xe9e avec succ\xe8s"),alert("Grille supprim\xe9e avec succ\xe8s"),await _()}catch(a){var t,r;console.error("\u274c Erreur lors de la suppression:",a),alert("Erreur lors de la suppression: "+((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||a.message))}})(e),className:"bg-red-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-red-700 transition-colors",children:(0,Pn.jsx)(as,{className:"h-4 w-4"})})]})]},e.id)})})]}):(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 text-center",children:[(0,Pn.jsx)(Gs,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune \xe9valuation"}),(0,Pn.jsx)("p",{className:"text-gray-600 mb-4",children:"Cet \xe9tudiant n'a pas encore d'\xe9valuation U51."}),(0,Pn.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4 mb-4 text-left",children:[(0,Pn.jsx)("h4",{className:"font-medium text-yellow-800 mb-2",children:"\ud83d\udd0d Informations de debug:"}),(0,Pn.jsxs)("div",{className:"text-sm text-yellow-700 space-y-1",children:[(0,Pn.jsxs)("p",{children:["\u2022 Total grilles trouv\xe9es: ",(0,Pn.jsx)("strong",{children:h.length})]}),(0,Pn.jsxs)("p",{children:["\u2022 \xc9tudiant s\xe9lectionn\xe9 ID: ",(0,Pn.jsx)("strong",{children:null===u||void 0===u?void 0:u.id})]}),(0,Pn.jsxs)("p",{children:["\u2022 \xc9valuations pour cet \xe9tudiant: ",(0,Pn.jsx)("strong",{children:e.length})]}),(0,Pn.jsxs)("p",{children:["\u2022 Toutes les grilles: ",h.map(e=>"".concat(e.student_id,"(").concat(e.student_name,")")).join(", ")]})]})]}),(0,Pn.jsxs)("button",{onClick:()=>E(u),className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-green-700 transition-colors flex items-center mx-auto",children:[(0,Pn.jsx)(us,{className:"h-4 w-4 mr-2"}),"Cr\xe9er la premi\xe8re \xe9valuation"]})]})})()]}):(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 text-center",children:[(0,Pn.jsx)(Hn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"S\xe9lectionnez un \xe9tudiant"}),(0,Pn.jsx)("p",{className:"text-gray-600",children:"Choisissez un \xe9tudiant dans la liste de gauche pour voir ses \xe9valuations."})]})})]}),(console.log("\ud83d\udd0d \xc9tat du modal:",{showEvaluationGrid:p,selectedGrid:!!x,studentId:null===x||void 0===x?void 0:x.student_id}),p&&x&&x.student_id&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>{g(!1),v(null)}}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:(0,Pn.jsx)(qs,{student:{id:x.student_id,first_name:x.student_name.split(" ")[0],last_name:x.student_name.split(" ").slice(1).join(" ")},evaluationType:"U51",evaluation:x.evaluations?qe(qe({},x.evaluations[0]),{},{global_comments:(null===(e=x.evaluations[0])||void 0===e?void 0:e.global_comments)||"",existingScores:x.evaluations.reduce((e,t)=>(e[t.competence]={score:t.score,comments:t.comments,criteria:t.criteria},e),{})}):null,onCancel:()=>{g(!1),v(null)},onSave:()=>{g(!1),v(null),_()}})})]})})),(0,Pn.jsx)($s,{isOpen:b,onClose:()=>y(!1),onSave:e=>{console.log("\ud83d\udcbe Sauvegarde de la fiche TP:",e),alert("Fiche TP sauvegard\xe9e avec succ\xe8s !")}})]})})},Ks=()=>{const{selectedYear:e}=Fn(),[t,r]=(0,s.useState)([]),[a,n]=(0,s.useState)([]),[i,l]=(0,s.useState)(null),[o,c]=(0,s.useState)(!0),[d,u]=(0,s.useState)(""),[f,h]=(0,s.useState)(null),m=(0,s.useCallback)(async()=>{try{const t=await Rn.get("/api/classes?school_year=".concat(e));t.data.success&&n(t.data.data)}catch(t){console.error("Erreur lors du chargement des donn\xe9es:",t),sr.error("Erreur lors du chargement des donn\xe9es")}finally{c(!1)}},[]),p=(0,s.useCallback)(async e=>{try{const t=await Rn.get("/api/classes/".concat(e,"/students"));t.data.success&&r(t.data.data)}catch(t){console.error("Erreur lors du chargement des \xe9tudiants de la classe:",t),sr.error("Erreur lors du chargement des \xe9tudiants")}},[]);(0,s.useEffect)(()=>{m()},[m,e]);const g=t.filter(e=>{var t;return e.first_name.toLowerCase().includes(d.toLowerCase())||e.last_name.toLowerCase().includes(d.toLowerCase())||(null===(t=e.class)||void 0===t?void 0:t.toLowerCase().includes(d.toLowerCase()))});return o?(0,Pn.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"U61 - Conception et \xe9tude d\xe9taill\xe9e"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Grille d'\xe9valuation des comp\xe9tences U61"})]}),(0,Pn.jsx)("div",{className:"flex space-x-3",children:f&&(0,Pn.jsxs)("button",{className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 transition-colors",children:[(0,Pn.jsx)(es,{className:"h-4 w-4 mr-2"}),"Nouvelle \xc9valuation"]})})]}),(0,Pn.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"S\xe9lectionner une classe"}),a.length>0?(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:a.map(e=>(0,Pn.jsxs)("div",{onClick:()=>(e=>{l(e),p(e.id)})(e),className:"p-3 rounded-lg border cursor-pointer transition-colors ".concat((null===i||void 0===i?void 0:i.id)===e.id?"bg-blue-50 border-blue-300":"bg-gray-50 border-gray-200 hover:bg-gray-100"),children:[(0,Pn.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,Pn.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]},e.id))}):(0,Pn.jsx)("p",{className:"text-gray-500",children:"Aucune classe disponible"})]}),i?(0,Pn.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,Pn.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:['\xc9tudiants de la classe "',i.name,'" (',t.length,")"]})}):(0,Pn.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,Pn.jsx)("p",{className:"text-yellow-800",children:"Veuillez s\xe9lectionner une classe pour afficher les \xe9tudiants et leurs \xe9valuations."})}),i&&(0,Pn.jsxs)("div",{className:"flex space-x-6 h-screen",children:[(0,Pn.jsxs)("div",{className:"w-1/3 bg-white shadow rounded-lg overflow-hidden",children:[(0,Pn.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"\xc9tudiants"}),(0,Pn.jsx)("div",{className:"mt-4",children:(0,Pn.jsxs)("div",{className:"relative",children:[(0,Pn.jsx)(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,Pn.jsx)("input",{type:"text",placeholder:"Rechercher un \xe9tudiant...",value:d,onChange:e=>u(e.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500"})]})})]}),(0,Pn.jsx)("div",{className:"overflow-y-auto h-full",children:g.map(e=>{const t=(null===f||void 0===f?void 0:f.id)===e.id;return(0,Pn.jsx)("div",{onClick:()=>(e=>{h(e)})(e),className:"p-4 border-b border-gray-100 cursor-pointer transition-colors ".concat(t?"bg-blue-50 border-l-4 border-blue-500":"hover:bg-gray-50 border-l-4 border-transparent"),children:(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,Pn.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:(0,Pn.jsx)(Hn,{className:"h-5 w-5 text-primary-600"})})}),(0,Pn.jsxs)("div",{className:"ml-3",children:[(0,Pn.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,Pn.jsxs)("div",{className:"text-xs text-gray-500",children:[e.class||"Non d\xe9finie"," \u2022 ",e.group_name||"Non assign\xe9"]})]})]}),(0,Pn.jsx)("div",{className:"text-right",children:(0,Pn.jsx)("div",{className:"text-xs text-gray-500",children:"U61 - En attente"})})]})},e.id)})})]}),(0,Pn.jsx)("div",{className:"flex-1 bg-white shadow rounded-lg overflow-hidden",children:f?(0,Pn.jsxs)("div",{className:"h-full flex flex-col",children:[(0,Pn.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["\xc9valuations U61 de ",(0,Pn.jsxs)("span",{className:"text-xl font-bold text-blue-600",children:[f.first_name," ",f.last_name]})]}),(0,Pn.jsxs)("p",{className:"text-sm text-gray-500",children:[f.class||"Non d\xe9finie"," \u2022 ",f.group_name||"Non assign\xe9"]})]})}),(0,Pn.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,Pn.jsxs)("div",{className:"text-center py-12",children:[(0,Pn.jsx)(us,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"En attente des instructions"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"La grille d'\xe9valuation U61 sera configur\xe9e selon vos sp\xe9cifications."})]})})]}):(0,Pn.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)(Hn,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"S\xe9lectionnez un \xe9tudiant"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Choisissez un \xe9tudiant dans la liste pour voir ses \xe9valuations U61."})]})})})]})]})},Xs=()=>{const{selectedYear:e}=Fn(),[t,r]=(0,s.useState)([]),[a,n]=(0,s.useState)([]),[i,l]=(0,s.useState)(null),[o,c]=(0,s.useState)(!0),[d,u]=(0,s.useState)(""),[f,h]=(0,s.useState)(null),m=(0,s.useCallback)(async()=>{try{const t=await Rn.get("/api/classes?school_year=".concat(e));t.data.success&&n(t.data.data)}catch(t){console.error("Erreur lors du chargement des donn\xe9es:",t),sr.error("Erreur lors du chargement des donn\xe9es")}finally{c(!1)}},[]),p=(0,s.useCallback)(async e=>{try{const t=await Rn.get("/api/classes/".concat(e,"/students"));t.data.success&&r(t.data.data)}catch(t){console.error("Erreur lors du chargement des \xe9tudiants de la classe:",t),sr.error("Erreur lors du chargement des \xe9tudiants")}},[]);(0,s.useEffect)(()=>{m()},[m,e]);const g=t.filter(e=>{var t;return e.first_name.toLowerCase().includes(d.toLowerCase())||e.last_name.toLowerCase().includes(d.toLowerCase())||(null===(t=e.class)||void 0===t?void 0:t.toLowerCase().includes(d.toLowerCase()))});return o?(0,Pn.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"U62 - R\xe9alisation et mise en service"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Grille d'\xe9valuation des comp\xe9tences U62"})]}),(0,Pn.jsx)("div",{className:"flex space-x-3",children:f&&(0,Pn.jsxs)("button",{className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 transition-colors",children:[(0,Pn.jsx)(es,{className:"h-4 w-4 mr-2"}),"Nouvelle \xc9valuation"]})})]}),(0,Pn.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"S\xe9lectionner une classe"}),a.length>0?(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:a.map(e=>(0,Pn.jsxs)("div",{onClick:()=>(e=>{l(e),p(e.id)})(e),className:"p-3 rounded-lg border cursor-pointer transition-colors ".concat((null===i||void 0===i?void 0:i.id)===e.id?"bg-blue-50 border-blue-300":"bg-gray-50 border-gray-200 hover:bg-gray-100"),children:[(0,Pn.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,Pn.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]},e.id))}):(0,Pn.jsx)("p",{className:"text-gray-500",children:"Aucune classe disponible"})]}),i?(0,Pn.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,Pn.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:['\xc9tudiants de la classe "',i.name,'" (',t.length,")"]})}):(0,Pn.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,Pn.jsx)("p",{className:"text-yellow-800",children:"Veuillez s\xe9lectionner une classe pour afficher les \xe9tudiants et leurs \xe9valuations."})}),i&&(0,Pn.jsxs)("div",{className:"flex space-x-6 h-screen",children:[(0,Pn.jsxs)("div",{className:"w-1/3 bg-white shadow rounded-lg overflow-hidden",children:[(0,Pn.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"\xc9tudiants"}),(0,Pn.jsx)("div",{className:"mt-4",children:(0,Pn.jsxs)("div",{className:"relative",children:[(0,Pn.jsx)(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,Pn.jsx)("input",{type:"text",placeholder:"Rechercher un \xe9tudiant...",value:d,onChange:e=>u(e.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500"})]})})]}),(0,Pn.jsx)("div",{className:"overflow-y-auto h-full",children:g.map(e=>{const t=(null===f||void 0===f?void 0:f.id)===e.id;return(0,Pn.jsx)("div",{onClick:()=>(e=>{h(e)})(e),className:"p-4 border-b border-gray-100 cursor-pointer transition-colors ".concat(t?"bg-blue-50 border-l-4 border-blue-500":"hover:bg-gray-50 border-l-4 border-transparent"),children:(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,Pn.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:(0,Pn.jsx)(Hn,{className:"h-5 w-5 text-primary-600"})})}),(0,Pn.jsxs)("div",{className:"ml-3",children:[(0,Pn.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,Pn.jsxs)("div",{className:"text-xs text-gray-500",children:[e.class||"Non d\xe9finie"," \u2022 ",e.group_name||"Non assign\xe9"]})]})]}),(0,Pn.jsx)("div",{className:"text-right",children:(0,Pn.jsx)("div",{className:"text-xs text-gray-500",children:"U62 - En attente"})})]})},e.id)})})]}),(0,Pn.jsx)("div",{className:"flex-1 bg-white shadow rounded-lg overflow-hidden",children:f?(0,Pn.jsxs)("div",{className:"h-full flex flex-col",children:[(0,Pn.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["\xc9valuations U62 de ",(0,Pn.jsxs)("span",{className:"text-xl font-bold text-blue-600",children:[f.first_name," ",f.last_name]})]}),(0,Pn.jsxs)("p",{className:"text-sm text-gray-500",children:[f.class||"Non d\xe9finie"," \u2022 ",f.group_name||"Non assign\xe9"]})]})}),(0,Pn.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,Pn.jsxs)("div",{className:"text-center py-12",children:[(0,Pn.jsx)(us,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"En attente des instructions"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"La grille d'\xe9valuation U62 sera configur\xe9e selon vos sp\xe9cifications."})]})})]}):(0,Pn.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)(Hn,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"S\xe9lectionnez un \xe9tudiant"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Choisissez un \xe9tudiant dans la liste pour voir ses \xe9valuations U62."})]})})})]})]})},Js=()=>{const{selectedYear:e}=Fn(),[t,r]=(0,s.useState)([]),[a,n]=(0,s.useState)([]),[i,l]=(0,s.useState)([]),[o,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),[f,h]=(0,s.useState)(null),[m,p]=(0,s.useState)(!0),[g,x]=(0,s.useState)(""),[v,b]=(0,s.useState)(!1),[y,w]=(0,s.useState)(!1),[N,j]=(0,s.useState)(!1),[k,E]=(0,s.useState)(null),S=(0,s.useRef)();(0,s.useEffect)(()=>{_()},[e]);const T=e=>{c(e),(async e=>{try{const t=await Rn.get("/api/classes/".concat(e,"/students"));t.data.success&&n(t.data.data)}catch(t){console.error("Erreur lors du chargement des \xe9tudiants de la classe:",t),sr.error("Erreur lors du chargement des \xe9tudiants")}})(e.id)},_=async()=>{try{p(!0);const[t,a]=await Promise.all([Rn.get("/api/evaluations/grids/all"),Rn.get("/api/classes?school_year=".concat(e))]);if(t.data.success){const e=t.data.data.filter(e=>"U52"===e.type).sort((e,t)=>{const r=e.student_name.toLowerCase(),a=t.student_name.toLowerCase();return r.localeCompare(a)}),a=await Promise.all(e.map(async e=>{try{const t=await Rn.get("/api/evaluations/student/".concat(e.student_id));if(t.data.success&&t.data.data){const r=t.data.data.filter(e=>"U52"===e.type);if(r.length>0){const t=C(r);return qe(qe({},e),{},{calculated_score:t.average,has_evaluations:t.hasEvaluations})}}return qe(qe({},e),{},{calculated_score:0,has_evaluations:!1})}catch(t){return console.error("Erreur lors du recalcul pour la grille:",e.id,t),qe(qe({},e),{},{calculated_score:0,has_evaluations:!1})}}));r(a)}a.data.success&&l(a.data.data)}catch(t){console.error("Erreur lors du chargement des donn\xe9es:",t),sr.error("Erreur lors du chargement des donn\xe9es")}finally{p(!1)}},C=e=>{if(!e||0===e.length)return{average:0,hasEvaluations:!1};const t={};e.forEach(e=>{t[e.evaluated_at]||(t[e.evaluated_at]=[]),t[e.evaluated_at].push(e)});const r=Object.values(t).filter(e=>e.length>=4).map(e=>e.reduce((e,t)=>e+(t.score||0),0)/e.length);if(0===r.length)return{average:0,hasEvaluations:!1};return{average:r.reduce((e,t)=>e+t,0)/r.length,hasEvaluations:!0,sessionCount:r.length}},A=e=>{u(e),b(!0)},O=async e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer cette grille d'\xe9valuation ?"))try{await Rn.delete("/api/evaluations/grid/".concat(e)),sr.success("Grille supprim\xe9e avec succ\xe8s"),_()}catch(t){console.error("Erreur lors de la suppression:",t),sr.error("Erreur lors de la suppression")}},R=e=>{E(e),j(!0)},P=a.filter(e=>e.first_name.toLowerCase().includes(g.toLowerCase())||e.last_name.toLowerCase().includes(g.toLowerCase())),D=t.filter(e=>e.student_name.toLowerCase().includes(g.toLowerCase()));return m?(0,Pn.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):(0,Pn.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,Pn.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,Pn.jsx)("div",{className:"mb-8",children:(0,Pn.jsx)("div",{className:"flex items-center justify-between",children:(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[(0,Pn.jsx)(Gs,{className:"h-8 w-8 mr-3 text-blue-600"}),"\xc9valuations U52"]}),(0,Pn.jsx)("p",{className:"mt-2 text-gray-600",children:"Gestion des \xe9valuations de comp\xe9tences U52"})]})})}),(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[(0,Pn.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,Pn.jsx)(Hn,{className:"h-5 w-5 mr-2"}),"S\xe9lectionner une classe"]}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(e=>(0,Pn.jsxs)("button",{onClick:()=>T(e),className:"p-4 rounded-lg border-2 text-left transition-colors ".concat((null===o||void 0===o?void 0:o.id)===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[(0,Pn.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,Pn.jsxs)("div",{className:"text-sm text-gray-500",children:[e.student_count," \xe9tudiant",e.student_count>1?"s":""]})]},e.id))})]}),o&&(0,Pn.jsxs)(Pn.Fragment,{children:[(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pn.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,Pn.jsx)(Hn,{className:"h-5 w-5 mr-2"}),"\xc9tudiants - ",o.name]}),(0,Pn.jsxs)("div",{className:"relative",children:[(0,Pn.jsx)(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,Pn.jsx)("input",{type:"text",placeholder:"Rechercher un \xe9tudiant...",value:g,onChange:e=>x(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(e=>{var r;const a=t.find(t=>t.student_id===e.id);return(0,Pn.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("h3",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,Pn.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]}),a&&(0,Pn.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"\xc9valu\xe9"})]}),a&&(0,Pn.jsx)("div",{className:"mb-3",children:(0,Pn.jsxs)("div",{className:"text-sm text-gray-600",children:["Note: ",(0,Pn.jsxs)("span",{className:"font-semibold text-blue-600",children:[(null===(r=a.calculated_score)||void 0===r?void 0:r.toFixed(1))||"0.0","/20"]})]})}),(0,Pn.jsx)("div",{className:"flex space-x-2",children:a?(0,Pn.jsxs)(Pn.Fragment,{children:[(0,Pn.jsxs)("button",{onClick:()=>A(a),className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-700 transition-colors flex items-center justify-center",children:[(0,Pn.jsx)(rs,{className:"h-4 w-4 mr-1"}),"Modifier"]}),(0,Pn.jsx)("button",{onClick:()=>R(a),className:"bg-gray-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-700 transition-colors",children:(0,Pn.jsx)(Vs,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:()=>O(a.id),className:"bg-red-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-red-700 transition-colors",children:(0,Pn.jsx)(as,{className:"h-4 w-4"})})]}):(0,Pn.jsxs)("button",{onClick:()=>(e=>{h(e),w(!0)})(e),className:"w-full bg-green-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-green-700 transition-colors flex items-center justify-center",children:[(0,Pn.jsx)(us,{className:"h-4 w-4 mr-1"}),"Cr\xe9er \xe9valuation"]})})]},e.id)})})]}),D.length>0&&(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,Pn.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,Pn.jsx)(Gs,{className:"h-5 w-5 mr-2"}),"Grilles d'\xe9valuation existantes"]}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.map(e=>{var t;return(0,Pn.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Pn.jsx)("h3",{className:"font-medium text-gray-900",children:e.student_name}),(0,Pn.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"U52"})]}),(0,Pn.jsxs)("div",{className:"mb-3",children:[(0,Pn.jsxs)("div",{className:"text-sm text-gray-600",children:["Note: ",(0,Pn.jsxs)("span",{className:"font-semibold text-blue-600",children:[(null===(t=e.calculated_score)||void 0===t?void 0:t.toFixed(1))||"0.0","/20"]})]}),(0,Pn.jsxs)("div",{className:"text-xs text-gray-500",children:["Cr\xe9\xe9e le ",new Date(e.created_at).toLocaleDateString()]})]}),(0,Pn.jsxs)("div",{className:"flex space-x-2",children:[(0,Pn.jsxs)("button",{onClick:()=>A(e),className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-700 transition-colors flex items-center justify-center",children:[(0,Pn.jsx)(rs,{className:"h-4 w-4 mr-1"}),"Modifier"]}),(0,Pn.jsx)("button",{onClick:()=>R(e),className:"bg-gray-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-700 transition-colors",children:(0,Pn.jsx)(Vs,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:()=>O(e.id),className:"bg-red-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-red-700 transition-colors",children:(0,Pn.jsx)(as,{className:"h-4 w-4"})})]})]},e.id)})})]})]}),v&&d&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>b(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Grille d'\xe9valuation U52"}),(0,Pn.jsx)("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600",children:(0,Pn.jsx)(os,{className:"h-6 w-6"})})]}),(0,Pn.jsx)(qs,{student:d,onClose:()=>b(!1),onSave:()=>{b(!1),_()}})]})})]})}),y&&f&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>w(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pn.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Nouvelle grille d'\xe9valuation U52 - ",f.first_name," ",f.last_name]}),(0,Pn.jsx)("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600",children:(0,Pn.jsx)(os,{className:"h-6 w-6"})})]}),(0,Pn.jsx)(qs,{student:f,onClose:()=>w(!1),onSave:()=>{w(!1),_()}})]})})]})}),N&&k&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>j(!1)}),(0,Pn.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Pr\xe9visualisation d'impression"}),(0,Pn.jsx)("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600",children:(0,Pn.jsx)(os,{className:"h-6 w-6"})})]}),(0,Pn.jsx)("div",{ref:S,className:"print-content",children:(0,Pn.jsx)(Ws,{grid:k})})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsxs)("button",{type:"button",onClick:()=>{S.current&&window.print()},className:"btn btn-primary sm:ml-3 sm:w-auto flex items-center",children:[(0,Pn.jsx)(Vs,{className:"h-4 w-4 mr-2"}),"Imprimer"]}),(0,Pn.jsx)("button",{type:"button",className:"btn btn-secondary sm:ml-3 sm:w-auto",onClick:()=>{j(!1),E(null)},children:"Annuler"})]})]})]})})]})})},Qs=Vn("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Zs=()=>{const[e,t]=(0,s.useState)(!1),r=()=>{console.log("\ud83d\uddb1\ufe0f Bouton Cr\xe9er une fiche TP cliqu\xe9"),t(!0),console.log("\ud83d\udcdd showTPSheetModal d\xe9fini \xe0 true")};return(0,Pn.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,Pn.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,Pn.jsx)("div",{className:"mb-8",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[(0,Pn.jsx)(us,{className:"h-8 w-8 mr-3 text-blue-600"}),"Fiche TP"]}),(0,Pn.jsx)("p",{className:"mt-2 text-gray-600",children:"Gestion des fiches de travaux pratiques"})]}),(0,Pn.jsxs)("button",{onClick:r,className:"bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 transition-colors flex items-center",children:[(0,Pn.jsx)(es,{className:"h-4 w-4 mr-2"}),"Nouvelle fiche TP"]})]})}),(0,Pn.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:(0,Pn.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,Pn.jsx)("div",{className:"flex-1",children:(0,Pn.jsxs)("div",{className:"relative",children:[(0,Pn.jsx)(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,Pn.jsx)("input",{type:"text",placeholder:"Rechercher une fiche TP...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,Pn.jsxs)("div",{className:"flex gap-2",children:[(0,Pn.jsxs)("select",{className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,Pn.jsx)("option",{value:"",children:"Toutes les classes"}),(0,Pn.jsx)("option",{value:"STS ELEC1",children:"STS ELEC1"}),(0,Pn.jsx)("option",{value:"STS ELEC2",children:"STS ELEC2"})]}),(0,Pn.jsxs)("select",{className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,Pn.jsx)("option",{value:"",children:"Tous les types"}),(0,Pn.jsx)("option",{value:"TP",children:"TP"}),(0,Pn.jsx)("option",{value:"TD",children:"TD"}),(0,Pn.jsx)("option",{value:"Projet",children:"Projet"})]}),(0,Pn.jsxs)("button",{className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors flex items-center",children:[(0,Pn.jsx)(Qs,{className:"h-4 w-4 mr-2"}),"Filtres"]})]})]})}),(0,Pn.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:(0,Pn.jsx)("div",{className:"p-6",children:(0,Pn.jsxs)("div",{className:"text-center py-12",children:[(0,Pn.jsx)(us,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune fiche TP trouv\xe9e"}),(0,Pn.jsx)("p",{className:"text-gray-500 mb-6",children:"Commencez par cr\xe9er votre premi\xe8re fiche de travaux pratiques."}),(0,Pn.jsxs)("button",{onClick:r,className:"bg-blue-600 text-white px-6 py-3 rounded-md text-sm font-medium hover:bg-blue-700 transition-colors flex items-center mx-auto",children:[(0,Pn.jsx)(es,{className:"h-4 w-4 mr-2"}),"Cr\xe9er une fiche TP"]})]})})}),(0,Pn.jsxs)("div",{className:"mt-8 bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-yellow-800 mb-2",children:"\ud83d\udccb Instructions pour le d\xe9veloppement"}),(0,Pn.jsx)("p",{className:"text-yellow-700 mb-4",children:"Cette page est pr\xeate pour recevoir les fonctionnalit\xe9s de gestion des fiches TP. En attente des sp\xe9cifications d\xe9taill\xe9es pour l'impl\xe9mentation."}),(0,Pn.jsxs)("div",{className:"text-sm text-yellow-600",children:[(0,Pn.jsx)("p",{children:(0,Pn.jsx)("strong",{children:"Fonctionnalit\xe9s sugg\xe9r\xe9es :"})}),(0,Pn.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,Pn.jsx)("li",{children:"Cr\xe9ation et \xe9dition de fiches TP"}),(0,Pn.jsx)("li",{children:"Gestion des objectifs p\xe9dagogiques"}),(0,Pn.jsx)("li",{children:"Liste du mat\xe9riel n\xe9cessaire"}),(0,Pn.jsx)("li",{children:"Proc\xe9dures d\xe9taill\xe9es"}),(0,Pn.jsx)("li",{children:"\xc9valuation et crit\xe8res de r\xe9ussite"}),(0,Pn.jsx)("li",{children:"Association aux classes et mati\xe8res"})]})]})]}),(0,Pn.jsx)($s,{isOpen:e,onClose:()=>t(!1),onSave:e=>{console.log("\ud83d\udcbe Sauvegarde de la fiche TP:",e),alert("Fiche TP sauvegard\xe9e avec succ\xe8s !")}})]})})},ei=()=>{const[e,t]=(0,s.useState)([]),[r,a]=(0,s.useState)(null),[n,i]=(0,s.useState)([]),[l,o]=(0,s.useState)(!0),[c,d]=(0,s.useState)(!1),[u,f]=(0,s.useState)({document_type:"",phase_id:"",file:null});(0,s.useEffect)(()=>{h()},[]),(0,s.useEffect)(()=>{r&&m(r.id)},[r]);const h=async()=>{try{const e=await Rn.get("/api/students");e.data.success&&t(e.data.data)}catch(e){console.error("Erreur lors du chargement des \xe9tudiants:",e),sr.error("Erreur lors du chargement des \xe9tudiants")}finally{o(!1)}},m=async e=>{try{const t=await Rn.get("/api/documents/student/".concat(e));t.data.success&&i(t.data.data)}catch(t){console.error("Erreur lors du chargement des documents:",t),sr.error("Erreur lors du chargement des documents")}},p=async e=>{try{const t=await Rn.get("/api/documents/download/".concat(e),{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=r,a.setAttribute("download","document"),document.body.appendChild(a),a.click(),a.remove()}catch(t){console.error("Erreur lors du t\xe9l\xe9chargement:",t),sr.error("Erreur lors du t\xe9l\xe9chargement")}},g=e=>({planning:"Planning",fiche_technique:"Fiche technique",schema_electrique:"Sch\xe9ma \xe9lectrique",plan_securite:"Plan de s\xe9curit\xe9",cahier_charges:"Cahier des charges",analyse_contraintes:"Analyse des contraintes",suivi_heures:"Suivi des heures",observations:"Observations",remarques_enseignant:"Remarques enseignant",modifications_planning:"Modifications planning",rapport_intermediaire:"Rapport interm\xe9diaire",rapport_final:"Rapport final",presentation:"Pr\xe9sentation",grille_evaluation:"Grille d'\xe9valuation",commentaires_soutenance:"Commentaires soutenance",note_finale:"Note finale"}[e]||e);return l?(0,Pn.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Documents"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Gestion des documents par phase et par \xe9tudiant"})]}),(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"S\xe9lectionner un \xe9tudiant"}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,Pn.jsx)("button",{onClick:()=>a(e),className:"p-4 rounded-lg border-2 text-left transition-colors ".concat((null===r||void 0===r?void 0:r.id)===e.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300"),children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,Pn.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:(0,Pn.jsx)(Hn,{className:"h-6 w-6 text-primary-600"})})}),(0,Pn.jsxs)("div",{className:"ml-3",children:[(0,Pn.jsxs)("div",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,Pn.jsx)("div",{className:"text-sm text-gray-500",children:e.project_title||"Aucun projet"})]})]})},e.id))})]}),r&&(0,Pn.jsxs)("div",{className:"card",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pn.jsxs)("h2",{className:"text-lg font-medium text-gray-900",children:["Documents - ",r.first_name," ",r.last_name]}),(0,Pn.jsxs)("button",{onClick:()=>d(!0),className:"btn btn-primary flex items-center",children:[(0,Pn.jsx)(ss,{className:"h-4 w-4 mr-2"}),"Upload document"]})]}),0===n.length?(0,Pn.jsxs)("div",{className:"text-center py-8",children:[(0,Pn.jsx)(us,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Aucun document"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Commencez par uploader des documents."})]}):(0,Pn.jsx)("div",{className:"space-y-4",children:n.map(e=>{return(0,Pn.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pn.jsx)(us,{className:"h-5 w-5 text-gray-400"}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("div",{className:"font-medium text-gray-900",children:e.filename}),(0,Pn.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,Pn.jsx)("span",{className:"badge ".concat((t=e.document_type,t.includes("planning")||t.includes("plan")?"text-blue-600 bg-blue-100":t.includes("rapport")||t.includes("presentation")?"text-green-600 bg-green-100":t.includes("evaluation")||t.includes("note")?"text-purple-600 bg-purple-100":"text-gray-600 bg-gray-100")),children:g(e.document_type)}),e.phase_number&&(0,Pn.jsxs)("span",{className:"badge badge-info",children:["Phase ",e.phase_number]})]})]})]}),(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)("button",{onClick:()=>p(e.id),className:"text-primary-600 hover:text-primary-900",title:"T\xe9l\xe9charger",children:(0,Pn.jsx)(Is,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer ce document ?"))try{await Rn.delete("/api/documents/".concat(e)),sr.success("Document supprim\xe9 avec succ\xe8s"),m(r.id)}catch(t){console.error("Erreur lors de la suppression:",t),sr.error("Erreur lors de la suppression")}})(e.id),className:"text-red-600 hover:text-red-900",title:"Supprimer",children:(0,Pn.jsx)(as,{className:"h-4 w-4"})})]})]}),(0,Pn.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["Upload\xe9 le ",new Date(e.uploaded_at).toLocaleDateString("fr-FR")]})]},e.id);var t})})]}),c&&r&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>d(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,Pn.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!u.file)return void sr.error("Veuillez s\xe9lectionner un fichier");const t=new FormData;t.append("document",u.file),t.append("student_id",r.id),t.append("document_type",u.document_type),u.phase_id&&t.append("phase_id",u.phase_id);try{await Rn.post("/api/documents/upload",t,{headers:{"Content-Type":"multipart/form-data"}}),sr.success("Document upload\xe9 avec succ\xe8s"),d(!1),f({document_type:"",phase_id:"",file:null}),m(r.id)}catch(a){console.error("Erreur lors de l'upload:",a),sr.error("Erreur lors de l'upload")}},children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsxs)("div",{className:"mb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Upload de document"}),(0,Pn.jsxs)("p",{className:"text-sm text-gray-500",children:[r.first_name," ",r.last_name]})]}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Type de document *"}),(0,Pn.jsxs)("select",{required:!0,className:"input",value:u.document_type,onChange:e=>f(qe(qe({},u),{},{document_type:e.target.value})),children:[(0,Pn.jsx)("option",{value:"",children:"S\xe9lectionner un type"}),(0,Pn.jsx)("option",{value:"planning",children:"Planning"}),(0,Pn.jsx)("option",{value:"fiche_technique",children:"Fiche technique"}),(0,Pn.jsx)("option",{value:"schema_electrique",children:"Sch\xe9ma \xe9lectrique"}),(0,Pn.jsx)("option",{value:"plan_securite",children:"Plan de s\xe9curit\xe9"}),(0,Pn.jsx)("option",{value:"cahier_charges",children:"Cahier des charges"}),(0,Pn.jsx)("option",{value:"analyse_contraintes",children:"Analyse des contraintes"}),(0,Pn.jsx)("option",{value:"suivi_heures",children:"Suivi des heures"}),(0,Pn.jsx)("option",{value:"observations",children:"Observations"}),(0,Pn.jsx)("option",{value:"remarques_enseignant",children:"Remarques enseignant"}),(0,Pn.jsx)("option",{value:"rapport_intermediaire",children:"Rapport interm\xe9diaire"}),(0,Pn.jsx)("option",{value:"rapport_final",children:"Rapport final"}),(0,Pn.jsx)("option",{value:"presentation",children:"Pr\xe9sentation"}),(0,Pn.jsx)("option",{value:"grille_evaluation",children:"Grille d'\xe9valuation"}),(0,Pn.jsx)("option",{value:"note_finale",children:"Note finale"})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Phase (optionnel)"}),(0,Pn.jsxs)("select",{className:"input",value:u.phase_id,onChange:e=>f(qe(qe({},u),{},{phase_id:e.target.value})),children:[(0,Pn.jsx)("option",{value:"",children:"Aucune phase sp\xe9cifique"}),(0,Pn.jsx)("option",{value:"1",children:"Phase 1 - Planification"}),(0,Pn.jsx)("option",{value:"2",children:"Phase 2 - Pilotage"}),(0,Pn.jsx)("option",{value:"3",children:"Phase 3 - Soutenance"})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Fichier *"}),(0,Pn.jsx)("input",{type:"file",required:!0,className:"input",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif",onChange:e=>f(qe(qe({},u),{},{file:e.target.files[0]}))}),(0,Pn.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Formats accept\xe9s : PDF, DOC, DOCX, JPG, PNG, GIF (max 10MB)"})]})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsx)("button",{type:"submit",className:"btn btn-primary sm:ml-3 sm:w-auto",children:"Uploader"}),(0,Pn.jsx)("button",{type:"button",className:"btn btn-secondary sm:mt-0 sm:w-auto",onClick:()=>d(!1),children:"Annuler"})]})]})})]})})]})},ti=Vn("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),ri=Vn("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),ai=()=>{const{selectedYear:e}=Fn(),[t,r]=(0,s.useState)([]),[a,n]=(0,s.useState)([]),[i,l]=(0,s.useState)([]),[o,c]=(0,s.useState)([]),[d,u]=(0,s.useState)([]),[f,h]=(0,s.useState)(!0),[m,p]=(0,s.useState)("students"),[g,x]=(0,s.useState)(""),[v,b]=(0,s.useState)(null),[y,w]=(0,s.useState)({student:200,class:120,company:150,address:300,phone:120,supervisor:150,supervisorPhone:120,period:180,status:120,actions:200}),[N,j]=(0,s.useState)(!1),[k,E]=(0,s.useState)(null),S=(e,t)=>{e.preventDefault(),j(!0),E(t),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},T=e=>{if(!N||!k)return;const t=document.querySelector("table");if(!t)return;const r=t.getBoundingClientRect(),a=e.clientX-r.left;a>80&&w(e=>qe(qe({},e),{},{[k]:a}))},_=()=>{j(!1),E(null),document.body.style.cursor="",document.body.style.userSelect=""},C=e=>{if(!e)return"";const t=new Date(e),r=t.getDate().toString().padStart(2,"0"),a=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(r,"/").concat(a,"/").concat(n)},A=()=>{z(!1),V(null),W({})},[O,R]=(0,s.useState)(!1),[P,D]=(0,s.useState)(!1),[L,I]=(0,s.useState)(!1),[M,F]=(0,s.useState)(!1),[U,z]=(0,s.useState)(!1),[B,V]=(0,s.useState)(null),[H,W]=(0,s.useState)({}),[q,G]=(0,s.useState)(!1),[$,Y]=(0,s.useState)(null),[K,X]=(0,s.useState)({student_id:"",company_id:"",company_name:"",company_address:"",company_phone:"",company_email:"",supervisor_name:"",supervisor_phone:"",start_date:"",end_date:"",status:"active"}),[J,Q]=(0,s.useState)({student_id:"",date:"",reason:"",type:"justified",duration:"full_day"}),[Z,ee]=(0,s.useState)({student_id:"",date:"",title:"",description:"",type:"technical",hours:0,observations:""});(0,s.useEffect)(()=>{te()},[e]),(0,s.useEffect)(()=>(N&&(document.addEventListener("mousemove",T),document.addEventListener("mouseup",_)),()=>{document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",_)}),[N,k]);const te=async()=>{try{const[t,a,s,i]=await Promise.all([Rn.get("/api/students?school_year=".concat(e)),Rn.get("/api/internships").catch(e=>{var t;if(404===(null===(t=e.response)||void 0===t?void 0:t.status))return{data:{success:!0,data:[]}};throw e}),Rn.get("/api/activities?school_year=".concat(e)).catch(e=>{var t;if(404===(null===(t=e.response)||void 0===t?void 0:t.status))return{data:{success:!0,data:[]}};throw e}),Rn.get("/api/absences?school_year=".concat(e)).catch(e=>{var t;if(404===(null===(t=e.response)||void 0===t?void 0:t.status))return{data:{success:!0,data:[]}};throw e})]);if(t.data.success){const e=t.data.data.filter(e=>"STS ELEC1"===e.class||"BTS ELEC"===e.class);r(e)}a.data.success&&n(a.data.data),s.data.success&&c(s.data.data),i.data.success&&l(i.data.data),await re()}catch(t){console.error("Erreur lors du chargement des donn\xe9es:",t),sr.error("Erreur lors du chargement des donn\xe9es")}finally{h(!1)}},re=async()=>{try{const e=await fetch("/entreprise.csv"),t=await e.text(),r=t.split("\n").slice(1).map((e,t)=>{const r=ae(e);return{id:t+1,raisonSociale:ne(r[0])||"",activite:ne(r[1])||"",ape:ne(r[2])||"",adresse1:ne(r[3])||"",adresse2:ne(r[4])||"",codePostal:ne(r[5])||"",ville:ne(r[6])||"",pays:ne(r[7])||"",telephoneFixe:ne(r[8])||"",telephonePortable:ne(r[9])||"",email:ne(r[10])||"",siret:ne(r[11])||"",ursaff:ne(r[12])||"",compagnieAssurance:ne(r[13])||"",policeAssurance:ne(r[14])||"",civiliteResponsable:ne(r[15])||"",nomResponsable:ne(r[16])||"",prenomResponsable:ne(r[17])||"",fonctionResponsable:ne(r[18])||"",telephoneFixeResponsable:ne(r[19])||"",faxResponsable:ne(r[20])||"",telephonePortableResponsable:ne(r[21])||"",emailResponsable:ne(r[22])||""}}).filter(e=>""!==e.raisonSociale.trim());u(r)}catch(e){console.error("Erreur lors du chargement des entreprises:",e)}},ae=e=>{const t=[];let r="",a=!1;for(let n=0;n<e.length;n++){const s=e[n];'"'===s?a=!a:","!==s||a?r+=s:(t.push(r.trim()),r="")}return t.push(r.trim()),t},ne=e=>e?e.toString().trim().replace(/^"(.*)"$/,"$1").replace(/Activit/g,"Activit\xe9").replace(/Tlphone/g,"T\xe9l\xe9phone").replace(/Civilit/g,"Civilit\xe9").replace(/Prnom/g,"Pr\xe9nom").replace(/Scurit/g,"S\xe9curit\xe9").replace(/Matriel/g,"Mat\xe9riel").replace(/Gnrale/g,"G\xe9n\xe9rale"):"",se=e=>{switch(e){case"active":return"text-green-600 bg-green-100";case"completed":return"text-blue-600 bg-blue-100";case"terminated":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},ie=t.filter(e=>{var t;return e.first_name.toLowerCase().includes(g.toLowerCase())||e.last_name.toLowerCase().includes(g.toLowerCase())||(null===(t=e.class)||void 0===t?void 0:t.toLowerCase().includes(g.toLowerCase()))});return f?(0,Pn.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,Pn.jsxs)("div",{className:"space-y-6",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des Stages"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"BTS \xc9lectrotechnique - Suivi des stages en entreprise"})]}),(0,Pn.jsxs)("div",{className:"flex space-x-3",children:[(0,Pn.jsxs)("button",{className:"btn btn-secondary flex items-center",children:[(0,Pn.jsx)(Is,{className:"h-4 w-4 mr-2"}),"Exporter"]}),(0,Pn.jsxs)("button",{className:"btn btn-primary flex items-center",children:[(0,Pn.jsx)(ss,{className:"h-4 w-4 mr-2"}),"Importer"]})]})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,Pn.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,Pn.jsx)("div",{className:"p-5",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(Hn,{className:"h-6 w-6 text-blue-400"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"\xc9tudiants"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:t.length})]})})]})})}),(0,Pn.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,Pn.jsx)("div",{className:"p-5",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(ti,{className:"h-6 w-6 text-green-400"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Stages actifs"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:a.filter(e=>"active"===e.status).length})]})})]})})}),(0,Pn.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,Pn.jsx)("div",{className:"p-5",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(ds,{className:"h-6 w-6 text-red-400"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Absences ce mois"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:i.length})]})})]})})}),(0,Pn.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,Pn.jsx)("div",{className:"p-5",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)(ri,{className:"h-6 w-6 text-purple-400"})}),(0,Pn.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,Pn.jsxs)("dl",{children:[(0,Pn.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Activit\xe9s"}),(0,Pn.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:o.length})]})})]})})})]}),(0,Pn.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,Pn.jsx)("div",{className:"border-b border-gray-200",children:(0,Pn.jsx)("nav",{className:"-mb-px flex space-x-8 px-6",children:[{id:"students",name:"\xc9tudiants",icon:Hn},{id:"internships",name:"Stages",icon:ti},{id:"absences",name:"Absences",icon:ds},{id:"activities",name:"Activit\xe9s",icon:ri}].map(e=>(0,Pn.jsxs)("button",{onClick:()=>p(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center ".concat(m===e.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,Pn.jsx)(e.icon,{className:"h-4 w-4 mr-2"}),e.name]},e.id))})}),(0,Pn.jsxs)("div",{className:"p-6",children:[(0,Pn.jsxs)("div",{className:"mb-6 flex items-center space-x-4",children:[(0,Pn.jsx)("div",{className:"flex-1",children:(0,Pn.jsxs)("div",{className:"relative",children:[(0,Pn.jsx)(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,Pn.jsx)("input",{type:"text",placeholder:"Rechercher...",value:g,onChange:e=>x(e.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500"})]})}),(0,Pn.jsxs)("button",{className:"btn btn-secondary flex items-center",children:[(0,Pn.jsx)(Qs,{className:"h-4 w-4 mr-2"}),"Filtres"]})]}),"students"===m&&(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Liste des \xe9tudiants BTS \xc9lectrotechnique"}),(0,Pn.jsxs)("button",{onClick:()=>F(!0),className:"btn btn-primary flex items-center",children:[(0,Pn.jsx)(es,{className:"h-4 w-4 mr-2"}),"Ajouter \xe9tudiant"]})]}),(0,Pn.jsx)("div",{className:"overflow-x-auto",children:(0,Pn.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,Pn.jsx)("thead",{className:"bg-gray-100",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsxs)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider relative",style:{width:y.student},children:["\xc9tudiant",(0,Pn.jsx)("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize bg-transparent hover:bg-blue-300",onMouseDown:e=>S(e,"student")})]}),(0,Pn.jsxs)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider relative",style:{width:y.class},children:["Classe",(0,Pn.jsx)("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize bg-transparent hover:bg-blue-300",onMouseDown:e=>S(e,"class")})]}),(0,Pn.jsxs)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider relative",style:{width:y.company},children:["Entreprise",(0,Pn.jsx)("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize bg-transparent hover:bg-blue-300",onMouseDown:e=>S(e,"company")})]}),(0,Pn.jsxs)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider relative",style:{width:y.address},children:["Adresse",(0,Pn.jsx)("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize bg-transparent hover:bg-blue-300",onMouseDown:e=>S(e,"address")})]}),(0,Pn.jsxs)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider relative",style:{width:y.phone},children:["T\xe9l\xe9phone",(0,Pn.jsx)("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize bg-transparent hover:bg-blue-300",onMouseDown:e=>S(e,"phone")})]}),(0,Pn.jsxs)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider relative",style:{width:y.supervisor},children:["Nom du tuteur",(0,Pn.jsx)("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize bg-transparent hover:bg-blue-300",onMouseDown:e=>S(e,"supervisor")})]}),(0,Pn.jsxs)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider relative",style:{width:y.supervisorPhone},children:["T\xe9l. tuteur",(0,Pn.jsx)("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize bg-transparent hover:bg-blue-300",onMouseDown:e=>S(e,"supervisorPhone")})]}),(0,Pn.jsxs)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider relative",style:{width:y.period},children:["P\xe9riode",(0,Pn.jsx)("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize bg-transparent hover:bg-blue-300",onMouseDown:e=>S(e,"period")})]}),(0,Pn.jsxs)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider relative",style:{width:y.status},children:["Statut",(0,Pn.jsx)("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize bg-transparent hover:bg-blue-300",onMouseDown:e=>S(e,"status")})]}),(0,Pn.jsxs)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider relative",style:{width:y.actions},children:["Actions",(0,Pn.jsx)("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize bg-transparent hover:bg-blue-300",onMouseDown:e=>S(e,"actions")})]})]})}),(0,Pn.jsx)("tbody",{className:"bg-white",children:ie.map(e=>{const t=a.find(t=>t.student_id==e.id);return(0,Pn.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>{b(e),t?(R(!0),X(qe(qe({},K),{},{student_id:e.id,company_id:t.company_id,company_name:t.company_name,company_address:t.company_address,company_phone:t.company_phone,company_email:t.company_email,supervisor_name:t.supervisor_name,supervisor_phone:t.supervisor_phone,start_date:t.start_date,end_date:t.end_date,status:t.status}))):(R(!0),X(qe(qe({},K),{},{student_id:e.id})))},children:[(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0 h-8 w-8",children:(0,Pn.jsx)("div",{className:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center",children:(0,Pn.jsx)(Hn,{className:"h-4 w-4 text-primary-600"})})}),(0,Pn.jsxs)("div",{className:"ml-3",children:[(0,Pn.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,Pn.jsx)("div",{className:"text-xs text-gray-500",children:e.date_de_naissance})]})]})}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:e.class||"Non assign\xe9"}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:t?(0,Pn.jsx)("div",{className:"font-medium",children:t.company_name}):(0,Pn.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:t?(0,Pn.jsx)("div",{className:"whitespace-normal break-words",children:t.company_address||"-"}):(0,Pn.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:t?(0,Pn.jsx)("div",{children:t.company_phone||"-"}):(0,Pn.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:t?(0,Pn.jsx)("div",{className:"font-medium",children:t.supervisor_name||"-"}):(0,Pn.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:t?(0,Pn.jsx)("div",{children:t.supervisor_phone||"-"}):(0,Pn.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:t?(0,Pn.jsx)("div",{className:"text-xs",children:t.start_date&&t.end_date?"".concat(C(t.start_date)," au ").concat(C(t.end_date)):"Non d\xe9fini"}):(0,Pn.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3",children:t?(0,Pn.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(se(t.status)),children:"active"===t.status?"En cours":"completed"===t.status?"Termin\xe9":"Termin\xe9 anticip\xe9"}):(0,Pn.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full text-gray-600 bg-gray-100",children:"En attente"})}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm font-medium",children:(0,Pn.jsxs)("div",{className:"flex space-x-2",children:[(0,Pn.jsx)("button",{onClick:t=>{t.stopPropagation(),b(e),R(!0),X(qe(qe({},K),{},{student_id:e.id}))},className:"text-primary-600 hover:text-primary-900",title:"G\xe9rer le stage",children:(0,Pn.jsx)(ti,{className:"h-4 w-4"})}),t&&(0,Pn.jsxs)(Pn.Fragment,{children:[(0,Pn.jsx)("button",{onClick:r=>{r.stopPropagation(),b(e),R(!0),X(qe(qe({},K),{},{student_id:e.id,company_id:t.company_id,company_name:t.company_name,company_address:t.company_address,company_phone:t.company_phone,company_email:t.company_email,supervisor_name:t.supervisor_name,supervisor_phone:t.supervisor_phone,start_date:t.start_date,end_date:t.end_date,status:t.status}))},className:"text-blue-600 hover:text-blue-900",title:"Modifier le stage",children:(0,Pn.jsx)(rs,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:e=>{e.stopPropagation(),(async e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer ce stage ?"))try{(await Rn.delete("/api/internships/".concat(e))).data.success&&(sr.success("Stage supprim\xe9 avec succ\xe8s"),await te())}catch(a){var t,r;console.error("\u274c Erreur lors de la suppression du stage:",a),sr.error("Erreur lors de la suppression: ".concat((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||a.message))}})(t.id)},className:"text-red-600 hover:text-red-900",title:"Supprimer le stage",children:(0,Pn.jsx)(as,{className:"h-4 w-4"})})]}),(0,Pn.jsx)("button",{onClick:t=>{t.stopPropagation(),b(e),D(!0),Q(qe(qe({},J),{},{student_id:e.id}))},className:"text-red-600 hover:text-red-900",title:"Enregistrer une absence",children:(0,Pn.jsx)(ds,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:t=>{t.stopPropagation(),b(e),I(!0),ee(qe(qe({},Z),{},{student_id:e.id}))},className:"text-green-600 hover:text-green-900",title:"Ajouter une activit\xe9",children:(0,Pn.jsx)(ri,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{Y(e),G(!0)})(e)},className:"text-blue-600 hover:text-blue-900",title:"Voir les d\xe9tails",children:(0,Pn.jsx)(Gn,{className:"h-4 w-4"})})]})})]},e.id)})})]})})]}),"internships"===m&&(0,Pn.jsxs)("div",{className:"text-center py-12",children:[(0,Pn.jsx)(ti,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Gestion des stages"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Interface de gestion des stages en entreprise"})]}),"absences"===m&&(0,Pn.jsxs)("div",{className:"text-center py-12",children:[(0,Pn.jsx)(ds,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Registre des absences"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Suivi des absences des \xe9tudiants"})]}),"activities"===m&&(0,Pn.jsxs)("div",{className:"text-center py-12",children:[(0,Pn.jsx)(ri,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pn.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Activit\xe9s r\xe9alis\xe9es"}),(0,Pn.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Suivi des activit\xe9s pendant les stages"})]})]})]}),O&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>R(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full",children:(0,Pn.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{console.log("\ud83d\udcbe Sauvegarde du stage:",K);(await Rn.post("/api/internships",K).catch(e=>{var t;if(404===(null===(t=e.response)||void 0===t?void 0:t.status))return sr.warning("API internships non disponible, sauvegarde locale temporaire"),{data:{success:!0}};throw e})).data.success?(sr.success("Stage ajout\xe9 avec succ\xe8s"),R(!1),X({student_id:"",company_id:"",company_name:"",company_address:"",company_phone:"",company_email:"",supervisor_name:"",supervisor_phone:"",start_date:"",end_date:"",status:"active"}),await te()):sr.error("Erreur lors de l'ajout du stage")}catch(a){var t,r;console.error("\u274c Erreur lors de la sauvegarde du stage:",a),sr.error("Erreur lors de l'ajout du stage: ".concat((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||a.message))}},children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:v?"Stage pour ".concat(v.first_name," ").concat(v.last_name):"Nouveau stage"})}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"\xc9tudiant"}),(0,Pn.jsxs)("select",{required:!0,className:"input",value:K.student_id,onChange:e=>X(qe(qe({},K),{},{student_id:e.target.value})),children:[(0,Pn.jsx)("option",{value:"",children:"S\xe9lectionner un \xe9tudiant"}),t.map(e=>(0,Pn.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name," - ",e.class]},e.id))]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Statut"}),(0,Pn.jsxs)("select",{required:!0,className:"input",value:K.status,onChange:e=>X(qe(qe({},K),{},{status:e.target.value})),children:[(0,Pn.jsx)("option",{value:"active",children:"En cours"}),(0,Pn.jsx)("option",{value:"completed",children:"Termin\xe9"}),(0,Pn.jsx)("option",{value:"terminated",children:"Termin\xe9 anticip\xe9"})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Nom de l'entreprise *"}),(0,Pn.jsxs)("div",{className:"flex space-x-2",children:[(0,Pn.jsxs)("select",{required:!0,className:"input flex-1",value:K.company_id,onChange:e=>(e=>{const t=d.find(t=>t.id===parseInt(e));t&&X(qe(qe({},K),{},{company_id:e,company_name:t.raisonSociale,company_address:t.adresse1+(t.adresse2?", "+t.adresse2:"")+", "+t.codePostal+" "+t.ville,company_phone:t.telephoneFixe||t.telephonePortable||"",company_email:t.email||"",supervisor_name:t.prenomResponsable+" "+t.nomResponsable,supervisor_phone:t.telephoneFixeResponsable||t.telephonePortableResponsable||""}))})(e.target.value),children:[(0,Pn.jsx)("option",{value:"",children:"S\xe9lectionner une entreprise"}),d.map(e=>(0,Pn.jsx)("option",{value:e.id,children:e.raisonSociale},e.id))]}),K.company_id&&(0,Pn.jsx)("button",{type:"button",onClick:()=>{const e=d.find(e=>e.id==K.company_id);e&&(V(e),W({raisonSociale:e.raisonSociale||"",activite:e.activite||"",ape:e.ape||"",adresse1:e.adresse1||"",adresse2:e.adresse2||"",codePostal:e.codePostal||"",ville:e.ville||"",pays:e.pays||"",telephoneFixe:e.telephoneFixe||"",telephonePortable:e.telephonePortable||"",email:e.email||"",siret:e.siret||"",ursaff:e.ursaff||"",tva:e.tva||"",capital:e.capital||"",formeJuridique:e.formeJuridique||"",effectif:e.effectif||"",dirigeant:e.dirigeant||"",contact:e.contact||"",telephoneContact:e.telephoneContact||"",emailContact:e.emailContact||"",siteWeb:e.siteWeb||"",observations:e.observations||""}),z(!0))},className:"btn btn-secondary flex items-center px-3 py-2",title:"Modifier l'entreprise s\xe9lectionn\xe9e",children:(0,Pn.jsx)(rs,{className:"h-4 w-4"})})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Adresse de l'entreprise"}),(0,Pn.jsx)("input",{type:"text",className:"input",value:K.company_address,onChange:e=>X(qe(qe({},K),{},{company_address:e.target.value})),readOnly:!0})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"T\xe9l\xe9phone entreprise"}),(0,Pn.jsx)("input",{type:"tel",className:"input",value:K.company_phone,onChange:e=>X(qe(qe({},K),{},{company_phone:e.target.value})),readOnly:!0})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Email entreprise"}),(0,Pn.jsx)("input",{type:"email",className:"input",value:K.company_email,onChange:e=>X(qe(qe({},K),{},{company_email:e.target.value})),readOnly:!0})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Nom du tuteur"}),(0,Pn.jsx)("input",{type:"text",className:"input",value:K.supervisor_name,onChange:e=>X(qe(qe({},K),{},{supervisor_name:e.target.value})),readOnly:!0})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"T\xe9l\xe9phone tuteur"}),(0,Pn.jsx)("input",{type:"tel",className:"input",value:K.supervisor_phone,onChange:e=>X(qe(qe({},K),{},{supervisor_phone:e.target.value})),readOnly:!0})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Date de d\xe9but *"}),(0,Pn.jsxs)("div",{className:"relative",children:[(0,Pn.jsx)("input",{type:"date",required:!0,className:"input pr-10",value:K.start_date,onChange:e=>X(qe(qe({},K),{},{start_date:e.target.value}))}),(0,Pn.jsx)(ts,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Date de fin *"}),(0,Pn.jsxs)("div",{className:"relative",children:[(0,Pn.jsx)("input",{type:"date",required:!0,className:"input pr-10",value:K.end_date,onChange:e=>X(qe(qe({},K),{},{end_date:e.target.value}))}),(0,Pn.jsx)(ts,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]})]})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 flex justify-end space-x-3",children:[(0,Pn.jsx)("button",{type:"button",className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",onClick:()=>R(!1),children:"Annuler"}),(0,Pn.jsx)("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Enregistrer le stage"})]})]})})]})}),P&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>D(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,Pn.jsxs)("form",{onSubmit:async r=>{r.preventDefault();try{console.log("\ud83d\udcbe Sauvegarde de l'absence:",J);try{if(!(await Rn.post("/api/absences",qe(qe({},J),{},{school_year:e}))).data.success)throw new Error("Erreur de sauvegarde");sr.success("Absence enregistr\xe9e avec succ\xe8s"),D(!1),Q({student_id:"",date:"",reason:"",type:"justified",duration:"full_day"}),await te()}catch(o){var a;if(404!==(null===(a=o.response)||void 0===a?void 0:a.status))throw o;{console.warn("API absences non disponible, sauvegarde locale temporaire");const e=qe(qe({id:Date.now()},J),{},{student:t.find(e=>e.id==J.student_id)});l([...i,e]),D(!1),Q({student_id:"",date:"",reason:"",type:"justified",duration:"full_day"}),sr.success("Absence sauvegard\xe9e localement (API non disponible)")}}}catch(c){var n,s;console.error("\u274c Erreur lors de l'enregistrement de l'absence:",c),sr.error("Erreur lors de l'enregistrement de l'absence: ".concat((null===(n=c.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||c.message))}},children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:v?"Absence pour ".concat(v.first_name," ").concat(v.last_name):"Nouvelle absence"})}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"\xc9tudiant"}),(0,Pn.jsxs)("select",{required:!0,className:"input",value:J.student_id,onChange:e=>Q(qe(qe({},J),{},{student_id:e.target.value})),children:[(0,Pn.jsx)("option",{value:"",children:"S\xe9lectionner un \xe9tudiant"}),t.map(e=>(0,Pn.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name]},e.id))]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Date *"}),(0,Pn.jsx)("input",{type:"date",required:!0,className:"input",value:J.date,onChange:e=>Q(qe(qe({},J),{},{date:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Type d'absence"}),(0,Pn.jsxs)("select",{required:!0,className:"input",value:J.type,onChange:e=>Q(qe(qe({},J),{},{type:e.target.value})),children:[(0,Pn.jsx)("option",{value:"justified",children:"Justifi\xe9e"}),(0,Pn.jsx)("option",{value:"unjustified",children:"Non justifi\xe9e"}),(0,Pn.jsx)("option",{value:"medical",children:"M\xe9dicale"})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Dur\xe9e"}),(0,Pn.jsxs)("select",{required:!0,className:"input",value:J.duration,onChange:e=>Q(qe(qe({},J),{},{duration:e.target.value})),children:[(0,Pn.jsx)("option",{value:"full_day",children:"Journ\xe9e compl\xe8te"}),(0,Pn.jsx)("option",{value:"half_day",children:"Demi-journ\xe9e"}),(0,Pn.jsx)("option",{value:"hours",children:"Heures sp\xe9cifiques"})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Raison *"}),(0,Pn.jsx)("textarea",{required:!0,className:"input",rows:"3",value:J.reason,onChange:e=>Q(qe(qe({},J),{},{reason:e.target.value})),placeholder:"D\xe9tails de l'absence..."})]})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsx)("button",{type:"submit",className:"btn btn-primary sm:ml-3 sm:w-auto",children:"Enregistrer l'absence"}),(0,Pn.jsx)("button",{type:"button",className:"btn btn-secondary sm:mt-0 sm:w-auto",onClick:()=>D(!1),children:"Annuler"})]})]})})]})}),L&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>I(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,Pn.jsxs)("form",{onSubmit:async r=>{r.preventDefault();try{console.log("\ud83d\udcbe Sauvegarde de l'activit\xe9:",Z);try{if(!(await Rn.post("/api/activities",qe(qe({},Z),{},{school_year:e}))).data.success)throw new Error("Erreur de sauvegarde");sr.success("Activit\xe9 ajout\xe9e avec succ\xe8s"),I(!1),ee({student_id:"",date:"",title:"",description:"",type:"technical",hours:0,observations:""}),await te()}catch(i){var a;if(404!==(null===(a=i.response)||void 0===a?void 0:a.status))throw i;{console.warn("API activities non disponible, sauvegarde locale temporaire");const e=qe(qe({id:Date.now()},Z),{},{student:t.find(e=>e.id==Z.student_id)});c([...o,e]),I(!1),ee({student_id:"",date:"",title:"",description:"",type:"technical",hours:0,observations:""}),sr.success("Activit\xe9 sauvegard\xe9e localement (API non disponible)")}}}catch(l){var n,s;console.error("\u274c Erreur lors de l'ajout de l'activit\xe9:",l),sr.error("Erreur lors de l'ajout de l'activit\xe9: ".concat((null===(n=l.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||l.message))}},children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:v?"Activit\xe9 pour ".concat(v.first_name," ").concat(v.last_name):"Nouvelle activit\xe9"})}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"\xc9tudiant"}),(0,Pn.jsxs)("select",{required:!0,className:"input",value:Z.student_id,onChange:e=>ee(qe(qe({},Z),{},{student_id:e.target.value})),children:[(0,Pn.jsx)("option",{value:"",children:"S\xe9lectionner un \xe9tudiant"}),t.map(e=>(0,Pn.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name]},e.id))]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Date *"}),(0,Pn.jsx)("input",{type:"date",required:!0,className:"input",value:Z.date,onChange:e=>ee(qe(qe({},Z),{},{date:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Titre de l'activit\xe9 *"}),(0,Pn.jsx)("input",{type:"text",required:!0,className:"input",value:Z.title,onChange:e=>ee(qe(qe({},Z),{},{title:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Type d'activit\xe9"}),(0,Pn.jsxs)("select",{required:!0,className:"input",value:Z.type,onChange:e=>ee(qe(qe({},Z),{},{type:e.target.value})),children:[(0,Pn.jsx)("option",{value:"technical",children:"Technique"}),(0,Pn.jsx)("option",{value:"administrative",children:"Administrative"}),(0,Pn.jsx)("option",{value:"formation",children:"Formation"})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Nombre d'heures"}),(0,Pn.jsx)("input",{type:"number",min:"0",step:"0.5",className:"input",value:Z.hours,onChange:e=>ee(qe(qe({},Z),{},{hours:parseFloat(e.target.value)||0}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Description *"}),(0,Pn.jsx)("textarea",{required:!0,className:"input",rows:"4",value:Z.description,onChange:e=>ee(qe(qe({},Z),{},{description:e.target.value})),placeholder:"D\xe9tails de l'activit\xe9 r\xe9alis\xe9e..."})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Observations"}),(0,Pn.jsx)("textarea",{className:"input",rows:"3",value:Z.observations,onChange:e=>ee(qe(qe({},Z),{},{observations:e.target.value})),placeholder:"Observations suppl\xe9mentaires sur l'activit\xe9..."})]})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsx)("button",{type:"submit",className:"btn btn-primary sm:ml-3 sm:w-auto",children:"Enregistrer l'activit\xe9"}),(0,Pn.jsx)("button",{type:"button",className:"btn btn-secondary sm:mt-0 sm:w-auto",onClick:()=>I(!1),children:"Annuler"})]})]})})]})}),U&&(0,Pn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Pn.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,Pn.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 rounded-t-xl",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h2",{className:"text-2xl font-bold",children:"Modifier l'entreprise"}),(0,Pn.jsx)("p",{className:"text-blue-100 mt-1",children:null===B||void 0===B?void 0:B.raisonSociale})]}),(0,Pn.jsx)("button",{onClick:A,className:"text-white hover:text-blue-200 transition-colors",children:(0,Pn.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pn.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,Pn.jsxs)("div",{className:"p-6",children:[(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Raison sociale *"}),(0,Pn.jsx)("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.raisonSociale||"",onChange:e=>W(qe(qe({},H),{},{raisonSociale:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Activit\xe9"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.activite||"",onChange:e=>W(qe(qe({},H),{},{activite:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Code APE"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.ape||"",onChange:e=>W(qe(qe({},H),{},{ape:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse 1"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.adresse1||"",onChange:e=>W(qe(qe({},H),{},{adresse1:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse 2"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.adresse2||"",onChange:e=>W(qe(qe({},H),{},{adresse2:e.target.value}))})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Code postal"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.codePostal||"",onChange:e=>W(qe(qe({},H),{},{codePostal:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ville"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.ville||"",onChange:e=>W(qe(qe({},H),{},{ville:e.target.value}))})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pays"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.pays||"",onChange:e=>W(qe(qe({},H),{},{pays:e.target.value}))})]})]}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"T\xe9l\xe9phone fixe"}),(0,Pn.jsx)("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.telephoneFixe||"",onChange:e=>W(qe(qe({},H),{},{telephoneFixe:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"T\xe9l\xe9phone portable"}),(0,Pn.jsx)("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.telephonePortable||"",onChange:e=>W(qe(qe({},H),{},{telephonePortable:e.target.value}))})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,Pn.jsx)("input",{type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.email||"",onChange:e=>W(qe(qe({},H),{},{email:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SIRET"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.siret||"",onChange:e=>W(qe(qe({},H),{},{siret:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URSSAF"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.ursaff||"",onChange:e=>W(qe(qe({},H),{},{ursaff:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"TVA"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.tva||"",onChange:e=>W(qe(qe({},H),{},{tva:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capital"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.capital||"",onChange:e=>W(qe(qe({},H),{},{capital:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Forme juridique"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.formeJuridique||"",onChange:e=>W(qe(qe({},H),{},{formeJuridique:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Effectif"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.effectif||"",onChange:e=>W(qe(qe({},H),{},{effectif:e.target.value}))})]})]})]}),(0,Pn.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informations de contact"}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact"}),(0,Pn.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.contact||"",onChange:e=>W(qe(qe({},H),{},{contact:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"T\xe9l\xe9phone contact"}),(0,Pn.jsx)("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.telephoneContact||"",onChange:e=>W(qe(qe({},H),{},{telephoneContact:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email contact"}),(0,Pn.jsx)("input",{type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.emailContact||"",onChange:e=>W(qe(qe({},H),{},{emailContact:e.target.value}))})]})]})]}),(0,Pn.jsxs)("div",{className:"mt-6",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observations"}),(0,Pn.jsx)("textarea",{rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:H.observations||"",onChange:e=>W(qe(qe({},H),{},{observations:e.target.value}))})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-6 py-4 rounded-b-xl flex justify-end space-x-3",children:[(0,Pn.jsx)("button",{onClick:A,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),(0,Pn.jsxs)("button",{onClick:()=>{const e=d.map(e=>e.id===B.id?qe(qe({},e),H):e);u(e),X(qe(qe({},K),{},{company_name:H.raisonSociale,company_address:"".concat(H.adresse1||""," ").concat(H.adresse2||""," ").concat(H.codePostal||""," ").concat(H.ville||"").trim(),company_phone:H.telephoneFixe||H.telephonePortable||"",company_email:H.email||""})),A(),sr.success("Entreprise mise \xe0 jour avec succ\xe8s")},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[(0,Pn.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pn.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,Pn.jsx)("span",{children:"Sauvegarder"})]})]})]})}),q&&$&&(0,Pn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Pn.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[(0,Pn.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 rounded-t-xl",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h2",{className:"text-2xl font-bold",children:"D\xe9tails de l'\xe9tudiant"}),(0,Pn.jsxs)("p",{className:"text-blue-100 mt-1",children:[$.first_name," ",$.last_name," - ",$.class||"Non assign\xe9"]})]}),(0,Pn.jsx)("button",{onClick:()=>G(!1),className:"text-white hover:text-blue-200 transition-colors",children:(0,Pn.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pn.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,Pn.jsxs)("div",{className:"p-6",children:[(0,Pn.jsxs)("div",{className:"mb-6",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informations personnelles"}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Pn.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom complet"}),(0,Pn.jsxs)("p",{className:"text-gray-900",children:[$.first_name," ",$.last_name]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de naissance"}),(0,Pn.jsx)("p",{className:"text-gray-900",children:$.date_de_naissance})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Classe"}),(0,Pn.jsx)("p",{className:"text-gray-900",children:$.class||"Non assign\xe9"})]})]})]}),(()=>{const e=a.find(e=>e.student_id==$.id);return e?(0,Pn.jsxs)("div",{className:"mb-6",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informations du stage"}),(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Pn.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Entreprise"}),(0,Pn.jsx)("p",{className:"text-gray-900 font-medium",children:e.company_name})]}),(0,Pn.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tuteur"}),(0,Pn.jsx)("p",{className:"text-gray-900",children:e.supervisor_name||"Non d\xe9fini"})]}),(0,Pn.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"P\xe9riode"}),(0,Pn.jsx)("p",{className:"text-gray-900",children:e.start_date&&e.end_date?"".concat(C(e.start_date)," au ").concat(C(e.end_date)):"Non d\xe9fini"})]}),(0,Pn.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),(0,Pn.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("active"===e.status?"bg-green-100 text-green-800":"completed"===e.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:"active"===e.status?"En cours":"completed"===e.status?"Termin\xe9":"Termin\xe9 anticip\xe9"})]})]})]}):(0,Pn.jsxs)("div",{className:"mb-6",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informations du stage"}),(0,Pn.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:(0,Pn.jsx)("p",{className:"text-gray-500",children:"Aucun stage assign\xe9"})})]})})(),(0,Pn.jsxs)("div",{className:"mb-6",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Activit\xe9s enregistr\xe9es"}),(()=>{const e=o.filter(e=>e.student_id==$.id);return e.length>0?(0,Pn.jsx)("div",{className:"overflow-x-auto",children:(0,Pn.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,Pn.jsx)("thead",{className:"bg-gray-100",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Date"}),(0,Pn.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Titre"}),(0,Pn.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Type"}),(0,Pn.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Heures"}),(0,Pn.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Description"}),(0,Pn.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Observations"})]})}),(0,Pn.jsx)("tbody",{className:"bg-white",children:e.map((e,t)=>(0,Pn.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:C(e.date)}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900 font-medium",children:e.title||"Sans titre"}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:(0,Pn.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("technical"===e.type?"bg-blue-100 text-blue-800":"administrative"===e.type?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"),children:"technical"===e.type?"Technique":"administrative"===e.type?"Administrative":"Formation"})}),(0,Pn.jsxs)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:[e.hours,"h"]}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900 max-w-xs",children:(0,Pn.jsx)("div",{className:"truncate",title:e.description,children:e.description})}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900 max-w-xs",children:(0,Pn.jsx)("div",{className:"truncate",title:e.observations||"Aucune observation",children:e.observations||"-"})})]},t))})]})}):(0,Pn.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:(0,Pn.jsx)("p",{className:"text-gray-500",children:"Aucune activit\xe9 enregistr\xe9e"})})})()]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Absences enregistr\xe9es"}),(()=>{const e=i.filter(e=>e.student_id==$.id);return e.length>0?(0,Pn.jsx)("div",{className:"overflow-x-auto",children:(0,Pn.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,Pn.jsx)("thead",{className:"bg-gray-100",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Date"}),(0,Pn.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Type"}),(0,Pn.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Dur\xe9e"}),(0,Pn.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Raison"})]})}),(0,Pn.jsx)("tbody",{className:"bg-white",children:e.map((e,t)=>(0,Pn.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:C(e.date)}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:(0,Pn.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("justified"===e.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"justified"===e.type?"Justifi\xe9e":"Non justifi\xe9e"})}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:"full_day"===e.duration?"Journ\xe9e compl\xe8te":"Demi-journ\xe9e"}),(0,Pn.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm text-gray-900",children:e.reason||"Non sp\xe9cifi\xe9e"})]},t))})]})}):(0,Pn.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:(0,Pn.jsx)("p",{className:"text-gray-500",children:"Aucune absence enregistr\xe9e"})})})()]})]}),(0,Pn.jsx)("div",{className:"bg-gray-50 px-6 py-4 rounded-b-xl flex justify-end",children:(0,Pn.jsx)("button",{onClick:()=>G(!1),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Fermer"})})]})})]})},ni=Vn("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),si=Vn("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),ii=Vn("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);var li={version:"0.18.5"},oi=1200,ci=1252,di=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ui={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fi=function(e){-1!=di.indexOf(e)&&(ci=ui[0]=e)};var hi=function(e){oi=e,fi(e)};function mi(){hi(1200),fi(1252)}function pi(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function gi(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var xi,vi=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==r?gi(e.slice(2)):65279==t?e.slice(1):e},bi=function(e){return String.fromCharCode(e)},yi=function(e){return String.fromCharCode(e)};var wi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ni(e){for(var t="",r=0,a=0,n=0,s=0,i=0,l=0,o=0,c=0;c<e.length;)s=(r=e.charCodeAt(c++))>>2,i=(3&r)<<4|(a=e.charCodeAt(c++))>>4,l=(15&a)<<2|(n=e.charCodeAt(c++))>>6,o=63&n,isNaN(a)?l=o=64:isNaN(n)&&(o=64),t+=wi.charAt(s)+wi.charAt(i)+wi.charAt(l)+wi.charAt(o);return t}function ji(e){var t="",r=0,a=0,n=0,s=0,i=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var o=0;o<e.length;)r=wi.indexOf(e.charAt(o++))<<2|(s=wi.indexOf(e.charAt(o++)))>>4,t+=String.fromCharCode(r),a=(15&s)<<4|(i=wi.indexOf(e.charAt(o++)))>>2,64!==i&&(t+=String.fromCharCode(a)),n=(3&i)<<6|(l=wi.indexOf(e.charAt(o++))),64!==l&&(t+=String.fromCharCode(n));return t}var ki=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),Ei=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(Ge){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Si(e){return ki?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Ti(e){return ki?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var _i=function(e){return ki?Ei(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function Ci(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Ai(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ai(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Oi=ki?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:Ei(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var Ri=/\u0000/g,Pi=/[\u0001-\u0006]/g;function Di(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Li(e,t){var r=""+e;return r.length>=t?r:Wl("0",t-r.length)+r}function Ii(e,t){var r=""+e;return r.length>=t?r:Wl(" ",t-r.length)+r}function Mi(e,t){var r=""+e;return r.length>=t?r:r+Wl(" ",t-r.length)}var Fi=Math.pow(2,32);function Ui(e,t){return e>Fi||e<-Fi?function(e,t){var r=""+Math.round(e);return r.length>=t?r:Wl("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:Wl("0",t-r.length)+r}(Math.round(e),t)}function zi(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Bi=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Vi=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Hi={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Wi={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},qi={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Gi(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,i=1,l=0,o=1,c=0,d=0,u=Math.floor(n);c<t&&(l=(u=Math.floor(n))*i+s,d=u*c+o,!(n-u<5e-8));)n=1/(n-u),s=i,i=l,o=c,c=d;if(d>t&&(c>t?(d=o,l=s):(d=c,l=i)),!r)return[0,a*l,d];var f=Math.floor(a*l/d);return[f,a*l-f*d,d]}function $i(e,t,r){if(e>2958465||e<0)return null;var a=0|e,n=Math.floor(86400*(e-a)),s=0,i=[],l={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,86400==++n&&(l.T=n=0,++a,++l.D)),60===a)i=r?[1317,10,29]:[1900,2,29],s=3;else if(0===a)i=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var o=new Date(1900,0,1);o.setDate(o.getDate()+a-1),i=[o.getFullYear(),o.getMonth()+1,o.getDate()],s=o.getDay(),a<60&&(s=(s+6)%7),r&&(s=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(o,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=s,l}var Yi=new Date(1899,11,31,0,0,0),Ki=Yi.getTime(),Xi=new Date(1900,2,1,0,0,0);function Ji(e,t){var r=e.getTime();return t?r-=1262304e5:e>=Xi&&(r+=864e5),(r-(Ki+6e4*(e.getTimezoneOffset()-Yi.getTimezoneOffset())))/864e5}function Qi(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Zi(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=Qi(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=Qi(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),Qi(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function el(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Zi(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return wl(14,Ji(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function tl(e,t,r,a){var n,s="",i=0,l=0,o=r.y,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:n=o%100,c=2;break;default:n=o%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:n=r.m,c=t.length;break;case 3:return Vi[r.m-1][1];case 5:return Vi[r.m-1][0];default:return Vi[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:n=r.d,c=t.length;break;case 3:return Bi[r.q][0];default:return Bi[r.q][1]}break;case 104:switch(t.length){case 1:case 2:n=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:n=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:n=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(l=a>=2?3===a?1e3:100:1===a?10:1,(i=Math.round(l*(r.S+r.u)))>=60*l&&(i=0),"s"===t?0===i?"0":""+i/l:(s=Li(i,2+a),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):Li(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":n=24*r.D+r.H;break;case"[m]":case"[mm]":n=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":n=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:n=o,c=1}return c>0?Li(n,c):""}function rl(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var al=/%/g;function nl(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+nl(e,-t);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),-1===(r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(n+s)%n)+"."+a.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var sl=/# (\?+)( ?)\/( ?)(\d+)/;var il=/^#*0*\.([0#]+)/,ll=/\).*[0#]/,ol=/\(###\) ###\\?-####/;function cl(e){for(var t,r="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function dl(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function ul(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function fl(e,t,r){if(40===e.charCodeAt(0)&&!t.match(ll)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fl("n",a,r):"("+fl("n",a,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return pl(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var a=t.replace(al,""),n=t.length-a.length;return pl(e,a,r*Math.pow(10,2*n))+Wl("%",n)}(e,t,r);if(-1!==t.indexOf("E"))return nl(t,r);if(36===t.charCodeAt(0))return"$"+fl(e,t.substr(" "==t.charAt(1)?2:1),r);var n,s,i,l,o=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ui(o,t.length);if(t.match(/^[#?]+$/))return"0"===(n=Ui(r,0))&&(n=""),n.length>t.length?n:cl(t.substr(0,t.length-n.length))+n;if(s=t.match(sl))return function(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),s=Math.floor(n/a),i=n-s*a,l=a;return r+(0===s?"":""+s)+" "+(0===i?Wl(" ",e[1].length+1+e[4].length):Ii(i,e[1].length)+e[2]+"/"+e[3]+Li(l,e[4].length))}(s,o,c);if(t.match(/^#+0+$/))return c+Ui(o,t.length-t.indexOf("0"));if(s=t.match(il))return n=dl(r,s[1].length).replace(/^([^\.]+)$/,"$1."+cl(s[1])).replace(/\.$/,"."+cl(s[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+Wl("0",cl(s[1]).length-t.length)}),-1!==t.indexOf("0.")?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+dl(o,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+rl(Ui(o,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fl(e,t,-r):rl(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,s[1].length)))+"."+Li(ul(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return fl(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Di(fl(e,t.replace(/[\\-]/g,""),r)),i=0,Di(Di(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<n.length?n.charAt(i++):"0"===e?"0":""}));if(t.match(ol))return"("+(n=fl(e,"##########",r)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),l=Gi(o,Math.pow(10,i)-1,!1),n=""+c," "==(d=pl("n",s[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),n+=d+s[2]+"/"+s[3],(d=Mi(l[2],i)).length<s[4].length&&(d=cl(s[4].substr(s[4].length-d.length))+d),n+=d;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((l=Gi(o,Math.pow(10,i)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?Ii(l[1],i)+s[2]+"/"+s[3]+Mi(l[2],i):Wl(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=Ui(r,0),t.length<=n.length?n:cl(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var u=t.indexOf(".")-i,f=t.length-n.length-u;return cl(t.substr(0,u)+n+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=ul(r,s[1].length),r<0?"-"+fl(e,t,-r):rl(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Li(0,3-e.length):"")+e})+"."+Li(i,s[1].length);switch(t){case"###,##0.00":return fl(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=rl(Ui(o,0));return"0"!==h?c+h:"";case"###,###.00":return fl(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return fl(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function hl(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+hl(e,-t);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),!(r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(n+s)%n)+"."+a.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ml(e,t,r){if(40===e.charCodeAt(0)&&!t.match(ll)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ml("n",a,r):"("+ml("n",a,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return pl(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var a=t.replace(al,""),n=t.length-a.length;return pl(e,a,r*Math.pow(10,2*n))+Wl("%",n)}(e,t,r);if(-1!==t.indexOf("E"))return hl(t,r);if(36===t.charCodeAt(0))return"$"+ml(e,t.substr(" "==t.charAt(1)?2:1),r);var n,s,i,l,o=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Li(o,t.length);if(t.match(/^[#?]+$/))return n=""+r,0===r&&(n=""),n.length>t.length?n:cl(t.substr(0,t.length-n.length))+n;if(s=t.match(sl))return function(e,t,r){return r+(0===t?"":""+t)+Wl(" ",e[1].length+2+e[4].length)}(s,o,c);if(t.match(/^#+0+$/))return c+Li(o,t.length-t.indexOf("0"));if(s=t.match(il))return n=(n=(""+r).replace(/^([^\.]+)$/,"$1."+cl(s[1])).replace(/\.$/,"."+cl(s[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+Wl("0",cl(s[1]).length-t.length)}),-1!==t.indexOf("0.")?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+rl(""+o);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ml(e,t,-r):rl(""+r)+"."+Wl("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ml(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Di(ml(e,t.replace(/[\\-]/g,""),r)),i=0,Di(Di(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<n.length?n.charAt(i++):"0"===e?"0":""}));if(t.match(ol))return"("+(n=ml(e,"##########",r)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),l=Gi(o,Math.pow(10,i)-1,!1),n=""+c," "==(d=pl("n",s[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),n+=d+s[2]+"/"+s[3],(d=Mi(l[2],i)).length<s[4].length&&(d=cl(s[4].substr(s[4].length-d.length))+d),n+=d;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((l=Gi(o,Math.pow(10,i)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?Ii(l[1],i)+s[2]+"/"+s[3]+Mi(l[2],i):Wl(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:cl(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var u=t.indexOf(".")-i,f=t.length-n.length-u;return cl(t.substr(0,u)+n+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ml(e,t,-r):rl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Li(0,3-e.length):"")+e})+"."+Li(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=rl(""+o);return"0"!==h?c+h:"";default:if(t.match(/\.[0#?]*$/))return ml(e,t.slice(0,t.lastIndexOf(".")),r)+cl(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function pl(e,t,r){return(0|r)===r?ml(e,t,r):fl(e,t,r)}var gl=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xl(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":zi(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=r;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(gl))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var vl=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function bl(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function yl(e,t){var r=function(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var s=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[a,s];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var i=r[0].match(vl),l=r[1].match(vl);return bl(t,i)?[a,r[0]]:bl(t,l)?[a,r[1]]:[a,r[null!=i&&null!=l?2:1]]}return[a,s]}function wl(e,t,r){null==r&&(r={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(a=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:Hi)[e])&&(a=r.table&&r.table[Wi[e]]||Hi[Wi[e]]),null==a&&(a=qi[e]||"General")}if(zi(a,0))return el(t,r);t instanceof Date&&(t=Ji(t,r.date1904));var n=yl(a,t);if(zi(n[1]))return el(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,a){for(var n,s,i,l=[],o="",c=0,d="",u="t",f="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!zi(e,c))throw new Error("unrecognized character "+d+" in "+e);l[l.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";34!==(i=e.charCodeAt(++c))&&c<e.length;)o+=String.fromCharCode(i);l[l.length]={t:"t",v:o},++c;break;case"\\":var h=e.charAt(++c),m="("===h||")"===h?h:"t";l[l.length]={t:m,v:h},++c;break;case"_":l[l.length]={t:"t",v:" "},c+=2;break;case"@":l[l.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==n&&null==(n=$i(t,r,"2"===e.charAt(c+1))))return"";l[l.length]={t:"X",v:e.substr(c,2)},u=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==n&&null==(n=$i(t,r)))return"";for(o=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)o+=d;"m"===d&&"h"===u.toLowerCase()&&(d="M"),"h"===d&&(d=f),l[l.length]={t:d,v:o},u=d;break;case"A":case"a":case"\u4e0a":var p={t:d,v:d};if(null==n&&(n=$i(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=n&&(p.v=n.H>=12?"P":"A"),p.t="T",f="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=n&&(p.v=n.H>=12?"PM":"AM"),p.t="T",c+=5,f="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=n&&(p.v=n.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),p.t="T",c+=5,f="h"):(p.t="t",++c),null==n&&"T"===p.t)return"";l[l.length]=p,u=d;break;case"[":for(o=d;"]"!==e.charAt(c++)&&c<e.length;)o+=e.charAt(c);if("]"!==o.slice(-1))throw'unterminated "[" block: |'+o+"|";if(o.match(gl)){if(null==n&&null==(n=$i(t,r)))return"";l[l.length]={t:"Z",v:o.toLowerCase()},u=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",xl(e)||(l[l.length]={t:"t",v:o}));break;case".":if(null!=n){for(o=d;++c<e.length&&"0"===(d=e.charAt(c));)o+=d;l[l.length]={t:"s",v:o};break}case"0":case"#":for(o=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)o+=d;l[l.length]={t:"n",v:o};break;case"?":for(o=d;e.charAt(++c)===d;)o+=d;l[l.length]={t:d,v:o},u=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":l[l.length]={t:1===a?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)o+=e.charAt(c);l[l.length]={t:"D",v:o};break;case" ":l[l.length]={t:d,v:d},++c;break;case"$":l[l.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);l[l.length]={t:"t",v:d},++c}var g,x=0,v=0;for(c=l.length-1,u="t";c>=0;--c)switch(l[c].t){case"h":case"H":l[c].t=f,u="h",x<1&&(x=1);break;case"s":(g=l[c].v.match(/\.0+$/))&&(v=Math.max(v,g[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":u=l[c].t;break;case"m":"s"===u&&(l[c].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&l[c].v.match(/[Hh]/)&&(x=1),x<2&&l[c].v.match(/[Mm]/)&&(x=2),x<3&&l[c].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M),n.M>=60&&(n.M=0,++n.H);break;case 2:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M)}var b,y="";for(c=0;c<l.length;++c)switch(l[c].t){case"t":case"T":case" ":case"D":break;case"X":l[c].v="",l[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[c].v=tl(l[c].t.charCodeAt(0),l[c].v,n,v),l[c].t="t";break;case"n":case"?":for(b=c+1;null!=l[b]&&("?"===(d=l[b].t)||"D"===d||(" "===d||"t"===d)&&null!=l[b+1]&&("?"===l[b+1].t||"t"===l[b+1].t&&"/"===l[b+1].v)||"("===l[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===l[b].v||" "===l[b].v&&null!=l[b+1]&&"?"==l[b+1].t));)l[c].v+=l[b].v,l[b]={v:"",t:";"},++b;y+=l[c].v,c=b-1;break;case"G":l[c].t="t",l[c].v=el(t,r)}var w,N,j="";if(y.length>0){40==y.charCodeAt(0)?(w=t<0&&45===y.charCodeAt(0)?-t:t,N=pl("n",y,w)):(N=pl("n",y,w=t<0&&a>1?-t:t),w<0&&l[0]&&"t"==l[0].t&&(N=N.substr(1),l[0].v="-"+l[0].v)),b=N.length-1;var k=l.length;for(c=0;c<l.length;++c)if(null!=l[c]&&"t"!=l[c].t&&l[c].v.indexOf(".")>-1){k=c;break}var E=l.length;if(k===l.length&&-1===N.indexOf("E")){for(c=l.length-1;c>=0;--c)null!=l[c]&&-1!=="n?".indexOf(l[c].t)&&(b>=l[c].v.length-1?(b-=l[c].v.length,l[c].v=N.substr(b+1,l[c].v.length)):b<0?l[c].v="":(l[c].v=N.substr(0,b+1),b=-1),l[c].t="t",E=c);b>=0&&E<l.length&&(l[E].v=N.substr(0,b+1)+l[E].v)}else if(k!==l.length&&-1===N.indexOf("E")){for(b=N.indexOf(".")-1,c=k;c>=0;--c)if(null!=l[c]&&-1!=="n?".indexOf(l[c].t)){for(s=l[c].v.indexOf(".")>-1&&c===k?l[c].v.indexOf(".")-1:l[c].v.length-1,j=l[c].v.substr(s+1);s>=0;--s)b>=0&&("0"===l[c].v.charAt(s)||"#"===l[c].v.charAt(s))&&(j=N.charAt(b--)+j);l[c].v=j,l[c].t="t",E=c}for(b>=0&&E<l.length&&(l[E].v=N.substr(0,b+1)+l[E].v),b=N.indexOf(".")+1,c=k;c<l.length;++c)if(null!=l[c]&&(-1!=="n?(".indexOf(l[c].t)||c===k)){for(s=l[c].v.indexOf(".")>-1&&c===k?l[c].v.indexOf(".")+1:0,j=l[c].v.substr(0,s);s<l[c].v.length;++s)b<N.length&&(j+=N.charAt(b++));l[c].v=j,l[c].t="t",E=c}}}for(c=0;c<l.length;++c)null!=l[c]&&"n?".indexOf(l[c].t)>-1&&(w=a>1&&t<0&&c>0&&"-"===l[c-1].v?-t:t,l[c].v=pl(l[c].t,l[c].v,w),l[c].t="t");var S="";for(c=0;c!==l.length;++c)null!=l[c]&&(S+=l[c].v);return S}(n[1],t,r,n[0])}function Nl(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=Hi[r]){if(Hi[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return Hi[t]=e,t}function jl(){Hi=function(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',e}()}var kl={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},El=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Sl=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,a=0,n="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(a=0;256!=a;++a)n[a]=e[a];for(a=0;256!=a;++a)for(r=e[a],t=256+a;t<4096;t+=256)r=n[t]=r>>>8^e[255&r];var s=[];for(a=1;16!=a;++a)s[a-1]="undefined"!==typeof Int32Array?n.subarray(256*a,256*a+256):n.slice(256*a,256*a+256);return s}(t),a=r[0],n=r[1],s=r[2],i=r[3],l=r[4],o=r[5],c=r[6],d=r[7],u=r[8],f=r[9],h=r[10],m=r[11],p=r[12],g=r[13],x=r[14];return e.table=t,e.bstr=function(e,r){for(var a=-1^r,n=0,s=e.length;n<s;)a=a>>>8^t[255&(a^e.charCodeAt(n++))];return~a},e.buf=function(e,r){for(var v=-1^r,b=e.length-15,y=0;y<b;)v=x[e[y++]^255&v]^g[e[y++]^v>>8&255]^p[e[y++]^v>>16&255]^m[e[y++]^v>>>24]^h[e[y++]]^f[e[y++]]^u[e[y++]]^d[e[y++]]^c[e[y++]]^o[e[y++]]^l[e[y++]]^i[e[y++]]^s[e[y++]]^n[e[y++]]^a[e[y++]]^t[e[y++]];for(b+=15;y<b;)v=v>>>8^t[255&(v^e[y++])];return~v},e.str=function(e,r){for(var a=-1^r,n=0,s=e.length,i=0,l=0;n<s;)(i=e.charCodeAt(n++))<128?a=a>>>8^t[255&(a^i)]:i<2048?a=(a=a>>>8^t[255&(a^(192|i>>6&31))])>>>8^t[255&(a^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),l=1023&e.charCodeAt(n++),a=(a=(a=(a=a>>>8^t[255&(a^(240|i>>8&7))])>>>8^t[255&(a^(128|i>>2&63))])>>>8^t[255&(a^(128|l>>6&15|(3&i)<<4))])>>>8^t[255&(a^(128|63&l))]):a=(a=(a=a>>>8^t[255&(a^(224|i>>12&15))])>>>8^t[255&(a^(128|i>>6&63))])>>>8^t[255&(a^(128|63&i))];return~a},e}(),Tl=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function a(e){if("/"==e.charAt(e.length-1))return a(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function n(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var a=t.getFullYear()-1980;a=(a=a<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,a)}function s(e){Nc(e,0);for(var t={},r=0;e.l<=e.length-4;){var a=e.read_shift(2),n=e.read_shift(2),s=e.l+n,i={};if(21589===a)1&(r=e.read_shift(1))&&(i.mtime=e.read_shift(4)),n>5&&(2&r&&(i.atime=e.read_shift(4)),4&r&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=s,t[a]=i}return t}function i(){return e||(e={})}function l(e,t){if(80==e[0]&&75==e[1])return ae(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=N(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",a=(ki&&Buffer.isBuffer(e)?e.toString("binary"):N(e)).split("\r\n"),n=0,s="";for(n=0;n<a.length;++n)if(s=a[n],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),r||(r=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),s.slice(0,r.length)!=r););var i=(a[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var l="--"+(i[1]||""),o=[],c=[],d={FileIndex:o,FullPaths:c};f(d);var u,h=0;for(n=0;n<a.length;++n){var m=a[n];m!==l&&m!==l+"--"||(h++&&ce(d,a.slice(u,n),r),u=n)}return d}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,a,n,s,i,l,h=512,m=[],p=e.slice(0,512);Nc(p,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(v,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(r=g[0]){case 3:h=512;break;case 4:h=4096;break;case 0:if(0==g[1])return ae(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==h&&Nc(p=e.slice(0,h),28);var b=e.slice(0,h);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,r);var y=p.read_shift(4,"i");if(3===r&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);p.l+=4,s=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),i=p.read_shift(4,"i"),a=p.read_shift(4,"i"),l=p.read_shift(4,"i"),n=p.read_shift(4,"i");for(var w=-1,j=0;j<109&&!((w=p.read_shift(4,"i"))<0);++j)m[j]=w;var k=function(e,t){for(var r=Math.ceil(e.length/t)-1,a=[],n=1;n<r;++n)a[n-1]=e.slice(n*t,(n+1)*t);return a[r-1]=e.slice(r*t),a}(e,h);c(l,n,k,h,m);var E=function(e,t,r,a){var n=e.length,s=[],i=[],l=[],o=[],c=a-1,d=0,u=0,f=0,h=0;for(d=0;d<n;++d)if(l=[],(f=d+t)>=n&&(f-=n),!i[f]){o=[];var m=[];for(u=f;u>=0;){m[u]=!0,i[u]=!0,l[l.length]=u,o.push(e[u]);var p=r[Math.floor(4*u/a)];if(a<4+(h=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+a);if(!e[p])break;if(m[u=mc(e[p],h)])break}s[f]={nodes:l,data:Ho([o])}}return s}(k,s,m,h);E[s].name="!Directory",a>0&&i!==x&&(E[i].name="!MiniFAT"),E[m[0]].name="!FAT",E.fat_addrs=m,E.ssz=h;var S=[],T=[],_=[];!function(e,t,r,a,n,s,i,l){for(var c,f=0,h=a.length?2:0,m=t[e].data,p=0,g=0;p<m.length;p+=128){var v=m.slice(p,p+128);Nc(v,64),g=v.read_shift(2),c=qo(v,0,g-h),a.push(c);var b={name:c,type:v.read_shift(1),color:v.read_shift(1),L:v.read_shift(4,"i"),R:v.read_shift(4,"i"),C:v.read_shift(4,"i"),clsid:v.read_shift(16),state:v.read_shift(4,"i"),start:0,size:0};0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(b.ct=u(v,v.l-8)),0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(b.mt=u(v,v.l-8)),b.start=v.read_shift(4,"i"),b.size=v.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=x,b.name=""),5===b.type?(f=b.start,n>0&&f!==x&&(t[f].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=d(r,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:f!==x&&b.start!==x&&t[f]&&(b.content=o(b,t[f].data,(t[l]||{}).data))),b.content&&Nc(b.content,0),s[c]=b,i.push(b)}}(s,E,k,S,a,{},T,i),function(e,t,r){for(var a=0,n=0,s=0,i=0,l=0,o=r.length,c=[],d=[];a<o;++a)c[a]=d[a]=a,t[a]=r[a];for(;l<d.length;++l)n=e[a=d[l]].L,s=e[a].R,i=e[a].C,c[a]===a&&(-1!==n&&c[n]!==n&&(c[a]=c[n]),-1!==s&&c[s]!==s&&(c[a]=c[s])),-1!==i&&(c[i]=a),-1!==n&&a!=c[a]&&(c[n]=c[a],d.lastIndexOf(n)<l&&d.push(n)),-1!==s&&a!=c[a]&&(c[s]=c[a],d.lastIndexOf(s)<l&&d.push(s));for(a=1;a<o;++a)c[a]===a&&(-1!==s&&c[s]!==s?c[a]=c[s]:-1!==n&&c[n]!==n&&(c[a]=c[n]));for(a=1;a<o;++a)if(0!==e[a].type){if((l=a)!=c[l])do{l=c[l],t[a]=t[l]+"/"+t[a]}while(0!==l&&-1!==c[l]&&l!=c[l]);c[a]=-1}for(t[0]+="/",a=1;a<o;++a)2!==e[a].type&&(t[a]+="/")}(T,_,S),S.shift();var C={FileIndex:T,FullPaths:_};return t&&t.raw&&(C.raw={header:b,sectors:k}),C}function o(e,t,r){for(var a=e.start,n=e.size,s=[],i=a;r&&n>0&&i>=0;)s.push(t.slice(i*g,i*g+g)),n-=g,i=mc(r,4*i);return 0===s.length?kc(0):Oi(s).slice(0,e.size)}function c(e,t,r,a,n){var s=x;if(e===x){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=r[e],l=(a>>>2)-1;if(!i)return;for(var o=0;o<l&&(s=mc(i,4*o))!==x;++o)n.push(s);c(mc(i,a-4),t-1,r,a,n)}}function d(e,t,r,a,n){var s=[],i=[];n||(n=[]);var l=a-1,o=0,c=0;for(o=t;o>=0;){n[o]=!0,s[s.length]=o,i.push(e[o]);var d=r[Math.floor(4*o/a)];if(a<4+(c=4*o&l))throw new Error("FAT boundary crossed: "+o+" 4 "+a);if(!e[d])break;o=mc(e[d],c)}return{nodes:s,data:Ho([i])}}function u(e,t){return new Date(1e3*(hc(e,t+4)/1e7*Math.pow(2,32)+hc(e,t)/1e7-11644473600))}function f(e,t){var r=t||{},a=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=a+"/",e.FileIndex[0]={name:a,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(Tl.find(e,"/"+t))return;var r=kc(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),h(e)}(e)}function h(e,t){f(e);for(var n=!1,s=!1,i=e.FullPaths.length-1;i>=0;--i){var l=e.FileIndex[i];switch(l.type){case 0:s?n=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(l.R*l.L*l.C)&&(n=!0),l.R>-1&&l.L>-1&&l.R==l.L&&(n=!0);break;default:n=!0}}if(n||t){var o=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},u=[];for(i=0;i<e.FullPaths.length;++i)d[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&u.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<u.length;++i){var h=r(u[i][0]);(s=d[h])||(u.push([h,{name:a(h).replace("/",""),type:1,clsid:y,ct:o,mt:o,content:null}]),d[h]=!0)}for(u.sort(function(e,t){return function(e,t){for(var r=e.split("/"),a=t.split("/"),n=0,s=0,i=Math.min(r.length,a.length);n<i;++n){if(s=r[n].length-a[n].length)return s;if(r[n]!=a[n])return r[n]<a[n]?-1:1}return r.length-a.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<u.length;++i)e.FullPaths[i]=u[i][0],e.FileIndex[i]=u[i][1];for(i=0;i<u.length;++i){var m=e.FileIndex[i],p=e.FullPaths[i];if(m.name=a(p).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||y,0===i)m.C=u.length>1?1:-1,m.size=0,m.type=5;else if("/"==p.slice(-1)){for(c=i+1;c<u.length&&r(e.FullPaths[c])!=p;++c);for(m.C=c>=u.length?-1:c,c=i+1;c<u.length&&r(e.FullPaths[c])!=r(p);++c);m.R=c>=u.length?-1:c,m.type=1}else r(e.FullPaths[i+1]||"")==r(p)&&(m.R=i+1),m.type=2}}}function m(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},a=r.boundary||"SheetJS",n=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(a="------="+a).slice(2)+'"',"","",""],s=e.FullPaths[0],i=s,l=e.FileIndex[0],o=1;o<e.FullPaths.length;++o)if(i=e.FullPaths[o].slice(s.length),(l=e.FileIndex[o]).size&&l.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=l.content,d=ki&&Buffer.isBuffer(c)?c.toString("binary"):N(c),u=0,f=Math.min(1024,d.length),h=0,m=0;m<=f;++m)(h=d.charCodeAt(m))>=32&&h<128&&++u;var p=u>=4*f/5;n.push(a),n.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+i),n.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),n.push("Content-Type: "+ie(l,i)),n.push(""),n.push(p?oe(d):le(d))}return n.push(a+"--\r\n"),n.join("\r\n")}(e,r);if(h(e),"zip"===r.fileType)return function(e,t){var r=t||{},a=[],s=[],i=kc(1),l=r.compression?8:0,o=0;0;var c=0,d=0,u=0,f=0,h=e.FullPaths[0],m=h,p=e.FileIndex[0],g=[],x=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(h.length),(p=e.FileIndex[c]).size&&p.content&&"\x01Sh33tJ5"!=m){var v=u,b=kc(m.length);for(d=0;d<m.length;++d)b.write_shift(1,127&m.charCodeAt(d));b=b.slice(0,b.l),g[f]=Sl.buf(p.content,0);var y=p.content;8==l&&(y=j(y)),(i=kc(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,o),i.write_shift(2,l),p.mt?n(i,p.mt):i.write_shift(4,0),i.write_shift(-4,8&o?0:g[f]),i.write_shift(4,8&o?0:y.length),i.write_shift(4,8&o?0:p.content.length),i.write_shift(2,b.length),i.write_shift(2,0),u+=i.length,a.push(i),u+=b.length,a.push(b),u+=y.length,a.push(y),8&o&&((i=kc(12)).write_shift(-4,g[f]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),u+=i.l,a.push(i)),(i=kc(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,o),i.write_shift(2,l),i.write_shift(4,0),i.write_shift(-4,g[f]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),i.write_shift(2,b.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,v),x+=i.l,s.push(i),x+=b.length,s.push(b),++f}return i=kc(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,f),i.write_shift(2,f),i.write_shift(4,x),i.write_shift(4,u),i.write_shift(2,0),Oi([Oi(a),Oi(s),i])}(e,r);var a=function(e){for(var t=0,r=0,a=0;a<e.FileIndex.length;++a){var n=e.FileIndex[a];if(n.content){var s=n.content.length;s>0&&(s<4096?t+=s+63>>6:r+=s+511>>9)}}for(var i=e.FullPaths.length+3>>2,l=t+127>>7,o=(t+7>>3)+r+i+l,c=o+127>>7,d=c<=109?0:Math.ceil((c-109)/127);o+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var u=[1,d,c,l,i,r,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),s=kc(a[7]<<9),i=0,l=0;for(i=0;i<8;++i)s.write_shift(1,b[i]);for(i=0;i<8;++i)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),i=0;i<3;++i)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,a[2]),s.write_shift(4,a[0]+a[1]+a[2]+a[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,a[3]?a[0]+a[1]+a[2]-1:x),s.write_shift(4,a[3]),s.write_shift(-4,a[1]?a[0]-1:x),s.write_shift(4,a[1]),i=0;i<109;++i)s.write_shift(-4,i<a[2]?a[1]+i:-1);if(a[1])for(l=0;l<a[1];++l){for(;i<236+127*l;++i)s.write_shift(-4,i<a[2]?a[1]+i:-1);s.write_shift(-4,l===a[1]-1?x:l+1)}var o=function(e){for(l+=e;i<l-1;++i)s.write_shift(-4,i+1);e&&(++i,s.write_shift(-4,x))};for(l=i=0,l+=a[1];i<l;++i)s.write_shift(-4,w.DIFSECT);for(l+=a[2];i<l;++i)s.write_shift(-4,w.FATSECT);o(a[3]),o(a[4]);for(var c=0,d=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((d=u.content.length)<4096||(u.start=l,o(d+511>>9)));for(o(a[6]+7>>3);511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(l=i=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(d=u.content.length)||d>=4096||(u.start=l,o(d+63>>6)));for(;511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(i=0;i<a[4]<<2;++i){var f=e.FullPaths[i];if(f&&0!==f.length){u=e.FileIndex[i],0===i&&(u.start=u.size?u.start-1:x);var m=0===i&&r.root||u.name;if(d=2*(m.length+1),s.write_shift(64,m,"utf16le"),s.write_shift(2,d),s.write_shift(1,u.type),s.write_shift(1,u.color),s.write_shift(-4,u.L),s.write_shift(-4,u.R),s.write_shift(-4,u.C),u.clsid)s.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,u.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,u.start),s.write_shift(4,u.size),s.write_shift(4,0)}else{for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>=4096)if(s.l=u.start+1<<9,ki&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)s.write_shift(1,u.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>0&&u.size<4096)if(ki&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)s.write_shift(1,u.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(ki)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.2.1";var p,g=64,x=-2,v="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:x,FREESECT:-1,HEADER_SIGNATURE:v,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function N(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function j(e){return p?p.deflateRawSync(e):Y(e)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function T(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var _="undefined"!==typeof Uint8Array,C=_?new Uint8Array(256):[],A=0;A<256;++A)C[A]=T(A);function O(e,t){var r=C[255&e];return t<=8?r>>>8-t:(r=r<<8|C[e>>8&255],t<=16?r>>>16-t:(r=r<<8|C[e>>16&255])>>>24-t)}function R(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=6?0:e[a+1]<<8))>>>r&3}function P(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=5?0:e[a+1]<<8))>>>r&7}function D(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=3?0:e[a+1]<<8))>>>r&31}function L(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=1?0:e[a+1]<<8))>>>r&127}function I(e,t,r){var a=7&t,n=t>>>3,s=(1<<r)-1,i=e[n]>>>a;return r<8-a?i&s:(i|=e[n+1]<<8-a,r<16-a?i&s:(i|=e[n+2]<<16-a,r<24-a?i&s:(i|=e[n+3]<<24-a)&s))}function M(e,t,r){var a=7&t,n=t>>>3;return a<=5?e[n]|=(7&r)<<a:(e[n]|=r<<a&255,e[n+1]=(7&r)>>8-a),t+3}function F(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function U(e,t,r){var a=t>>>3;return r<<=7&t,e[a]|=255&r,r>>>=8,e[a+1]=r,t+8}function z(e,t,r){var a=t>>>3;return r<<=7&t,e[a]|=255&r,r>>>=8,e[a+1]=255&r,e[a+2]=r>>>8,t+16}function B(e,t){var r=e.length,a=2*r>t?2*r:t+5,n=0;if(r>=t)return e;if(ki){var s=Ti(a);if(e.copy)e.copy(s);else for(;n<e.length;++n)s[n]=e[n];return s}if(_){var i=new Uint8Array(a);if(i.set)i.set(e);else for(;n<r;++n)i[n]=e[n];return i}return e.length=a,e}function V(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function H(e,t,r){var a=1,n=0,s=0,i=0,l=0,o=e.length,c=_?new Uint16Array(32):V(32);for(s=0;s<32;++s)c[s]=0;for(s=o;s<r;++s)e[s]=0;o=e.length;var d=_?new Uint16Array(o):V(o);for(s=0;s<o;++s)c[n=e[s]]++,a<n&&(a=n),d[s]=0;for(c[0]=0,s=1;s<=a;++s)c[s+16]=l=l+c[s-1]<<1;for(s=0;s<o;++s)0!=(l=e[s])&&(d[s]=c[l+16]++);var u=0;for(s=0;s<o;++s)if(0!=(u=e[s]))for(l=O(d[s],a)>>a-u,i=(1<<a+4-u)-1;i>=0;--i)t[l|i<<u]=15&u|s<<4;return a}var W=_?new Uint16Array(512):V(512),q=_?new Uint16Array(32):V(32);if(!_){for(var G=0;G<512;++G)W[G]=0;for(G=0;G<32;++G)q[G]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,q,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);H(r,W,288)}();var $=function(){for(var e=_?new Uint8Array(32768):[],t=0,r=0;t<S.length-1;++t)for(;r<S[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var a=_?new Uint8Array(259):[];for(t=0,r=0;t<E.length-1;++t)for(;r<E[t+1];++r)a[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var a=Math.min(65535,e.length-r),n=r+a==e.length;for(t.write_shift(1,+n),t.write_shift(2,a),t.write_shift(2,65535&~a);a-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var n=0,s=0,i=_?new Uint16Array(32768):[];s<t.length;){var l=Math.min(65535,t.length-s);if(l<10){for(7&(n=M(r,n,+!(s+l!=t.length)))&&(n+=8-(7&n)),r.l=n/8|0,r.write_shift(2,l),r.write_shift(2,65535&~l);l-- >0;)r[r.l++]=t[s++];n=8*r.l}else{n=M(r,n,+!(s+l!=t.length)+2);for(var o=0;l-- >0;){var c=t[s],d=-1,u=0;if((d=i[o=32767&(o<<5^c)])&&((d|=-32768&s)>s&&(d-=32768),d<s))for(;t[d+u]==t[s+u]&&u<250;)++u;if(u>2){(c=a[u])<=22?n=U(r,n,C[c+1]>>1)-1:(U(r,n,3),U(r,n+=5,C[c-23]>>5),n+=3);var f=c<8?0:c-4>>2;f>0&&(z(r,n,u-E[c]),n+=f),c=e[s-d],n=U(r,n,C[c]>>3),n-=3;var h=c<4?0:c-2>>1;h>0&&(z(r,n,s-d-S[c]),n+=h);for(var m=0;m<u;++m)i[o]=32767&s,o=32767&(o<<5^t[s]),++s;l-=u-1}else c<=143?c+=48:n=F(r,n,1),n=U(r,n,C[c]),i[o]=32767&s,++s}n=U(r,n,0)-1}}return r.l=(n+7)/8|0,r.l}(t,r)}}();function Y(e){var t=kc(50+Math.floor(1.1*e.length)),r=$(e,t);return t.slice(0,r)}var K=_?new Uint16Array(32768):V(32768),X=_?new Uint16Array(32768):V(32768),J=_?new Uint16Array(128):V(128),Q=1,Z=1;function ee(e,t){var r=D(e,t)+257,a=D(e,t+=5)+1,n=function(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=4?0:e[a+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var s=0,i=_?new Uint8Array(19):V(19),l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=1,c=_?new Uint8Array(8):V(8),d=_?new Uint8Array(8):V(8),u=i.length,f=0;f<n;++f)i[k[f]]=s=P(e,t),o<s&&(o=s),c[s]++,t+=3;var h=0;for(c[0]=0,f=1;f<=o;++f)d[f]=h=h+c[f-1]<<1;for(f=0;f<u;++f)0!=(h=i[f])&&(l[f]=d[h]++);var m=0;for(f=0;f<u;++f)if(0!=(m=i[f])){h=C[l[f]]>>8-m;for(var p=(1<<7-m)-1;p>=0;--p)J[h|p<<m]=7&m|f<<3}var g=[];for(o=1;g.length<r+a;)switch(t+=7&(h=J[L(e,t)]),h>>>=3){case 16:for(s=3+R(e,t),t+=2,h=g[g.length-1];s-- >0;)g.push(h);break;case 17:for(s=3+P(e,t),t+=3;s-- >0;)g.push(0);break;case 18:for(s=11+L(e,t),t+=7;s-- >0;)g.push(0);break;default:g.push(h),o<h&&(o=h)}var x=g.slice(0,r),v=g.slice(r);for(f=r;f<286;++f)x[f]=0;for(f=a;f<30;++f)v[f]=0;return Q=H(x,K,286),Z=H(v,X,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[Si(t),2];for(var r=0,a=0,n=Ti(t||1<<18),s=0,i=n.length>>>0,l=0,o=0;0==(1&a);)if(a=P(e,r),r+=3,a>>>1!=0)for(a>>1==1?(l=9,o=5):(r=ee(e,r),l=Q,o=Z);;){!t&&i<s+32767&&(i=(n=B(n,s+32767)).length);var c=I(e,r,l),d=a>>>1==1?W[c]:K[c];if(r+=15&d,0===((d>>>=4)>>>8&255))n[s++]=d;else{if(256==d)break;var u=(d-=257)<8?0:d-4>>2;u>5&&(u=0);var f=s+E[d];u>0&&(f+=I(e,r,u),r+=u),c=I(e,r,o),r+=15&(d=a>>>1==1?q[c]:X[c]);var h=(d>>>=4)<4?0:d-2>>1,m=S[d];for(h>0&&(m+=I(e,r,h),r+=h),!t&&i<f&&(i=(n=B(n,f+100)).length);s<f;)n[s]=n[s-m],++s}}else{7&r&&(r+=8-(7&r));var p=e[r>>>3]|e[(r>>>3)+1]<<8;if(r+=32,p>0)for(!t&&i<s+p&&(i=(n=B(n,s+p)).length);p-- >0;)n[s++]=e[r>>>3],r+=8}return t?[n,r+7>>>3]:[n.slice(0,s),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ae(e,t){var r=e;Nc(r,0);var a={FileIndex:[],FullPaths:[]};f(a,{root:t.root});for(var n=r.length-4;(80!=r[n]||75!=r[n+1]||5!=r[n+2]||6!=r[n+3])&&n>=0;)--n;r.l=n+4,r.l+=4;var i=r.read_shift(2);r.l+=6;var l=r.read_shift(4);for(r.l=l,n=0;n<i;++n){r.l+=20;var o=r.read_shift(4),c=r.read_shift(4),d=r.read_shift(2),u=r.read_shift(2),h=r.read_shift(2);r.l+=8;var m=r.read_shift(4),p=s(r.slice(r.l+d,r.l+d+u));r.l+=d+u+h;var g=r.l;r.l=m+4,ne(r,o,c,a,p),r.l=g}return a}function ne(e,t,r,a,n){e.l+=2;var i=e.read_shift(2),l=e.read_shift(2),o=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),a=new Date,n=31&r,s=15&(r>>>=5);r>>>=4,a.setMilliseconds(0),a.setFullYear(r+1980),a.setMonth(s-1),a.setDate(n);var i=31&t,l=63&(t>>>=5);return t>>>=6,a.setHours(t),a.setMinutes(l),a.setSeconds(i<<1),a}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2),f=e.read_shift(2),h="",m=0;m<u;++m)h+=String.fromCharCode(e[e.l++]);if(f){var g=s(e.slice(e.l,e.l+f));(g[21589]||{}).mt&&(o=g[21589].mt),((n||{})[21589]||{}).mt&&(o=n[21589].mt)}e.l+=f;var x=e.slice(e.l,e.l+c);switch(l){case 8:x=function(e,t){if(!p)return te(e,t);var r=new(0,p.InflateRaw),a=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,a}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+l)}var v=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),v=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=t&&re(v,"Bad compressed size: "+t+" != "+c),d!=r&&re(v,"Bad uncompressed size: "+r+" != "+d),de(a,h,x,{unsafe:!0,mt:o})}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var r=e.name||"",a=r.match(/\.([^\.]+)$/);return a&&se[a[1]]||t&&(a=(r=t).match(/[\.\\]([^\.\\])+$/))&&se[a[1]]?se[a[1]]:"application/octet-stream"}function le(e){for(var t=Ni(e),r=[],a=0;a<t.length;a+=76)r.push(t.slice(a,a+76));return r.join("\r\n")+"\r\n"}function oe(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],a=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),n=0;n<a.length;++n){var s=a[n];if(0!=s.length)for(var i=0;i<s.length;){var l=76,o=s.slice(i,i+l);"="==o.charAt(l-1)?l--:"="==o.charAt(l-2)?l-=2:"="==o.charAt(l-3)&&(l-=3),o=s.slice(i,i+l),(i+=l)<s.length&&(o+="="),r.push(o)}else r.push("")}return r.join("\r\n")}function ce(e,t,r){for(var a,n="",s="",i="",l=0;l<10;++l){var o=t[l];if(!o||o.match(/^\s*$/))break;var c=o.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":n=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++l,s.toLowerCase()){case"base64":a=_i(ji(t.slice(l).join("")));break;case"quoted-printable":a=function(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r];r<=e.length&&"="==a.charAt(a.length-1);)a=a.slice(0,a.length-1)+e[++r];t.push(a)}for(var n=0;n<t.length;++n)t[n]=t[n].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return _i(t.join("\r\n"))}(t.slice(l));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var d=de(e,n.slice(r.length),a,{unsafe:!0});i&&(d.ctype=i)}function de(e,t,r,n){var s=n&&n.unsafe;s||f(e);var i=!s&&Tl.find(e,t);if(!i){var l=e.FullPaths[0];t.slice(0,l.length)==l?l=t:("/"!=l.slice(-1)&&(l+="/"),l=(l+t).replace("//","/")),i={name:a(t),type:2},e.FileIndex.push(i),e.FullPaths.push(l),s||Tl.utils.cfb_gc(e)}return i.content=r,i.size=r?r.length:0,n&&(n.CLSID&&(i.clsid=n.CLSID),n.mt&&(i.mt=n.mt),n.ct&&(i.ct=n.ct)),i}return t.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),a=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),n=!1;47===t.charCodeAt(0)?(n=!0,t=r[0].slice(0,-1)+t):n=-1!==t.indexOf("/");var s=t.toUpperCase(),i=!0===n?r.indexOf(s):a.indexOf(s);if(-1!==i)return e.FileIndex[i];var l=!s.match(Pi);for(s=s.replace(Ri,""),l&&(s=s.replace(Pi,"!")),i=0;i<r.length;++i){if((l?r[i].replace(Pi,"!"):r[i]).replace(Ri,"")==s)return e.FileIndex[i];if((l?a[i].replace(Pi,"!"):a[i]).replace(Ri,"")==s)return e.FileIndex[i]}return null},t.read=function(t,r){var a=r&&r.type;switch(a||ki&&Buffer.isBuffer(t)&&(a="buffer"),a||"base64"){case"file":return function(t,r){return i(),l(e.readFileSync(t),r)}(t,r);case"base64":return l(_i(ji(t)),r);case"binary":return l(_i(t),r)}return l(t,r)},t.parse=l,t.write=function(t,r){var a=m(t,r);switch(r&&r.type||"buffer"){case"file":return i(),e.writeFileSync(r.filename,a),a;case"binary":return"string"==typeof a?a:N(a);case"base64":return Ni("string"==typeof a?a:N(a));case"buffer":if(ki)return Buffer.isBuffer(a)?a:Ei(a);case"array":return"string"==typeof a?_i(a):a}return a},t.writeFile=function(t,r,a){i();var n=m(t,a);e.writeFileSync(r,n)},t.utils={cfb_new:function(e){var t={};return f(t,e),t},cfb_add:de,cfb_del:function(e,t){f(e);var r=Tl.find(e,t);if(r)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==r)return e.FileIndex.splice(a,1),e.FullPaths.splice(a,1),!0;return!1},cfb_mov:function(e,t,r){f(e);var n=Tl.find(e,t);if(n)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==n)return e.FileIndex[s].name=a(r),e.FullPaths[s]=r,!0;return!1},cfb_gc:function(e){h(e,!0)},ReadShift:gc,CheckField:wc,prep_blob:Nc,bconcat:Oi,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(Ge){console.error("cannot use native zlib: "+(Ge.message||Ge))}},_deflateRaw:Y,_inflateRaw:te,consts:w},t}();let _l;function Cl(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function Al(e){for(var t=[],r=Cl(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}var Ol=new Date(1899,11,30,0,0,0);function Rl(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(Ol.getTime()+6e4*(e.getTimezoneOffset()-Ol.getTimezoneOffset())))/864e5}var Pl=new Date,Dl=Ol.getTime()+6e4*(Pl.getTimezoneOffset()-Ol.getTimezoneOffset()),Ll=Pl.getTimezoneOffset();function Il(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Dl),t.getTimezoneOffset()!==Ll&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Ll)),t}function Ml(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!a)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(n[s],10)}return t}var Fl=new Date("2017-02-19T19:06:09.000Z"),Ul=isNaN(Fl.getFullYear())?new Date("2/19/17"):Fl,zl=2017==Ul.getFullYear();function Bl(e,t){var r=new Date(e);if(zl)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==Ul.getFullYear()&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function Vl(e,t){if(ki&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return _o(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return _o(gi(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return _o(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return _o(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return r[e]||e})}catch(Ge){}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Hl(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Hl(e[r]));return t}function Wl(e,t){for(var r="";r.length<t;)r+=e;return r}function ql(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(a))?(a=a.replace(/[(](.*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(a))?t:t/r):t/r}var Gl=["january","february","march","april","may","june","july","august","september","october","november","december"];function $l(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Gl.indexOf(i))return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&101!=a?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Yl=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,a){if(e||"string"==typeof r)return t.split(r);for(var n=t.split(r),s=[n[0]],i=1;i<n.length;++i)s.push(a),s.push(n[i]);return s}}();function Kl(e){return e?e.content&&e.type?Vl(e.content,!0):e.data?vi(e.data):e.asNodeBuffer&&ki?vi(e.asNodeBuffer().toString("binary")):e.asBinary?vi(e.asBinary()):e._data&&e._data.getContent?vi(Vl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Xl(e){if(!e)return null;if(e.data)return pi(e.data);if(e.asNodeBuffer&&ki)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?pi(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Jl(e,t){for(var r=e.FullPaths||Cl(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||n==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Ql(e,t){var r=Jl(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function Zl(e,t,r){if(!r)return function(e){return e&&".bin"===e.name.slice(-4)?Xl(e):Kl(e)}(Ql(e,t));if(!t)return null;try{return Zl(e,t)}catch(Ge){return null}}function eo(e,t,r){if(!r)return Kl(Ql(e,t));if(!t)return null;try{return eo(e,t)}catch(Ge){return null}}function to(e,t,r){if(!r)return Xl(Ql(e,t));if(!t)return null;try{return to(e,t)}catch(Ge){return null}}function ro(e){for(var t=e.FullPaths||Cl(e.files),r=[],a=0;a<t.length;++a)"/"!=t[a].slice(-1)&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function ao(e,t,r){if(e.FullPaths){var a;if("string"==typeof r)return a=ki?Ei(r):function(e){for(var t=[],r=0,a=e.length+250,n=Si(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)n[r++]=i;else if(i<2048)n[r++]=192|i>>6&31,n[r++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var l=1023&e.charCodeAt(++s);n[r++]=240|i>>8&7,n[r++]=128|i>>2&63,n[r++]=128|l>>6&15|(3&i)<<4,n[r++]=128|63&l}else n[r++]=224|i>>12&15,n[r++]=128|i>>6&63,n[r++]=128|63&i;r>a&&(t.push(n.slice(0,r)),r=0,n=Si(65535),a=65530)}return t.push(n.slice(0,r)),Oi(t)}(r),Tl.utils.cfb_add(e,t,a);Tl.utils.cfb_add(e,t,r)}else e.file(t,r)}function no(e,t){switch(t.type){case"base64":return Tl.read(e,{type:"base64"});case"binary":return Tl.read(e,{type:"binary"});case"buffer":case"array":return Tl.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function so(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var a=e.split("/");0!==a.length;){var n=a.shift();".."===n?r.pop():"."!==n&&r.push(n)}return r.join("/")}var io='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',lo=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,oo=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,co=io.match(oo)?oo:/<[^>]*>/g,uo=/<\w*:/,fo=/<(\/?)\w+:/;function ho(e,t,r){for(var a={},n=0,s=0;n!==e.length&&(32!==(s=e.charCodeAt(n))&&10!==s&&13!==s);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var i=e.match(lo),l=0,o="",c=0,d="",u="",f=1;if(i)for(c=0;c!=i.length;++c){for(u=i[c],s=0;s!=u.length&&61!==u.charCodeAt(s);++s);for(d=u.slice(0,s).trim();32==u.charCodeAt(s+1);)++s;for(f=34==(n=u.charCodeAt(s+1))||39==n?1:0,o=u.slice(s+1+f,u.length-f),l=0;l!=d.length&&58!==d.charCodeAt(l);++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=o,r||(a[d.toLowerCase()]=o);else{var h=(5===l&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(l+1);if(a[h]&&"ext"==d.slice(l-3,l))continue;a[h]=o,r||(a[h.toLowerCase()]=o)}}return a}function mo(e){return e.replace(fo,"<$1")}var po={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},go=Al(po),xo=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(-1==s)return n.replace(e,function(e,t){return po[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var i=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,i)+r(n.slice(i+3))}}(),vo=/[&<>'"]/g;var bo=/[\u0000-\u001f]/g;function yo(e){return(e+"").replace(vo,function(e){return go[e]}).replace(/\n/g,"<br/>").replace(bo,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var wo=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function No(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function jo(e){for(var t="",r=0,a=0,n=0,s=0,i=0,l=0;r<e.length;)(a=e.charCodeAt(r++))<128?t+=String.fromCharCode(a):(n=e.charCodeAt(r++),a>191&&a<224?(i=(31&a)<<6,i|=63&n,t+=String.fromCharCode(i)):(s=e.charCodeAt(r++),a<240?t+=String.fromCharCode((15&a)<<12|(63&n)<<6|63&s):(l=((7&a)<<18|(63&n)<<12|(63&s)<<6|63&(i=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(1023&l)))));return t}function ko(e){var t,r,a,n=Si(2*e.length),s=1,i=0,l=0;for(r=0;r<e.length;r+=s)s=1,(a=e.charCodeAt(r))<128?t=a:a<224?(t=64*(31&a)+(63&e.charCodeAt(r+1)),s=2):a<240?(t=4096*(15&a)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),s=3):(s=4,t=262144*(7&a)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),l=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==l&&(n[i++]=255&l,n[i++]=l>>>8,l=0),n[i++]=t%256,n[i++]=t>>>8;return n.slice(0,i).toString("ucs2")}function Eo(e){return Ei(e,"binary").toString("utf8")}var So="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",To=ki&&(Eo(So)==jo(So)&&Eo||ko(So)==jo(So)&&ko)||jo,_o=ki?function(e){return Ei(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(63&a)));break;case a>=55296&&a<57344:a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)))}return t.join("")},Co=function(){var e={};return function(t,r){var a=t+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),Ao=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}}(),Oo=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Ro=/<\/?(?:vt:)?variant>/g,Po=/<(?:vt:)([^>]*)>([\s\S]*)</;function Do(e,t){var r=ho(e),a=e.match(Oo(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(e){var t=e.replace(Ro,"").match(Po);t&&n.push({v:To(t[2]),t:t[1]})}),n}var Lo=/(^\s|\s$|\n)/;function Io(e){return Cl(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Mo(e,t,r){return"<"+e+(null!=r?Io(r):"")+(null!=t?(t.match(Lo)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Fo(e){if(ki&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return To(Ci(Ai(e)));throw new Error("Bad input format: expected Buffer or string")}var Uo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,zo="http://schemas.openxmlformats.org/package/2006/content-types",Bo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var Vo=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,n=e[0][r].length;a<n;a+=10240)t.push.apply(t,e[0][r].slice(a,a+10240));return t},Ho=ki?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:Ei(e)})):Vo(e)}:Vo,Wo=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(uc(e,n)));return a.join("").replace(Ri,"")},qo=ki?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ri,""):Wo(e,t,r)}:Wo,Go=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},$o=ki?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Go(e,t,r)}:Go,Yo=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(dc(e,n)));return a.join("")},Ko=ki?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):Yo(e,t,r)}:Yo,Xo=function(e,t){var r=hc(e,t);return r>0?Ko(e,t+4,t+4+r-1):""},Jo=Xo,Qo=function(e,t){var r=hc(e,t);return r>0?Ko(e,t+4,t+4+r-1):""},Zo=Qo,ec=function(e,t){var r=2*hc(e,t);return r>0?Ko(e,t+4,t+4+r-1):""},tc=ec,rc=function(e,t){var r=hc(e,t);return r>0?qo(e,t+4,t+4+r):""},ac=rc,nc=function(e,t){var r=hc(e,t);return r>0?Ko(e,t+4,t+4+r):""},sc=nc,ic=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),a=((127&e[t+7])<<4)+(e[t+6]>>>4&15),n=15&e[t+6],s=5;s>=0;--s)n=256*n+e[t+s];return 2047==a?0==n?r*(1/0):NaN:(0==a?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}(e,t)},lc=ic,oc=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function cc(){qo=function(e,t,r){return xi.utils.decode(1200,e.slice(t,r)).replace(Ri,"")},Ko=function(e,t,r){return xi.utils.decode(65001,e.slice(t,r))},Jo=function(e,t){var r=hc(e,t);return r>0?xi.utils.decode(ci,e.slice(t+4,t+4+r-1)):""},Zo=function(e,t){var r=hc(e,t);return r>0?xi.utils.decode(oi,e.slice(t+4,t+4+r-1)):""},tc=function(e,t){var r=2*hc(e,t);return r>0?xi.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},ac=function(e,t){var r=hc(e,t);return r>0?xi.utils.decode(1200,e.slice(t+4,t+4+r)):""},sc=function(e,t){var r=hc(e,t);return r>0?xi.utils.decode(65001,e.slice(t+4,t+4+r)):""}}ki&&(Jo=function(e,t){if(!Buffer.isBuffer(e))return Xo(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Zo=function(e,t){if(!Buffer.isBuffer(e))return Qo(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},tc=function(e,t){if(!Buffer.isBuffer(e))return ec(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},ac=function(e,t){if(!Buffer.isBuffer(e))return rc(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},sc=function(e,t){if(!Buffer.isBuffer(e))return nc(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},lc=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):ic(e,t)},oc=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof xi&&cc();var dc=function(e,t){return e[t]},uc=function(e,t){return 256*e[t+1]+e[t]},fc=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},hc=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},mc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},pc=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function gc(e,t){var r,a,n,s,i,l,o="",c=[];switch(t){case"dbcs":if(l=this.l,ki&&Buffer.isBuffer(this))o=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)o+=String.fromCharCode(uc(this,l)),l+=2;e*=2;break;case"utf8":o=Ko(this,this.l,this.l+e);break;case"utf16le":e*=2,o=qo(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof xi)return gc.call(this,e,"dbcs");o=xi.utils.decode(oi,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":o=Jo(this,this.l),e=4+hc(this,this.l);break;case"lpstr-cp":o=Zo(this,this.l),e=4+hc(this,this.l);break;case"lpwstr":o=tc(this,this.l),e=4+2*hc(this,this.l);break;case"lpp4":e=4+hc(this,this.l),o=ac(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+hc(this,this.l),o=sc(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,o="";0!==(n=dc(this,this.l+e++));)c.push(bi(n));o=c.join("");break;case"_wstr":for(e=0,o="";0!==(n=uc(this,this.l+e));)c.push(bi(n)),e+=2;e+=2,o=c.join("");break;case"dbcs-cont":for(o="",l=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(l))return n=dc(this,l),this.l=l+1,s=gc.call(this,e-i,n?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(bi(uc(this,l))),l+=2}o=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof xi){o=xi.utils.decode(oi,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(o="",l=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(l))return n=dc(this,l),this.l=l+1,s=gc.call(this,e-i,n?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(bi(dc(this,l))),l+=1}o=c.join("");break;default:switch(e){case 1:return r=dc(this,this.l),this.l++,r;case 2:return r=("i"===t?fc:uc)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?mc:pc)(this,this.l),this.l+=4,r):(a=hc(this,this.l),this.l+=4,a);case 8:case-8:if("f"===t)return a=8==e?lc(this,this.l):lc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:o=$o(this,this.l,e)}}return this.l+=e,o}var xc=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},vc=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},bc=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function yc(e,t,r){var a=0,n=0;if("dbcs"===r){for(n=0;n!=t.length;++n)bc(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if("sbcs"===r){if("undefined"!==typeof xi&&874==ci)for(n=0;n!=t.length;++n){var s=xi.utils.encode(ci,t.charAt(n));this[this.l+n]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=255&t.charCodeAt(n);a=t.length}else{if("hex"===r){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}if("utf16le"===r){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=255&l,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:a=1,this[this.l]=255&t;break;case 2:a=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:a=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:a=4,xc(this,t,this.l);break;case 8:if(a=8,"f"===r){!function(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,i=a?-t:t;isFinite(i)?0==i?n=s=0:(n=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=255&s;e[r+6]=(15&n)<<4|15&s,e[r+7]=n>>4|a}(this,t,this.l);break}case 16:break;case-4:a=4,vc(this,t,this.l)}}return this.l+=a,this}function wc(e,t){var r=$o(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Nc(e,t){e.l=t,e.read_shift=gc,e.chk=wc,e.write_shift=yc}function jc(e,t){e.l+=t}function kc(e){var t=Si(e);return Nc(t,0),t}function Ec(e,t,r){if(e){var a,n,s;Nc(e,e.l||0);for(var i=e.length,l=0,o=0;e.l<i;){128&(l=e.read_shift(1))&&(l=(127&l)+((127&e.read_shift(1))<<7));var c=Lm[l]||Lm[65535];for(s=127&(a=e.read_shift(1)),n=1;n<4&&128&a;++n)s+=(127&(a=e.read_shift(1)))<<7*n;o=e.l+s;var d=c.f&&c.f(e,s,r);if(e.l=o,t(d,c,l))return}}}function Sc(){var e=[],t=ki?256:2048,r=function(e){var t=kc(e);return Nc(t,0),t},a=r(t),n=function(){a&&(a.length>a.l&&((a=a.slice(0,a.l)).l=a.length),a.length>0&&e.push(a),a=null)},s=function(e){return a&&e<a.length-a.l?a:(n(),a=r(Math.max(e+1,t)))};return{next:s,push:function(e){n(),null==(a=e).l&&(a.l=a.length),s(t)},end:function(){return n(),Oi(e)},_bufs:e}}function Tc(e,t,r){var a=Hl(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function _c(e,t,r){var a=Hl(e);return a.s=Tc(a.s,t.s,r),a.e=Tc(a.e,t.s,r),a}function Cc(e,t){if(e.cRel&&e.c<0)for(e=Hl(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Hl(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ic(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function Ac(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?Cc(e.s,t.biff)+":"+Cc(e.e,t.biff):(e.s.rRel?"":"$")+Rc(e.s.r)+":"+(e.e.rRel?"":"$")+Rc(e.e.r):(e.s.cRel?"":"$")+Dc(e.s.c)+":"+(e.e.cRel?"":"$")+Dc(e.e.c)}function Oc(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Rc(e){return""+(e+1)}function Pc(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Dc(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Lc(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ic(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Mc(e){var t=e.indexOf(":");return-1==t?{s:Lc(e),e:Lc(e)}:{s:Lc(e.slice(0,t)),e:Lc(e.slice(t+1))}}function Fc(e,t){return"undefined"===typeof t||"number"===typeof t?Fc(e.s,e.e):("string"!==typeof e&&(e=Ic(e)),"string"!==typeof t&&(t=Ic(t)),e==t?e:e+":"+t)}function Uc(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||10!=n)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function zc(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=wl(e.z,r?Rl(t):t)}catch(Ge){}try{return e.w=wl((e.XF||{}).numFmtId||(r?14:0),r?Rl(t):t)}catch(Ge){return""+t}}function Bc(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?md[e.v]||e.v:zc(e,void 0==t?e.v:t))}function Vc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function Hc(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense;var s=e||(n?[]:{}),i=0,l=0;if(s&&null!=a.origin){if("number"==typeof a.origin)i=a.origin;else{var o="string"==typeof a.origin?Lc(a.origin):a.origin;i=o.r,l=o.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Uc(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==i&&(c.e.r=i=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[u].length;++f)if("undefined"!==typeof t[u][f]){var h={v:t[u][f]},m=i+u,p=l+f;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),!t[u][f]||"object"!==typeof t[u][f]||Array.isArray(t[u][f])||t[u][f]instanceof Date)if(Array.isArray(h.v)&&(h.f=t[u][f][1],h.v=h.v[0]),null===h.v)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else{if(!a.sheetStubs)continue;h.t="z"}else"number"===typeof h.v?h.t="n":"boolean"===typeof h.v?h.t="b":h.v instanceof Date?(h.z=a.dateNF||Hi[14],a.cellDates?(h.t="d",h.w=wl(h.z,Rl(h.v))):(h.t="n",h.v=Rl(h.v),h.w=wl(h.z,h.v))):h.t="s";else h=t[u][f];if(n)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(h.z=s[m][p].z),s[m][p]=h;else{var g=Ic({c:p,r:m});s[g]&&s[g].z&&(h.z=s[g].z),s[g]=h}}}return c.s.c<1e7&&(s["!ref"]=Fc(c)),s}function Wc(e,t){return Hc(null,e,t)}function qc(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Gc(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function $c(e,t){var r=e.l,a=e.read_shift(1),n=qc(e),s=[],i={t:n,h:n};if(0!==(1&a)){for(var l=e.read_shift(4),o=0;o!=l;++o)s.push(Gc(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var Yc=$c;function Kc(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Xc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Jc=qc;function Qc(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var Zc=qc,ed=Qc;function td(e){var t=e.slice(e.l,e.l+4),r=1&t[0],a=2&t[0];e.l+=4;var n=0===a?lc([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):mc(t,0)>>2;return r?n/100:n}function rd(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ad=rd;function nd(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function sd(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var id=80,ld=[id,81],od={1:{n:"CodePage",t:2},2:{n:"Category",t:id},3:{n:"PresentationFormat",t:id},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:id},15:{n:"Company",t:id},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:id},27:{n:"ContentStatus",t:id},28:{n:"Language",t:id},29:{n:"Version",t:id},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},cd={1:{n:"CodePage",t:2},2:{n:"Title",t:id},3:{n:"Subject",t:id},4:{n:"Author",t:id},5:{n:"Keywords",t:id},6:{n:"Comments",t:id},7:{n:"Template",t:id},8:{n:"LastAuthor",t:id},9:{n:"RevNumber",t:id},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:id},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},dd={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ud=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function fd(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var hd=Hl(fd([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),md={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},pd={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},gd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var xd={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vd(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function bd(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var a={};return(e.match(co)||[]).forEach(function(e){var n=ho(e);if("<Relationship"===n[0]){var s={};s.Type=n.Type,s.Target=n.Target,s.Id=n.Id,n.TargetMode&&(s.TargetMode=n.TargetMode);var i="External"===n.TargetMode?n.Target:so(n.Target,t);r[i]=s,a[n.Id]=s}}),r["!id"]=a,r}var yd=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],wd=function(){for(var e=new Array(yd.length),t=0;t<yd.length;++t){var r=yd[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function Nd(e){var t={};e=To(e);for(var r=0;r<yd.length;++r){var a=yd[r],n=e.match(wd[r]);null!=n&&n.length>0&&(t[a[1]]=xo(n[1])),"date"===a[2]&&t[a[1]]&&(t[a[1]]=Bl(t[a[1]]))}return t}var jd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function kd(e,t,r,a){var n=[];if("string"==typeof e)n=Do(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(e){return{v:e}}));var i="string"==typeof t?Do(t,a).map(function(e){return e.v}):t,l=0,o=0;if(i.length>0)for(var c=0;c!==n.length;c+=2){switch(o=+n[c+1].v,n[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":r.Worksheets=o,r.SheetNames=i.slice(l,l+o);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":r.NamedRanges=o,r.DefinedNames=i.slice(l,l+o);break;case"Charts":case"Diagramme":r.Chartsheets=o,r.ChartNames=i.slice(l,l+o)}l+=o}}var Ed=/<[^>]+>[^<]*/g;var Sd,Td={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function _d(e,t,r){Sd||(Sd=Al(Td)),e[t=Sd[t]||t]=r}function Cd(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Ad(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function Od(e,t,r){var a=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(a.length+1&3)&3),a}function Rd(e,t,r){return 31===t?Od(e):Ad(e,0,r)}function Pd(e,t,r){return Rd(e,t,!1===r?0:4)}function Dd(e){var t=e.l,r=Md(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,Md(e,3)]}function Ld(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var s=e.read_shift(4),i=e.read_shift(4);a[s]=e.read_shift(i,1200===t?"utf16le":"utf8").replace(Ri,"").replace(Pi,"!"),1200===t&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),a}function Id(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function Md(e,t,r){var a,n=e.read_shift(2),s=r||{};if(e.l+=2,12!==t&&n!==t&&-1===ld.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&n)))throw new Error("Expected type "+t+" saw "+n);switch(12===t?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return a=e.read_shift(4);case 30:return Ad(e,0,4).replace(Ri,"");case 31:return Od(e);case 64:return Cd(e);case 65:return Id(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Pd(e,n,!s.raw).replace(Ri,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Rd(e,t,0)}(e,n).replace(Ri,"");case 4108:return function(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(Dd(e));return r}(e);case 4126:case 4127:return 4127==n?function(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Ri,""),e.l-n&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Ri,"");return r}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Fd(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0,l=0,o=-1,c={};for(i=0;i!=n;++i){var d=e.read_shift(4),u=e.read_shift(4);s[i]=[d,u+r]}s.sort(function(e,t){return e[1]-t[1]});var f={};for(i=0;i!=n;++i){if(e.l!==s[i][1]){var h=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,h=!1);break;case 80:case 4108:e.l<=s[i][1]&&(e.l=s[i][1],h=!1)}if((!t||0==i)&&e.l<=s[i][1]&&(h=!1,e.l=s[i][1]),h)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[s[i][0]];if(f[m.n]=Md(e,m.t,{raw:!0}),"version"===m.p&&(f[m.n]=String(f[m.n]>>16)+"."+("0000"+String(65535&f[m.n])).slice(-4)),"CodePage"==m.n)switch(f[m.n]){case 0:f[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:hi(l=f[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[m.n])}}else if(1===s[i][0]){if(l=f.CodePage=Md(e,2),hi(l),-1!==o){var p=e.l;e.l=s[o][1],c=Ld(e,l),e.l=p}}else if(0===s[i][0]){if(0===l){o=i,e.l=s[i+1][1];continue}c=Ld(e,l)}else{var g,x=c[s[i][0]];switch(e[e.l]){case 65:e.l+=4,g=Id(e);break;case 30:case 31:e.l+=4,g=Pd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Bd(e,4);break;case 64:e.l+=4,g=Bl(Cd(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[x]=g}}return e.l=r+a,f}function Ud(e,t,r){var a=e.content;if(!a)return{};Nc(a,0);var n,s,i,l,o=0;a.chk("feff","Byte Order: "),a.read_shift(2);var c=a.read_shift(4),d=a.read_shift(16);if(d!==Tl.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(1!==(n=a.read_shift(4))&&2!==n)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),l=a.read_shift(4),1===n&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);2===n&&(i=a.read_shift(16),o=a.read_shift(4));var u,f=Fd(a,t),h={SystemIdentifier:c};for(var m in f)h[m]=f[m];if(h.FMTID=s,1===n)return h;if(o-a.l==2&&(a.l+=2),a.l!==o)throw new Error("Length mismatch 2: "+a.l+" !== "+o);try{u=Fd(a,null)}catch(Ge){}for(m in u)h[m]=u[m];return h.FMTID=[s,i],h}function zd(e,t){return e.read_shift(t),null}function Bd(e,t){return 1===e.read_shift(t)}function Vd(e){return e.read_shift(2,"u")}function Hd(e,t){return function(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}(e,t,Vd)}function Wd(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont",s=oi;(r&&r.biff>=8&&(oi=1200),r&&8!=r.biff)?12==r.biff&&(n="wstr"):e.read_shift(1)&&(n="dbcs-cont");r.biff>=2&&r.biff<=5&&(n="cpstr");var i=a?e.read_shift(a,n):"";return oi=s,i}function qd(e){var t=oi;oi=1200;var r,a=e.read_shift(2),n=e.read_shift(1),s=4&n,i=8&n,l=1+(1&n),o=0,c={};i&&(o=e.read_shift(2)),s&&(r=e.read_shift(4));var d=2==l?"dbcs-cont":"sbcs-cont",u=0===a?"":e.read_shift(a,d);return i&&(e.l+=4*o),s&&(e.l+=r),c.t=u,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),oi=t,c}function Gd(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function $d(e,t,r){var a=e.read_shift(r&&2==r.biff?1:2);return 0===a?(e.l++,""):Gd(e,a,r)}function Yd(e,t,r){if(r.biff>5)return $d(e,0,r);var a=e.read_shift(1);return 0===a?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Kd(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Ri,"");return a&&(e.l+=24),n}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+a.replace(/\\/g,"/");var n=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(n>>1,"utf16le").replace(Ri,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}function Xd(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(Ri,""):""}function Jd(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function Qd(e,t){var r=Jd(e);return r[3]=0,r}function Zd(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function eu(e,t,r){var a=r.biff>8?4:2;return[e.read_shift(a),e.read_shift(a,"i"),e.read_shift(a,"i")]}function tu(e){return[e.read_shift(2),td(e)]}function ru(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function au(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}var nu=au;function su(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function iu(e){e.l+=2,e.l+=e.read_shift(2)}var lu={0:iu,4:iu,5:iu,6:iu,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:iu,9:iu,10:iu,11:iu,12:iu,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:iu,15:iu,16:iu,17:iu,18:iu,19:iu,20:iu,21:su};function ou(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function cu(e,t,r){var a=0;r&&2==r.biff||(a=e.read_shift(2));var n=e.read_shift(2);return r&&2==r.biff&&(a=1-(n>>15),n&=32767),[{Unsynced:1&a,DyZero:(2&a)>>1,ExAsc:(4&a)>>2,ExDsc:(8&a)>>3},n]}var du=Yd;function uu(e,t,r){var a=e.l+t,n=8!=r.biff&&r.biff?2:4,s=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(2),o=e.read_shift(2);return e.l=a,{s:{r:s,c:l},e:{r:i,c:o}}}function fu(e,t,r){var a=Zd(e);2!=r.biff&&9!=t||++e.l;var n=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return a.val=n,a.t=!0===n||!1===n?"b":"e",a}var hu=function(e,t,r){return 0===t?"":Yd(e,0,r)};function mu(e,t,r){var a,n=e.read_shift(2),s={fBuiltIn:1&n,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return 14849===r.sbcch&&(a=function(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=Wd(e,0,r),s=e.read_shift(2);if(s!==(a-=e.l))throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}(e,t-2,r)),s.body=a||e.read_shift(t-2),"string"===typeof a&&(s.Name=a),s}var pu=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function gu(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(r&&2==r.biff?1:2),o=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),o=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var c=Gd(e,i,r);32&n&&(c=pu[c.charCodeAt(0)]);var d=a-e.l;r&&2==r.biff&&--d;var u=a!=e.l&&0!==l&&d>0?function(e,t,r,a){var n,s=e.l+t,i=ih(e,a,r);s!==e.l&&(n=sh(e,s-e.l,i,r));return[i,n]}(e,d,r,l):[];return{chKey:s,Name:c,itab:o,rgce:u}}function xu(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var a=Wd(e,0,r);return 3==a.charCodeAt(0)?a.slice(1):a}(e,0,r);for(var a=[],n=e.l+t,s=e.read_shift(r.biff>8?4:2);0!==s--;)a.push(eu(e,r.biff,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function vu(e,t,r){var a=nu(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,fh(e,t,r)]}var bu={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function yu(e,t,r){if(!r.cellStyles)return jc(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(2);2==a&&(e.l+=2);var c={s:n,e:s,w:i,ixfe:l,flags:o};return(r.biff>=5||!r.biff)&&(c.level=o>>8&7),c}var wu=Zd,Nu=Hd,ju=$d;var ku=[2,3,48,49,131,139,140,245],Eu=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Al({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var a=r||{};a.dateNF||(a.dateNF="yyyymmdd");var n=Wc(function(t,r){var a=[],n=Si(1);switch(r.type){case"base64":n=_i(ji(t));break;case"binary":n=_i(t);break;case"buffer":case"array":n=t}Nc(n,0);var s=n.read_shift(1),i=!!(136&s),l=!1,o=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:l=!0,i=!0;break;case 140:o=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var c=0,d=521;2==s&&(c=n.read_shift(2)),n.l+=3,2!=s&&(c=n.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(d=n.read_shift(2));var u=n.read_shift(2),f=r.codepage||1252;2!=s&&(n.l+=16,n.read_shift(1),0!==n[n.l]&&(f=e[n[n.l]]),n.l+=1,n.l+=2),o&&(n.l+=36);for(var h=[],m={},p=Math.min(n.length,2==s?521:d-10-(l?264:0)),g=o?32:11;n.l<p&&13!=n[n.l];)switch((m={}).name=xi.utils.decode(f,n.slice(n.l,n.l+g)).replace(/[\u0000\r\n].*$/g,""),n.l+=g,m.type=String.fromCharCode(n.read_shift(1)),2==s||o||(m.offset=n.read_shift(4)),m.len=n.read_shift(1),2==s&&(m.offset=n.read_shift(2)),m.dec=n.read_shift(1),m.name.length&&h.push(m),2!=s&&(n.l+=o?13:14),m.type){case"B":l&&8==m.len||!r.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==n[n.l]&&(n.l=d-1),13!==n.read_shift(1))throw new Error("DBF Terminator not found "+n.l+" "+n[n.l]);n.l=d;var x=0,v=0;for(a[0]=[],v=0;v!=h.length;++v)a[0][v]=h[v].name;for(;c-- >0;)if(42!==n[n.l])for(++n.l,a[++x]=[],v=0,v=0;v!=h.length;++v){var b=n.slice(n.l,n.l+h[v].len);n.l+=h[v].len,Nc(b,0);var y=xi.utils.decode(f,b);switch(h[v].type){case"C":y.trim().length&&(a[x][v]=y.replace(/\s+$/,""));break;case"D":8===y.length?a[x][v]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):a[x][v]=y;break;case"F":a[x][v]=parseFloat(y.trim());break;case"+":case"I":a[x][v]=o?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":a[x][v]=!0;break;case"N":case"F":a[x][v]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));a[x][v]="##MEMO##"+(o?parseInt(y.trim(),10):b.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(a[x][v]=+y||0);break;case"@":a[x][v]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":a[x][v]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":a[x][v]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":a[x][v]=-b.read_shift(-8,"f");break;case"B":if(l&&8==h[v].len){a[x][v]=b.read_shift(8,"f");break}case"G":case"P":b.l+=h[v].len;break;case"0":if("_NullFlags"===h[v].name)break;default:throw new Error("DBF Unsupported data type "+h[v].type)}}else n.l+=u;if(2!=s&&n.l<n.length&&26!=n[n.l++])throw new Error("DBF EOF Marker missing "+(n.l-1)+" of "+n.length+" "+n[n.l-1].toString(16));return r&&r.sheetRows&&(a=a.slice(0,r.sheetRows)),r.DBF=h,a}(t,a),a);return n["!cols"]=a.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete a.DBF,n}var a={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return Vc(r(e,t),t)}catch(Ge){if(t&&t.WTF)throw Ge}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var n=r||{};if(+n.codepage>=0&&hi(+n.codepage),"string"==n.type)throw new Error("Cannot write DBF to JS string");var s=Sc(),i=Cp(e,{header:1,raw:!0,cellDates:!0}),l=i[0],o=i.slice(1),c=e["!cols"]||[],d=0,u=0,f=0,h=1;for(d=0;d<l.length;++d)if(((c[d]||{}).DBF||{}).name)l[d]=c[d].DBF.name,++f;else if(null!=l[d]){if(++f,"number"===typeof l[d]&&(l[d]=l[d].toString(10)),"string"!==typeof l[d])throw new Error("DBF Invalid column name "+l[d]+" |"+typeof l[d]+"|");if(l.indexOf(l[d])!==d)for(u=0;u<1024;++u)if(-1==l.indexOf(l[d]+"_"+u)){l[d]+="_"+u;break}}var m=Uc(e["!ref"]),p=[],g=[],x=[];for(d=0;d<=m.e.c-m.s.c;++d){var v="",b="",y=0,w=[];for(u=0;u<o.length;++u)null!=o[u][d]&&w.push(o[u][d]);if(0!=w.length&&null!=l[d]){for(u=0;u<w.length;++u){switch(typeof w[u]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=w[u]instanceof Date?"D":"C"}y=Math.max(y,String(w[u]).length),v=v&&v!=b?"C":b}y>250&&(y=250),"C"==(b=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>y&&(y=c[d].DBF.len),"B"==v&&"N"==b&&(v="N",x[d]=c[d].DBF.dec,y=c[d].DBF.len),g[d]="C"==v||"N"==b?y:a[v]||0,h+=g[d],p[d]=v}else p[d]="?"}var N=s.next(32);for(N.write_shift(4,318902576),N.write_shift(4,o.length),N.write_shift(2,296+32*f),N.write_shift(2,h),d=0;d<4;++d)N.write_shift(4,0);for(N.write_shift(4,(+t[ci]||3)<<8),d=0,u=0;d<l.length;++d)if(null!=l[d]){var j=s.next(32),k=(l[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,k,"sbcs"),j.write_shift(1,"?"==p[d]?"C":p[d],"sbcs"),j.write_shift(4,u),j.write_shift(1,g[d]||a[p[d]]||0),j.write_shift(1,x[d]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),u+=g[d]||a[p[d]]||0}var E=s.next(264);for(E.write_shift(4,13),d=0;d<65;++d)E.write_shift(4,0);for(d=0;d<o.length;++d){var S=s.next(h);for(S.write_shift(1,0),u=0;u<l.length;++u)if(null!=l[u])switch(p[u]){case"L":S.write_shift(1,null==o[d][u]?63:o[d][u]?84:70);break;case"B":S.write_shift(8,o[d][u]||0,"f");break;case"N":var T="0";for("number"==typeof o[d][u]&&(T=o[d][u].toFixed(x[u]||0)),f=0;f<g[u]-T.length;++f)S.write_shift(1,32);S.write_shift(1,T,"sbcs");break;case"D":o[d][u]?(S.write_shift(4,("0000"+o[d][u].getFullYear()).slice(-4),"sbcs"),S.write_shift(2,("00"+(o[d][u].getMonth()+1)).slice(-2),"sbcs"),S.write_shift(2,("00"+o[d][u].getDate()).slice(-2),"sbcs")):S.write_shift(8,"00000000","sbcs");break;case"C":var _=String(null!=o[d][u]?o[d][u]:"").slice(0,g[u]);for(S.write_shift(1,_,"sbcs"),f=0;f<g[u]-_.length;++f)S.write_shift(1,32)}}return s.next(1).write_shift(1,26),s.end()}}}(),Su=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Cl(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var a=e[r];return"number"==typeof a?yi(a):a},a=function(e,t,r){var a=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==a?e:yi(a)};function n(e,n){var s,i=e.split(/[\n\r]+/),l=-1,o=-1,c=0,d=0,u=[],f=[],h=null,m={},p=[],g=[],x=[],v=0;for(+n.codepage>=0&&hi(+n.codepage);c!==i.length;++c){v=0;var b,y=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),w=y.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),N=w[0];if(y.length>0)switch(N){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&f.push(y.slice(3).replace(/;;/g,";"));break;case"C":var j=!1,k=!1,E=!1,S=!1,T=-1,_=-1;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"A":case"G":break;case"X":o=parseInt(w[d].slice(1))-1,k=!0;break;case"Y":for(l=parseInt(w[d].slice(1))-1,k||(o=0),s=u.length;s<=l;++s)u[s]=[];break;case"K":'"'===(b=w[d].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(ql(b))?isNaN($l(b).getDate())||(b=Bl(b)):(b=ql(b),null!==h&&xl(h)&&(b=Il(b))),"undefined"!==typeof xi&&"string"==typeof b&&"string"!=(n||{}).type&&(n||{}).codepage&&(b=xi.utils.decode(n.codepage,b)),j=!0;break;case"E":S=!0;var C=Df(w[d].slice(1),{r:l,c:o});u[l][o]=[u[l][o],C];break;case"S":E=!0,u[l][o]=[u[l][o],"S5S"];break;case"R":T=parseInt(w[d].slice(1))-1;break;case"C":_=parseInt(w[d].slice(1))-1;break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+y)}if(j&&(u[l][o]&&2==u[l][o].length?u[l][o][0]=b:u[l][o]=b,h=null),E){if(S)throw new Error("SYLK shared formula cannot have own formula");var A=T>-1&&u[T][_];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");u[l][o][1]=Mf(A[1],{r:l-T,c:o-_})}break;case"F":var O=0;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"X":o=parseInt(w[d].slice(1))-1,++O;break;case"Y":for(l=parseInt(w[d].slice(1))-1,s=u.length;s<=l;++s)u[s]=[];break;case"M":v=parseInt(w[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":h=f[parseInt(w[d].slice(1))];break;case"W":for(x=w[d].slice(1).split(" "),s=parseInt(x[0],10);s<=parseInt(x[1],10);++s)v=parseInt(x[2],10),g[s-1]=0===v?{hidden:!0}:{wch:v},cf(g[s-1]);break;case"C":g[o=parseInt(w[d].slice(1))-1]||(g[o]={});break;case"R":p[l=parseInt(w[d].slice(1))-1]||(p[l]={}),v>0?(p[l].hpt=v,p[l].hpx=ff(v)):0===v&&(p[l].hidden=!0);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+y)}O<1&&(h=null);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+y)}}return p.length>0&&(m["!rows"]=p),g.length>0&&(m["!cols"]=g),n&&n.sheetRows&&(u=u.slice(0,n.sheetRows)),[u,m]}function s(e,t){var r=function(e,t){switch(t.type){case"base64":return n(ji(e),t);case"binary":return n(e,t);case"buffer":return n(ki&&Buffer.isBuffer(e)?e.toString("binary"):Ci(e),t);case"array":return n(Vl(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),a=r[0],s=r[1],i=Wc(a,t);return Cl(s).forEach(function(e){i[e]=s[e]}),i}function i(e,t,r,a){var n="C;Y"+(r+1)+";X"+(a+1)+";K";switch(e.t){case"n":n+=e.v||0,e.f&&!e.F&&(n+=";E"+If(e.f,{r:r,c:a}));break;case"b":n+=e.v?"TRUE":"FALSE";break;case"e":n+=e.w||e.v;break;case"d":n+='"'+(e.w||e.v)+'"';break;case"s":n+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return n}return e["|"]=254,{to_workbook:function(e,t){return Vc(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var r,a,n=["ID;PWXL;N;E"],s=[],l=Uc(e["!ref"]),o=Array.isArray(e),c="\r\n";n.push("P;PGeneral"),n.push("F;P0;DG0G8;M255"),e["!cols"]&&(a=n,e["!cols"].forEach(function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=af(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=nf(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&a.push(r)})),e["!rows"]&&function(e,t){t.forEach(function(t,r){var a="F;";t.hidden?a+="M0;":t.hpt?a+="M"+20*t.hpt+";":t.hpx&&(a+="M"+20*uf(t.hpx)+";"),a.length>2&&e.push(a+"R"+(r+1))})}(n,e["!rows"]),n.push("B;Y"+(l.e.r-l.s.r+1)+";X"+(l.e.c-l.s.c+1)+";D"+[l.s.c,l.s.r,l.e.c,l.e.r].join(" "));for(var d=l.s.r;d<=l.e.r;++d)for(var u=l.s.c;u<=l.e.c;++u){var f=Ic({r:d,c:u});(r=o?(e[d]||[])[u]:e[f])&&(null!=r.v||r.f&&!r.F)&&s.push(i(r,0,d,u))}return n.join(c)+c+s.join(c)+c+"E"+c}}}(),Tu=function(){function e(e,t){for(var r=e.split("\n"),a=-1,n=-1,s=0,i=[];s!==r.length;++s)if("BOT"!==r[s].trim()){if(!(a<0)){for(var l=r[s].trim().split(","),o=l[0],c=l[1],d=r[++s]||"";1&(d.match(/["]/g)||[]).length&&s<r.length-1;)d+="\n"+r[++s];switch(d=d.trim(),+o){case-1:if("BOT"===d){i[++a]=[],n=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[a][n]=!0:"FALSE"===d?i[a][n]=!1:isNaN(ql(c))?isNaN($l(c).getDate())?i[a][n]=c:i[a][n]=Bl(c):i[a][n]=ql(c),++n;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[a][n++]=""!==d?d:null}if("EOD"===d)break}}else i[++a]=[],n=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,r){return Wc(function(t,r){switch(r.type){case"base64":return e(ji(t),r);case"binary":return e(t,r);case"buffer":return e(ki&&Buffer.isBuffer(t)?t.toString("binary"):Ci(t),r);case"array":return e(Vl(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}var r=function(){var e=function(e,t,r,a,n){e.push(t),e.push(r+","+a),e.push('"'+n.replace(/"/g,'""')+'"')},t=function(e,t,r,a){e.push(t+","+r),e.push(1==t?'"'+a.replace(/"/g,'""')+'"':a)};return function(r){var a,n=[],s=Uc(r["!ref"]),i=Array.isArray(r);e(n,"TABLE",0,1,"sheetjs"),e(n,"VECTORS",0,s.e.r-s.s.r+1,""),e(n,"TUPLES",0,s.e.c-s.s.c+1,""),e(n,"DATA",0,0,"");for(var l=s.s.r;l<=s.e.r;++l){t(n,-1,0,"BOT");for(var o=s.s.c;o<=s.e.c;++o){var c=Ic({r:l,c:o});if(a=i?(r[l]||[])[o]:r[c])switch(a.t){case"n":var d=a.w;d||null==a.v||(d=a.v),null==d?a.f&&!a.F?t(n,1,0,"="+a.f):t(n,1,0,""):t(n,0,d,"V");break;case"b":t(n,0,a.v?1:0,a.v?"TRUE":"FALSE");break;case"s":t(n,1,0,isNaN(a.v)?a.v:'="'+a.v+'"');break;case"d":a.w||(a.w=wl(a.z||Hi[14],Rl(Bl(a.v)))),t(n,0,a.w,"V");break;default:t(n,1,0,"")}else t(n,1,0,"")}}t(n,-1,0,"EOD");return n.join("\r\n")}}();return{to_workbook:function(e,r){return Vc(t(e,r),r)},to_sheet:t,from_sheet:r}}(),_u=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(t,r){return Wc(function(t,r){for(var a=t.split("\n"),n=-1,s=-1,i=0,l=[];i!==a.length;++i){var o=a[i].trim().split(":");if("cell"===o[0]){var c=Lc(o[1]);if(l.length<=c.r)for(n=l.length;n<=c.r;++n)l[n]||(l[n]=[]);switch(n=c.r,s=c.c,o[2]){case"t":l[n][s]=e(o[3]);break;case"v":l[n][s]=+o[3];break;case"vtf":var d=o[o.length-1];case"vtc":"nl"===o[3]?l[n][s]=!!+o[4]:l[n][s]=+o[4],"vtf"==o[2]&&(l[n][s]=[l[n][s],d])}}}return r&&r.sheetRows&&(l=l.slice(0,r.sheetRows)),l}(t,r),r)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),n=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function l(e){if(!e||!e["!ref"])return"";for(var r,a=[],n=[],s="",i=Mc(e["!ref"]),l=Array.isArray(e),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c)if(s=Ic({r:o,c:c}),(r=l?(e[o]||[])[c]:e[s])&&null!=r.v&&"z"!==r.t){switch(n=["cell",s,"t"],r.t){case"s":case"str":n.push(t(r.v));break;case"n":r.f?(n[2]="vtf",n[3]="n",n[4]=r.v,n[5]=t(r.f)):(n[2]="v",n[3]=r.v);break;case"b":n[2]="vt"+(r.f?"f":"c"),n[3]="nl",n[4]=r.v?"1":"0",n[5]=t(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var d=Rl(Bl(r.v));n[2]="vtc",n[3]="nd",n[4]=""+d,n[5]=r.w||wl(r.z||Hi[14],d);break;case"e":continue}a.push(n.join(":"))}return a.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),a.push("valueformat:1:text-wiki"),a.join("\n")}return{to_workbook:function(e,t){return Vc(r(e,t),t)},to_sheet:r,from_sheet:function(e){return[a,n,s,n,l(e),i].join("\n")}}}(),Cu=function(){function e(e,t,r,a,n){n.raw?t[r][a]=e:""===e||("TRUE"===e?t[r][a]=!0:"FALSE"===e?t[r][a]=!1:isNaN(ql(e))?isNaN($l(e).getDate())?t[r][a]=e:t[r][a]=Bl(e):t[r][a]=ql(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(e){for(var a={},n=!1,s=0,i=0;s<e.length;++s)34==(i=e.charCodeAt(s))?n=!n:!n&&i in t&&(a[i]=(a[i]||0)+1);for(s in i=[],a)Object.prototype.hasOwnProperty.call(a,s)&&i.push([a[s],s]);if(!i.length)for(s in a=r)Object.prototype.hasOwnProperty.call(a,s)&&i.push([a[s],s]);return i.sort(function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]}),t[i.pop()[1]]||44}function n(e,t){var r=t||{},n="";var s=r.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(n=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(n=e.charAt(4),e=e.slice(6)):n=a(e.slice(0,1024)):n=r&&r.FS?r.FS:a(e.slice(0,1024));var l=0,o=0,c=0,d=0,u=0,f=n.charCodeAt(0),h=!1,m=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=r.dateNF?function(e){var t="number"==typeof e?Hi[e]:e;return t=t.replace(El,"(\\d+)"),new RegExp("^"+t+"$")}(r.dateNF):null;function x(){var t=e.slice(d,u),a={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)a.t="z";else if(r.raw)a.t="s",a.v=t;else if(0===t.trim().length)a.t="s",a.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(a.t="s",a.v=t.slice(2,-1).replace(/""/g,'"')):!function(e){return 1!=e.length}(t)?(a.t="s",a.v=t):(a.t="n",a.f=t.slice(1));else if("TRUE"==t)a.t="b",a.v=!0;else if("FALSE"==t)a.t="b",a.v=!1;else if(isNaN(c=ql(t)))if(!isNaN($l(t).getDate())||g&&t.match(g)){a.z=r.dateNF||Hi[14];var n=0;g&&t.match(g)&&(t=function(e,t,r){var a=-1,n=-1,s=-1,i=-1,l=-1,o=-1;(t.match(El)||[]).forEach(function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":a=c;break;case"d":s=c;break;case"h":i=c;break;case"s":o=c;break;case"m":i>=0?l=c:n=c}}),o>=0&&-1==l&&n>=0&&(l=n,n=-1);var c=(""+(a>=0?a:(new Date).getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return-1==i&&-1==l&&-1==o?c:-1==a&&-1==n&&-1==s?d:c+"T"+d}(0,r.dateNF,t.match(g)||[]),n=1),r.cellDates?(a.t="d",a.v=Bl(t,n)):(a.t="n",a.v=Rl(Bl(t,n))),!1!==r.cellText&&(a.w=wl(a.z,a.v instanceof Date?Rl(a.v):a.v)),r.cellNF||delete a.z}else a.t="s",a.v=t;else a.t="n",!1!==r.cellText&&(a.w=t),a.v=c;if("z"==a.t||(r.dense?(s[l]||(s[l]=[]),s[l][o]=a):s[Ic({c:o,r:l})]=a),d=u+1,p=e.charCodeAt(d),i.e.c<o&&(i.e.c=o),i.e.r<l&&(i.e.r=l),m==f)++o;else if(o=0,++l,r.sheetRows&&r.sheetRows<=l)return!0}e:for(;u<e.length;++u)switch(m=e.charCodeAt(u)){case 34:34===p&&(h=!h);break;case f:case 10:case 13:if(!h&&x())break e}return u-d>0&&x(),s["!ref"]=Fc(i),s}function s(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?n(t,r):Wc(function(t,r){var a=r||{},n=[];if(!t||0===t.length)return n;for(var s=t.split(/[\r\n]/),i=s.length-1;i>=0&&0===s[i].length;)--i;for(var l=10,o=0,c=0;c<=i;++c)-1==(o=s[c].indexOf(" "))?o=s[c].length:o++,l=Math.max(l,o);for(c=0;c<=i;++c){n[c]=[];var d=0;for(e(s[c].slice(0,l).trim(),n,c,d,a),d=1;d<=(s[c].length-l)/10+1;++d)e(s[c].slice(l+10*(d-1),l+10*d).trim(),n,c,d,a)}return a.sheetRows&&(n=n.slice(0,a.sheetRows)),n}(t,r),r):n(t,r)}function i(e,t){var r="",a="string"==t.type?[0,0,0,0]:kp(e,t);switch(t.type){case"base64":r=ji(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof xi?xi.utils.decode(t.codepage,e):ki&&Buffer.isBuffer(e)?e.toString("binary"):Ci(e);break;case"array":r=Vl(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==a[0]&&187==a[1]&&191==a[2]?r=To(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=To(r):"binary"==t.type&&"undefined"!==typeof xi&&t.codepage&&(r=xi.utils.decode(t.codepage,xi.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?_u.to_sheet("string"==t.type?r:To(r),t):s(r,t)}return{to_workbook:function(e,t){return Vc(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,r=[],a=Uc(e["!ref"]),n=Array.isArray(e),s=a.s.r;s<=a.e.r;++s){for(var i=[],l=a.s.c;l<=a.e.c;++l){var o=Ic({r:s,c:l});if((t=n?(e[s]||[])[l]:e[o])&&null!=t.v){for(var c=(t.w||(Bc(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===l?" ":""))}else i.push("          ")}r.push(i.join(""))}return r.join("\n")}}}();var Au=function(){function e(e,t,r){if(e){Nc(e,e.l||0);for(var a=r.Enum||x;e.l<e.length;){var n=e.read_shift(2),s=a[n]||a[65535],i=e.read_shift(2),l=e.l+i,o=s.f&&s.f(e,i,r);if(e.l=l,t(o,s,n))return}}}function t(t,r){if(!t)return t;var a=r||{};var n=a.dense?[]:{},s="Sheet1",i="",l=0,o={},c=[],d=[],u={s:{r:0,c:0},e:{r:0,c:0}},f=a.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])a.Enum=x,e(t,function(e,t,r){switch(r){case 0:a.vers=e,e>=4096&&(a.qpro=!0);break;case 6:u=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:a.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=a.dateNF||Hi[14],a.cellDates&&(e[1].t="d",e[1].v=Il(e[1].v))),a.qpro&&e[3]>l&&(n["!ref"]=Fc(u),o[s]=n,c.push(s),n=a.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],s=i||"Sheet"+(l+1),i="");var d=a.dense?(n[e[0].r]||[])[e[0].c]:n[Ic(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}a.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[Ic(e[0])]=e[1]}},a);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);a.Enum=v,14==t[2]&&(a.qpro=!0,t.l=0),e(t,function(e,t,r){switch(r){case 204:s=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>l&&(n["!ref"]=Fc(u),o[s]=n,c.push(s),n=a.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],s="Sheet"+(l+1)),f>0&&e[0].r>=f)break;a.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[Ic(e[0])]=e[1],u.e.c<e[0].c&&(u.e.c=e[0].c),u.e.r<e[0].r&&(u.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==l&&(s=e[1])}},a)}if(n["!ref"]=Fc(u),o[i||s]=n,c.push(i||s),!d.length)return{SheetNames:c,Sheets:o};for(var h={},m=[],p=0;p<d.length;++p)o[c[p]]?(m.push(d[p]||c[p]),h[d[p]]=o[d[p]]||o[c[p]]):(m.push(d[p]),h[d[p]]={"!ref":"A1"});return{SheetNames:m,Sheets:h}}function r(e,t,r){var a=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(a[0].c=e.read_shift(1),a[3]=e.read_shift(1),a[0].r=e.read_shift(2),e.l+=2):(a[2]=e.read_shift(1),a[0].c=e.read_shift(2),a[0].r=e.read_shift(2)),a}function a(e,t,a){var n=e.l+t,s=r(e,0,a);if(s[1].t="s",20768==a.vers){e.l++;var i=e.read_shift(1);return s[1].v=e.read_shift(i,"utf8"),s}return a.qpro&&e.l++,s[1].v=e.read_shift(n-e.l,"cstr"),s}function n(e,t,r){var a=kc(7+r.length);a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(1,39);for(var n=0;n<a.length;++n){var s=r.charCodeAt(n);a.write_shift(1,s>=128?95:s)}return a.write_shift(1,0),a}function s(e,t,r){var a=kc(7);return a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(2,r,"i"),a}function i(e,t,r){var a=kc(13);return a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(8,r,"f"),a}function l(e,t,r){var a=32768&t;return t=(a?e:0)+((t&=-32769)>=8192?t-16384:t),(a?"":"$")+(r?Dc(t):Rc(t))}var o={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function u(e,t,r,a){var n=kc(6+a.length);n.write_shift(2,e),n.write_shift(1,r),n.write_shift(1,t),n.write_shift(1,39);for(var s=0;s<a.length;++s){var i=a.charCodeAt(s);n.write_shift(1,i>=128?95:i)}return n.write_shift(1,0),n}function f(e,t){var r=d(e),a=e.read_shift(4),n=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===a&&3221225472===n?(r[1].t="e",r[1].v=15):0===a&&3489660928===n?(r[1].t="e",r[1].v=42):r[1].v=0,r;var i=32768&s;return s=(32767&s)-16446,r[1].v=(1-2*i)*(n*Math.pow(2,s+32)+a*Math.pow(2,s)),r}function h(e,t,r,a){var n=kc(14);if(n.write_shift(2,e),n.write_shift(1,r),n.write_shift(1,t),0==a)return n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,65535),n;var s,i=0,l=0,o=0;return a<0&&(i=1,a=-a),l=0|Math.log2(a),0==(2147483648&(o=(a/=Math.pow(2,l-31))>>>0))&&(++l,o=(a/=2)>>>0),a-=o,o|=2147483648,o>>>=0,s=(a*=Math.pow(2,32))>>>0,n.write_shift(4,s),n.write_shift(4,o),l+=16383+(i?32768:0),n.write_shift(2,l),n}function m(e,t){var r=d(e),a=e.read_shift(8,"f");return r[1].v=a,r}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var r=kc(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var a=0;a<e.length;++a){var n=e.charCodeAt(a);r[r.l++]=n>127?95:n}return r[r.l++]=0,r}var x={0:{n:"BOF",f:Vd},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var a={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(a.s.c=e.read_shift(1),e.l++,a.s.r=e.read_shift(2),a.e.c=e.read_shift(1),e.l++,a.e.r=e.read_shift(2),a):(a.s.c=e.read_shift(2),a.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),a.e.c=e.read_shift(2),a.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==a.s.c&&(a.s.c=a.e.c=a.s.r=a.e.r=0),a)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,a){var n=r(e,0,a);return n[1].v=e.read_shift(2,"i"),n}},14:{n:"NUMBER",f:function(e,t,a){var n=r(e,0,a);return n[1].v=e.read_shift(8,"f"),n}},15:{n:"LABEL",f:a},16:{n:"FORMULA",f:function(e,t,a){var n=e.l+t,s=r(e,0,a);if(s[1].v=e.read_shift(8,"f"),a.qpro)e.l=n;else{var i=e.read_shift(2);!function(e,t){Nc(e,0);var r=[],a=0,n="",s="",i="",d="";for(;e.l<e.length;){var u=e[e.l++];switch(u){case 0:r.push(e.read_shift(8,"f"));break;case 1:s=l(t[0].c,e.read_shift(2),!0),n=l(t[0].r,e.read_shift(2),!1),r.push(s+n);break;case 2:var f=l(t[0].c,e.read_shift(2),!0),h=l(t[0].r,e.read_shift(2),!1);s=l(t[0].c,e.read_shift(2),!0),n=l(t[0].r,e.read_shift(2),!1),r.push(f+h+":"+s+n);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var m="";u=e[e.l++];)m+=String.fromCharCode(u);r.push('"'+m.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:d=r.pop(),i=r.pop(),r.push(["AND","OR"][u-20]+"("+i+","+d+")");break;default:if(u<32&&c[u])d=r.pop(),i=r.pop(),r.push(i+c[u]+d);else{if(!o[u])return u<=7?console.error("WK1 invalid opcode "+u.toString(16)):u<=24?console.error("WK1 unsupported op "+u.toString(16)):u<=30?console.error("WK1 invalid opcode "+u.toString(16)):u<=115?console.error("WK1 unsupported function opcode "+u.toString(16)):console.error("WK1 unrecognized opcode "+u.toString(16));if(69==(a=o[u][1])&&(a=e[e.l++]),a>r.length)return void console.error("WK1 bad formula parse 0x"+u.toString(16)+":|"+r.join("|")+"|");var p=r.slice(-a);r.length-=a,r.push(o[u][0]+"("+p.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+i),s),e.l+=i}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:a},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var a="";a.length<r;)a+=String.fromCharCode(e[e.l++]);return a}},65535:{n:""}},v={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=d(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:f},24:{n:"NUMBER18",f:function(e,t){var r=d(e);r[1].v=e.read_shift(2);var a=r[1].v>>1;if(1&r[1].v)switch(7&a){case 0:a=5e3*(a>>3);break;case 1:a=500*(a>>3);break;case 2:a=(a>>3)/20;break;case 3:a=(a>>3)/200;break;case 4:a=(a>>3)/2e3;break;case 5:a=(a>>3)/2e4;break;case 6:a=(a>>3)/16;break;case 7:a=(a>>3)/64}return r[1].v=a,r}},25:{n:"FORMULA19",f:function(e,t){var r=f(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},a=e.l+t;e.l<a;){var n=e.read_shift(2);if(14e3==n){for(r[n]=[0,""],r[n][0]=e.read_shift(2);e[e.l];)r[n][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=d(e),a=e.read_shift(4);return r[1].v=a>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var r=m(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var a=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[a,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&hi(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var a=Sc(),l=Uc(e["!ref"]),o=Array.isArray(e),c=[];Mm(a,0,function(e){var t=kc(2);return t.write_shift(2,e),t}(1030)),Mm(a,6,function(e){var t=kc(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(l));for(var d=Math.min(l.e.r,8191),u=l.s.r;u<=d;++u)for(var f=Rc(u),h=l.s.c;h<=l.e.c;++h){u===l.s.r&&(c[h]=Dc(h));var m=c[h]+f,p=o?(e[u]||[])[h]:e[m];if(p&&"z"!=p.t)if("n"==p.t)(0|p.v)==p.v&&p.v>=-32768&&p.v<=32767?Mm(a,13,s(u,h,p.v)):Mm(a,14,i(u,h,p.v));else Mm(a,15,n(u,h,Bc(p).slice(0,239)))}return Mm(a,1),a.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&hi(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var a=Sc();Mm(a,0,function(e){var t=kc(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,a=0,n=0,s=0;s<e.SheetNames.length;++s){var i=e.SheetNames[s],l=e.Sheets[i];if(l&&l["!ref"]){++n;var o=Mc(l["!ref"]);r<o.e.r&&(r=o.e.r),a<o.e.c&&(a=o.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,n),t.write_shift(1,a),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var n=0,s=0;n<e.SheetNames.length;++n)(e.Sheets[e.SheetNames[n]]||{})["!ref"]&&Mm(a,27,g(e.SheetNames[n],s++));var i=0;for(n=0;n<e.SheetNames.length;++n){var l=e.Sheets[e.SheetNames[n]];if(l&&l["!ref"]){for(var o=Uc(l["!ref"]),c=Array.isArray(l),d=[],f=Math.min(o.e.r,8191),m=o.s.r;m<=f;++m)for(var p=Rc(m),x=o.s.c;x<=o.e.c;++x){m===o.s.r&&(d[x]=Dc(x));var v=d[x]+p,b=c?(l[m]||[])[x]:l[v];if(b&&"z"!=b.t)if("n"==b.t)Mm(a,23,h(m,x,i,b.v));else Mm(a,22,u(m,x,i,Bc(b).slice(0,239)))}++i}}return Mm(a,1),a.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(_i(ji(e)),r);case"binary":return t(_i(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var Ou=function(){var e=Co("t"),t=Co("rPr");function r(r){var a=r.match(e);if(!a)return{t:"s",v:""};var n={t:"s",v:xo(a[1])},s=r.match(t);return s&&(n.s=function(e){var t={},r=e.match(co),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=ho(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=ui[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(47!==s[0].charCodeAt(1)&&!n)throw new Error("Unrecognized rich format "+s[0])}}return t}(s[1])),n}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(e){return e.replace(a,"").split(n).map(r).filter(function(e){return e.v})}}(),Ru=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var a=[];e.u&&a.push("text-decoration: underline;"),e.uval&&a.push("text-underline-style:"+e.uval+";"),e.sz&&a.push("font-size:"+e.sz+"pt;"),e.outline&&a.push("text-effect: outline;"),e.shadow&&a.push("text-shadow: auto;"),t.push('<span style="'+a.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var n=e.valign||"";"superscript"==n||"super"==n?n="sup":"subscript"==n&&(n="sub"),""!=n&&(t.push("<"+n+">"),r.push("</"+n+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),Pu=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Du=/<(?:\w+:)?r>/,Lu=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Iu(e,t){var r=!t||t.cellHTML,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=xo(To(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=To(e),r&&(a.h=yo(a.t))):e.match(Du)&&(a.r=To(e),a.t=xo(To((e.replace(Lu,"").match(Pu)||[]).join("").replace(co,""))),r&&(a.h=Ru(Ou(a.r)))),a):{t:""}}var Mu=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Fu=/<(?:\w+:)?(?:si|sstItem)>/g,Uu=/<\/(?:\w+:)?(?:si|sstItem)>/;function zu(e){if("undefined"!==typeof xi)return xi.utils.encode(ci,e);for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Bu(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Vu(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function Hu(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Bu(e,4),t.U=Bu(e,4),t.W=Bu(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function Wu(e,t){var r=e.l+t,a={};a.Flags=63&e.read_shift(4),e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=36==a.Flags;break;case 26625:n=4==a.Flags;break;case 0:n=16==a.Flags||4==a.Flags||36==a.Flags;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function qu(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function Gu(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:Wu(e,t),v:qu(e,e.length-e.l)}}function $u(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Yu(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(co,function(e){var r=ho(e);switch(mo(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){a[e]=r[e]});break;case"<dataIntegrity":a.encryptedHmacKey=r.encryptedHmacKey,a.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"<keyEncryptor":a.uri=r.uri;break;case"<encryptedKey":a.encs.push(r);break;default:throw r[0]}}),a}function Ku(e){var t,r,a=0,n=zu(e),s=n.length+1;for((t=Si(s))[0]=n.length,r=1;r!=s;++r)t[r]=n[r-1];for(r=s-1;r>=0;--r)a=((0===(16384&a)?0:1)|a<<1&32767)^t[r];return 52811^a}var Xu=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(n){for(var s,i,l,o=zu(n),c=function(e){for(var a=t[e.length-1],n=104,s=e.length-1;s>=0;--s)for(var i=e[s],l=0;7!=l;++l)64&i&&(a^=r[n]),i*=2,--n;return a}(o),d=o.length,u=Si(16),f=0;16!=f;++f)u[f]=0;for(1===(1&d)&&(s=c>>8,u[d]=a(e[0],s),--d,s=255&c,i=o[o.length-1],u[d]=a(i,s));d>0;)s=c>>8,u[--d]=a(o[d],s),s=255&c,u[--d]=a(o[d],s);for(d=15,l=15-o.length;l>0;)s=c>>8,u[d]=a(e[l],s),--l,s=255&c,u[--d]=a(o[d],s),--d,--l;return u}}(),Ju=function(e){var t=0,r=Xu(e);return function(e){var a=function(e,t,r,a,n){var s,i;for(n||(n=t),a||(a=Xu(e)),s=0;s!=t.length;++s)i=t[s],i=255&((i^=a[r])>>5|i<<3),n[s]=i,++r;return[n,r,a]}("",e,t,r);return t=a[1],a[0]}};function Qu(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,1===a.Info?a.Data=function(e){var t={},r=t.EncryptionVersionInfo=Bu(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):a.Data=function(e,t){var r={},a=r.EncryptionVersionInfo=Bu(e,4);if(t-=4,2!=a.Minor)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=Wu(e,n),t-=n,r.EncryptionVerifier=qu(e,t),r}(e,t),a}var Zu=function(){function e(e,r){switch(r.type){case"base64":return t(ji(e),r);case"binary":return t(e,r);case"buffer":return t(ki&&Buffer.isBuffer(e)?e.toString("binary"):Ci(e),r);case"array":return t(Vl(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},a=e.match(/\\trowd.*?\\row\b/g);if(!a.length)throw new Error("RTF missing table");var n={s:{c:0,r:0},e:{c:0,r:a.length-1}};return a.forEach(function(e,t){Array.isArray(r)&&(r[t]=[]);for(var a,s=/\\\w+\b/g,i=0,l=-1;a=s.exec(e);){if("\\cell"===a[0]){var o=e.slice(i,s.lastIndex-a[0].length);if(" "==o[0]&&(o=o.slice(1)),++l,o.length){var c={v:o,t:"s"};Array.isArray(r)?r[t][l]=c:r[Ic({r:t,c:l})]=c}}i=s.lastIndex}l>n.e.c&&(n.e.c=l)}),r["!ref"]=Fc(n),r}return{to_workbook:function(t,r){return Vc(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],a=Uc(e["!ref"]),n=Array.isArray(e),s=a.s.r;s<=a.e.r;++s){r.push("\\trowd\\trautofit1");for(var i=a.s.c;i<=a.e.c;++i)r.push("\\cellx"+(i+1));for(r.push("\\pard\\intbl"),i=a.s.c;i<=a.e.c;++i){var l=Ic({r:s,c:i});(t=n?(e[s]||[])[i]:e[l])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(Bc(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function ef(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function tf(e,t){if(0===t)return e;var r=function(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),s=Math.min(t,r,a),i=n-s;if(0===i)return[0,0,t];var l,o=0,c=n+s;switch(l=i/(c>1?2-c:c),n){case t:o=((r-a)/i+6)%6;break;case r:o=(a-t)/i+2;break;case a:o=(t-r)/i+4}return[o/6,l,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),ef(function(e){var t,r=e[0],a=e[1],n=e[2],s=2*a*(n<.5?n:1-n),i=n-s/2,l=[i,i,i],o=6*r;if(0!==a)switch(0|o){case 0:case 6:t=s*o,l[0]+=s,l[1]+=t;break;case 1:t=s*(2-o),l[0]+=t,l[1]+=s;break;case 2:t=s*(o-2),l[1]+=s,l[2]+=t;break;case 3:t=s*(4-o),l[1]+=t,l[2]+=s;break;case 4:t=s*(o-4),l[2]+=s,l[0]+=t;break;case 5:t=s*(6-o),l[2]+=t,l[0]+=s}for(var c=0;3!=c;++c)l[c]=Math.round(255*l[c]);return l}(r))}var rf=6;function af(e){return Math.floor((e+Math.round(128/rf)/256)*rf)}function nf(e){return Math.floor((e-5)/rf*100+.5)/100}function sf(e){return Math.round((e*rf+5)/rf*256)/256}function lf(e){return sf(nf(af(e)))}function of(e){var t=Math.abs(e-lf(e)),r=rf;if(t>.005)for(rf=1;rf<15;++rf)Math.abs(e-lf(e))<=t&&(t=Math.abs(e-lf(e)),r=rf);rf=r}function cf(e){e.width?(e.wpx=af(e.width),e.wch=nf(e.wpx),e.MDW=rf):e.wpx?(e.wch=nf(e.wpx),e.width=sf(e.wch),e.MDW=rf):"number"==typeof e.wch&&(e.width=sf(e.wch),e.wpx=af(e.width),e.MDW=rf),e.customWidth&&delete e.customWidth}var df=96;function uf(e){return 96*e/df}function ff(e){return e*df/96}var hf={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var mf=["numFmtId","fillId","fontId","borderId","xfId"],pf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var gf=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,i,l){var o,c={};return s?((o=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,r){t.NumberFmt=[];for(var a=Cl(Hi),n=0;n<a.length;++n)t.NumberFmt[a[n]]=Hi[a[n]];var s=e[0].match(co);if(s)for(n=0;n<s.length;++n){var i=ho(s[n]);switch(mo(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var l=xo(To(i.formatCode)),o=parseInt(i.numFmtId,10);if(t.NumberFmt[o]=l,o>0){if(o>392){for(o=392;o>60&&null!=t.NumberFmt[o];--o);t.NumberFmt[o]=l}Nl(l,o)}break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}(o,c,l),(o=s.match(a))&&function(e,t,r,a){t.Fonts=[];var n={},s=!1;(e[0].match(co)||[]).forEach(function(e){var i=ho(e);switch(mo(i[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":i.val&&(n.name=To(i.val));break;case"<b":n.bold=i.val?No(i.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=i.val?No(i.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(i.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=i.val?No(i.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=i.val?No(i.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=i.val?No(i.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=i.val?No(i.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=i.val?No(i.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":i.val&&(n.sz=+i.val);break;case"<vertAlign":i.val&&(n.vertAlign=i.val);break;case"<family":i.val&&(n.family=parseInt(i.val,10));break;case"<scheme":i.val&&(n.scheme=i.val);break;case"<charset":if("1"==i.val)break;i.codepage=ui[parseInt(i.val,10)];break;case"<color":if(n.color||(n.color={}),i.auto&&(n.color.auto=No(i.auto)),i.rgb)n.color.rgb=i.rgb.slice(-6);else if(i.indexed){n.color.index=parseInt(i.indexed,10);var l=hd[n.color.index];81==n.color.index&&(l=hd[1]),l||(l=hd[1]),n.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else i.theme&&(n.color.theme=parseInt(i.theme,10),i.tint&&(n.color.tint=parseFloat(i.tint)),i.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=tf(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fonts")}})}(o,c,i,l),(o=s.match(r))&&function(e,t,r,a){t.Fills=[];var n={},s=!1;(e[0].match(co)||[]).forEach(function(e){var r=ho(e);switch(mo(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":r.patternType&&(n.patternType=r.patternType);break;case"<bgColor":n.bgColor||(n.bgColor={}),r.indexed&&(n.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(n.bgColor.theme=parseInt(r.theme,10)),r.tint&&(n.bgColor.tint=parseFloat(r.tint)),r.rgb&&(n.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":n.fgColor||(n.fgColor={}),r.theme&&(n.fgColor.theme=parseInt(r.theme,10)),r.tint&&(n.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(n.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+r[0]+" in fills")}})}(o,c,0,l),(o=s.match(n))&&function(e,t,r,a){t.Borders=[];var n={},s=!1;(e[0].match(co)||[]).forEach(function(e){var r=ho(e);switch(mo(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":n={},r.diagonalUp&&(n.diagonalUp=No(r.diagonalUp)),r.diagonalDown&&(n.diagonalDown=No(r.diagonalDown)),t.Borders.push(n);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+r[0]+" in borders")}})}(o,c,0,l),(o=s.match(t))&&function(e,t,r){var a;t.CellXf=[];var n=!1;(e[0].match(co)||[]).forEach(function(e){var s=ho(e),i=0;switch(mo(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(a=s)[0],i=0;i<mf.length;++i)a[mf[i]]&&(a[mf[i]]=parseInt(a[mf[i]],10));for(i=0;i<pf.length;++i)a[pf[i]]&&(a[pf[i]]=No(a[pf[i]]));if(t.NumberFmt&&a.numFmtId>392)for(i=392;i>60;--i)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[i]){a.numFmtId=i;break}t.CellXf.push(a);break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),null!=s.textRotation&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=No(s.wrapText)),a.alignment=l;break;case"<AlternateContent":case"<ext":n=!0;break;case"</AlternateContent>":case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}(o,c,l),c):c}}();var xf=jc;var vf=jc;var bf=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function yf(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(co)||[]).forEach(function(e){var n=ho(e);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=n.val;break;case"<a:sysClr":a.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===n[0].charAt(1)?(t.themeElements.clrScheme[bf.indexOf(n[0])]=a,a={}):a.name=n[0].slice(3,n[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function wf(){}function Nf(){}var jf=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,kf=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Ef=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Sf=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Tf(e,t){var r;e&&0!==e.length||(e=_f());var a={};if(!(r=e.match(Sf)))throw new Error("themeElements not found in theme");return function(e,t,r){var a;t.themeElements={},[["clrScheme",jf,yf],["fontScheme",kf,wf],["fmtScheme",Ef,Nf]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}(r[0],a,t),a.raw=e,a}function _f(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[io];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Cf(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return jc(e,t)}(e,4);break;case 2:t.xclrValue=Jd(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function Af(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Cf(e);break;case 6:a[1]=function(e,t){return jc(e,t)}(e,r);break;case 14:case 15:a[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Of(e,t){t.forEach(function(e){e[0]})}function Rf(e,t,r,a){var n,s=Array.isArray(e);t.forEach(function(t){var i=Lc(t.ref);if(s?(e[i.r]||(e[i.r]=[]),n=e[i.r][i.c]):n=e[t.ref],!n){n={t:"z"},s?e[i.r][i.c]=n:e[t.ref]=n;var l=Uc(e["!ref"]||"BDWGO1000001:A1");l.s.r>i.r&&(l.s.r=i.r),l.e.r<i.r&&(l.e.r=i.r),l.s.c>i.c&&(l.s.c=i.c),l.e.c<i.c&&(l.e.c=i.c);var o=Fc(l);o!==e["!ref"]&&(e["!ref"]=o)}n.c||(n.c=[]);var c={a:t.author,t:t.t,r:t.r,T:r};t.h&&(c.h=t.h);for(var d=n.c.length-1;d>=0;--d){if(!r&&n.c[d].T)return;r&&!n.c[d].T&&n.c.splice(d,1)}if(r&&a)for(d=0;d<a.length;++d)if(c.a==a[d].id){c.a=a[d].name||c.a;break}n.c.push(c)})}var Pf=qc;var Df=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,a,n){var s=!1,i=!1;0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1)),0==n.length?s=!0:"["==n.charAt(0)&&(s=!0,n=n.slice(1,-1));var l=a.length>0?0|parseInt(a,10):0,o=n.length>0?0|parseInt(n,10):0;return s?o+=t.c:--o,i?l+=t.r:--l,r+(s?"":"$")+Dc(o)+(i?"":"$")+Rc(l)}return function(a,n){return t=n,a.replace(e,r)}}(),Lf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,If=function(){return function(e,t){return e.replace(Lf,function(e,r,a,n,s,i){var l=Pc(n)-(a?0:t.c),o=Oc(i)-(s?0:t.r);return r+"R"+(0==o?"":s?o+1:"["+o+"]")+"C"+(0==l?"":a?l+1:"["+l+"]")})}}();function Mf(e,t){return e.replace(Lf,function(e,r,a,n,s,i){return r+("$"==a?a+n:Dc(Pc(n)+t.c))+("$"==s?s+i:Rc(Oc(i)+t.r))})}function Ff(e,t,r){var a=Mc(t).s,n=Lc(r);return Mf(e,{r:n.r-a.r,c:n.c-a.c})}function Uf(e){return e.replace(/_xlfn\./g,"")}function zf(e){e.l+=1}function Bf(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function Vf(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return Hf(e);12==r.biff&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),i=Bf(e,2),l=Bf(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function Hf(e){var t=Bf(e,2),r=Bf(e,2),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function Wf(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=Bf(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var a=e.read_shift(r&&12==r.biff?4:2),n=Bf(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function qf(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function Gf(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function $f(e){return[e.read_shift(1),e.read_shift(1)]}function Yf(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=Bd(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=md[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=nd(e);break;case 2:r[1]=Yd(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Kf(e,t,r){for(var a=e.read_shift(12==r.biff?4:2),n=[],s=0;s!=a;++s)n.push((12==r.biff?ad:ru)(e,8));return n}function Xf(e,t,r){var a=0,n=0;12==r.biff?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,0==--n&&(n=256));for(var s=0,i=[];s!=a&&(i[s]=[]);++s)for(var l=0;l!=n;++l)i[s][l]=Yf(e,r.biff);return i}function Jf(e,t,r){return e.l+=2,[qf(e)]}function Qf(e){return e.l+=6,[]}function Zf(e){return e.l+=2,[Vd(e),1&e.read_shift(2)]}var eh=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var th={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:jc},3:{n:"PtgAdd",f:zf},4:{n:"PtgSub",f:zf},5:{n:"PtgMul",f:zf},6:{n:"PtgDiv",f:zf},7:{n:"PtgPower",f:zf},8:{n:"PtgConcat",f:zf},9:{n:"PtgLt",f:zf},10:{n:"PtgLe",f:zf},11:{n:"PtgEq",f:zf},12:{n:"PtgGe",f:zf},13:{n:"PtgGt",f:zf},14:{n:"PtgNe",f:zf},15:{n:"PtgIsect",f:zf},16:{n:"PtgUnion",f:zf},17:{n:"PtgRange",f:zf},18:{n:"PtgUplus",f:zf},19:{n:"PtgUminus",f:zf},20:{n:"PtgPercent",f:zf},21:{n:"PtgParen",f:zf},22:{n:"PtgMissArg",f:zf},23:{n:"PtgStr",f:function(e,t,r){return e.l++,Wd(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,md[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,nd(e)}},32:{n:"PtgArray",f:function(e,t,r){var a=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[a]}},33:{n:"PtgFunc",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[Nh[n],wh[n],a]}},34:{n:"PtgFuncVar",f:function(e,t,r){var a=e[e.l++],n=e.read_shift(1),s=r&&r.biff<=3?[88==a?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[n,(0===s[0]?wh:yh)[s[1]]]}},35:{n:"PtgName",f:function(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[a,0,s]}},36:{n:"PtgRef",f:function(e,t,r){var a=(96&e[e.l])>>5;return e.l+=1,[a,Wf(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,Vf(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[a,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:jc},40:{n:"PtgMemNoMem",f:jc},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[a]}},43:{n:"PtgAreaErr",f:function(e,t,r){var a=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}},44:{n:"PtgRefN",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var n=function(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),a=(32768&t)>>15,n=(16384&t)>>14;return t&=16383,1==a&&t>=8192&&(t-=16384),1==n&&r>=128&&(r-=256),{r:t,c:r,cRel:n,rRel:a}}(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),i=(16384&s)>>14,l=(32768&s)>>15;if(s&=16383,1==l)for(;n>524287;)n-=1048576;if(1==i)for(;s>8191;)s-=16384;return{r:n,c:s,cRel:i,rRel:l}}(e,0,r);return[a,n]}},45:{n:"PtgAreaN",f:function(e,t,r){var a=(96&e[e.l++])>>5,n=function(e,t,r){if(r.biff<8)return Hf(e);var a=e.read_shift(12==r.biff?4:2),n=e.read_shift(12==r.biff?4:2),s=Bf(e,2),i=Bf(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,r);return[a,n]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[a,n,Wf(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,n=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12;break;case 12:0}return[a,n,Vf(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[a,n]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[a,n]}},255:{}},rh={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ah={1:{n:"PtgElfLel",f:Zf},2:{n:"PtgElfRw",f:Jf},3:{n:"PtgElfCol",f:Jf},6:{n:"PtgElfRwV",f:Jf},7:{n:"PtgElfColV",f:Jf},10:{n:"PtgElfRadical",f:Jf},11:{n:"PtgElfRadicalS",f:Qf},13:{n:"PtgElfColS",f:Qf},15:{n:"PtgElfColSV",f:Qf},16:{n:"PtgElfRadicalLel",f:Zf},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&r,rt:eh[r>>2&31],idx:a,c:n,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},nh={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[a]}},2:{n:"PtgAttrIf",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var a=e.read_shift(r&&2==r.biff?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&2==r.biff?1:2));return n}},8:{n:"PtgAttrGoto",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Gf},33:{n:"PtgAttrBaxcel",f:Gf},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),$f(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),$f(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function sh(e,t,r,a){if(a.biff<8)return jc(e,t);for(var n=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Xf(e,0,a),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Kf(e,r[i][1],a),s.push(r[i][2]);break;case"PtgExp":a&&12==a.biff&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return 0!==(t=n-e.l)&&s.push(jc(e,t)),s}function ih(e,t,r){for(var a,n,s=e.l+t,i=[];s!=e.l;)t=s-e.l,n=e[e.l],a=th[n]||th[rh[n]],24!==n&&25!==n||(a=(24===n?ah:nh)[e[e.l+1]]),a&&a.f?i.push([a.n,a.f(e,t,r)]):jc(e,t);return i}function lh(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var i=a[s];if(i)if(2===i[0])n.push('"'+i[1].replace(/"/g,'""')+'"');else n.push(i[1]);else n.push("")}t.push(n.join(","))}return t.join(";")}var oh={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ch(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=-1==a[1]?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=-1==a[1]?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[a[0]][0][3]?(n=-1==a[1]?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function dh(e,t,r){var a=ch(e,t,r);return"#REF"==a?a:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(a,r)}function uh(e,t,r,a,n){var s,i,l,o,c=n&&n.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},u=[],f=0,h=0,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",x=0,v=e[0].length;x<v;++x){var b=e[0][x];switch(b[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=u.pop(),i=u.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Wl(" ",e[0][p][1][1]);break;case 1:g=Wl("\r",e[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}i+=g,p=-1}u.push(i+oh[b[0]]+s);break;case"PtgIsect":s=u.pop(),i=u.pop(),u.push(i+" "+s);break;case"PtgUnion":s=u.pop(),i=u.pop(),u.push(i+","+s);break;case"PtgRange":s=u.pop(),i=u.pop(),u.push(i+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":l=Tc(b[1][1],d,n),u.push(Cc(l,c));break;case"PtgRefN":l=r?Tc(b[1][1],r,n):b[1][1],u.push(Cc(l,c));break;case"PtgRef3d":f=b[1][1],l=Tc(b[1][2],d,n);m=dh(a,f,n);u.push(m+"!"+Cc(l,c));break;case"PtgFunc":case"PtgFuncVar":var y=b[1][0],w=b[1][1];y||(y=0);var N=0==(y&=127)?[]:u.slice(-y);u.length-=y,"User"===w&&(w=N.shift()),u.push(w+"("+N.join(",")+")");break;case"PtgBool":u.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(b[1]);break;case"PtgNum":u.push(String(b[1]));break;case"PtgStr":u.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":o=_c(b[1][1],r?{s:r}:d,n),u.push(Ac(o,n));break;case"PtgArea":o=_c(b[1][1],d,n),u.push(Ac(o,n));break;case"PtgArea3d":f=b[1][1],o=b[1][2],m=dh(a,f,n),u.push(m+"!"+Ac(o,n));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":h=b[1][2];var j=(a.names||[])[h-1]||(a[0]||[])[h],k=j?j.Name:"SH33TJSNAME"+String(h);k&&"_xlfn."==k.slice(0,6)&&!n.xlfn&&(k=k.slice(6)),u.push(k);break;case"PtgNameX":var E,S=b[1][1];if(h=b[1][2],!(n.biff<=5)){var T="";if(14849==((a[S]||[])[0]||[])[0]||(1025==((a[S]||[])[0]||[])[0]?a[S][h]&&a[S][h].itab>0&&(T=a.SheetNames[a[S][h].itab-1]+"!"):T=a.SheetNames[h-1]+"!"),a[S]&&a[S][h])T+=a[S][h].Name;else if(a[0]&&a[0][h])T+=a[0][h].Name;else{var _=(ch(a,S,n)||"").split(";;");_[h-1]?T=_[h-1]:T+="SH33TJSERRX"}u.push(T);break}S<0&&(S=-S),a[S]&&(E=a[S][h]),E||(E={Name:"SH33TJSERRY"}),u.push(E.Name);break;case"PtgParen":var C="(",A=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:C=Wl(" ",e[0][p][1][1])+C;break;case 3:C=Wl("\r",e[0][p][1][1])+C;break;case 4:A=Wl(" ",e[0][p][1][1])+A;break;case 5:A=Wl("\r",e[0][p][1][1])+A;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}u.push(C+u.pop()+A);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":l={c:b[1][1],r:b[1][0]};var O={c:r.c,r:r.r};if(a.sharedf[Ic(l)]){var R=a.sharedf[Ic(l)];u.push(uh(R,d,O,a,n))}else{var P=!1;for(s=0;s!=a.arrayf.length;++s)if(i=a.arrayf[s],!(l.c<i[0].s.c||l.c>i[0].e.c)&&!(l.r<i[0].s.r||l.r>i[0].e.r)){u.push(uh(i[1],d,O,a,n)),P=!0;break}P||u.push(b[1])}break;case"PtgArray":u.push("{"+lh(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=n.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][x][0])){var D=!0;switch((b=e[0][p])[1][0]){case 4:D=!1;case 0:g=Wl(" ",b[1][1]);break;case 5:D=!1;case 1:g=Wl("\r",b[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}u.push((D?g:"")+u.pop()+(D?"":g)),p=-1}}if(u.length>1&&n.WTF)throw new Error("bad formula stack");return u[0]}function fh(e,t,r){var a,n=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],jc(e,t-2)];var l=ih(e,i,r);return t!==i+s&&(a=sh(e,t-i-s,l,r)),e.l=n,[l,a]}function hh(e,t,r){var a,n=e.l+t,s=e.read_shift(2),i=ih(e,s,r);return 65535==s?[[],jc(e,t-2)]:(t!==s+2&&(a=sh(e,n-s-2,i,r)),[i,a])}function mh(e,t,r){var a=e.l+t,n=Zd(e);2==r.biff&&++e.l;var s=function(e){var t;if(65535!==uc(e,e.l+6))return[nd(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),i=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=function(e,t,r){var a,n=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],jc(e,t-2)];var l=ih(e,i,r);return t!==i+s&&(a=sh(e,t-i-s,l,r)),e.l=n,[l,a]}(e,a-e.l,r);return{cell:n,val:s[0],formula:l,shared:i>>3&1,tt:s[1]}}function ph(e,t,r){var a=e.read_shift(4),n=ih(e,a,r),s=e.read_shift(4);return[n,s>0?sh(e,s,n,r):null]}var gh=ph,xh=ph,vh=ph,bh=ph,yh={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},wh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Nh={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function jh(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function kh(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Eh={},Sh={};function Th(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function _h(e,t,r,a,n,s){try{a.cellNF&&(e.z=Hi[t])}catch(Ge){if(a.WTF)throw Ge}if("z"!==e.t||a.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Bl(e.v)),(!a||!1!==a.cellText)&&"z"!==e.t)try{if(null==Hi[t]&&Nl(kl[t]||"General",t),"e"===e.t)e.w=e.w||md[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Zi(e.v);else if("d"===e.t){var i=Rl(e.v);e.w=(0|i)===i?i.toString(10):Zi(i)}else{if(void 0===e.v)return"";e.w=el(e.v,Sh)}else"d"===e.t?e.w=wl(t,Rl(e.v),Sh):e.w=wl(t,e.v,Sh)}catch(Ge){if(a.WTF)throw Ge}if(a.cellStyles&&null!=r)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=tf(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=tf(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(Ge){if(a.WTF&&s.Fills)throw Ge}}}var Ch=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Ah=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Oh=/<(?:\w:)?hyperlink [^>]*>/gm,Rh=/"(\w*:\w*)"/,Ph=/<(?:\w:)?col\b[^>]*[\/]?>/g,Dh=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Lh=/<(?:\w:)?pageMargins[^>]*\/>/g,Ih=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Mh=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Fh=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Uh(e,t,r,a,n,s,i){if(!e)return e;a||(a={"!id":{}});var l=t.dense?[]:{},o={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",u=e.match(Ah);u?(c=e.slice(0,u.index),d=e.slice(u.index+u[0].length)):c=d=e;var f=c.match(Ih);f?zh(f[0],l,n,r):(f=c.match(Mh))&&function(e,t,r,a,n){zh(e.slice(0,e.indexOf(">")),r,a,n)}(f[0],f[1],l,n,r);var h=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=c.slice(h,h+50).match(Rh);m&&function(e,t){var r=Uc(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Fc(r))}(l,m[1])}var p=c.match(Fh);p&&p[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(Bh)||[]).forEach(function(e,r){var a=ho(e);t.Views[r]||(t.Views[r]={}),+a.zoomScale&&(t.Views[r].zoom=+a.zoomScale),No(a.rightToLeft)&&(t.Views[r].RTL=!0)})}(p[1],n);var g=[];if(t.cellStyles){var x=c.match(Ph);x&&function(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=ho(t[a],!0);n.hidden&&(n.hidden=No(n.hidden));var s=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,of(n.width)),cf(n);s<=i;)e[s++]=Hl(n)}}(g,x)}u&&Vh(u[1],l,t,o,s,i);var v=d.match(Dh);v&&(l["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(v[0]));var b=[],y=d.match(Ch);if(y)for(h=0;h!=y.length;++h)b[h]=Uc(y[h].slice(y[h].indexOf('"')+1));var w=d.match(Oh);w&&function(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var s=ho(To(t[n]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+xo(s.location))):(s.Target="#"+xo(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=Uc(s.ref),o=l.s.r;o<=l.e.r;++o)for(var c=l.s.c;c<=l.e.c;++c){var d=Ic({c:c,r:o});a?(e[o]||(e[o]=[]),e[o][c]||(e[o][c]={t:"z",v:void 0}),e[o][c].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}(l,w,a);var N=d.match(Lh);if(N&&(l["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}(ho(N[0]))),!l["!ref"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r&&(l["!ref"]=Fc(o)),t.sheetRows>0&&l["!ref"]){var j=Uc(l["!ref"]);t.sheetRows<=+j.e.r&&(j.e.r=t.sheetRows-1,j.e.r>o.e.r&&(j.e.r=o.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>o.e.c&&(j.e.c=o.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Fc(j))}return g.length>0&&(l["!cols"]=g),b.length>0&&(l["!merges"]=b),l}function zh(e,t,r,a){var n=ho(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=xo(To(n.codeName)))}var Bh=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;var Vh=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=Co("v"),i=Co("f");return function(l,o,c,d,u,f){for(var h,m,p,g,x,v=0,b="",y=[],w=[],N=0,j=0,k=0,E="",S=0,T=0,_=0,C=0,A=Array.isArray(f.CellXf),O=[],R=[],P=Array.isArray(o),D=[],L={},I=!1,M=!!c.sheetStubs,F=l.split(t),U=0,z=F.length;U!=z;++U){var B=(b=F[U].trim()).length;if(0!==B){var V=0;e:for(v=0;v<B;++v)switch(b[v]){case">":if("/"!=b[v-1]){++v;break e}if(c&&c.cellStyles){if(S=null!=(m=ho(b.slice(V,v),!0)).r?parseInt(m.r,10):S+1,T=-1,c.sheetRows&&c.sheetRows<S)continue;L={},I=!1,m.ht&&(I=!0,L.hpt=parseFloat(m.ht),L.hpx=ff(L.hpt)),"1"==m.hidden&&(I=!0,L.hidden=!0),null!=m.outlineLevel&&(I=!0,L.level=+m.outlineLevel),I&&(D[S-1]=L)}break;case"<":V=v}if(V>=v)break;if(S=null!=(m=ho(b.slice(V,v),!0)).r?parseInt(m.r,10):S+1,T=-1,!(c.sheetRows&&c.sheetRows<S)){d.s.r>S-1&&(d.s.r=S-1),d.e.r<S-1&&(d.e.r=S-1),c&&c.cellStyles&&(L={},I=!1,m.ht&&(I=!0,L.hpt=parseFloat(m.ht),L.hpx=ff(L.hpt)),"1"==m.hidden&&(I=!0,L.hidden=!0),null!=m.outlineLevel&&(I=!0,L.level=+m.outlineLevel),I&&(D[S-1]=L)),y=b.slice(v).split(e);for(var H=0;H!=y.length&&"<"==y[H].trim().charAt(0);++H);for(y=y.slice(H),v=0;v!=y.length;++v)if(0!==(b=y[v].trim()).length){if(w=b.match(r),N=v,j=0,k=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=w&&2===w.length){for(N=0,E=w[1],j=0;j!=E.length&&!((k=E.charCodeAt(j)-64)<1||k>26);++j)N=26*N+k;T=--N}else++T;for(j=0;j!=b.length&&62!==b.charCodeAt(j);++j);if(++j,(m=ho(b.slice(0,j),!0)).r||(m.r=Ic({r:S-1,c:T})),h={t:""},null!=(w=(E=b.slice(j)).match(s))&&""!==w[1]&&(h.v=xo(w[1])),c.cellFormula){if(null!=(w=E.match(i))&&""!==w[1]){if(h.f=xo(To(w[1])).replace(/\r\n/g,"\n"),c.xlfn||(h.f=Uf(h.f)),w[0].indexOf('t="array"')>-1)h.F=(E.match(n)||[])[1],h.F.indexOf(":")>-1&&O.push([Uc(h.F),h.F]);else if(w[0].indexOf('t="shared"')>-1){g=ho(w[0]);var W=xo(To(w[1]));c.xlfn||(W=Uf(W)),R[parseInt(g.si,10)]=[g,W,m.r]}}else(w=E.match(/<f[^>]*\/>/))&&R[(g=ho(w[0])).si]&&(h.f=Ff(R[g.si][1],R[g.si][2],m.r));var q=Lc(m.r);for(j=0;j<O.length;++j)q.r>=O[j][0].s.r&&q.r<=O[j][0].e.r&&q.c>=O[j][0].s.c&&q.c<=O[j][0].e.c&&(h.F=O[j][1])}if(null==m.t&&void 0===h.v)if(h.f||h.F)h.v=0,h.t="n";else{if(!M)continue;h.t="z"}else h.t=m.t||"n";switch(d.s.c>T&&(d.s.c=T),d.e.c<T&&(d.e.c=T),h.t){case"n":if(""==h.v||null==h.v){if(!M)continue;h.t="z"}else h.v=parseFloat(h.v);break;case"s":if("undefined"==typeof h.v){if(!M)continue;h.t="z"}else p=Eh[parseInt(h.v,10)],h.v=p.t,h.r=p.r,c.cellHTML&&(h.h=p.h);break;case"str":h.t="s",h.v=null!=h.v?To(h.v):"",c.cellHTML&&(h.h=yo(h.v));break;case"inlineStr":w=E.match(a),h.t="s",null!=w&&(p=Iu(w[1]))?(h.v=p.t,c.cellHTML&&(h.h=p.h)):h.v="";break;case"b":h.v=No(h.v);break;case"d":c.cellDates?h.v=Bl(h.v,1):(h.v=Rl(Bl(h.v,1)),h.t="n");break;case"e":c&&!1===c.cellText||(h.w=h.v),h.v=pd[h.v]}if(_=C=0,x=null,A&&void 0!==m.s&&null!=(x=f.CellXf[m.s])&&(null!=x.numFmtId&&(_=x.numFmtId),c.cellStyles&&null!=x.fillId&&(C=x.fillId)),_h(h,_,C,c,u,f),c.cellDates&&A&&"n"==h.t&&xl(Hi[_])&&(h.t="d",h.v=Il(h.v)),m.cm&&c.xlmeta){var G=(c.xlmeta.Cell||[])[+m.cm-1];G&&"XLDAPR"==G.type&&(h.D=!0)}if(P){var $=Lc(m.r);o[$.r]||(o[$.r]=[]),o[$.r][$.c]=h}else o[m.r]=h}}}}D.length>0&&(o["!rows"]=D)}}();var Hh=ad;function Wh(e){return[Xc(e),nd(e),"n"]}var qh=ad;var Gh=["left","right","top","bottom","header","footer"];function $h(e,t,r,a,n,s){var i=s||{"!type":"chart"};if(!e)return s;var l=0,o=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,r=[],a=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=a?+t[2]:t[2])});var n=xo((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[r,n,t]}(e);d.s.r=d.s.c=0,d.e.c=l,c=Dc(l),t[0].forEach(function(e,r){i[c+Rc(r)]={t:"n",v:e,z:t[1]},o=r}),d.e.r<o&&(d.e.r=o),++l}),l>0&&(i["!ref"]=Fc(d)),i}var Yh=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Kh=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Xh=[],Jh=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Qh(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var s=t[n];if(null==a[s[0]])a[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof a[s[0]]&&(a[s[0]]=No(a[s[0]]));break;case"int":"string"==typeof a[s[0]]&&(a[s[0]]=parseInt(a[s[0]],10))}}}function Zh(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(null==e[a[0]])e[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof e[a[0]]&&(e[a[0]]=No(e[a[0]]));break;case"int":"string"==typeof e[a[0]]&&(e[a[0]]=parseInt(e[a[0]],10))}}}function em(e){Zh(e.WBProps,Yh),Zh(e.CalcPr,Jh),Qh(e.WBView,Kh),Qh(e.Sheets,Xh),Sh.date1904=No(e.WBProps.date1904)}var tm="][*?/\\".split("");function rm(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return tm.forEach(function(a){if(-1!=e.indexOf(a)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var am=/<\w+:workbook/;function nm(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function sm(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Lm[16]={n:"BrtFRTArchID$",f:nm},Ec(e,function(e,l,o){switch(o){case 156:i.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=uh(e.Ptg,0,null,i,t),delete t.SID,delete e.Ptg,s.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([o,e]):i[0]=[o,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 35:case 37:a.push(o),n=!0;break;case 36:case 38:a.pop(),n=!1;break;default:if(l.T);else if(!n||t.WTF&&37!=a[a.length-1]&&35!=a[a.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}},t),em(r),r.Names=s,r.supbooks=i,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},i=0;if(e.replace(co,function(l,o){var c=ho(l);switch(mo(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":l.match(am)&&(n="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=c[n];break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":Yh.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=No(c[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:r.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(r.WBProps.CodeName=To(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=xo(To(c.name)),delete c[0],r.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":a=!1;break;case"<definedName":(s={}).Name=To(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),No(c.hidden||"0")&&(s.Hidden=!0),i=o+l.length;break;case"</definedName>":s.Ref=xo(To(e.slice(i,o))),r.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete c[0],r.CalcPr=c;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return l}),-1===Bo.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return em(r),r}(e,r)}function im(e,t,r,a,n,s,i,l){return".bin"===t.slice(-4)?function(e,t,r,a,n,s,i){if(!e)return e;var l=t||{};a||(a={"!id":{}});var o,c,d,u,f,h,m,p,g,x,v=l.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=[],w=!1,N=!1,j=[];l.biff=12,l["!row"]=0;var k=0,E=!1,S=[],T={},_=l.supbooks||n.supbooks||[[]];if(_.sharedf=T,_.arrayf=S,_.SheetNames=n.SheetNames||n.Sheets.map(function(e){return e.name}),!l.supbooks&&(l.supbooks=_,n.Names))for(var C=0;C<n.Names.length;++C)_[0][C+1]=n.Names[C];var A,O,R=[],P=[],D=!1;if(Lm[16]={n:"BrtShortReal",f:Wh},Ec(e,function(e,t,C){if(!N)switch(C){case 148:o=e;break;case 0:c=e,l.sheetRows&&l.sheetRows<=c.r&&(N=!0),g=Rc(f=c.r),l["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=ff(e.hpt)),P[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(d={t:e[2]},e[2]){case"n":d.v=e[1];break;case"s":p=Eh[e[1]],d.v=p.t,d.r=p.r;break;case"b":d.v=!!e[1];break;case"e":d.v=e[1],!1!==l.cellText&&(d.w=md[d.v]);break;case"str":d.t="s",d.v=e[1];break;case"is":d.t="s",d.v=e[1].t}if((u=i.CellXf[e[0].iStyleRef])&&_h(d,u.numFmtId,null,l,s,i),h=-1==e[0].c?h+1:e[0].c,l.dense?(v[f]||(v[f]=[]),v[f][h]=d):v[Dc(h)+g]=d,l.cellFormula){for(E=!1,k=0;k<S.length;++k){var L=S[k];c.r>=L[0].s.r&&c.r<=L[0].e.r&&h>=L[0].s.c&&h<=L[0].e.c&&(d.F=Fc(L[0]),E=!0)}!E&&e.length>3&&(d.f=e[3])}if(b.s.r>c.r&&(b.s.r=c.r),b.s.c>h&&(b.s.c=h),b.e.r<c.r&&(b.e.r=c.r),b.e.c<h&&(b.e.c=h),l.cellDates&&u&&"n"==d.t&&xl(Hi[u.numFmtId])){var I=$i(d.v);I&&(d.t="d",d.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}A&&("XLDAPR"==A.type&&(d.D=!0),A=void 0),O&&(O=void 0);break;case 1:case 12:if(!l.sheetStubs||w)break;d={t:"z",v:void 0},h=-1==e[0].c?h+1:e[0].c,l.dense?(v[f]||(v[f]=[]),v[f][h]=d):v[Dc(h)+g]=d,b.s.r>c.r&&(b.s.r=c.r),b.s.c>h&&(b.s.c=h),b.e.r<c.r&&(b.e.r=c.r),b.e.c<h&&(b.e.c=h),A&&("XLDAPR"==A.type&&(d.D=!0),A=void 0),O&&(O=void 0);break;case 176:j.push(e);break;case 49:A=((l.xlmeta||{}).Cell||[])[e-1];break;case 494:var M=a["!id"][e.relId];for(M?(e.Target=M.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=M):""==e.relId&&(e.Target="#"+e.loc),f=e.rfx.s.r;f<=e.rfx.e.r;++f)for(h=e.rfx.s.c;h<=e.rfx.e.c;++h)l.dense?(v[f]||(v[f]=[]),v[f][h]||(v[f][h]={t:"z",v:void 0}),v[f][h].l=e):(m=Ic({c:h,r:f}),v[m]||(v[m]={t:"z",v:void 0}),v[m].l=e);break;case 426:if(!l.cellFormula)break;S.push(e),(x=l.dense?v[f][h]:v[Dc(h)+g]).f=uh(e[1],0,{r:c.r,c:h},_,l),x.F=Fc(e[0]);break;case 427:if(!l.cellFormula)break;T[Ic(e[0].s)]=e[1],(x=l.dense?v[f][h]:v[Dc(h)+g]).f=uh(e[1],0,{r:c.r,c:h},_,l);break;case 60:if(!l.cellStyles)break;for(;e.e>=e.s;)R[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},D||(D=!0,of(e.w/256)),cf(R[e.e+1]);break;case 161:v["!autofilter"]={ref:Fc(e)};break;case 476:v["!margins"]=e;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),e.name&&(n.Sheets[r].CodeName=e.name),(e.above||e.left)&&(v["!outline"]={above:e.above,left:e.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),e.RTL&&(n.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:w=!0;break;case 36:w=!1;break;case 37:y.push(C),w=!0;break;case 38:y.pop(),w=!1;break;default:if(t.T);else if(!w||l.WTF)throw new Error("Unexpected record 0x"+C.toString(16))}},l),delete l.supbooks,delete l["!row"],!v["!ref"]&&(b.s.r<2e6||o&&(o.e.r>0||o.e.c>0||o.s.r>0||o.s.c>0))&&(v["!ref"]=Fc(o||b)),l.sheetRows&&v["!ref"]){var L=Uc(v["!ref"]);l.sheetRows<=+L.e.r&&(L.e.r=l.sheetRows-1,L.e.r>b.e.r&&(L.e.r=b.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>b.e.c&&(L.e.c=b.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),v["!fullref"]=v["!ref"],v["!ref"]=Fc(L))}return j.length>0&&(v["!merges"]=j),R.length>0&&(v["!cols"]=R),P.length>0&&(v["!rows"]=P),v}(e,a,r,n,s,i,l):Uh(e,a,r,n,s,i,l)}function lm(e,t,r,a,n,s,i,l){return".bin"===t.slice(-4)?function(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=[],l=!1;return Ec(e,function(e,a,o){switch(o){case 550:s["!rel"]=e;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),e.name&&(n.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(o);break;case 38:i.pop();break;default:if(a.T>0)i.push(o);else if(a.T<0)i.pop();else if(!l||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}},t),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}(e,a,r,n,s):function(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s,i={"!type":"chart","!drawel":null,"!rel":""},l=e.match(Ih);return l&&zh(l[0],0,n,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}(e,0,r,n,s)}function om(e,t,r,a){return".bin"===t.slice(-4)?function(e,t,r){var a={NumberFmt:[]};for(var n in Hi)a.NumberFmt[n]=Hi[n];a.CellXf=[],a.Fonts=[];var s=[],i=!1;return Ec(e,function(e,n,l){switch(l){case 44:a.NumberFmt[e[0]]=e[1],Nl(e[1],e[0]);break;case 43:a.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=tf(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&a.CellXf.push(e);break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(l),i=!0;break;case 38:s.pop(),i=!1;break;default:if(n.T>0)s.push(l);else if(n.T<0)s.pop();else if(!i||r.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}}),a}(e,r,a):gf(e,r,a)}function cm(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],a=!1;return Ec(e,function(e,n,s){switch(s){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(n.T,!a||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),r}(e,r):function(e,t){var r=[],a="";if(!e)return r;var n=e.match(Mu);if(n){a=n[2].replace(Fu,"").split(Uu);for(var s=0;s!=a.length;++s){var i=Iu(a[s].trim(),t);null!=i&&(r[r.length]=i)}n=ho(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}(e,r)}function dm(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],a=[],n={},s=!1;return Ec(e,function(e,i,l){switch(l){case 632:a.push(e);break;case 635:n=e;break;case 637:n.t=e.t,n.h=e.h,n.r=e.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var n=e.match(/<(?:\w+:)?comment[^>]*>/);if(n){var s=ho(n[0]),i={author:s.authorId&&r[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},l=Lc(s.ref);if(!(t.sheetRows&&t.sheetRows<=l.r)){var o=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!o&&!!o[1]&&Iu(o[1])||{r:"",t:"",h:""};i.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),i.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(i.h=c.h),a.push(i)}}}}),a}(e,r)}function um(e,t,r){return".bin"===t.slice(-4)?function(e){var t=[];return Ec(e,function(e,r,a){if(63===a)t.push(e);else if(!r.T)throw new Error("Unexpected record 0x"+a.toString(16))}),t}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(co)||[]).forEach(function(e){var a=ho(e);switch(a[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a)}}),t}(e)}function fm(e,t,r,a){if(".bin"===r.slice(-4))return function(e,t,r,a){if(!e)return e;var n=a||{},s=!1;Ec(e,function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(t.T);else if(!s||n.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}},n)}(e,0,0,a)}function hm(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],i=!1,l=2;return Ec(e,function(e,t,r){switch(r){case 335:a.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==l?a.Cell.push({type:a.Types[e[0]-1].name,index:e[1]}):0==l&&a.Value.push({type:a.Types[e[0]-1].name,index:e[1]})});break;case 337:l=e?1:0;break;case 338:l=2;break;case 35:s.push(r),i=!0;break;case 36:s.pop(),i=!1;break;default:if(t.T);else if(!i||n.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}}),a}(e,0,r):function(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n,s=!1,i=2;return e.replace(co,function(e){var t=ho(e);switch(mo(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":a.Types.push({name:t.name});break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==t.name&&(n=a.Types[l]);break;case"<rc":1==i?a.Cell.push({type:a.Types[t.t-1].name,index:+t.v}):0==i&&a.Value.push({type:a.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":i=1;break;case"</cellMetadata>":case"</valueMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!n)break;n.offsets||(n.offsets=[]),n.offsets.push(+t.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e}),a}(e,0,r)}var mm,pm=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gm=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xm(e,t){var r=e.split(/\s+/),a=[];if(t||(a[0]=r[0]),1===r.length)return a;var n,s,i,l=e.match(pm);if(l)for(i=0;i!=l.length;++i)-1===(s=(n=l[i].match(gm))[1].indexOf(":"))?a[n[1]]=n[2].slice(1,n[2].length-1):a["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(s+1)]=n[2].slice(1,n[2].length-1);return a}function vm(e){var t={};if(1===e.split(/\s+/).length)return t;var r,a,n,s=e.match(pm);if(s)for(n=0;n!=s.length;++n)-1===(a=(r=s[n].match(gm))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(a+1)]=r[2].slice(1,r[2].length-1);return t}function bm(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=No(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Bl(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[xo(t)]=n}function ym(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||md[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Zi(e.v):e.w=el(e.v):e.w=function(e,t){var r=mm[e]||xo(e);return"General"===r?el(t):wl(r,t)}(t||"General",e.v)}catch(Ge){if(r.WTF)throw Ge}try{var a=mm[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&"n"==e.t&&xl(a)){var n=$i(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(Ge){if(r.WTF)throw Ge}}}function wm(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=hf[a.Pattern]||a.Pattern)}e[t.ID]=t}function Nm(e,t,r,a,n,s,i,l,o,c){var d="General",u=a.StyleID,f={};c=c||{};var h=[],m=0;for(void 0===u&&l&&(u=l.StyleID),void 0===u&&i&&(u=i.StyleID);void 0!==s[u]&&(s[u].nf&&(d=s[u].nf),s[u].Interior&&h.push(s[u].Interior),s[u].Parent);)u=s[u].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=No(e);break;case"String":a.t="s",a.r=wo(xo(e)),a.v=e.indexOf("<")>-1?xo(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),a.v=(Bl(e)-new Date(Date.UTC(1899,11,30)))/864e5,a.v!==a.v?a.v=xo(e):a.v<60&&(a.v=a.v-1),d&&"General"!=d||(d="yyyy-mm-dd");case"Number":void 0===a.v&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=pd[e],!1!==c.cellText&&(a.w=e);break;default:""==e&&""==t?a.t="z":(a.t="s",a.v=wo(t||e))}if(ym(a,d,c),!1!==c.cellFormula)if(a.Formula){var p=xo(a.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),a.f=Df(p,n),delete a.Formula,"RC"==a.ArrayRange?a.F=Df("RC:RC",n):a.ArrayRange&&(a.F=Df(a.ArrayRange,n),o.push([Uc(a.F),a.F]))}else for(m=0;m<o.length;++m)n.r>=o[m][0].s.r&&n.r<=o[m][0].e.r&&n.c>=o[m][0].s.c&&n.c<=o[m][0].e.c&&(a.F=o[m][1]);c.cellStyles&&(h.forEach(function(e){!f.patternType&&e.patternType&&(f.patternType=e.patternType)}),a.s=f),void 0!==a.StyleID&&(a.ixfe=a.StyleID)}function jm(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function km(e,t){var r=t||{};jl();var a=vi(Fo(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(a="undefined"!==typeof xi?xi.utils.decode(65001,pi(a)):To(a));var n,s=a.slice(0,1024).toLowerCase(),i=!1;if((1023&(s=s.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var l=Hl(r);return l.type="string",Cu.to_workbook(a,l)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){s.indexOf("<"+e)>=0&&(i=!0)}),i)return function(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length)return Vc(Fm(r[0],t),t);var a={SheetNames:[],Sheets:{}};return r.forEach(function(e,r){Mp(a,Fm(e,t),"Sheet"+(r+1))}),a}(a,r);mm={"General Number":"General","General Date":Hi[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Hi[15],"Short Date":Hi[14],"Long Time":Hi[19],"Medium Time":Hi[18],"Short Time":Hi[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Hi[2],Standard:Hi[4],Percent:Hi[10],Scientific:Hi[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[];var d,u={},f=[],h=r.dense?[]:{},m="",p={},g={},x=xm('<Data ss:Type="String">'),v=0,b=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},j={},k="",E=0,S=[],T={},_={},C=0,A=[],O=[],R={},P=[],D=!1,L=[],I=[],M={},F=0,U=0,z={Sheets:[],WBProps:{date1904:!1}},B={};Uo.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/gm,"");for(var V="";n=Uo.exec(a);)switch(n[3]=(V=n[3]).toLowerCase()){case"data":if("data"==V){if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&c.push([n[3],!0]);break}if(c[c.length-1][1])break;"/"===n[1]?Nm(a.slice(v,n.index),k,x,"comment"==c[c.length-1][0]?R:p,{c:b,r:y},N,P[b],g,L,r):(k="",x=xm(n[0]),v=n.index+n[0].length);break;case"cell":if("/"===n[1])if(O.length>0&&(p.c=O),(!r.sheetRows||r.sheetRows>y)&&void 0!==p.v&&(r.dense?(h[y]||(h[y]=[]),h[y][b]=p):h[Dc(b)+Rc(y)]=p),p.HRef&&(p.l={Target:xo(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(F=b+(0|parseInt(p.MergeAcross,10)),U=y+(0|parseInt(p.MergeDown,10)),S.push({s:{c:b,r:y},e:{c:F,r:U}})),r.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var H=b;H<=F;++H)for(var W=y;W<=U;++W)(H>b||W>y)&&(r.dense?(h[W]||(h[W]=[]),h[W][H]={t:"z"}):h[Dc(H)+Rc(W)]={t:"z"});b=F+1}else++b;else p.MergeAcross?b=F+1:++b;else(p=vm(n[0])).Index&&(b=+p.Index-1),b<w.s.c&&(w.s.c=b),b>w.e.c&&(w.e.c=b),"/>"===n[0].slice(-2)&&++b,O=[];break;case"row":"/"===n[1]||"/>"===n[0].slice(-2)?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),"/>"===n[0].slice(-2)&&(g=xm(n[0])).Index&&(y=+g.Index-1),b=0,++y):((g=xm(n[0])).Index&&(y=+g.Index-1),M={},("0"==g.AutoFitHeight||g.Height)&&(M.hpx=parseInt(g.Height,10),M.hpt=uf(M.hpx),I[y]=M),"1"==g.Hidden&&(M.hidden=!0,I[y]=M));break;case"worksheet":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"));f.push(m),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(h["!ref"]=Fc(w),r.sheetRows&&r.sheetRows<=w.e.r&&(h["!fullref"]=h["!ref"],w.e.r=r.sheetRows-1,h["!ref"]=Fc(w))),S.length&&(h["!merges"]=S),P.length>0&&(h["!cols"]=P),I.length>0&&(h["!rows"]=I),u[m]=h}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=b=0,c.push([n[3],!1]),o=xm(n[0]),m=xo(o.Name),h=r.dense?[]:{},S=[],L=[],I=[],B={name:m,Hidden:0},z.Sheets.push(B);break;case"table":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else{if("/>"==n[0].slice(-2))break;c.push([n[3],!1]),P=[],D=!1}break;case"style":"/"===n[1]?wm(N,j,r):j=xm(n[0]);break;case"numberformat":j.nf=xo(xm(n[0]).Format||"General"),mm[j.nf]&&(j.nf=mm[j.nf]);for(var q=0;392!=q&&Hi[q]!=j.nf;++q);if(392==q)for(q=57;392!=q;++q)if(null==Hi[q]){Nl(j.nf,q);break}break;case"column":if("table"!==c[c.length-1][0])break;if((d=xm(n[0])).Hidden&&(d.hidden=!0,delete d.Hidden),d.Width&&(d.wpx=parseInt(d.Width,10)),!D&&d.wpx>10){D=!0,rf=6;for(var G=0;G<P.length;++G)P[G]&&cf(P[G])}D&&cf(d),P[d.Index-1||P.length]=d;for(var $=0;$<+d.Span;++$)P[P.length]=Hl(d);break;case"namedrange":if("/"===n[1])break;z.Names||(z.Names=[]);var Y=ho(n[0]),K={Name:Y.Name,Ref:Df(Y.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(K.Sheet=z.Sheets.length-1),z.Names.push(K);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===n[0].slice(-2))break;"/"===n[1]?k+=a.slice(E,n.index):E=n.index+n[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=xm(n[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===n[0].slice(-2))break;"/"===n[1]?_d(T,V,a.slice(C,n.index)):C=n.index+n[0].length;break;case"styles":case"workbook":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else c.push([n[3],!1]);break;case"comment":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"));jm(R),O.push(R)}else c.push([n[3],!1]),R={a:(o=xm(n[0])).Author};break;case"autofilter":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else if("/"!==n[0].charAt(n[0].length-2)){var X=xm(n[0]);h["!autofilter"]={ref:Df(X.Range).replace(/\$/g,"")},c.push([n[3],!0])}break;case"datavalidation":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&c.push([n[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===n[1]){if((o=c.pop())[0]!==n[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&c.push([n[3],!0]);break;default:if(0==c.length&&"document"==n[3])return Jm(a,r);if(0==c.length&&"uof"==n[3])return Jm(a,r);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(n[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(n[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(n[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(n[3]){case"owcversion":case"height":case"width":break;default:J=!1}break;case"worksheetoptions":switch(n[3]){case"visible":if("/>"===n[0].slice(-2));else if("/"===n[1])switch(a.slice(C,n.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2}else C=n.index+n[0].length;break;case"header":h["!margins"]||Th(h["!margins"]={},"xlml"),isNaN(+ho(n[0]).Margin)||(h["!margins"].header=+ho(n[0]).Margin);break;case"footer":h["!margins"]||Th(h["!margins"]={},"xlml"),isNaN(+ho(n[0]).Margin)||(h["!margins"].footer=+ho(n[0]).Margin);break;case"pagemargins":var Q=ho(n[0]);h["!margins"]||Th(h["!margins"]={},"xlml"),isNaN(+Q.Top)||(h["!margins"].top=+Q.Top),isNaN(+Q.Left)||(h["!margins"].left=+Q.Left),isNaN(+Q.Right)||(h["!margins"].right=+Q.Right),isNaN(+Q.Bottom)||(h["!margins"].bottom=+Q.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;default:J=!1}break;case"pivottable":case"pivotcache":switch(n[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:J=!1}break;case"pagebreaks":switch(n[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:J=!1}break;case"autofilter":switch(n[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:J=!1}break;case"querytable":switch(n[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(n[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(n[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(n[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1}if(J)break;if(n[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+n[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===n[0].slice(-2))break;"/"===n[1]?bm(_,V,A,a.slice(C,n.index)):(A=n,C=n.index+n[0].length);break}if(r.WTF)throw"Unrecognized tag: "+n[3]+"|"+c.join("|")}var Z={};return r.bookSheets||r.bookProps||(Z.Sheets=u),Z.SheetNames=f,Z.Workbook=z,Z.SSF=Hl(Hi),Z.Props=T,Z.Custprops=_,Z}function Em(e,t){switch(vp(t=t||{}),t.type||"base64"){case"base64":return km(ji(e),t);case"binary":case"buffer":case"file":return km(e,t);case"array":return km(Ci(e),t)}}function Sm(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return sd(e,1)}(r),r.length-r.l<=4)return t;var a=r.read_shift(4);return 0==a||a>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(a=r.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return sd(e,2)}(r),0==(a=r.read_shift(4))||a>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var Tm=[60,1084,2066,2165,2175];function _m(e,t,r,a,n){var s=a,i=[],l=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:n.enc.insitu(l)}i.push(l),r.l+=s;for(var o=uc(r,r.l),c=Im[o],d=0;null!=c&&Tm.indexOf(o)>-1;)s=uc(r,r.l+2),d=r.l+4,2066==o?d+=4:2165!=o&&2175!=o||(d+=12),l=r.slice(d,r.l+4+s),i.push(l),r.l+=4+s,c=Im[o=uc(r,r.l)];var u=Oi(i);Nc(u,0);var f=0;u.lens=[];for(var h=0;h<i.length;++h)u.lens.push(f),f+=i[h].length;if(u.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+a;return t.f(u,u.length,n)}function Cm(e,t,r){if("z"!==e.t&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Hi[a])}catch(Ge){if(t.WTF)throw Ge}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||md[e.v]:0===a||"General"==a?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Zi(e.v):e.w=el(e.v):e.w=wl(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(Ge){if(t.WTF)throw Ge}if(t.cellDates&&a&&"n"==e.t&&xl(Hi[a]||String(a))){var n=$i(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Am(e,t,r){return{v:e,ixfe:t,t:r}}function Om(e,t){var r={opts:{}},a={};var n,s,i,l,o,c,d,u,f=t.dense?[]:{},h={},m={},p=null,g=[],x="",v={},b="",y={},w=[],N=[],j=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},S=function(e){return e<8?hd[e]:e<64&&j[e-8]||hd[e]},T=function(e,t,r){if(!(M>1)&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var a,n=t.XF.data;n&&n.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=n.patternType,(a=ef(S(n.icvFore)))&&(t.s.fgColor={rgb:a}),(a=ef(S(n.icvBack)))&&(t.s.bgColor={rgb:a}))}(0,t,r),delete t.ixfe,delete t.XF,n=e,b=Ic(e),m&&m.s&&m.e||(m={s:{r:0,c:0},e:{r:0,c:0}}),e.r<m.s.r&&(m.s.r=e.r),e.c<m.s.c&&(m.s.c=e.c),e.r+1>m.e.r&&(m.e.r=e.r+1),e.c+1>m.e.c&&(m.e.c=e.c+1),r.cellFormula&&t.f)for(var a=0;a<w.length;++a)if(!(w[a][0].s.c>e.c||w[a][0].s.r>e.r)&&!(w[a][0].e.c<e.c||w[a][0].e.r<e.r)){t.F=Fc(w[a][0]),w[a][0].s.c==e.c&&w[a][0].s.r==e.r||delete t.f,t.f&&(t.f=""+uh(w[a][1],0,e,D,_));break}r.dense?(f[e.r]||(f[e.r]=[]),f[e.r][e.c]=t):f[b]=t}},_={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(_.password=t.password);var C=[],A=[],O=[],R=[],P=!1,D=[];D.SheetNames=_.snames,D.sharedf=_.sharedf,D.arrayf=_.arrayf,D.names=[],D.XTI=[];var L,I=0,M=0,F=0,U=[],z=[];_.codepage=1200,hi(1200);for(var B=!1;e.l<e.length-1;){var V=e.l,H=e.read_shift(2);if(0===H&&10===I)break;var W=e.l===e.length?0:e.read_shift(2),q=Im[H];if(q&&q.f){if(t.bookSheets&&133===I&&133!==H)break;if(I=H,2===q.r||12==q.r){var G=e.read_shift(2);if(W-=2,!_.enc&&G!==H&&((255&G)<<8|G>>8)!==H)throw new Error("rt mismatch: "+G+"!="+H);12==q.r&&(e.l+=10,W-=10)}var $={};if($=10===H?q.f(e,W,_):_m(H,q,e,W,_),0==M&&-1===[9,521,1033,2057].indexOf(I))continue;switch(H){case 34:r.opts.Date1904=k.WBProps.date1904=$;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(_.enc||(e.l=0),_.enc=$,!t.password)throw new Error("File is password-protected");if(null==$.valid)throw new Error("Encryption scheme unsupported");if(!$.valid)throw new Error("Password is incorrect");break;case 92:_.lastuser=$;break;case 66:var Y=Number($);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252}hi(_.codepage=Y),B=!0;break;case 317:_.rrtabid=$;break;case 25:_.winlocked=$;break;case 439:r.opts.RefreshAll=$;break;case 12:r.opts.CalcCount=$;break;case 16:r.opts.CalcDelta=$;break;case 17:r.opts.CalcIter=$;break;case 13:r.opts.CalcMode=$;break;case 14:r.opts.CalcPrecision=$;break;case 95:r.opts.CalcSaveRecalc=$;break;case 15:_.CalcRefMode=$;break;case 2211:r.opts.FullCalc=$;break;case 129:$.fDialog&&(f["!type"]="dialog"),$.fBelow||((f["!outline"]||(f["!outline"]={})).above=!0),$.fRight||((f["!outline"]||(f["!outline"]={})).left=!0);break;case 224:N.push($);break;case 430:D.push([$]),D[D.length-1].XTI=[];break;case 35:case 547:D[D.length-1].push($);break;case 24:case 536:L={Name:$.Name,Ref:uh($.rgce,0,null,D,_)},$.itab>0&&(L.Sheet=$.itab-1),D.names.push(L),D[0]||(D[0]=[],D[0].XTI=[]),D[D.length-1].push($),"_xlnm._FilterDatabase"==$.Name&&$.itab>0&&$.rgce&&$.rgce[0]&&$.rgce[0][0]&&"PtgArea3d"==$.rgce[0][0][0]&&(z[$.itab-1]={ref:Fc($.rgce[0][0][1][2])});break;case 22:_.ExternCount=$;break;case 23:0==D.length&&(D[0]=[],D[0].XTI=[]),D[D.length-1].XTI=D[D.length-1].XTI.concat($),D.XTI=D.XTI.concat($);break;case 2196:if(_.biff<8)break;null!=L&&(L.Comment=$[1]);break;case 18:f["!protect"]=$;break;case 19:0!==$&&_.WTF&&console.error("Password verifier: "+$);break;case 133:h[$.pos]=$,_.snames.push($.name);break;case 10:if(--M)break;if(m.e){if(m.e.r>0&&m.e.c>0){if(m.e.r--,m.e.c--,f["!ref"]=Fc(m),t.sheetRows&&t.sheetRows<=m.e.r){var K=m.e.r;m.e.r=t.sheetRows-1,f["!fullref"]=f["!ref"],f["!ref"]=Fc(m),m.e.r=K}m.e.r++,m.e.c++}C.length>0&&(f["!merges"]=C),A.length>0&&(f["!objects"]=A),O.length>0&&(f["!cols"]=O),R.length>0&&(f["!rows"]=R),k.Sheets.push(E)}""===x?v=f:a[x]=f,f=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===_.biff&&(_.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[$.BIFFVer]||8),_.biffguess=0==$.BIFFVer,0==$.BIFFVer&&4096==$.dt&&(_.biff=5,B=!0,hi(_.codepage=28591)),8==_.biff&&0==$.BIFFVer&&16==$.dt&&(_.biff=2),M++)break;if(f=t.dense?[]:{},_.biff<8&&!B&&(B=!0,hi(_.codepage=t.codepage||1252)),_.biff<5||0==$.BIFFVer&&4096==$.dt){""===x&&(x="Sheet1"),m={s:{r:0,c:0},e:{r:0,c:0}};var X={pos:e.l-W,name:x};h[X.pos]=X,_.snames.push(x)}else x=(h[V]||{name:""}).name;32==$.dt&&(f["!type"]="chart"),64==$.dt&&(f["!type"]="macro"),C=[],A=[],_.arrayf=w=[],O=[],R=[],P=!1,E={Hidden:(h[V]||{hs:0}).hs,name:x};break;case 515:case 3:case 2:"chart"==f["!type"]&&(t.dense?(f[$.r]||[])[$.c]:f[Ic({c:$.c,r:$.r})])&&++$.c,c={ixfe:$.ixfe,XF:N[$.ixfe]||{},v:$.val,t:"n"},F>0&&(c.z=U[c.ixfe>>8&63]),Cm(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t);break;case 5:case 517:c={ixfe:$.ixfe,XF:N[$.ixfe],v:$.val,t:$.t},F>0&&(c.z=U[c.ixfe>>8&63]),Cm(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t);break;case 638:c={ixfe:$.ixfe,XF:N[$.ixfe],v:$.rknum,t:"n"},F>0&&(c.z=U[c.ixfe>>8&63]),Cm(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t);break;case 189:for(var J=$.c;J<=$.C;++J){var Q=$.rkrec[J-$.c][0];c={ixfe:Q,XF:N[Q],v:$.rkrec[J-$.c][1],t:"n"},F>0&&(c.z=U[c.ixfe>>8&63]),Cm(c,t,r.opts.Date1904),T({c:J,r:$.r},c,t)}break;case 6:case 518:case 1030:if("String"==$.val){p=$;break}if((c=Am($.val,$.cell.ixfe,$.tt)).XF=N[c.ixfe],t.cellFormula){var Z=$.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],re=Ic({r:ee,c:te});y[re]?c.f=""+uh($.formula,0,$.cell,D,_):c.F=((t.dense?(f[ee]||[])[te]:f[re])||{}).F}else c.f=""+uh($.formula,0,$.cell,D,_)}F>0&&(c.z=U[c.ixfe>>8&63]),Cm(c,t,r.opts.Date1904),T($.cell,c,t),p=$;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=$,(c=Am($,p.cell.ixfe,"s")).XF=N[c.ixfe],t.cellFormula&&(c.f=""+uh(p.formula,0,p.cell,D,_)),F>0&&(c.z=U[c.ixfe>>8&63]),Cm(c,t,r.opts.Date1904),T(p.cell,c,t),p=null;break;case 33:case 545:w.push($);var ae=Ic($[0].s);if(s=t.dense?(f[$[0].s.r]||[])[$[0].s.c]:f[ae],t.cellFormula&&s){if(!p)break;if(!ae||!s)break;s.f=""+uh($[1],0,$[0],D,_),s.F=Fc($[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!p)break;y[Ic(p.cell)]=$[0],((s=t.dense?(f[p.cell.r]||[])[p.cell.c]:f[Ic(p.cell)])||{}).f=""+uh($[0],0,n,D,_)}break;case 253:c=Am(g[$.isst].t,$.ixfe,"s"),g[$.isst].h&&(c.h=g[$.isst].h),c.XF=N[c.ixfe],F>0&&(c.z=U[c.ixfe>>8&63]),Cm(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:$.ixfe,XF:N[$.ixfe],t:"z"},F>0&&(c.z=U[c.ixfe>>8&63]),Cm(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t));break;case 190:if(t.sheetStubs)for(var ne=$.c;ne<=$.C;++ne){var se=$.ixfe[ne-$.c];c={ixfe:se,XF:N[se],t:"z"},F>0&&(c.z=U[c.ixfe>>8&63]),Cm(c,t,r.opts.Date1904),T({c:ne,r:$.r},c,t)}break;case 214:case 516:case 4:(c=Am($.val,$.ixfe,"s")).XF=N[c.ixfe],F>0&&(c.z=U[c.ixfe>>8&63]),Cm(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t);break;case 0:case 512:1===M&&(m=$);break;case 252:g=$;break;case 1054:if(4==_.biff){U[F++]=$[1];for(var ie=0;ie<F+163&&Hi[ie]!=$[1];++ie);ie>=163&&Nl($[1],F+163)}else Nl($[1],$[0]);break;case 30:U[F++]=$;for(var le=0;le<F+163&&Hi[le]!=$;++le);le>=163&&Nl($,F+163);break;case 229:C=C.concat($);break;case 93:A[$.cmo[0]]=_.lastobj=$;break;case 438:_.lastobj.TxO=$;break;case 127:_.lastobj.ImData=$;break;case 440:for(o=$[0].s.r;o<=$[0].e.r;++o)for(l=$[0].s.c;l<=$[0].e.c;++l)(s=t.dense?(f[o]||[])[l]:f[Ic({c:l,r:o})])&&(s.l=$[1]);break;case 2048:for(o=$[0].s.r;o<=$[0].e.r;++o)for(l=$[0].s.c;l<=$[0].e.c;++l)(s=t.dense?(f[o]||[])[l]:f[Ic({c:l,r:o})])&&s.l&&(s.l.Tooltip=$[1]);break;case 28:if(_.biff<=5&&_.biff>=2)break;s=t.dense?(f[$[0].r]||[])[$[0].c]:f[Ic($[0])];var oe=A[$[2]];s||(t.dense?(f[$[0].r]||(f[$[0].r]=[]),s=f[$[0].r][$[0].c]={t:"z"}):s=f[Ic($[0])]={t:"z"},m.e.r=Math.max(m.e.r,$[0].r),m.s.r=Math.min(m.s.r,$[0].r),m.e.c=Math.max(m.e.c,$[0].c),m.s.c=Math.min(m.s.c,$[0].c)),s.c||(s.c=[]),i={a:$[1],t:oe.TxO.t},s.c.push(i);break;case 2173:Of(N[$.ixfe],$.ext);break;case 125:if(!_.cellStyles)break;for(;$.e>=$.s;)O[$.e--]={width:$.w/256,level:$.level||0,hidden:!!(1&$.flags)},P||(P=!0,of($.w/256)),cf(O[$.e+1]);break;case 520:var ce={};null!=$.level&&(R[$.r]=ce,ce.level=$.level),$.hidden&&(R[$.r]=ce,ce.hidden=!0),$.hpt&&(R[$.r]=ce,ce.hpt=$.hpt,ce.hpx=ff($.hpt));break;case 38:case 39:case 40:case 41:f["!margins"]||Th(f["!margins"]={}),f["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=$;break;case 161:f["!margins"]||Th(f["!margins"]={}),f["!margins"].header=$.header,f["!margins"].footer=$.footer;break;case 574:$.RTL&&(k.Views[0].RTL=!0);break;case 146:j=$;break;case 2198:u=$;break;case 140:d=$;break;case 442:x?E.CodeName=$||E.name:k.WBProps.CodeName=$||"ThisWorkbook"}}else q||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=W}return r.SheetNames=Cl(h).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return h[e].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&v["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=v)):r.Preamble=v,r.Sheets&&z.forEach(function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e}),r.Strings=g,r.SSF=Hl(Hi),_.enc&&(r.Encryption=_.enc),u&&(r.Themes=u),r.Metadata={},void 0!==d&&(r.Metadata.Country=d),D.names.length>0&&(k.Names=D.names),r.Workbook=k,r}var Rm="e0859ff2f94f6810ab9108002b27b3d9",Pm="02d5cdd59c2e1b10939708002b2cf9ae";function Dm(e,t){var r,a,n,s;if(t||(t={}),vp(t),mi(),t.codepage&&fi(t.codepage),e.FullPaths){if(Tl.find(e,"/encryption"))throw new Error("File is password-protected");r=Tl.find(e,"!CompObj"),a=Tl.find(e,"/Workbook")||Tl.find(e,"/Book")}else{switch(t.type){case"base64":e=_i(ji(e));break;case"binary":e=_i(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Nc(e,0),a={content:e}}if(r&&Sm(r),t.bookProps&&!t.bookSheets)n={};else{var i=ki?"buffer":"array";if(a&&a.content)n=Om(a.content,t);else if((s=Tl.find(e,"PerfectOffice_MAIN"))&&s.content)n=Au.to_workbook(s.content,(t.type=i,t));else{if(!(s=Tl.find(e,"NativeContent_MAIN"))||!s.content)throw(s=Tl.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n=Au.to_workbook(s.content,(t.type=i,t))}t.bookVBA&&e.FullPaths&&Tl.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=function(e){var t=Tl.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Tl.utils.cfb_add(t,n,e.FileIndex[a].content)}}),Tl.write(t)}(e))}var l={};return e.FullPaths&&function(e,t,r){var a=Tl.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Ud(a,od,Pm);for(var s in n)t[s]=n[s]}catch(Ge){if(r.WTF)throw Ge}var i=Tl.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var l=Ud(i,cd,Rm);for(var o in l)null==t[o]&&(t[o]=l[o])}catch(Ge){if(r.WTF)throw Ge}t.HeadingPairs&&t.TitlesOfParts&&(kd(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,l,t),n.Props=n.Custprops=l,t.bookFiles&&(n.cfb=e),n}var Lm={0:{f:function(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,7&s&&(r.level=7&s),16&s&&(r.hidden=!0),32&s&&(r.hpt=n/20),r}},1:{f:function(e){return[Kc(e)]}},2:{f:function(e){return[Kc(e),td(e),"n"]}},3:{f:function(e){return[Kc(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Kc(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Kc(e),nd(e),"n"]}},6:{f:function(e){return[Kc(e),qc(e),"str"]}},7:{f:function(e){return[Kc(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var a=e.l+t,n=Kc(e);n.r=r["!row"];var s=[n,qc(e),"str"];if(r.cellFormula){e.l+=2;var i=xh(e,a-e.l,r);s[3]=uh(i,0,n,r.supbooks,r)}else e.l=a;return s}},9:{f:function(e,t,r){var a=e.l+t,n=Kc(e);n.r=r["!row"];var s=[n,nd(e),"n"];if(r.cellFormula){e.l+=2;var i=xh(e,a-e.l,r);s[3]=uh(i,0,n,r.supbooks,r)}else e.l=a;return s}},10:{f:function(e,t,r){var a=e.l+t,n=Kc(e);n.r=r["!row"];var s=[n,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var i=xh(e,a-e.l,r);s[3]=uh(i,0,n,r.supbooks,r)}else e.l=a;return s}},11:{f:function(e,t,r){var a=e.l+t,n=Kc(e);n.r=r["!row"];var s=[n,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var i=xh(e,a-e.l,r);s[3]=uh(i,0,n,r.supbooks,r)}else e.l=a;return s}},12:{f:function(e){return[Xc(e)]}},13:{f:function(e){return[Xc(e),td(e),"n"]}},14:{f:function(e){return[Xc(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Xc(e),e.read_shift(1),"b"]}},16:{f:Wh},17:{f:function(e){return[Xc(e),qc(e),"str"]}},18:{f:function(e){return[Xc(e),e.read_shift(4),"s"]}},19:{f:$c},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=Zc(e),i=vh(e,0,r),l=Qc(e);e.l=a;var o={Name:s,Ptg:i};return n<268435455&&(o.Sheet=n),l&&(o.Comment=l),o}},40:{},42:{},43:{f:function(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1),700===e.read_shift(2)&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(a.underline=s);var i=e.read_shift(1);i>0&&(a.family=i);var l=e.read_shift(1);switch(l>0&&(a.charset=l),e.l++,a.color=function(e){var t={},r=e.read_shift(1)>>>1,a=e.read_shift(1),n=e.read_shift(2,"i"),s=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=a;var o=hd[a];o&&(t.rgb=ef(o));break;case 2:t.rgb=ef([s,i,l]);break;case 3:t.theme=a}return 0!=n&&(t.tint=n>0?n/32767:n/32768),t}(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor"}return a.name=qc(e),a}},44:{f:function(e,t){return[e.read_shift(2),qc(e)]}},45:{f:xf},46:{f:vf},47:{f:function(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:yu},62:{f:function(e){return[Kc(e),$c(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ic(r);var a=e.read_shift(1);return 2&a&&(t.l="1"),8&a&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:jc,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},a=e[e.l];return++e.l,r.above=!(64&a),r.left=!(128&a),e.l+=18,r.name=Jc(e,t-19),r}},148:{f:Hh,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?qc(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(65536&a),r.backupFile=!!(64&a),r.checkCompatibility=!!(4096&a),r.date1904=!!(1&a),r.filterPrivacy=!!(8&a),r.hidePivotFieldList=!!(1024&a),r.promptedSolutions=!!(16&a),r.publishItems=!!(2048&a),r.refreshAllConnections=!!(262144&a),r.saveExternalLinkValues=!!(128&a),r.showBorderUnselectedTables=!!(4&a),r.showInkAnnotation=!!(32&a),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(32768&a),r.updateLinks=["userSet","never","always"][a>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ed(e,t-8),r.name=qc(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:ad},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qh},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:qc(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ed},357:{},358:{},359:{},360:{T:1},361:{},362:{f:xu},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var a=e.l+t,n=rd(e),s=e.read_shift(1),i=[n];if(i[2]=s,r.cellFormula){var l=gh(e,a-e.l,r);i[1]=l}else e.l=a;return i}},427:{f:function(e,t,r){var a=e.l+t,n=[ad(e,16)];if(r.cellFormula){var s=bh(e,a-e.l,r);n[1]=s,e.l=a}else e.l=a;return n}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Gh.forEach(function(r){t[r]=nd(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,a=ad(e,16),n=Qc(e),s=qc(e),i=qc(e),l=qc(e);e.l=r;var o={rfx:a,relId:n,loc:s,display:l};return i&&(o.Tooltip=i),o}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ed},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Pf},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=ad(e,16);return t.rfx=r.s,t.ref=Ic(r.s),e.l+=16,t}},636:{T:-1},637:{f:Yc},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:qc(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Im={6:{f:mh},10:{f:zd},12:{f:Vd},13:{f:Vd},14:{f:Bd},15:{f:Bd},16:{f:nd},17:{f:Bd},18:{f:Bd},19:{f:Vd},20:{f:hu},21:{f:hu},23:{f:xu},24:{f:gu},25:{f:Bd},26:{},27:{},28:{f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=Yd(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},l,i,s]}}(e,0,r)}},29:{},34:{f:Bd},35:{f:mu},38:{f:nd},39:{f:nd},40:{f:nd},41:{f:nd},42:{f:Bd},43:{f:Bd},47:{f:function(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?Qu(e,t-2,a):function(e,t,r,a){var n={key:Vd(e),verificationBytes:Vd(e)};r.password&&(n.verifier=Ku(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=Ju(r.password))}(e,r.biff,r,a),a}},49:{f:function(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return a.name=Wd(e,0,r),a}},51:{f:Vd},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Bd},65:{f:function(){}},66:{f:Vd},77:{},80:{},81:{},82:{},85:{f:Vd},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=Yd(e,0,r);return e.read_shift(t+a-e.l),n}},93:{f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((bu[a]||jc)(e,t,r)),{cmo:[n,a,s],ft:i}}(e,t,r);var a=su(e),n=function(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(lu[n](e,r-e.l))}catch(Ge){return e.l=r,a}}return e.l!=r&&(e.l=r),a}(e,t-22,a[1]);return{cmo:a,ft:n}}},94:{},95:{f:Bd},96:{},97:{},99:{f:Bd},125:{f:yu},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var a=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&a,fBelow:64&a,fRight:128&a}}},130:{f:Vd},131:{f:Bd},132:{f:Bd},133:{f:function(e,t,r){var a=e.read_shift(4),n=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}var i=Wd(e,0,r);return 0===i.length&&(i="Sheet1"),{pos:a,hs:n,dt:s,name:i}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=dd[t]||t,t=e.read_shift(2),r[1]=dd[t]||t,r}},141:{f:Vd},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Qd(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:Vd},157:{},158:{},160:{f:Nu},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=nd(e),r.footer=nd(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(tu(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:i,rkrec:s}}},190:{f:function(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:i,ixfe:s}}},193:{f:zd},197:{},198:{},199:{},200:{},201:{},202:{f:Bd},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Vd},220:{},221:{f:Bd},222:{},224:{f:function(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,a.data=function(e,t,r,a){var n={},s=e.read_shift(4),i=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(2);return n.patternType=ud[l>>26],a.cellStyles?(n.alc=7&s,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=15&i,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=127&l,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=127&o,n.icvBack=o>>7&127,n.fsxButton=o>>14&1,n):n}(e,0,a.fStyle,r),a}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:zd},227:{},229:{f:function(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(ru(e));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0;i!=n&&e.l<r;++i)s.push(qd(e));return s.Count=a,s.Unique=n,s}},253:{f:function(e){var t=Zd(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Hd},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Bd},353:{f:zd},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,1025==s||14849==s)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Gd(e,s),l=[];a>e.l;)l.push($d(e));return[s,n,i,l]}},431:{f:Bd},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var a=e.l,n="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}(e);var i=e.read_shift(2);e.read_shift(2),Vd(e);var l=e.read_shift(2);e.l+=l;for(var o=1;o<e.lens.length-1;++o){if(e.l-a!=e.lens[o])throw new Error("TxO: bad continue record");var c=e[e.l];if((n+=Gd(e,e.lens[o+1]-e.lens[o]-1)).length>=(c?i:2*i))break}if(n.length!==i&&n.length!==2*i)throw new Error("cchText: "+i+" != "+n.length);return e.l=a+t,{t:n}}catch(Ge){return e.l=a+t,{t:n}}}},439:{f:Bd},440:{f:function(e,t){var r=ru(e);e.l+=16;var a=function(e,t){var r=e.l+t,a=e.read_shift(4);if(2!==a)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,i,l,o,c,d,u="";16&n&&(s=Xd(e,e.l)),128&n&&(i=Xd(e,e.l)),257===(257&n)&&(l=Xd(e,e.l)),1===(257&n)&&(o=Kd(e,e.l)),8&n&&(u=Xd(e,e.l)),32&n&&(c=e.read_shift(16)),64&n&&(d=Cd(e)),e.l=r;var f=i||l||o||"";f&&u&&(f+="#"+u),f||(f="#"+u),2&n&&"/"==f.charAt(0)&&"/"!=f.charAt(1)&&(f="file://"+f);var h={Target:f};return c&&(h.guid=c),d&&(h.time=d),s&&(h.Tooltip=s),h}(e,t-24);return[r,a]}},441:{},442:{f:$d},443:{},444:{f:Vd},445:{},446:{},448:{f:zd},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:zd},512:{f:uu},513:{f:wu},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var a=Zd(e),n=nd(e);return a.val=n,a}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var a=Zd(e);2==r.biff&&e.l++;var n=$d(e,e.l,r);return a.val=n,a}},517:{f:fu},519:{f:ju},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,7&a&&(t.level=7&a),32&a&&(t.hidden=!0),64&a&&(t.hpt=r/20),t}},523:{},545:{f:vu},549:{f:cu},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),a=tu(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),Yd(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var a=au(e);e.l++;var n=e.read_shift(1);return[hh(e,t-=8,r),n,a]}},2048:{f:function(e,t){e.read_shift(2);var r=ru(e),a=e.read_shift((t-10)/2,"dbcs-cont");return[r,a=a.replace(Ri,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ou},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:zd},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),n=[];a-- >0;)n.push(Af(e,e.l));return{ixfe:r,ext:n}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Bd,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2);return[Gd(e,a,r),Gd(e,n,r)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var a=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var n,s=e.slice(e.l);e.l=a;try{n=no(s,{type:"array"})}catch(Ge){return}var i=eo(n,"theme/theme/theme1.xml",!0);if(i)return Tf(i,r)}else e.l=a},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:zd},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Vd},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var a={area:!1};if(5!=r.biff)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,16&n&&(a.area=!0),a}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Qd(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:uu},1:{},2:{f:function(e){var t=Zd(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},3:{f:function(e){var t=Zd(e);++e.l;var r=nd(e);return t.t="n",t.val=r,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var a=Zd(e);++e.l;var n=Yd(e,0,r);return a.t="str",a.val=n,a}},5:{f:fu},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:ou},11:{},22:{f:Vd},30:{f:du},31:{},32:{},33:{f:vu},36:{},37:{f:cu},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Vd},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var a=e.l+t,n=Zd(e),s=e.read_shift(2),i=Gd(e,s,r);return e.l=a,n.t="str",n.val=i,n}},223:{},234:{},354:{},421:{},518:{f:mh},521:{f:ou},536:{f:gu},547:{f:mu},561:{},579:{},1030:{f:mh},1033:{f:ou},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Mm(e,t,r,a){var n=t;if(!isNaN(n)){var s=a||(r||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,s),s>0&&oc(r)&&e.push(r)}}function Fm(e,t){var r=t||{};var a=r.dense?[]:{},n=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=n.index,l=s&&s.index||e.length,o=Yl(e.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,u=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<o.length;++i){var p=o[i].trim(),g=p.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var x=p.split(/<\/t[dh]>/i);for(l=0;l<x.length;++l){var v=x[l].trim();if(v.match(/<t[dh]/i)){for(var b=v,y=0;"<"==b.charAt(0)&&(y=b.indexOf(">"))>-1;)b=b.slice(y+1);for(var w=0;w<m.length;++w){var N=m[w];N.s.c==d&&N.s.r<c&&c<=N.e.r&&(d=N.e.c+1,w=-1)}var j=ho(v.slice(0,v.indexOf(">")));f=j.colspan?+j.colspan:1,((u=+j.rowspan)>1||f>1)&&m.push({s:{r:c,c:d},e:{r:c+(u||1)-1,c:d+f-1}});var k=j.t||j["data-t"]||"";if(b.length)if(b=Ao(b),h.s.r>c&&(h.s.r=c),h.e.r<c&&(h.e.r=c),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),b.length){var E={t:"s",v:b};r.raw||!b.trim().length||"s"==k||("TRUE"===b?E={t:"b",v:!0}:"FALSE"===b?E={t:"b",v:!1}:isNaN(ql(b))?isNaN($l(b).getDate())||(E={t:"d",v:Bl(b)},r.cellDates||(E={t:"n",v:Rl(E.v)}),E.z=r.dateNF||Hi[14]):E={t:"n",v:ql(b)}),r.dense?(a[c]||(a[c]=[]),a[c][d]=E):a[Ic({r:c,c:d})]=E,d+=f}else d+=f;else d+=f}}}}else{if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0}}return a["!ref"]=Fc(h),m.length&&(a["!merges"]=m),a}function Um(e,t,r,a){for(var n=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var l=0,o=0,c=0;c<n.length;++c)if(!(n[c].s.r>r||n[c].s.c>i)&&!(n[c].e.r<r||n[c].e.c<i)){if(n[c].s.r<r||n[c].s.c<i){l=-1;break}l=n[c].e.r-n[c].s.r+1,o=n[c].e.c-n[c].s.c+1;break}if(!(l<0)){var d=Ic({r:r,c:i}),u=a.dense?(e[r]||[])[i]:e[d],f=u&&null!=u.v&&(u.h||yo(u.w||(Bc(u),u.w)||""))||"",h={};l>1&&(h.rowspan=l),o>1&&(h.colspan=o),a.editable?f='<span contenteditable="true">'+f+"</span>":u&&(h["data-t"]=u&&u.t||"z",null!=u.v&&(h["data-v"]=u.v),null!=u.z&&(h["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(f='<a href="'+u.l.Target+'">'+f+"</a>")),h.id=(a.id||"sjs")+"-"+d,s.push(Mo("td",f,h))}}return"<tr>"+s.join("")+"</tr>"}var zm='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Bm="</body></html>";function Vm(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Hm(e,t){var r=t||{},a=null!=r.header?r.header:zm,n=null!=r.footer?r.footer:Bm,s=[a],i=Mc(e["!ref"]);r.dense=Array.isArray(e),s.push(Vm(0,0,r));for(var l=i.s.r;l<=i.e.r;++l)s.push(Um(e,i,l,r));return s.push("</table>"+n),s.join("")}function Wm(e,t,r){var a=r||{};var n=0,s=0;if(null!=a.origin)if("number"==typeof a.origin)n=a.origin;else{var i="string"==typeof a.origin?Lc(a.origin):a.origin;n=i.r,s=i.c}var l=t.getElementsByTagName("tr"),o=Math.min(a.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var d=Mc(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==n&&(c.e.r=n=d.e.r+1)}var u=[],f=0,h=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,x=0,v=0,b=0;for(e["!cols"]||(e["!cols"]=[]);m<l.length&&p<o;++m){var y=l[m];if(Gm(y)){if(a.display)continue;h[p]={hidden:!0}}var w=y.children;for(g=x=0;g<w.length;++g){var N=w[g];if(!a.display||!Gm(N)){var j=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):Ao(N.innerHTML),k=N.getAttribute("data-z")||N.getAttribute("z");for(f=0;f<u.length;++f){var E=u[f];E.s.c==x+s&&E.s.r<p+n&&p+n<=E.e.r&&(x=E.e.c+1-s,f=-1)}b=+N.getAttribute("colspan")||1,((v=+N.getAttribute("rowspan")||1)>1||b>1)&&u.push({s:{r:p+n,c:x+s},e:{r:p+n+(v||1)-1,c:x+s+(b||1)-1}});var S={t:"s",v:j},T=N.getAttribute("data-t")||N.getAttribute("t")||"";null!=j&&(0==j.length?S.t=T||"z":a.raw||0==j.trim().length||"s"==T||("TRUE"===j?S={t:"b",v:!0}:"FALSE"===j?S={t:"b",v:!1}:isNaN(ql(j))?isNaN($l(j).getDate())||(S={t:"d",v:Bl(j)},a.cellDates||(S={t:"n",v:Rl(S.v)}),S.z=a.dateNF||Hi[14]):S={t:"n",v:ql(j)})),void 0===S.z&&null!=k&&(S.z=k);var _="",C=N.getElementsByTagName("A");if(C&&C.length)for(var A=0;A<C.length&&(!C[A].hasAttribute("href")||"#"==(_=C[A].getAttribute("href")).charAt(0));++A);_&&"#"!=_.charAt(0)&&(S.l={Target:_}),a.dense?(e[p+n]||(e[p+n]=[]),e[p+n][x+s]=S):e[Ic({c:x+s,r:p+n})]=S,c.e.c<x+s&&(c.e.c=x+s),x+=b}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,p-1+n),e["!ref"]=Fc(c),p>=o&&(e["!fullref"]=Fc((c.e.r=l.length-m+p-1+n,c))),e}function qm(e,t){return Wm((t||{}).dense?[]:{},e,t)}function Gm(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function $m(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[xo(t.replace(/<[^>]*>/g,""))]}var Ym={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Km(e,t){var r=t||{};var a,n,s,i,l,o,c=Fo(e),d=[],u={name:""},f="",h=0,m={},p=[],g=r.dense?[]:{},x={value:""},v="",b=0,y=[],w=-1,N=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,E={},S=[],T={},_=[],C=1,A=1,O=[],R={Names:[]},P={},D=["",""],L=[],I={},M="",F=0,U=!1,z=!1,B=0;for(Uo.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");l=Uo.exec(c);)switch(l[3]=l[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===l[1]?(j.e.c>=j.s.c&&j.e.r>=j.s.r?g["!ref"]=Fc(j):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=j.e.r&&(g["!fullref"]=g["!ref"],j.e.r=r.sheetRows-1,g["!ref"]=Fc(j)),S.length&&(g["!merges"]=S),_.length&&(g["!rows"]=_),s.name=s["\u540d\u79f0"]||s.name,"undefined"!==typeof JSON&&JSON.stringify(s),p.push(s.name),m[s.name]=g,z=!1):"/"!==l[0].charAt(l[0].length-2)&&(s=ho(l[0],!1),w=N=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,g=r.dense?[]:{},S=[],_=[],z=!0);break;case"table-row-group":"/"===l[1]?--k:++k;break;case"table-row":case"\u884c":if("/"===l[1]){w+=C,C=1;break}if((i=ho(l[0],!1))["\u884c\u53f7"]?w=i["\u884c\u53f7"]-1:-1==w&&(w=0),(C=+i["number-rows-repeated"]||1)<10)for(B=0;B<C;++B)k>0&&(_[w+B]={level:k});N=-1;break;case"covered-table-cell":"/"!==l[1]&&++N,r.sheetStubs&&(r.dense?(g[w]||(g[w]=[]),g[w][N]={t:"z"}):g[Ic({r:w,c:N})]={t:"z"}),v="",y=[];break;case"table-cell":case"\u6570\u636e":if("/"===l[0].charAt(l[0].length-2))++N,x=ho(l[0],!1),A=parseInt(x["number-columns-repeated"]||"1",10),o={t:"z",v:null},x.formula&&0!=r.cellFormula&&(o.f=jh(xo(x.formula))),"string"==(x["\u6570\u636e\u7c7b\u578b"]||x["value-type"])&&(o.t="s",o.v=xo(x["string-value"]||""),r.dense?(g[w]||(g[w]=[]),g[w][N]=o):g[Ic({r:w,c:N})]=o),N+=A-1;else if("/"!==l[1]){v="",b=0,y=[],A=1;var V=C?w+C-1:w;if(++N>j.e.c&&(j.e.c=N),N<j.s.c&&(j.s.c=N),w<j.s.r&&(j.s.r=w),V>j.e.r&&(j.e.r=V),L=[],I={},o={t:(x=ho(l[0],!1))["\u6570\u636e\u7c7b\u578b"]||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=xo(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(T={s:{r:w,c:N},e:{r:w+(parseInt(x["number-matrix-rows-spanned"],10)||0)-1,c:N+(parseInt(x["number-matrix-columns-spanned"],10)||0)-1}},o.F=Fc(T),O.push([T,o.F])),x.formula)o.f=jh(x.formula);else for(B=0;B<O.length;++B)w>=O[B][0].s.r&&w<=O[B][0].e.r&&N>=O[B][0].s.c&&N<=O[B][0].e.c&&(o.F=O[B][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(T={s:{r:w,c:N},e:{r:w+(parseInt(x["number-rows-spanned"],10)||0)-1,c:N+(parseInt(x["number-columns-spanned"],10)||0)-1}},S.push(T)),x["number-columns-repeated"]&&(A=parseInt(x["number-columns-repeated"],10)),o.t){case"boolean":o.t="b",o.v=No(x["boolean-value"]);break;case"float":case"percentage":case"currency":o.t="n",o.v=parseFloat(x.value);break;case"date":o.t="d",o.v=Bl(x["date-value"]),r.cellDates||(o.t="n",o.v=Rl(o.v)),o.z="m/d/yy";break;case"time":o.t="n",o.v=Ml(x["time-value"])/86400,r.cellDates&&(o.t="d",o.v=Il(o.v)),o.z="HH:MM:SS";break;case"number":o.t="n",o.v=parseFloat(x["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==o.t&&"text"!==o.t&&o.t)throw new Error("Unsupported value type "+o.t);o.t="s",null!=x["string-value"]&&(v=xo(x["string-value"]),y=[])}}else{if(U=!1,"s"===o.t&&(o.v=v||"",y.length&&(o.R=y),U=0==b),P.Target&&(o.l=P),L.length>0&&(o.c=L,L=[]),v&&!1!==r.cellText&&(o.w=v),U&&(o.t="z",delete o.v),(!U||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var H=0;H<C;++H){if(A=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(g[w+H]||(g[w+H]=[]),g[w+H][N]=0==H?o:Hl(o);--A>0;)g[w+H][N+A]=Hl(o);else for(g[Ic({r:w+H,c:N})]=o;--A>0;)g[Ic({r:w+H,c:N+A})]=Hl(o);j.e.c<=N&&(j.e.c=N)}N+=(A=parseInt(x["number-columns-repeated"]||"1",10))-1,A=0,o={},v="",y=[]}P={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===l[1]){if((a=d.pop())[0]!==l[3])throw"Bad state: "+a}else"/"!==l[0].charAt(l[0].length-2)&&d.push([l[3],!0]);break;case"annotation":if("/"===l[1]){if((a=d.pop())[0]!==l[3])throw"Bad state: "+a;I.t=v,y.length&&(I.R=y),I.a=M,L.push(I)}else"/"!==l[0].charAt(l[0].length-2)&&d.push([l[3],!1]);M="",F=0,v="",b=0,y=[];break;case"creator":"/"===l[1]?M=c.slice(F,l.index):F=l.index+l[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===l[1]){if((a=d.pop())[0]!==l[3])throw"Bad state: "+a}else"/"!==l[0].charAt(l[0].length-2)&&d.push([l[3],!1]);v="",b=0,y=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===l[1]){if(E[u.name]=f,(a=d.pop())[0]!==l[3])throw"Bad state: "+a}else"/"!==l[0].charAt(l[0].length-2)&&(f="",u=ho(l[0],!1),d.push([l[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(d[d.length-1][0]){case"time-style":case"date-style":n=ho(l[0],!1),f+=Ym[l[3]]["long"===n.style?1:0]}break;case"text":if("/>"===l[0].slice(-2))break;if("/"===l[1])switch(d[d.length-1][0]){case"number-style":case"date-style":case"time-style":f+=c.slice(h,l.index)}else h=l.index+l[0].length;break;case"named-range":D=kh((n=ho(l[0],!1))["cell-range-address"]);var W={Name:n.name,Ref:D[0]+"!"+D[1]};z&&(W.Sheet=p.length),R.Names.push(W);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(d[d.length-1][0])>-1)break;if("/"!==l[1]||x&&x["string-value"])ho(l[0],!1),b=l.index+l[0].length;else{var q=$m(c.slice(b,l.index));v=(v.length>0?v+"\n":"")+q[0]}break;case"database-range":if("/"===l[1])break;try{m[(D=kh(ho(l[0])["target-range-address"]))[0]]["!autofilter"]={ref:D[1]}}catch(Ge){}break;case"a":if("/"!==l[1]){if(!(P=ho(l[0],!1)).href)break;P.Target=xo(P.href),delete P.href,"#"==P.Target.charAt(0)&&P.Target.indexOf(".")>-1?(D=kh(P.Target.slice(1)),P.Target="#"+D[0]+"!"+D[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;default:switch(l[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(r.WTF)throw new Error(l)}}var G={Sheets:m,SheetNames:p,Workbook:R};return r.bookSheets&&delete G.Sheets,G}function Xm(e,t){t=t||{},Jl(e,"META-INF/manifest.xml")&&function(e,t){for(var r,a,n=Fo(e);r=Uo.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(a=ho(r[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==a.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(Zl(e,"META-INF/manifest.xml"),t);var r=eo(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=Km(To(r),t);return Jl(e,"meta.xml")&&(a.Props=Nd(Zl(e,"meta.xml"))),a}function Jm(e,t){return Km(e,t)}function Qm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Zm(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):To(Ci(e))}function ep(e){var t=e.reduce(function(e,t){return e+t.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(e){r.set(e,a),a+=e.length}),r}function tp(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function rp(e,t){var r=t?t[0]:0,a=127&e[r];e:if(e[r++]>=128){if(a|=(127&e[r])<<7,e[r++]<128)break e;if(a|=(127&e[r])<<14,e[r++]<128)break e;if(a|=(127&e[r])<<21,e[r++]<128)break e;if(a+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(a+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(a+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),a}function ap(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function np(e){for(var t=[],r=[0];r[0]<e.length;){var a,n=r[0],s=rp(e,r),i=7&s,l=0;if(0==(s=Math.floor(s/8)))break;switch(i){case 0:for(var o=r[0];e[r[0]++]>=128;);a=e.slice(o,r[0]);break;case 5:l=4,a=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,a=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=rp(e,r),a=e.slice(r[0],r[0]+l),r[0]+=l;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:a,type:i};null==t[s]?t[s]=[c]:t[s].push(c)}return t}function sp(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function ip(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=rp(e,a),s=np(e.slice(a[0],a[0]+n));a[0]+=n;var i={id:ap(s[1][0].data),messages:[]};s[2].forEach(function(t){var r=np(t.data),n=ap(r[3][0].data);i.messages.push({meta:r,data:e.slice(a[0],a[0]+n)}),a[0]+=n}),(null==(t=s[3])?void 0:t[0])&&(i.merge=ap(s[3][0].data)>>>0>0),r.push(i)}return r}function lp(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=rp(t,r),n=[];r[0]<t.length;){var s=3&t[r[0]];if(0!=s){var i=0,l=0;if(1==s?(l=4+(t[r[0]]>>2&7),i=(224&t[r[0]++])<<3,i|=t[r[0]++]):(l=1+(t[r[0]++]>>2),2==s?(i=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(i=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[ep(n)],0==i)throw new Error("Invalid offset 0");if(i>n[0].length)throw new Error("Invalid offset beyond length");if(l>=i)for(n.push(n[0].slice(-i)),l-=i;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-i,-i+l))}else{var o=t[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[r[0]],c>1&&(o|=t[r[0]+1]<<8),c>2&&(o|=t[r[0]+2]<<16),c>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}n.push(t.slice(r[0],r[0]+o)),r[0]+=o}}var d=ep(n);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function op(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(lp(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ep(t)}function cp(e,t,r){var a,n=Qm(e),s=n.getUint32(8,!0),i=12,l=-1,o=-1,c=NaN,d=NaN,u=new Date(2001,0,1);switch(1&s&&(c=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,a=1&e[t+14],n=t+13;n>=t;--n)a=256*a+e[n];return(128&e[t+15]?-a:a)*Math.pow(10,r-6176)}(e,i),i+=16),2&s&&(d=n.getFloat64(i,!0),i+=8),4&s&&(u.setTime(u.getTime()+1e3*n.getFloat64(i,!0)),i+=8),8&s&&(o=n.getUint32(i,!0),i+=4),16&s&&(l=n.getUint32(i,!0),i+=4),e[1]){case 0:break;case 2:case 10:a={t:"n",v:c};break;case 3:a={t:"s",v:t[o]};break;case 5:a={t:"d",v:u};break;case 6:a={t:"b",v:d>0};break;case 7:a={t:"n",v:d/86400};break;case 8:a={t:"e",v:0};break;case 9:if(!(l>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)));a={t:"s",v:r[l]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)))}return a}function dp(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,r,a){var n,s=Qm(e),i=s.getUint32(4,!0),l=(a>1?12:8)+4*tp(i&(a>1?3470:398)),o=-1,c=-1,d=NaN,u=new Date(2001,0,1);switch(512&i&&(o=s.getUint32(l,!0),l+=4),l+=4*tp(i&(a>1?12288:4096)),16&i&&(c=s.getUint32(l,!0),l+=4),32&i&&(d=s.getFloat64(l,!0),l+=8),64&i&&(u.setTime(u.getTime()+1e3*s.getFloat64(l,!0)),l+=8),e[2]){case 0:break;case 2:n={t:"n",v:d};break;case 3:n={t:"s",v:t[c]};break;case 5:n={t:"d",v:u};break;case 6:n={t:"b",v:d>0};break;case 7:n={t:"n",v:d/86400};break;case 8:n={t:"e",v:0};break;case 9:if(o>-1)n={t:"s",v:r[o]};else if(c>-1)n={t:"s",v:t[c]};else{if(isNaN(d))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));n={t:"n",v:d}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return n}(e,t,r,e[0]);case 5:return cp(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function up(e){return rp(np(e)[1][0].data)}function fp(e,t){var r=np(t.data),a=ap(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(t){var r=np(t.data),n=ap(r[1][0].data)>>>0;switch(a){case 1:s[n]=Zm(r[3][0].data);break;case 8:var i=np(e[up(r[9][0].data)][0].data),l=e[up(i[1][0].data)][0],o=ap(l.meta[1][0].data);if(2001!=o)throw new Error("2000 unexpected reference to ".concat(o));var c=np(l.data);s[n]=c[3].map(function(e){return Zm(e.data)}).join("")}}),s}function hp(e,t){var r,a=np(t.data),n=(null==(r=null==a?void 0:a[7])?void 0:r[0])?ap(a[7][0].data)>>>0>0?1:0:-1,s=sp(a[5],function(e){return function(e,t){var r,a,n,s,i,l,o,c,d,u,f,h,m,p,g,x,v=np(e),b=ap(v[1][0].data)>>>0,y=ap(v[2][0].data)>>>0,w=(null==(a=null==(r=v[8])?void 0:r[0])?void 0:a.data)&&ap(v[8][0].data)>0||!1;if((null==(s=null==(n=v[7])?void 0:n[0])?void 0:s.data)&&0!=t)g=null==(l=null==(i=v[7])?void 0:i[0])?void 0:l.data,x=null==(c=null==(o=v[6])?void 0:o[0])?void 0:c.data;else{if(!(null==(u=null==(d=v[4])?void 0:d[0])?void 0:u.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(h=null==(f=v[4])?void 0:f[0])?void 0:h.data,x=null==(p=null==(m=v[3])?void 0:m[0])?void 0:p.data}for(var N=w?4:1,j=Qm(g),k=[],E=0;E<g.length/2;++E){var S=j.getUint16(2*E,!0);S<65535&&k.push([E,S])}if(k.length!=y)throw"Expected ".concat(y," cells, found ").concat(k.length);var T=[];for(E=0;E<k.length-1;++E)T[k[E][0]]=x.subarray(k[E][1]*N,k[E+1][1]*N);return k.length>=1&&(T[k[k.length-1][0]]=x.subarray(k[k.length-1][1]*N)),{R:b,cells:T}}(e,n)});return{nrows:ap(a[4][0].data)>>>0,data:s.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(r,a){if(e[t.R][a])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(a));e[t.R][a]=r}),e},[])}}function mp(e,t){var r={"!ref":"A1"},a=e[up(np(t.data)[2][0].data)],n=ap(a[0].meta[1][0].data);if(6001!=n)throw new Error("6000 unexpected reference to ".concat(n));return function(e,t,r){var a,n=np(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(ap(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(ap(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Fc(s);var i=np(n[4][0].data),l=fp(e,e[up(i[4][0].data)][0]),o=(null==(a=i[17])?void 0:a[0])?fp(e,e[up(i[17][0].data)][0]):[],c=np(i[3][0].data),d=0;c[1].forEach(function(t){var a=np(t.data),n=e[up(a[2][0].data)][0],s=ap(n.meta[1][0].data);if(6002!=s)throw new Error("6001 unexpected reference to ".concat(s));var i=hp(0,n);i.data.forEach(function(e,t){e.forEach(function(e,a){var n=Ic({r:d+t,c:a}),s=dp(e,l,o);s&&(r[n]=s)})}),d+=i.nrows})}(e,a[0],r),r}function pp(e,t){var r={SheetNames:[],Sheets:{}};if(sp(np(t.data)[1],up).forEach(function(t){e[t].forEach(function(t){if(2==ap(t.meta[1][0].data)){var a=function(e,t){var r,a=np(t.data),n={name:(null==(r=a[1])?void 0:r[0])?Zm(a[1][0].data):"",sheets:[]};return sp(a[2],up).forEach(function(t){e[t].forEach(function(t){6e3==ap(t.meta[1][0].data)&&n.sheets.push(mp(e,t))})}),n}(e,t);a.sheets.forEach(function(e,t){Mp(r,e,0==t?a.name:a.name+"_"+t,!0)})}})}),0==r.SheetNames.length)throw new Error("Empty NUMBERS file");return r}function gp(e){var t,r,a,n,s={},i=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var t,r;try{t=op(e.content)}catch(Ge){return console.log("?? "+e.content.length+" "+(Ge.message||Ge))}try{r=ip(t)}catch(Ge){return console.log("## "+(Ge.message||Ge))}r.forEach(function(e){s[e.id]=e.messages,i.push(e.id)})}}),!i.length)throw new Error("File has no messages");var l=(null==(n=null==(a=null==(r=null==(t=null==s?void 0:s[1])?void 0:t[0])?void 0:r.meta)?void 0:a[1])?void 0:n[0].data)&&1==ap(s[1][0].meta[1][0].data)&&s[1][0];if(l||i.forEach(function(e){s[e].forEach(function(e){if(1==ap(e.meta[1][0].data)>>>0){if(l)throw new Error("Document has multiple roots");l=e}})}),!l)throw new Error("Cannot find Document root");return pp(s,l)}function xp(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];void 0===t[a[0]]&&(t[a[0]]=a[1]),"n"===a[2]&&(t[a[0]]=Number(t[a[0]]))}}}function vp(e){xp([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function bp(e){return xd.WS.indexOf(e)>-1?"sheet":xd.CS&&e==xd.CS?"chart":xd.DS&&e==xd.DS?"dialog":xd.MS&&e==xd.MS?"macro":e&&e.length?e:"sheet"}function yp(e,t,r,a,n,s,i,l,o,c,d,u){try{s[a]=bd(eo(e,r,!0),t);var f,h=Zl(e,t);switch(l){case"sheet":f=im(h,t,n,o,s[a],c,d,u);break;case"chart":if(!(f=lm(h,t,n,o,s[a],c))||!f["!drawel"])break;var m=so(f["!drawel"].Target,t),p=vd(m),g=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(eo(e,m,!0),bd(eo(e,p,!0),m)),x=so(g,m),v=vd(x);f=$h(eo(e,x,!0),0,0,bd(eo(e,v,!0),x),0,f);break;case"macro":y=t,s[a],y.slice(-4),f={"!type":"macro"};break;case"dialog":f=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,s[a]);break;default:throw new Error("Unrecognized sheet type "+l)}i[a]=f;var b=[];s&&s[a]&&Cl(s[a]).forEach(function(r){var n="";if(s[a][r].Type==xd.CMNT){n=so(s[a][r].Target,t);var i=dm(Zl(e,n,!0),n,o);if(!i||!i.length)return;Rf(f,i,!1)}s[a][r].Type==xd.TCMNT&&(n=so(s[a][r].Target,t),b=b.concat(function(e,t){var r=[],a=!1,n={},s=0;return e.replace(co,function(i,l){var o=ho(i);switch(mo(o[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":n={author:o.personId,guid:o.id,ref:o.ref,T:1};break;case"</threadedComment>":null!=n.t&&r.push(n);break;case"<text>":case"<text":s=l+i.length;break;case"</text>":n.t=e.slice(s,l).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":a=!0;break;case"</mentions>":case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}(Zl(e,n,!0),o)))}),b&&b.length&&Rf(f,b,!0,o.people||[])}catch(Ge){if(o.WTF)throw Ge}var y}function wp(e){return"/"==e.charAt(0)?e.slice(1):e}function Np(e,t){if(jl(),vp(t=t||{}),Jl(e,"META-INF/manifest.xml"))return Xm(e,t);if(Jl(e,"objectdata.xml"))return Xm(e,t);if(Jl(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return gp(e);var r=Tl.utils.cfb_new();return ro(e).forEach(function(t){ao(r,t,to(e,t))}),gp(r)}if(!Jl(e,"[Content_Types].xml")){if(Jl(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Jl(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var a,n,s=ro(e),i=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(co)||[]).forEach(function(e){var a=ho(e);switch(a[0].replace(uo,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":void 0!==t[gd[a.ContentType]]&&t[gd[a.ContentType]].push(a.PartName)}}),t.xmlns!==zo)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(eo(e,"[Content_Types].xml")),l=!1;if(0===i.workbooks.length&&Zl(e,n="xl/workbook.xml",!0)&&i.workbooks.push(n),0===i.workbooks.length){if(!Zl(e,n="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(n),l=!0}"bin"==i.workbooks[0].slice(-3)&&(l=!0);var o={},c={};if(!t.bookSheets&&!t.bookProps){if(Eh=[],i.sst)try{Eh=cm(Zl(e,wp(i.sst)),i.sst,t)}catch(Ge){if(t.WTF)throw Ge}t.cellStyles&&i.themes.length&&(o=function(e,t,r){return Tf(e,r)}(eo(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=om(Zl(e,wp(i.style)),i.style,o,t))}i.links.map(function(r){try{bd(eo(e,vd(wp(r))),r);return fm(Zl(e,wp(r)),0,r,t)}catch(Ge){}});var d=sm(Zl(e,wp(i.workbooks[0])),i.workbooks[0],t),u={},f="";i.coreprops.length&&((f=Zl(e,wp(i.coreprops[0]),!0))&&(u=Nd(f)),0!==i.extprops.length&&(f=Zl(e,wp(i.extprops[0]),!0))&&function(e,t,r){var a={};t||(t={}),e=To(e),jd.forEach(function(r){var n=(e.match(Co(r[0]))||[])[1];switch(r[2]){case"string":n&&(t[r[1]]=xo(n));break;case"bool":t[r[1]]="true"===n;break;case"raw":var s=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));s&&s.length>0&&(a[r[1]]=s[1])}}),a.HeadingPairs&&a.TitlesOfParts&&kd(a.HeadingPairs,a.TitlesOfParts,t,r)}(f,u,t));var h={};t.bookSheets&&!t.bookProps||0!==i.custprops.length&&(f=eo(e,wp(i.custprops[0]),!0))&&(h=function(e,t){var r={},a="",n=e.match(Ed);if(n)for(var s=0;s!=n.length;++s){var i=n[s],l=ho(i);switch(l[0]){case"<?xml":case"<Properties":break;case"<property":a=xo(l.name);break;case"</property>":a=null;break;default:if(0===i.indexOf("<vt:")){var o=i.split(">"),c=o[0].slice(4),d=o[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[a]=xo(d);break;case"bool":r[a]=No(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=Bl(d);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",i,c,o)}}else if("</"===i.slice(0,2));else if(t.WTF)throw new Error(i)}}return r}(f,t));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?a=d.Sheets.map(function(e){return e.name}):u.Worksheets&&u.SheetNames.length>0&&(a=u.SheetNames),t.bookProps&&(m.Props=u,m.Custprops=h),t.bookSheets&&"undefined"!==typeof a&&(m.SheetNames=a),t.bookSheets?m.SheetNames:t.bookProps))return m;a={};var p={};t.bookDeps&&i.calcchain&&(p=um(Zl(e,wp(i.calcchain)),i.calcchain));var g,x,v=0,b={},y=d.Sheets;u.Worksheets=y.length,u.SheetNames=[];for(var w=0;w!=y.length;++w)u.SheetNames[w]=y[w].name;var N=l?"bin":"xml",j=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,j+1)+"_rels/"+i.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");Jl(e,k)||(k="xl/_rels/workbook."+N+".rels");var E=bd(eo(e,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=hm(Zl(e,wp(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=function(e,t){var r=[],a=!1;return e.replace(co,function(e){var n=ho(e);switch(mo(n[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:n.displayname,id:n.id});break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+n[0]+" in threaded comments")}return e}),r}(Zl(e,wp(i.people[0])),t)),E&&(E=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,bp(e["!id"][t.id].Type)]})}catch(Ge){return null}return e&&0!==e.length?e:null}(E,d.Sheets));var S=Zl(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=u.Worksheets;++v){var T="sheet";if(E&&E[v]?(g="xl/"+E[v][1].replace(/[\/]?xl\//,""),Jl(e,g)||(g=E[v][1]),Jl(e,g)||(g=k.replace(/_rels\/.*$/,"")+E[v][1]),T=E[v][2]):g=(g="xl/worksheets/sheet"+(v+1-S)+"."+N).replace(/sheet0\./,"sheet."),x=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(u.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var _=!1,C=0;C!=t.sheets.length;++C)"number"==typeof t.sheets[C]&&t.sheets[C]==v&&(_=1),"string"==typeof t.sheets[C]&&t.sheets[C].toLowerCase()==u.SheetNames[v].toLowerCase()&&(_=1);if(!_)continue e}}yp(e,g,x,u.SheetNames[v],v,b,a,T,t,d,o,c)}return m={Directory:i,Workbook:d,Props:u,Custprops:h,Deps:p,Sheets:a,SheetNames:u.SheetNames,Strings:Eh,Styles:c,Themes:o,SSF:Hl(Hi)},t&&t.bookFiles&&(e.files?(m.keys=s,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(t,r){t=t.replace(/^Root Entry[\/]/,""),m.keys.push(t),m.files[t]=e.FileIndex[r]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=Zl(e,wp(i.vba[0]),!0):i.defaults&&"application/vnd.ms-office.vbaProject"===i.defaults.bin&&(m.vbaraw=Zl(e,"xl/vbaProject.bin",!0))),m}function jp(e,t){var r=t||{},a="Workbook",n=Tl.find(e,a);try{if(a="/!DataSpaces/Version",!(n=Tl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=Bu(e,4),t.U=Bu(e,4),t.W=Bu(e,4)}(n.content),a="/!DataSpaces/DataSpaceMap",!(n=Tl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Vu(e));return t}(n.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(n=Tl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(n.content);if(1!=i.length||"StrongEncryptionTransform"!=i[0])throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(n=Tl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);Hu(n.content)}catch(Ge){}if(a="/EncryptionInfo",!(n=Tl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=function(e){var t=Bu(e);switch(t.Minor){case 2:return[t.Minor,Gu(e)];case 3:return[t.Minor,$u()];case 4:return[t.Minor,Yu(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(n.content);if(a="/EncryptedPackage",!(n=Tl.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(4==l[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(l[1],n.content,r.password||"",r);if(2==l[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function kp(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ji(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Ep(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Em(e.slice(r),t);default:break e}return Cu.to_workbook(e,t)}function Sp(e,t,r,a){return a?(r.type="string",Cu.to_workbook(e,r)):Cu.to_workbook(t,r)}function Tp(e,t){mi();var r=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return Tp(new Uint8Array(e),((r=Hl(r)).type="array",r));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!==typeof Deno?"buffer":"array");var a,n=e,s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Sh={},r.dateNF&&(Sh.dateNF=r.dateNF),r.type||(r.type=ki&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=ki?"buffer":"binary",n=function(e){if("undefined"!==typeof _l)return _l.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(Ge){if(!Ge.message||!Ge.message.match(/onstruct/))throw Ge}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||ki||(r.type="array")),"string"==r.type&&(s=!0,r.type="binary",r.codepage=65001,n=function(e){return e.match(/[^\x00-\x7F]/)?_o(e):e}(e)),"array"==r.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return(r=Hl(r)).type="array",Tp(Ai(n),r)}switch((a=kp(n,r))[0]){case 208:if(207===a[1]&&17===a[2]&&224===a[3]&&161===a[4]&&177===a[5]&&26===a[6]&&225===a[7])return function(e,t){return Tl.find(e,"EncryptedPackage")?jp(e,t):Dm(e,t)}(Tl.read(n,r),r);break;case 9:if(a[1]<=8)return Dm(n,r);break;case 60:return Em(n,r);case 73:if(73===a[1]&&42===a[2]&&0===a[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===a[1])return function(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=Su.to_workbook(e,r);return r.WTF=a,n}catch(Ge){if(r.WTF=a,!Ge.message.match(/SYLK bad record ID/)&&a)throw Ge;return Cu.to_workbook(e,t)}}(n,r);break;case 84:if(65===a[1]&&66===a[2]&&76===a[3])return Tu.to_workbook(n,r);break;case 80:return 75===a[1]&&a[2]<9&&a[3]<9?function(e,t){var r=e,a=t||{};return a.type||(a.type=ki&&Buffer.isBuffer(e)?"buffer":"base64"),Np(no(r,a),a)}(n,r):Sp(e,n,r,s);case 239:return 60===a[3]?Em(n,r):Sp(e,n,r,s);case 255:if(254===a[1])return function(e,t){var r=e;return"base64"==t.type&&(r=ji(r)),r=xi.utils.decode(1200,r.slice(2),"str"),t.type="binary",Ep(r,t)}(n,r);if(0===a[1]&&2===a[2]&&0===a[3])return Au.to_workbook(n,r);break;case 0:if(0===a[1]){if(a[2]>=2&&0===a[3])return Au.to_workbook(n,r);if(0===a[2]&&(8===a[3]||9===a[3]))return Au.to_workbook(n,r)}break;case 3:case 131:case 139:case 140:return Eu.to_workbook(n,r);case 123:if(92===a[1]&&114===a[2]&&116===a[3])return Zu.to_workbook(n,r);break;case 10:case 13:case 32:return function(e,t){var r="",a=kp(e,t);switch(t.type){case"base64":r=ji(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Vl(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==a[0]&&187==a[1]&&191==a[2]&&(r=To(r)),t.type="binary",Ep(r,t)}(n,r);case 137:if(80===a[1]&&78===a[2]&&71===a[3])throw new Error("PNG Image File is not a spreadsheet")}return ku.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Eu.to_workbook(n,r):Sp(e,n,r,s)}function _p(e,t,r,a,n,s,i,l){var o=Rc(r),c=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),u=!0,f=1===n?[]:{};if(1!==n)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch(Ge){f.__rowNum__=r}else f.__rowNum__=r;if(!i||e[r])for(var h=t.s.c;h<=t.e.c;++h){var m=i?e[r][h]:e[a[h]+o];if(void 0!==m&&void 0!==m.t){var p=m.v;switch(m.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(null!=s[h]){if(null==p)if("e"==m.t&&null===p)f[s[h]]=null;else if(void 0!==c)f[s[h]]=c;else{if(!d||null!==p)continue;f[s[h]]=null}else f[s[h]]=d&&("n"!==m.t||"n"===m.t&&!1!==l.rawNumbers)?p:Bc(m,p,l);null!=p&&(u=!1)}}else{if(void 0===c)continue;null!=s[h]&&(f[s[h]]=c)}}return{row:f,isempty:u}}function Cp(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},a=0,n=1,s=[],i=0,l="",o={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?a=1:"A"===c.header?a=2:Array.isArray(c.header)?a=3:null==c.header&&(a=0),typeof d){case"string":o=Uc(d);break;case"number":(o=Uc(e["!ref"])).s.r=d;break;default:o=d}a>0&&(n=0);var u=Rc(o.s.r),f=[],h=[],m=0,p=0,g=Array.isArray(e),x=o.s.r,v=0,b={};g&&!e[x]&&(e[x]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(v=o.s.c;v<=o.e.c;++v)if(!(y[v]||{}).hidden)switch(f[v]=Dc(v),r=g?e[x][v]:e[f[v]+u],a){case 1:s[v]=v-o.s.c;break;case 2:s[v]=f[v];break;case 3:s[v]=c.header[v-o.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),l=i=Bc(r,null,c),p=b[i]||0){do{l=i+"_"+p++}while(b[l]);b[i]=p,b[l]=1}else b[i]=1;s[v]=l}for(x=o.s.r+n;x<=o.e.r;++x)if(!(w[x]||{}).hidden){var N=_p(e,o,x,f,a,s,g,c);(!1===N.isempty||(1===a?!1!==c.blankrows:c.blankrows))&&(h[m++]=N.row)}return h.length=m,h}var Ap=/"/g;function Op(e,t,r,a,n,s,i,l){for(var o=!0,c=[],d="",u=Rc(r),f=t.s.c;f<=t.e.c;++f)if(a[f]){var h=l.dense?(e[r]||[])[f]:e[a[f]+u];if(null==h)d="";else if(null!=h.v){o=!1,d=""+(l.rawNumbers&&"n"==h.t?h.v:Bc(h,null,l));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===n||p===s||34===p||l.forceQuotes){d='"'+d.replace(Ap,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==h.f||h.F?d="":(o=!1,(d="="+h.f).indexOf(",")>=0&&(d='"'+d.replace(Ap,'""')+'"'));c.push(d)}return!1===l.blankrows&&o?null:c.join(i)}function Rp(e,t){var r=[],a=null==t?{}:t;if(null==e||null==e["!ref"])return"";var n=Uc(e["!ref"]),s=void 0!==a.FS?a.FS:",",i=s.charCodeAt(0),l=void 0!==a.RS?a.RS:"\n",o=l.charCodeAt(0),c=new RegExp(("|"==s?"\\|":s)+"+$"),d="",u=[];a.dense=Array.isArray(e);for(var f=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],m=n.s.c;m<=n.e.c;++m)(f[m]||{}).hidden||(u[m]=Dc(m));for(var p=0,g=n.s.r;g<=n.e.r;++g)(h[g]||{}).hidden||null!=(d=Op(e,n,g,u,i,o,s,a))&&(a.strip&&(d=d.replace(c,"")),(d||!1!==a.blankrows)&&r.push((p++?l:"")+d));return delete a.dense,r.join("")}function Pp(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=Rp(e,t);if("undefined"==typeof xi||"string"==t.type)return r;var a=xi.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+a}function Dp(e,t,r){var a,n=r||{},s=+!n.skipHeader,i=e||{},l=0,o=0;if(i&&null!=n.origin)if("number"==typeof n.origin)l=n.origin;else{var c="string"==typeof n.origin?Lc(n.origin):n.origin;l=c.r,o=c.c}var d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+s}};if(i["!ref"]){var u=Uc(i["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==l&&(l=u.e.r+1,d.e.r=l+t.length-1+s)}else-1==l&&(l=0,d.e.r=t.length-1+s);var f=n.header||[],h=0;t.forEach(function(e,t){Cl(e).forEach(function(r){-1==(h=f.indexOf(r))&&(f[h=f.length]=r);var c=e[r],d="z",u="",m=Ic({c:o+h,r:l+t+s});a=Lp(i,m),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",n.cellDates||(d="n",c=Rl(c)),u=n.dateNF||Hi[14]):null===c&&n.nullError&&(d="e",c=0),a?(a.t=d,a.v=c,delete a.w,delete a.R,u&&(a.z=u)):i[m]=a={t:d,v:c},u&&(a.z=u)):i[m]=c})}),d.e.c=Math.max(d.e.c,o+f.length-1);var m=Rc(l);if(s)for(h=0;h<f.length;++h)i[Dc(h+o)+m]={t:"s",v:f[h]};return i["!ref"]=Fc(d),i}function Lp(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var a=Lc(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Lp(e,Ic("number"!=typeof t?t:{r:t,c:r||0}))}function Ip(){return{SheetNames:[],Sheets:{}}}function Mp(e,t,r,a){var n=1;if(!r)for(;n<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+n);++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var i=s&&s[1]||r;for(++n;n<=65535&&-1!=e.SheetNames.indexOf(r=i+n);++n);}if(rm(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Fp(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var Up={encode_col:Dc,encode_row:Rc,encode_cell:Ic,encode_range:Fc,decode_col:Pc,decode_row:Oc,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Lc,decode_range:Mc,format_cell:Bc,sheet_add_aoa:Hc,sheet_add_json:Dp,sheet_add_dom:Wm,aoa_to_sheet:Wc,json_to_sheet:function(e,t){return Dp(null,e,t)},table_to_sheet:qm,table_to_book:function(e,t){return Vc(qm(e,t),t)},sheet_to_csv:Rp,sheet_to_txt:Pp,sheet_to_json:Cp,sheet_to_html:Hm,sheet_to_formulae:function(e){var t,r="",a="";if(null==e||null==e["!ref"])return[];var n,s=Uc(e["!ref"]),i="",l=[],o=[],c=Array.isArray(e);for(n=s.s.c;n<=s.e.c;++n)l[n]=Dc(n);for(var d=s.s.r;d<=s.e.r;++d)for(i=Rc(d),n=s.s.c;n<=s.e.c;++n)if(r=l[n]+i,a="",void 0!==(t=c?(e[d]||[])[n]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;a=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)a=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)a=""+t.v;else if("b"==t.t)a=t.v?"TRUE":"FALSE";else if(void 0!==t.w)a="'"+t.w;else{if(void 0===t.v)continue;a="s"==t.t?"'"+t.v:""+t.v}}o[o.length]=r+"="+a}return o},sheet_to_row_object_array:Cp,sheet_get_cell:Lp,book_new:Ip,book_append_sheet:Mp,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Fp,cell_set_internal_link:function(e,t,r){return Fp(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,a){for(var n="string"!=typeof t?t:Uc(t),s="string"==typeof t?t:Fc(t),i=n.s.r;i<=n.e.r;++i)for(var l=n.s.c;l<=n.e.c;++l){var o=Lp(e,i,l);o.t="n",o.F=s,delete o.v,i==n.s.r&&l==n.s.c&&(o.f=r,a&&(o.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};li.version;const zp=()=>{const[e,t]=(0,s.useState)([]),[r,a]=(0,s.useState)([]),[n,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)(""),[c,d]=(0,s.useState)(1),[u]=(0,s.useState)(20),[f,h]=(0,s.useState)("raisonSociale"),[m,p]=(0,s.useState)("asc"),[g,x]=(0,s.useState)(!1),[v,b]=(0,s.useState)(null),[y,w]=(0,s.useState)({}),[N,j]=(0,s.useState)(null),k=e=>e?e.toString().trim().replace(/^"(.*)"$/,"$1").replace(/Activit/g,"Activit\xe9").replace(/Tlphone/g,"T\xe9l\xe9phone").replace(/Civilit/g,"Civilit\xe9").replace(/Prnom/g,"Pr\xe9nom").replace(/Scurit/g,"S\xe9curit\xe9").replace(/Matriel/g,"Mat\xe9riel").replace(/Gnrale/g,"G\xe9n\xe9rale"):"",E=(0,s.useCallback)(async()=>{i(!0);try{const e=await fetch("/entreprise.csv"),r=await e.text(),n=r.split("\n").slice(1).map((e,t)=>{const r=(e=>{const t=[];let r="",a=!1;for(let n=0;n<e.length;n++){const s=e[n];'"'===s?a=!a:","!==s||a?r+=s:(t.push(r.trim()),r="")}return t.push(r.trim()),t})(e);return{id:t+1,raisonSociale:k(r[0])||"",activite:k(r[1])||"",ape:k(r[2])||"",adresse1:k(r[3])||"",adresse2:k(r[4])||"",codePostal:k(r[5])||"",ville:k(r[6])||"",pays:k(r[7])||"",telephoneFixe:k(r[8])||"",telephonePortable:k(r[9])||"",email:k(r[10])||"",siret:k(r[11])||"",ursaff:k(r[12])||"",compagnieAssurance:k(r[13])||"",policeAssurance:k(r[14])||"",civiliteResponsable:k(r[15])||"",nomResponsable:k(r[16])||"",prenomResponsable:k(r[17])||"",fonctionResponsable:k(r[18])||"",telephoneFixeResponsable:k(r[19])||"",faxResponsable:k(r[20])||"",telephonePortableResponsable:k(r[21])||"",emailResponsable:k(r[22])||""}}).filter(e=>""!==e.raisonSociale.trim());t(n),a(n)}catch(e){console.error("Erreur lors du chargement des donn\xe9es:",e),t([]),a([])}finally{i(!1)}},[]);(0,s.useEffect)(()=>{E()},[E]),(0,s.useEffect)(()=>{const t=e.filter(e=>{var t,r,a,n;return(null===(t=e.raisonSociale)||void 0===t?void 0:t.toLowerCase().includes(l.toLowerCase()))||(null===(r=e.activite)||void 0===r?void 0:r.toLowerCase().includes(l.toLowerCase()))||(null===(a=e.ville)||void 0===a?void 0:a.toLowerCase().includes(l.toLowerCase()))||(null===(n=e.email)||void 0===n?void 0:n.toLowerCase().includes(l.toLowerCase()))});a(t),d(1)},[l,e]);const S=e=>{const t=f===e&&"asc"===m?"desc":"asc";h(e),p(t);const n=[...r].sort((r,a)=>{const n=r[e]||"",s=a[e]||"";return"asc"===t?n.localeCompare(s):s.localeCompare(n)});a(n)},T=c*u,_=T-u,C=r.slice(_,T),A=Math.ceil(r.length/u),O=e=>{d(e)},R=()=>{x(!1),b(null),w({})},P=(e,t)=>{w(r=>qe(qe({},r),{},{[e]:t}))};return(0,Pn.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Pn.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white",children:(0,Pn.jsx)("div",{className:"w-full px-2 sm:px-4 lg:px-6 xl:px-8 py-6",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Gestion des Entreprises"}),(0,Pn.jsxs)("p",{className:"mt-2 text-blue-100 text-sm sm:text-base",children:[e.length," entreprises trouv\xe9es dans la base de donn\xe9es"]})]}),(0,Pn.jsx)("div",{className:"flex items-center space-x-4",children:(0,Pn.jsx)("div",{className:"bg-white/20 p-2 sm:p-3 rounded-full",children:(0,Pn.jsx)(ni,{className:"h-6 w-6 sm:h-8 sm:w-8 text-white"})})})]})})}),(0,Pn.jsx)("div",{className:"w-full px-2 sm:px-4 lg:px-6 xl:px-8 -mt-4",children:(0,Pn.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6",children:(0,Pn.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[(0,Pn.jsxs)("div",{className:"relative flex-1 max-w-lg",children:[(0,Pn.jsx)(ps,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,Pn.jsx)("input",{type:"text",placeholder:"Rechercher une entreprise, ville, activit\xe9...",value:l,onChange:e=>o(e.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg"})]}),(0,Pn.jsx)("div",{className:"flex space-x-3",children:(0,Pn.jsxs)("label",{className:"flex items-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-all duration-200 shadow-md hover:shadow-lg cursor-pointer",children:[(0,Pn.jsx)(ss,{className:"h-5 w-5"}),(0,Pn.jsx)("span",{className:"font-medium",children:"Importer fichier XLSX"}),(0,Pn.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{const r=e.target.files[0];if(!r)return;if(!r.name.match(/\.(xlsx|xls)$/i))return void alert("Veuillez s\xe9lectionner un fichier Excel (.xlsx ou .xls)");const n=new FileReader;n.onload=e=>{try{const r=Tp(new Uint8Array(e.target.result),{type:"array"}),n=r.SheetNames[0],s=r.Sheets[n],i=Up.sheet_to_json(s,{header:1});if(i.length<2)return void alert("Le fichier Excel doit contenir au moins un en-t\xeate et une ligne de donn\xe9es");const l=i.slice(1).map((e,t)=>({id:t+1,raisonSociale:k(e[0])||"",activite:k(e[1])||"",ape:k(e[2])||"",adresse1:k(e[3])||"",adresse2:k(e[4])||"",codePostal:k(e[5])||"",ville:k(e[6])||"",pays:k(e[7])||"",telephoneFixe:k(e[8])||"",telephonePortable:k(e[9])||"",email:k(e[10])||"",siret:k(e[11])||"",ursaff:k(e[12])||"",compagnieAssurance:k(e[13])||"",policeAssurance:k(e[14])||"",civiliteResponsable:k(e[15])||"",nomResponsable:k(e[16])||"",prenomResponsable:k(e[17])||"",fonctionResponsable:k(e[18])||"",telephoneFixeResponsable:k(e[19])||"",faxResponsable:k(e[20])||"",telephonePortableResponsable:k(e[21])||"",emailResponsable:k(e[22])||""})).filter(e=>""!==e.raisonSociale.trim());if(0===l.length)return void alert("Aucune entreprise valide trouv\xe9e dans le fichier");window.confirm("Voulez-vous remplacer les donn\xe9es actuelles par les ".concat(l.length," entreprises du fichier ?\n\nCette action remplacera toutes les donn\xe9es existantes."))&&(t(l),a(l),d(1),alert("Importation r\xe9ussie ! ".concat(l.length," entreprises ont \xe9t\xe9 import\xe9es.")))}catch(r){console.error("Erreur lors de l'importation:",r),alert("Erreur lors de la lecture du fichier Excel. V\xe9rifiez que le fichier n'est pas corrompu.")}},n.onerror=()=>{alert("Erreur lors de la lecture du fichier")},n.readAsArrayBuffer(r),e.target.value=""},className:"hidden"})]})})]})})}),(0,Pn.jsx)("div",{className:"w-full px-2 sm:px-4 lg:px-6 xl:px-8 py-6",children:n?(0,Pn.jsx)("div",{className:"flex items-center justify-center py-16",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Pn.jsx)("span",{className:"mt-4 text-lg text-gray-600",children:"Chargement des donn\xe9es..."})]})}):(0,Pn.jsxs)(Pn.Fragment,{children:[(0,Pn.jsx)("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,Pn.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,Pn.jsx)("strong",{children:"Debug:"})," ",e.length," entreprises charg\xe9es, ",r.length," apr\xe8s filtrage, Page ",c," sur ",A,", Affichage de ",_+1," \xe0 ",Math.min(T,r.length)]})}),(0,Pn.jsx)("div",{className:"mb-6",children:(0,Pn.jsxs)("button",{className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-md",children:[(0,Pn.jsx)("span",{className:"text-lg",children:"+"}),(0,Pn.jsx)("span",{children:"Cr\xe9er une entreprise"})]})}),C.length>0?(0,Pn.jsx)("div",{className:"bg-white border-2 border-gray-400 shadow-lg overflow-hidden",children:(0,Pn.jsx)("div",{className:"overflow-x-auto",children:(0,Pn.jsxs)("table",{className:"min-w-full border-collapse",children:[(0,Pn.jsx)("thead",{className:"bg-gray-200",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("th",{className:"border-2 border-gray-400 px-4 py-3 text-left text-sm font-bold text-gray-800 uppercase tracking-wider cursor-pointer hover:bg-gray-300 transition-colors",onClick:()=>S("raisonSociale"),children:(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)("span",{children:"Raison Sociale"}),"raisonSociale"===f&&(0,Pn.jsx)("span",{className:"text-blue-700 text-lg",children:"asc"===m?"\u2191":"\u2193"})]})}),(0,Pn.jsx)("th",{className:"border-2 border-gray-400 px-4 py-3 text-left text-sm font-bold text-gray-800 uppercase tracking-wider cursor-pointer hover:bg-gray-300 transition-colors",onClick:()=>S("activite"),children:(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)("span",{children:"Activit\xe9"}),"activite"===f&&(0,Pn.jsx)("span",{className:"text-blue-700 text-lg",children:"asc"===m?"\u2191":"\u2193"})]})}),(0,Pn.jsx)("th",{className:"border-2 border-gray-400 px-4 py-3 text-left text-sm font-bold text-gray-800 uppercase tracking-wider",children:"APE"}),(0,Pn.jsx)("th",{className:"border-2 border-gray-400 px-4 py-3 text-left text-sm font-bold text-gray-800 uppercase tracking-wider",children:"M\xe9tiers"}),(0,Pn.jsx)("th",{className:"border-2 border-gray-400 px-4 py-3 text-left text-sm font-bold text-gray-800 uppercase tracking-wider cursor-pointer hover:bg-gray-300 transition-colors",onClick:()=>S("ville"),children:(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)("span",{children:"Ville"}),"ville"===f&&(0,Pn.jsx)("span",{className:"text-blue-700 text-lg",children:"asc"===m?"\u2191":"\u2193"})]})}),(0,Pn.jsx)("th",{className:"border-2 border-gray-400 px-4 py-3 text-left text-sm font-bold text-gray-800 uppercase tracking-wider",children:"T\xe9l\xe9phone"}),(0,Pn.jsx)("th",{className:"border-2 border-gray-400 px-4 py-3 text-left text-sm font-bold text-gray-800 uppercase tracking-wider",children:"Email"}),(0,Pn.jsx)("th",{className:"border-2 border-gray-400 px-4 py-3 text-left text-sm font-bold text-gray-800 uppercase tracking-wider",children:"Responsable"}),(0,Pn.jsx)("th",{className:"border-2 border-gray-400 px-4 py-3 text-left text-sm font-bold text-gray-800 uppercase tracking-wider",children:"Actions"})]})}),(0,Pn.jsx)("tbody",{className:"bg-white",children:C.map((r,n)=>(0,Pn.jsxs)("tr",{className:"hover:bg-blue-100 transition-colors ".concat(n%2===0?"bg-white":"bg-gray-50"),children:[(0,Pn.jsxs)("td",{className:"border-2 border-gray-400 px-4 py-3 whitespace-nowrap",children:[(0,Pn.jsx)("div",{className:"text-sm font-semibold text-gray-900",children:r.raisonSociale}),r.denominationCommerciale&&r.denominationCommerciale!==r.raisonSociale&&(0,Pn.jsx)("div",{className:"text-sm text-gray-600 italic",children:r.denominationCommerciale})]}),(0,Pn.jsx)("td",{className:"border-2 border-gray-400 px-4 py-3",children:(0,Pn.jsx)("div",{className:"text-sm text-gray-900 max-w-sm truncate",title:r.activite,children:r.activite})}),(0,Pn.jsx)("td",{className:"border-2 border-gray-400 px-4 py-3 whitespace-nowrap",children:(0,Pn.jsx)("div",{className:"text-sm text-gray-900 font-mono font-semibold",children:r.ape})}),(0,Pn.jsx)("td",{className:"border-2 border-gray-400 px-4 py-3",children:(0,Pn.jsx)("div",{className:"text-sm text-gray-900 max-w-sm truncate",children:r.metiers||"Non sp\xe9cifi\xe9"})}),(0,Pn.jsxs)("td",{className:"border-2 border-gray-400 px-4 py-3 whitespace-nowrap",children:[(0,Pn.jsx)("div",{className:"text-sm text-gray-900 font-medium",children:r.ville}),r.codePostal&&(0,Pn.jsx)("div",{className:"text-sm text-gray-600",children:r.codePostal})]}),(0,Pn.jsx)("td",{className:"border-2 border-gray-400 px-4 py-3 whitespace-nowrap",children:(0,Pn.jsxs)("div",{className:"text-sm text-gray-900 space-y-1",children:[r.telephoneFixe&&(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)(si,{className:"h-4 w-4 text-gray-600"}),(0,Pn.jsx)("span",{className:"font-medium",children:r.telephoneFixe})]}),r.telephonePortable&&(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)(si,{className:"h-4 w-4 text-gray-600"}),(0,Pn.jsx)("span",{className:"font-medium",children:r.telephonePortable})]})]})}),(0,Pn.jsx)("td",{className:"border-2 border-gray-400 px-4 py-3 whitespace-nowrap",children:r.email&&(0,Pn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pn.jsx)(ii,{className:"h-4 w-4 text-gray-600"}),(0,Pn.jsx)("span",{className:"text-sm text-gray-900 truncate max-w-32 font-medium",title:r.email,children:r.email})]})}),(0,Pn.jsx)("td",{className:"border-2 border-gray-400 px-4 py-3 whitespace-nowrap",children:(r.nomResponsable||r.prenomResponsable)&&(0,Pn.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,Pn.jsxs)("div",{className:"font-semibold",children:[r.civiliteResponsable," ",r.prenomResponsable," ",r.nomResponsable]}),r.fonctionResponsable&&(0,Pn.jsx)("div",{className:"text-gray-600 text-xs",children:r.fonctionResponsable})]})}),(0,Pn.jsx)("td",{className:"border-2 border-gray-400 px-4 py-3 whitespace-nowrap text-center",children:(0,Pn.jsxs)("div",{className:"flex space-x-2 justify-center",children:[(0,Pn.jsx)("button",{onClick:()=>(e=>{b(e),w({raisonSociale:e.raisonSociale||"",activite:e.activite||"",ape:e.ape||"",adresse1:e.adresse1||"",adresse2:e.adresse2||"",codePostal:e.codePostal||"",ville:e.ville||"",pays:e.pays||"",telephoneFixe:e.telephoneFixe||"",telephonePortable:e.telephonePortable||"",email:e.email||"",siret:e.siret||"",ursaff:e.ursaff||"",compagnieAssurance:e.compagnieAssurance||"",policeAssurance:e.policeAssurance||"",civiliteResponsable:e.civiliteResponsable||"",nomResponsable:e.nomResponsable||"",prenomResponsable:e.prenomResponsable||"",fonctionResponsable:e.fonctionResponsable||"",telephoneFixeResponsable:e.telephoneFixeResponsable||"",faxResponsable:e.faxResponsable||"",telephonePortableResponsable:e.telephonePortableResponsable||"",emailResponsable:e.emailResponsable||""}),x(!0)})(r),className:"text-blue-600 hover:text-blue-800 p-2 rounded-lg hover:bg-blue-50 transition-all duration-200 border border-blue-200 hover:border-blue-300 hover:shadow-sm",title:"Modifier l'entreprise",children:(0,Pn.jsx)(rs,{className:"h-5 w-5"})}),(0,Pn.jsx)("button",{onClick:()=>(async r=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer l'entreprise \"".concat(r.raisonSociale,'" ?\n\nCette action est irr\xe9versible.')))try{j(r.id),await new Promise(e=>setTimeout(e,500));const n=e.filter(e=>e.id!==r.id);t(n),a(n);const s=Math.ceil(n.length/u);c>s&&s>0&&d(s),alert("L'entreprise \"".concat(r.raisonSociale,'" a \xe9t\xe9 supprim\xe9e avec succ\xe8s.'))}catch(n){console.error("Erreur lors de la suppression:",n),alert("Erreur lors de la suppression de l'entreprise.")}finally{j(null)}})(r),disabled:N===r.id,className:"p-2 rounded-lg transition-all duration-200 border ".concat(N===r.id?"text-gray-400 bg-gray-100 border-gray-200 cursor-not-allowed":"text-red-600 hover:text-red-800 hover:bg-red-50 border-red-200 hover:border-red-300 hover:shadow-sm"),title:N===r.id?"Suppression en cours...":"Supprimer l'entreprise",children:N===r.id?(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-400"}):(0,Pn.jsx)(as,{className:"h-5 w-5"})})]})})]},r.id))})]})})}):(0,Pn.jsx)("div",{className:"bg-white border-2 border-gray-400 p-8 text-center",children:(0,Pn.jsxs)("div",{className:"text-gray-500",children:[(0,Pn.jsx)(ni,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune entreprise trouv\xe9e"}),(0,Pn.jsx)("p",{className:"text-gray-500",children:l?"Aucune entreprise ne correspond \xe0 votre recherche.":"Aucune entreprise n'a \xe9t\xe9 charg\xe9e."}),l&&(0,Pn.jsx)("button",{onClick:()=>o(""),className:"mt-4 text-blue-600 hover:text-blue-800 font-medium",children:"Effacer la recherche"})]})}),A>1&&(0,Pn.jsxs)("div",{className:"bg-white border-l-2 border-r-2 border-b-2 border-gray-400 px-4 py-3 flex items-center justify-between",children:[(0,Pn.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,Pn.jsx)("button",{onClick:()=>O(c-1),disabled:1===c,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Pr\xe9c\xe9dent"}),(0,Pn.jsx)("button",{onClick:()=>O(c+1),disabled:c===A,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Suivant"})]}),(0,Pn.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,Pn.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pn.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,Pn.jsx)("span",{className:"font-medium text-blue-600",children:u})," ",(0,Pn.jsx)("span",{className:"font-medium text-blue-600",children:c})," ",(0,Pn.jsx)("span",{className:"font-medium text-blue-600",children:r.length})," / ",(0,Pn.jsx)("span",{className:"font-medium text-blue-600",children:r.length})]}),(0,Pn.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Pn.jsx)("button",{className:"p-1 text-gray-400 hover:text-gray-600",children:(0,Pn.jsx)(ps,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{className:"p-1 text-gray-400 hover:text-gray-600",children:(0,Pn.jsx)("span",{className:"text-lg",children:"+"})})]})]}),(0,Pn.jsx)("div",{children:(0,Pn.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[(0,Pn.jsx)("button",{onClick:()=>O(c-1),disabled:1===c,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Pr\xe9c\xe9dent"}),[...Array(A)].map((e,t)=>{const r=t+1;return 1===r||r===A||r>=c-2&&r<=c+2?(0,Pn.jsx)("button",{onClick:()=>O(r),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium ".concat(c===r?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:r},r):r===c-3||r===c+3?(0,Pn.jsx)("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:"..."},r):null}),(0,Pn.jsx)("button",{onClick:()=>O(c+1),disabled:c===A,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Suivant"})]})})]})]})]})}),g&&(0,Pn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Pn.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,Pn.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 rounded-t-xl",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h2",{className:"text-2xl font-bold",children:"Modifier l'entreprise"}),(0,Pn.jsx)("p",{className:"text-blue-100 mt-1",children:null===v||void 0===v?void 0:v.raisonSociale})]}),(0,Pn.jsx)("button",{onClick:R,className:"text-white hover:text-gray-200 transition-colors p-2 rounded-lg hover:bg-white/20",children:(0,Pn.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pn.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,Pn.jsx)("div",{className:"p-6",children:(0,Pn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b border-gray-200 pb-2",children:"Informations g\xe9n\xe9rales"}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Raison Sociale *"}),(0,Pn.jsx)("input",{type:"text",value:y.raisonSociale||"",onChange:e=>P("raisonSociale",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Activit\xe9"}),(0,Pn.jsx)("input",{type:"text",value:y.activite||"",onChange:e=>P("activite",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Code APE"}),(0,Pn.jsx)("input",{type:"text",value:y.ape||"",onChange:e=>P("ape",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SIRET"}),(0,Pn.jsx)("input",{type:"text",value:y.siret||"",onChange:e=>P("siret",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b border-gray-200 pb-2",children:"Adresse"}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse 1"}),(0,Pn.jsx)("input",{type:"text",value:y.adresse1||"",onChange:e=>P("adresse1",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse 2"}),(0,Pn.jsx)("input",{type:"text",value:y.adresse2||"",onChange:e=>P("adresse2",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Code Postal"}),(0,Pn.jsx)("input",{type:"text",value:y.codePostal||"",onChange:e=>P("codePostal",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ville"}),(0,Pn.jsx)("input",{type:"text",value:y.ville||"",onChange:e=>P("ville",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pays"}),(0,Pn.jsx)("input",{type:"text",value:y.pays||"",onChange:e=>P("pays",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b border-gray-200 pb-2",children:"Contact"}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xe9l\xe9phone Fixe"}),(0,Pn.jsx)("input",{type:"tel",value:y.telephoneFixe||"",onChange:e=>P("telephoneFixe",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xe9l\xe9phone Portable"}),(0,Pn.jsx)("input",{type:"tel",value:y.telephonePortable||"",onChange:e=>P("telephonePortable",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,Pn.jsx)("input",{type:"email",value:y.email||"",onChange:e=>P("email",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b border-gray-200 pb-2",children:"Responsable"}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Civilit\xe9"}),(0,Pn.jsxs)("select",{value:y.civiliteResponsable||"",onChange:e=>P("civiliteResponsable",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,Pn.jsx)("option",{value:"",children:"S\xe9lectionner"}),(0,Pn.jsx)("option",{value:"M.",children:"M."}),(0,Pn.jsx)("option",{value:"Mme",children:"Mme"}),(0,Pn.jsx)("option",{value:"Mlle",children:"Mlle"})]})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pr\xe9nom"}),(0,Pn.jsx)("input",{type:"text",value:y.prenomResponsable||"",onChange:e=>P("prenomResponsable",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom"}),(0,Pn.jsx)("input",{type:"text",value:y.nomResponsable||"",onChange:e=>P("nomResponsable",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fonction"}),(0,Pn.jsx)("input",{type:"text",value:y.fonctionResponsable||"",onChange:e=>P("fonctionResponsable",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Responsable"}),(0,Pn.jsx)("input",{type:"email",value:y.emailResponsable||"",onChange:e=>P("emailResponsable",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-6 py-4 rounded-b-xl flex justify-end space-x-3",children:[(0,Pn.jsx)("button",{onClick:R,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:"Annuler"}),(0,Pn.jsxs)("button",{onClick:()=>{console.log("Sauvegarde des modifications:",y);const r=e.map(e=>e.id===v.id?qe(qe({},e),y):e);t(r),a(r),R(),alert("Entreprise modifi\xe9e avec succ\xe8s !")},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[(0,Pn.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pn.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,Pn.jsx)("span",{children:"Sauvegarder"})]})]})]})})]})},Bp=()=>{const[e,t]=(0,s.useState)([]),[r,a]=(0,s.useState)(!0),[n,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)(null),[c,d]=(0,s.useState)(!1),[u,f]=(0,s.useState)(null),[h,m]=(0,s.useState)({username:"",password:"",email:"",first_name:"",last_name:"",role:"teacher"});(0,s.useEffect)(()=>{p()},[]);const p=async()=>{try{const e=await Rn.get("/api/users");e.data.success&&t(e.data.data)}catch(e){console.error("Erreur lors du chargement des utilisateurs:",e),sr.error("Erreur lors du chargement des utilisateurs")}finally{a(!1)}},g=()=>{m({username:"",password:"",email:"",first_name:"",last_name:"",role:"teacher"})},x=e=>{const t={admin:"bg-red-100 text-red-800 border-red-200",teacher:"bg-blue-100 text-blue-800 border-blue-200",student:"bg-green-100 text-green-800 border-green-200"};return(0,Pn.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full border ".concat(t[e]||t.teacher),children:"admin"===e?"Administrateur":"teacher"===e?"Professeur":"student"===e?"\xc9tudiant":e})};return r?(0,Pn.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,Pn.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,Pn.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[(0,Pn.jsx)(Jn,{className:"h-6 w-6 mr-2"}),"Gestion des utilisateurs"]}),(0,Pn.jsx)("p",{className:"text-gray-600 mt-1",children:"G\xe9rez les utilisateurs et leurs r\xf4les dans l'application"})]}),(0,Pn.jsxs)("div",{className:"flex space-x-3",children:[(0,Pn.jsxs)("button",{onClick:async()=>{try{const e=await Rn.post("/api/users/create-test-users");e.data.success&&(sr.success(e.data.message),p())}catch(r){var e,t;console.error("Erreur lors de la cr\xe9ation des utilisateurs de test:",r),sr.error((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Erreur lors de la cr\xe9ation des utilisateurs de test")}},className:"btn btn-outline flex items-center",children:[(0,Pn.jsx)(Hn,{className:"h-4 w-4 mr-2"}),"Cr\xe9er utilisateurs de test"]}),(0,Pn.jsxs)("button",{onClick:()=>{o(null),g(),i(!0)},className:"btn btn-primary flex items-center",children:[(0,Pn.jsx)(ms,{className:"h-4 w-4 mr-2"}),"Nouvel utilisateur"]})]})]}),(0,Pn.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,Pn.jsx)("div",{className:"overflow-x-auto",children:(0,Pn.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pn.jsx)("thead",{className:"bg-gray-50",children:(0,Pn.jsxs)("tr",{children:[(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilisateur"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"R\xf4le"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date de cr\xe9ation"}),(0,Pn.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Pn.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>{return(0,Pn.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,Pn.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:(0,Pn.jsx)(Hn,{className:"h-5 w-5 text-primary-600"})})}),(0,Pn.jsxs)("div",{className:"ml-4",children:[(0,Pn.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.first_name&&e.last_name?"".concat(e.first_name," ").concat(e.last_name):e.username}),(0,Pn.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[(0,Pn.jsx)(ii,{className:"h-3 w-3 mr-1"}),e.email||"Aucun email"]}),(0,Pn.jsxs)("div",{className:"text-xs text-gray-400",children:["@",e.username]})]})]})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:x(e.role)}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(t=e.is_active,(0,Pn.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full border ".concat(t?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-800 border-gray-200"),children:t?"Actif":"Inactif"}))}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)(ts,{className:"h-3 w-3 mr-1"}),new Date(e.created_at).toLocaleDateString("fr-FR")]})}),(0,Pn.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,Pn.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,Pn.jsx)("button",{onClick:()=>(e=>{o(e),m({username:e.username,password:"",email:e.email||"",first_name:e.first_name||"",last_name:e.last_name||"",role:e.role}),i(!0)})(e),className:"text-blue-600 hover:text-blue-900 p-1",title:"Modifier",children:(0,Pn.jsx)(rs,{className:"h-4 w-4"})}),(0,Pn.jsx)("button",{onClick:()=>(e=>{f(e),m(qe(qe({},h),{},{password:""})),d(!0)})(e),className:"text-yellow-600 hover:text-yellow-900 p-1",title:"Changer le mot de passe",children:(0,Pn.jsx)(Wn,{className:"h-4 w-4"})}),1!==e.id&&(0,Pn.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer cet utilisateur ?"))try{(await Rn.delete("/api/users/".concat(e))).data.success&&(sr.success("Utilisateur supprim\xe9 avec succ\xe8s"),p())}catch(a){var t,r;console.error("Erreur lors de la suppression:",a),sr.error((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Erreur lors de la suppression")}})(e.id),className:"text-red-600 hover:text-red-900 p-1",title:"Supprimer",children:(0,Pn.jsx)(as,{className:"h-4 w-4"})})]})})]},e.id);var t})})]})})}),n&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>i(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,Pn.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{if(l){(await Rn.put("/api/users/".concat(l.id),h)).data.success&&(sr.success("Utilisateur mis \xe0 jour avec succ\xe8s"),i(!1),o(null),g(),p())}else{(await Rn.post("/api/users",h)).data.success&&(sr.success("Utilisateur cr\xe9\xe9 avec succ\xe8s"),i(!1),g(),p())}}catch(a){var t,r;console.error("Erreur lors de la sauvegarde:",a),sr.error((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Erreur lors de la sauvegarde")}},children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsx)("div",{className:"mb-4",children:(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:l?"Modifier l'utilisateur":"Nouvel utilisateur"})}),(0,Pn.jsxs)("div",{className:"space-y-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Nom d'utilisateur *"}),(0,Pn.jsx)("input",{type:"text",required:!0,className:"input",value:h.username,onChange:e=>m(qe(qe({},h),{},{username:e.target.value}))})]}),!l&&(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Mot de passe *"}),(0,Pn.jsx)("input",{type:"password",required:!0,className:"input",value:h.password,onChange:e=>m(qe(qe({},h),{},{password:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Email"}),(0,Pn.jsx)("input",{type:"email",className:"input",value:h.email,onChange:e=>m(qe(qe({},h),{},{email:e.target.value}))})]}),(0,Pn.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Pr\xe9nom"}),(0,Pn.jsx)("input",{type:"text",className:"input",value:h.first_name,onChange:e=>m(qe(qe({},h),{},{first_name:e.target.value}))})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Nom"}),(0,Pn.jsx)("input",{type:"text",className:"input",value:h.last_name,onChange:e=>m(qe(qe({},h),{},{last_name:e.target.value}))})]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"R\xf4le *"}),(0,Pn.jsxs)("select",{required:!0,className:"input",value:h.role,onChange:e=>m(qe(qe({},h),{},{role:e.target.value})),children:[(0,Pn.jsx)("option",{value:"teacher",children:"Professeur"}),(0,Pn.jsx)("option",{value:"student",children:"\xc9tudiant"}),(0,Pn.jsx)("option",{value:"admin",children:"Administrateur"})]})]})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsx)("button",{type:"submit",className:"btn btn-primary sm:ml-3 sm:w-auto",children:l?"Modifier":"Cr\xe9er"}),(0,Pn.jsx)("button",{type:"button",className:"btn btn-secondary sm:ml-3 sm:w-auto",onClick:()=>i(!1),children:"Annuler"})]})]})})]})}),c&&u&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>d(!1)}),(0,Pn.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-md sm:w-full",children:(0,Pn.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{(await Rn.put("/api/users/".concat(u.id,"/password"),{password:h.password})).data.success&&(sr.success("Mot de passe modifi\xe9 avec succ\xe8s"),d(!1),f(null),g())}catch(a){var t,r;console.error("Erreur lors du changement de mot de passe:",a),sr.error((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Erreur lors du changement de mot de passe")}},children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsxs)("div",{className:"mb-4",children:[(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Changer le mot de passe"}),(0,Pn.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Nouveau mot de passe pour ",u.username]})]}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("label",{className:"label",children:"Nouveau mot de passe *"}),(0,Pn.jsx)("input",{type:"password",required:!0,className:"input",value:h.password,onChange:e=>m(qe(qe({},h),{},{password:e.target.value}))})]})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsx)("button",{type:"submit",className:"btn btn-primary sm:ml-3 sm:w-auto",children:"Modifier"}),(0,Pn.jsx)("button",{type:"button",className:"btn btn-secondary sm:ml-3 sm:w-auto",onClick:()=>d(!1),children:"Annuler"})]})]})})]})})]})},Vp=Vn("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),Hp=Vn("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Wp=()=>{const[e,t]=(0,s.useState)([]),[r,a]=(0,s.useState)([]),[n,i]=(0,s.useState)({}),[l,o]=(0,s.useState)(!0),[c,d]=(0,s.useState)(null),[u,f]=(0,s.useState)([]),[h,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{p(),g()},[]);const p=async()=>{try{const e=await Rn.get("/api/roles");e.data.success&&t(e.data.data)}catch(e){console.error("Erreur lors du chargement des r\xf4les:",e),sr.error("Erreur lors du chargement des r\xf4les")}},g=async()=>{try{const e=await Rn.get("/api/roles/permissions/all");e.data.success&&(a(e.data.data.permissions),i(e.data.data.grouped))}catch(e){console.error("Erreur lors du chargement des permissions:",e),sr.error("Erreur lors du chargement des permissions")}finally{o(!1)}},x=async e=>{try{const t=await Rn.get("/api/roles/".concat(e));if(t.data.success){const e=t.data.data.permissions.map(e=>e.id);f(e)}}catch(t){console.error("Erreur lors du chargement des permissions du r\xf4le:",t),sr.error("Erreur lors du chargement des permissions")}},v=e=>({dashboard:"\ud83d\udcca",projects:"\ud83d\udcc1",students:"\ud83d\udc65",planning:"\ud83d\udcc5",evaluations:"\ud83d\udccb",documents:"\ud83d\udcc4",roles:"\ud83d\udee1\ufe0f",users:"\ud83d\udc64"}[e]||"\u2699\ufe0f"),b=e=>({dashboard:"Tableau de bord",projects:"Projets",students:"\xc9tudiants",planning:"Planification",evaluations:"\xc9valuations",documents:"Documents",roles:"R\xf4les",users:"Utilisateurs"}[e]||e),y=e=>({view:"Voir",create:"Cr\xe9er",edit:"Modifier",delete:"Supprimer",print:"Imprimer",upload:"T\xe9l\xe9charger",manage:"G\xe9rer"}[e]||e);return l?(0,Pn.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,Pn.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,Pn.jsxs)("div",{className:"mb-6",children:[(0,Pn.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[(0,Pn.jsx)(Vp,{className:"h-6 w-6 mr-2"}),"Gestion des r\xf4les et permissions"]}),(0,Pn.jsx)("p",{className:"text-gray-600 mt-1",children:"Configurez les permissions pour chaque r\xf4le dans l'application"})]}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:e.map(e=>(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[(0,Pn.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center mr-3",children:(0,Pn.jsx)(Vp,{className:"h-5 w-5 text-primary-600"})}),(0,Pn.jsxs)("div",{children:[(0,Pn.jsx)("h3",{className:"text-lg font-semibold text-gray-900 capitalize",children:"admin"===e.name?"Administrateur":"teacher"===e.name?"Professeur":"student"===e.name?"\xc9tudiant":e.name}),(0,Pn.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})}),(0,Pn.jsxs)("div",{className:"space-y-3",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Pn.jsx)("span",{className:"text-gray-600",children:"Permissions :"}),(0,Pn.jsx)("span",{className:"font-medium text-primary-600",children:e.permission_count})]}),(0,Pn.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Pn.jsx)("span",{className:"text-gray-600",children:"Cr\xe9\xe9 le :"}),(0,Pn.jsx)("span",{className:"text-gray-500",children:new Date(e.created_at).toLocaleDateString("fr-FR")})]})]}),(0,Pn.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,Pn.jsxs)("button",{onClick:()=>(e=>{d(e),x(e.id),m(!0)})(e),className:"w-full btn btn-outline flex items-center justify-center",children:[(0,Pn.jsx)(Hp,{className:"h-4 w-4 mr-2"}),"G\xe9rer les permissions"]})})]},e.id))}),(0,Pn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Pn.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[(0,Pn.jsx)(Gn,{className:"h-5 w-5 mr-2"}),"Vue d'ensemble des permissions"]}),(0,Pn.jsx)("div",{className:"space-y-6",children:Object.entries(n).map(e=>{let[t,r]=e;return(0,Pn.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,Pn.jsxs)("div",{className:"flex items-center mb-3",children:[(0,Pn.jsx)("span",{className:"text-lg mr-2",children:v(t)}),(0,Pn.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:b(t)})]}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:r.map(e=>(0,Pn.jsx)("div",{className:"flex items-center p-2 bg-gray-50 rounded border",children:(0,Pn.jsxs)("div",{className:"flex-1",children:[(0,Pn.jsx)("div",{className:"text-sm font-medium text-gray-900",children:y(e.action)}),(0,Pn.jsx)("div",{className:"text-xs text-gray-500",children:e.description})]})},e.id))})]},t)})})]}),h&&c&&(0,Pn.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>m(!1)}),(0,Pn.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[(0,Pn.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,Pn.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Permissions pour ","admin"===c.name?"Administrateur":"teacher"===c.name?"Professeur":"student"===c.name?"\xc9tudiant":c.name]}),(0,Pn.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Cochez les permissions que vous souhaitez attribuer \xe0 ce r\xf4le"})]}),(0,Pn.jsx)("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:(0,Pn.jsx)(os,{className:"h-6 w-6"})})]}),(0,Pn.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,Pn.jsx)("div",{className:"space-y-6",children:Object.entries(n).map(e=>{let[t,r]=e;return(0,Pn.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,Pn.jsxs)("div",{className:"flex items-center mb-3",children:[(0,Pn.jsx)("span",{className:"text-lg mr-2",children:v(t)}),(0,Pn.jsx)("h4",{className:"text-md font-medium text-gray-900",children:b(t)})]}),(0,Pn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map(e=>(0,Pn.jsxs)("label",{className:"flex items-center p-3 bg-gray-50 rounded border cursor-pointer hover:bg-gray-100",children:[(0,Pn.jsx)("input",{type:"checkbox",checked:u.includes(e.id),onChange:()=>{return t=e.id,void f(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,Pn.jsxs)("div",{className:"ml-3 flex-1",children:[(0,Pn.jsx)("div",{className:"text-sm font-medium text-gray-900",children:y(e.action)}),(0,Pn.jsx)("div",{className:"text-xs text-gray-500",children:e.description})]})]},e.id))})]},t)})})})]}),(0,Pn.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,Pn.jsxs)("button",{onClick:async()=>{try{(await Rn.put("/api/roles/".concat(c.id,"/permissions"),{permissionIds:u})).data.success&&(sr.success("Permissions mises \xe0 jour avec succ\xe8s"),m(!1),d(null),f([]),p())}catch(r){var e,t;console.error("Erreur lors de la sauvegarde des permissions:",r),sr.error((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Erreur lors de la sauvegarde")}},className:"btn btn-primary sm:ml-3 sm:w-auto flex items-center",children:[(0,Pn.jsx)(Hs,{className:"h-4 w-4 mr-2"}),"Sauvegarder"]}),(0,Pn.jsx)("button",{onClick:()=>m(!1),className:"btn btn-secondary sm:ml-3 sm:w-auto",children:"Annuler"})]})]})]})})]})},qp=e=>{let{className:t=""}=e;const{selectedYear:r,availableYears:a,changeSchoolYear:n}=Fn();return(0,Pn.jsxs)("div",{className:"flex items-center space-x-2 ".concat(t),children:[(0,Pn.jsx)("label",{htmlFor:"school-year",className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"Ann\xe9e scolaire:"}),(0,Pn.jsx)("select",{id:"school-year",value:r,onChange:e=>n(e.target.value),className:"px-3 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:a.map(e=>(0,Pn.jsx)("option",{value:e.value,children:e.label},e.value))})]})},Gp=Vn("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),$p=Vn("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Yp=Vn("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Kp=Vn("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Xp=Vn("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Jp=()=>{const[e,t]=(0,s.useState)(!1),[r,a]=(0,s.useState)({}),{user:n,logout:i}=Ln(),l=ne(),o=async()=>{await i(),l("/login")},c=e=>{a(t=>qe(qe({},t),{},{[e]:!t[e]}))},d=[{name:"Tableau de bord",href:"/dashboard",icon:Gp,permission:"dashboard_view"},{name:"CONDUITE DE PROJET/CHANTIER",icon:Yn,permission:"projects_view",submenu:[{name:"Projets/Chantiers",href:"/projects",permission:"projects_view"},{name:"Planification",href:"/planning",permission:"planning_view"}]},{name:"\xc9tudiants",href:"/students",icon:Hn,permission:"students_view"},{name:"Classes",href:"/classes",icon:Jn,permission:"students_view"},{name:"Gestion des groupes",href:"/groups",icon:Jn,permission:"students_view"},{name:"Evaluations",icon:Gs,permission:"evaluations_view",submenu:[{name:"U51 Analyse - Diagnostic - Maintenance",href:"/evaluations-u51",permission:"evaluations_view"},{name:"U52 Conduite de chantier",href:"/evaluations",permission:"evaluations_view"},{name:"U61 - Conception et \xe9tude d\xe9taill\xe9e",href:"/evaluations-u61",permission:"evaluations_view"},{name:"U62 - R\xe9alisation et mise en service",href:"/evaluations-u62",permission:"evaluations_view"}]},{name:"Fiche TP",href:"/fiche-tp",icon:$p,permission:"documents_view"},{name:"Documents",href:"/documents",icon:us,permission:"documents_view"},{name:"Stage en entreprise",href:"/rapport-stage",icon:us,permission:"documents_view"},{name:"Entreprise",href:"/entreprise",icon:ni,permission:"documents_view"},..."admin"===(null===n||void 0===n?void 0:n.role)?[{name:"Utilisateurs",href:"/users",icon:Jn,permission:"users_view"},{name:"R\xf4les",href:"/roles",icon:Vp,permission:"roles_view"}]:[]].filter(e=>(e=>{var t;return(null===n||void 0===n||null===(t=n.permissions)||void 0===t?void 0:t.includes(e))||!1})(e.permission));return(0,Pn.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Pn.jsxs)("div",{className:"fixed inset-0 z-40 lg:hidden ".concat(e?"block":"hidden"),children:[(0,Pn.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>t(!1)}),(0,Pn.jsxs)("div",{className:"relative flex-1 flex flex-col max-w-xs w-full bg-white",children:[(0,Pn.jsx)("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:(0,Pn.jsx)("button",{type:"button",className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>t(!1),children:(0,Pn.jsx)(os,{className:"h-6 w-6 text-white"})})}),(0,Pn.jsxs)("div",{className:"flex-1 h-0 pt-5 pb-4 overflow-y-auto",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0 flex items-center px-4",children:(0,Pn.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:"GESTION BTS ELECTROTECHNIQUE"})}),(0,Pn.jsx)("nav",{className:"mt-5 px-2 space-y-1",children:d.map(e=>(0,Pn.jsx)("div",{children:e.submenu?(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("button",{onClick:()=>c(e.name),className:"group flex items-center justify-between w-full px-2 py-2 text-base font-medium rounded-md text-gray-600 hover:bg-gray-50 hover:text-gray-900",children:[(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)(e.icon,{className:"mr-4 h-6 w-6"}),e.name]}),r[e.name]?(0,Pn.jsx)(Yp,{className:"h-4 w-4"}):(0,Pn.jsx)(ks,{className:"h-4 w-4"})]}),r[e.name]&&(0,Pn.jsx)("div",{className:"ml-6 space-y-1",children:e.submenu.map(e=>(0,Pn.jsx)(Ie,{to:e.href,className:e=>{let{isActive:t}=e;return"group flex items-center px-2 py-2 text-sm font-medium rounded-md ".concat(t?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900")},onClick:()=>t(!1),children:e.name},e.name))})]}):(0,Pn.jsxs)(Ie,{to:e.href,className:e=>{let{isActive:t}=e;return"group flex items-center px-2 py-2 text-base font-medium rounded-md ".concat(t?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900")},onClick:()=>t(!1),children:[(0,Pn.jsx)(e.icon,{className:"mr-4 h-6 w-6"}),e.name]})},e.name))})]}),(0,Pn.jsx)("div",{className:"flex-shrink-0 flex border-t border-gray-200 p-4",children:(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)("div",{className:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center",children:(0,Pn.jsx)(Hn,{className:"h-5 w-5 text-primary-600"})})}),(0,Pn.jsxs)("div",{className:"ml-3",children:[(0,Pn.jsx)("p",{className:"text-base font-medium text-gray-700",children:null!==n&&void 0!==n&&n.first_name&&null!==n&&void 0!==n&&n.last_name?"".concat(n.first_name," ").concat(n.last_name):null===n||void 0===n?void 0:n.username}),(0,Pn.jsx)("p",{className:"text-sm font-medium text-gray-500 capitalize",children:"admin"===(null===n||void 0===n?void 0:n.role)?"Administrateur":"teacher"===(null===n||void 0===n?void 0:n.role)?"Professeur":"student"===(null===n||void 0===n?void 0:n.role)?"\xc9tudiant":null===n||void 0===n?void 0:n.role})]})]})})]})]}),(0,Pn.jsx)("div",{className:"hidden lg:flex lg:w-64 lg:flex-col lg:fixed lg:inset-y-0",children:(0,Pn.jsxs)("div",{className:"flex-1 flex flex-col min-h-0 bg-white border-r border-gray-200",children:[(0,Pn.jsxs)("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:[(0,Pn.jsx)("div",{className:"flex items-center flex-shrink-0 px-4",children:(0,Pn.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:"GESTION BTS ELECTROTECHNIQUE"})}),(0,Pn.jsx)("nav",{className:"mt-5 flex-1 px-2 space-y-1",children:d.map(e=>(0,Pn.jsx)("div",{children:e.submenu?(0,Pn.jsxs)("div",{children:[(0,Pn.jsxs)("button",{onClick:()=>c(e.name),className:"group flex items-center justify-between w-full px-2 py-2 text-sm font-medium rounded-md text-gray-600 hover:bg-gray-50 hover:text-gray-900",children:[(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)(e.icon,{className:"mr-3 h-5 w-5"}),e.name]}),r[e.name]?(0,Pn.jsx)(Yp,{className:"h-4 w-4"}):(0,Pn.jsx)(ks,{className:"h-4 w-4"})]}),r[e.name]&&(0,Pn.jsx)("div",{className:"ml-6 space-y-1",children:e.submenu.map(e=>(0,Pn.jsx)(Ie,{to:e.href,className:e=>{let{isActive:t}=e;return"group flex items-center px-2 py-2 text-sm font-medium rounded-md ".concat(t?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900")},children:e.name},e.name))})]}):(0,Pn.jsxs)(Ie,{to:e.href,className:e=>{let{isActive:t}=e;return"group flex items-center px-2 py-2 text-sm font-medium rounded-md ".concat(t?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900")},children:[(0,Pn.jsx)(e.icon,{className:"mr-3 h-5 w-5"}),e.name]})},e.name))})]}),(0,Pn.jsxs)("div",{className:"flex-shrink-0 flex border-t border-gray-200 p-4",children:[(0,Pn.jsxs)("div",{className:"flex items-center",children:[(0,Pn.jsx)("div",{className:"flex-shrink-0",children:(0,Pn.jsx)("div",{className:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center",children:(0,Pn.jsx)(Hn,{className:"h-5 w-5 text-primary-600"})})}),(0,Pn.jsxs)("div",{className:"ml-3",children:[(0,Pn.jsx)("p",{className:"text-sm font-medium text-gray-700",children:null!==n&&void 0!==n&&n.first_name&&null!==n&&void 0!==n&&n.last_name?"".concat(n.first_name," ").concat(n.last_name):null===n||void 0===n?void 0:n.username}),(0,Pn.jsx)("p",{className:"text-xs font-medium text-gray-500 capitalize",children:"admin"===(null===n||void 0===n?void 0:n.role)?"Administrateur":"teacher"===(null===n||void 0===n?void 0:n.role)?"Professeur":"student"===(null===n||void 0===n?void 0:n.role)?"\xc9tudiant":null===n||void 0===n?void 0:n.role})]})]}),(0,Pn.jsx)("button",{onClick:o,className:"ml-auto flex-shrink-0 p-1 rounded-full text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:(0,Pn.jsx)(Kp,{className:"h-5 w-5"})})]})]})}),(0,Pn.jsxs)("div",{className:"lg:pl-64 flex flex-col flex-1",children:[(0,Pn.jsxs)("div",{className:"sticky top-0 z-10 flex-shrink-0 flex h-16 bg-white shadow",children:[(0,Pn.jsx)("button",{type:"button",className:"px-4 border-r border-gray-200 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500 lg:hidden",onClick:()=>t(!0),children:(0,Pn.jsx)(Xp,{className:"h-6 w-6"})}),(0,Pn.jsxs)("div",{className:"flex-1 px-4 flex justify-between",children:[(0,Pn.jsx)("div",{className:"flex-1 flex",children:(0,Pn.jsx)("div",{className:"w-full flex md:ml-0",children:(0,Pn.jsxs)("div",{className:"relative w-full text-gray-400 focus-within:text-gray-600",children:[(0,Pn.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pointer-events-none",children:(0,Pn.jsx)(Hp,{className:"h-5 w-5"})}),(0,Pn.jsx)("input",{className:"block w-full h-full pl-8 pr-3 py-2 border-transparent text-gray-900 placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-0 focus:border-transparent sm:text-sm",placeholder:"Rechercher...",type:"search",name:"search"})]})})}),(0,Pn.jsx)("div",{className:"ml-4 flex items-center md:ml-6",children:(0,Pn.jsx)("button",{onClick:o,className:"p-1 rounded-full text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 lg:hidden",children:(0,Pn.jsx)(Kp,{className:"h-6 w-6"})})})]})]}),(0,Pn.jsx)("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:(0,Pn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pn.jsx)("div",{className:"flex items-center space-x-4",children:(0,Pn.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:(()=>{const e=window.location.pathname,t=d.find(t=>t.href===e||!!t.submenu&&t.submenu.some(t=>t.href===e));if(t){if(t.href===e)return t.name;if(t.submenu){const r=t.submenu.find(t=>t.href===e);return r?r.name:t.name}}return"GESTION BTS ELECTROTECHNIQUE"})()})}),(0,Pn.jsx)(qp,{})]})}),(0,Pn.jsx)("main",{className:"flex-1",children:(0,Pn.jsx)(we,{})})]})]})},Qp=()=>(0,Pn.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,Pn.jsxs)("div",{className:"text-center",children:[(0,Pn.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),(0,Pn.jsx)("p",{className:"text-gray-600 text-lg",children:"Chargement..."})]})}),Zp=e=>{let{children:t}=e;const{user:r,loading:a}=Ln();return a?(0,Pn.jsx)(Qp,{}):r?t:(0,Pn.jsx)(ye,{to:"/login",replace:!0})},eg=()=>(0,Pn.jsxs)(ke,{children:[(0,Pn.jsx)(Ne,{path:"/login",element:(0,Pn.jsx)($n,{})}),(0,Pn.jsxs)(Ne,{path:"/",element:(0,Pn.jsx)(Zp,{children:(0,Pn.jsx)(Jp,{})}),children:[(0,Pn.jsx)(Ne,{index:!0,element:(0,Pn.jsx)(ye,{to:"/planning",replace:!0})}),(0,Pn.jsx)(Ne,{path:"dashboard",element:(0,Pn.jsx)(Zn,{})}),(0,Pn.jsx)(Ne,{path:"projects",element:(0,Pn.jsx)(ns,{})}),(0,Pn.jsx)(Ne,{path:"students",element:(0,Pn.jsx)(hs,{})}),(0,Pn.jsx)(Ne,{path:"classes",element:(0,Pn.jsx)(gs,{})}),(0,Pn.jsx)(Ne,{path:"groups",element:(0,Pn.jsx)(xs,{})}),(0,Pn.jsx)(Ne,{path:"planning",element:(0,Pn.jsx)(Bs,{})}),(0,Pn.jsx)(Ne,{path:"evaluations",element:(0,Pn.jsx)(Js,{})}),(0,Pn.jsx)(Ne,{path:"evaluations-u51",element:(0,Pn.jsx)(Ys,{})}),(0,Pn.jsx)(Ne,{path:"evaluations-u61",element:(0,Pn.jsx)(Ks,{})}),(0,Pn.jsx)(Ne,{path:"evaluations-u62",element:(0,Pn.jsx)(Xs,{})}),(0,Pn.jsx)(Ne,{path:"fiche-tp",element:(0,Pn.jsx)(Zs,{})}),(0,Pn.jsx)(Ne,{path:"documents",element:(0,Pn.jsx)(ei,{})}),(0,Pn.jsx)(Ne,{path:"rapport-stage",element:(0,Pn.jsx)(ai,{})}),(0,Pn.jsx)(Ne,{path:"entreprise",element:(0,Pn.jsx)(zp,{})}),(0,Pn.jsx)(Ne,{path:"users",element:(0,Pn.jsx)(Bp,{})}),(0,Pn.jsx)(Ne,{path:"roles",element:(0,Pn.jsx)(Wp,{})})]})]}),tg=()=>(0,Pn.jsx)(In,{children:(0,Pn.jsx)(Un,{children:(0,Pn.jsx)(eg,{})})});l.createRoot(document.getElementById("root")).render((0,Pn.jsx)(s.StrictMode,{children:(0,Pn.jsxs)(Re,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[(0,Pn.jsx)(tg,{}),(0,Pn.jsx)(nr,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}})]})}))})();
//# sourceMappingURL=main.03bb5157.js.map